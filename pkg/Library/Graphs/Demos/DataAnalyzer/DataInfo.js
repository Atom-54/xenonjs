/**
 * @license
 * Copyright 2023 Atom54 LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */

// TODO: Fix "Chart" css.

export const dataInfo = {
  "meta":{
    "id":"DataInfo"
  },
  "JSONata":{
    "type":"$library/Json/Atoms/JSONata",
    "container":"Container",
    "state":{
      "expression":"$filter(\n  $map($, function($v, $i, $a) {\n    $v[0]\n  }), function($v, $i, $a) {\n    $i > 0 and $i <= 50\n})[]\n",
      "style":{
        "order":7
      }
    }
  },
  "Iterator":{
    "type":"$library/Data/Atoms/Iterator",
    "container":"Container",
    "state":{
      "stride":"5",
      "style":{
        "order":8
      }
    },
    "connections":{
      "source":[
        "JSONata$result"
      ],
      "response":[
        "Data$value"
      ]
    }
  },
  "StringFormatter":{
    "type":"$library/Data/Atoms/StringFormatter",
    "container":"Container",
    "state":{
      "format":"${arg0}\n${arg1}\n",
      "arg0":"The JSON array below contains summaries of customer interaction.",
      "style":{
        "order":9
      }
    },
    "connections":{
      "arg1":[
        "Iterator$data"
      ]
    }
  },
  "Gate":{
    "type":"$library/Data/Atoms/Gate",
    "container":"Container",
    "connections":{
      "json":[
        "StringFormatter$result"
      ],
      "trigger":[
        "ConsiderButton$value"
      ]
    }
  },
  "ConsiderButton":{
    "type":"$library/Fields/Atoms/Button",
    "container":"ButtonPanel#Container",
    "state":{
      "label":"Consider",
      "action":"toggle",
      "style":{
        "order":3,
        "flex":"0 0 auto",
        "max-width":"100px"
      }
    }
  },
  "OpenAISimpleChat":{
    "type":"$library/OpenAI/Atoms/OpenAISimpleChat",
    "container":"Container",
    "state":{
      "on":true,
      "user":"",
      "auto":"true",
      "system":"Produce a JSON array with one entry for each input entry. The produced entries should have fields called 'chosen' and 'reason'. 'chosen' is which product was chosen, and 'reason' is a one line summary of why.",
      "kTokens":"2",
      "temperature":"0.1",
      "style":{
        "order":8
      }
    },
    "connections":{
      "user":[
        "Gate$value"
      ]
    }
  },
  "ProgressBar":{
    "type":"$library/UX/Atoms/ProgressBar",
    "container":"ProgressPanel#Container",
    "state":{
      "height":8,
      "percentage":0,
      "inProgress":false,
      "interval":60,
      "style":{
        "flex":"0 0 auto",
        "borderRadius":"var(--radius-3)",
        "order":20
      }
    },
    "connections":{
      "inProgress":[
        "OpenAISimpleChat$working"
      ]
    }
  },
  "Data":{
    "type":"$library/Data/Atoms/Data",
    "container":"Container",
    "connections":{
      "json":[
        "OpenAISimpleChat$result"
      ]
    }
  },
  "Table":{
    "type":"$library/Data/Atoms/Table",
    "container":"MainPanel#Container",
    "state":{
      "options":{
        
      },
      "columns":[
        {
          "name":"chosen",
          "header":"Chosen",
          "width":120
        },
        {
          "name":"reason",
          "header":"Reasoning",
          "XwhiteSpace":"normal"
        }
      ],
      "style":{
        "fontSize":"var(--font-size-0)",
        "order":3,
        "flex":"1"
      }
    },
    "connections":{
      "data":[
        "Iterator$results"
      ]
    }
  },
  "ChartJSONata":{
    "type":"$library/Json/Atoms/JSONata",
    "container":"Container",
    "state":{
      "expression":"(\n$foo := $map($distinct(*.chosen), function($v) {\n  {\"chosen\": $v, \"count\": $count($filter($.chosen, function($v2) { $v2 = $v }))}\n});\n$bar := {\n    \"labels\": [$foo.chosen], \n    \"datasets\": [{\n        \"label\": \"Products\",\n        \"data\": [$foo.count],\n        \"backgroundColor\": [\n            'red',\n            'green',\n            'blue',\n            'yellow',\n            'purple'\n        ]\n    }]}\n)",
      "style":{
        "order":4
      }
    },
    "connections":{
      "json":[
        "Iterator$results"
      ]
    }
  },
  "Chart":{
    "type":"$library/Data/Atoms/Chart",
    "container":"ChartPanel#Container",
    "state":{
      "type":"pie",
      "style":{
        "order":"1",
        "alignItems":"",
        "backgroundColor":"white",
        "padding":"none",
        "flex":"1 1 0",
        "aspectRatio":"1 / 1"
      },
      "data":null
    },
    "connections":{
      "data":[
        "ChartJSONata$result"
      ]
    }
  },
  "MainPanel":{
    "type":"$library/Layout/Atoms/Panel",
    "container":"Container",
    "state":{
      "layout":"column",
      "style":{
        "flex":"1",
        "backgroundColor":"var(--xcolor-one)",
        "order":0
      }
    }
  },
  "ButtonPanel":{
    "type":"$library/Layout/Atoms/Panel",
    "container":"MainPanel#Container",
    "state":{
      "layout":"column",
      "style":{
        "padding":"var(--size-3)",
        "paddingBottom":"0px",
        "backgroundColor":"var(--xcolor-one)",
        "order":0,
        "flex":"0 0 auto"
      }
    }
  },
  "ProgressPanel":{
    "type":"$library/Layout/Atoms/Panel",
    "container":"MainPanel#Container",
    "state":{
      "layout":"column",
      "style":{
        "padding":"var(--size-1)",
        "order":1,
        "flex":"0 0 auto"
      }
    }
  },
  "ChartPanel":{
    "type":"$library/Layout/Atoms/Panel",
    "container":"MainPanel#Container",
    "state":{
      "layout":"column",
      "style":{
        "padding":"var(--size-2)",
        "order":2
      }
    }
  }
};
