(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PNoise = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PNoise=(()=>{var rh=Object.create;var Wn=Object.defineProperty;var nh=Object.getOwnPropertyDescriptor;var ih=Object.getOwnPropertyNames;var oh=Object.getPrototypeOf,sh=Object.prototype.hasOwnProperty;var j=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Rt=(t,e)=>{for(var r in e)Wn(t,r,{get:e[r],enumerable:!0})},va=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ih(e))!sh.call(t,i)&&i!==r&&Wn(t,i,{get:()=>e[i],enumerable:!(n=nh(e,i))||n.enumerable});return t};var Ct=(t,e,r)=>(r=t!=null?rh(oh(t)):{},va(e||!t||!t.__esModule?Wn(r,"default",{value:t,enumerable:!0}):r,t)),ah=t=>va(Wn({},"__esModule",{value:!0}),t);var Ca=j((Zg,Aa)=>{"use strict";function Ba(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function yh(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Ba(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),Ba(new i,r)}}Aa.exports=yh});var dt=j((zx,w0)=>{w0.exports={options:{usePureJavaScript:!1}}});var B0=j((Gx,S0)=>{var Mo={};S0.exports=Mo;var E0={};Mo.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=Wl(t,e);else{var i=0,o=e.length,s=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var c=0,f=t[i];c<a.length;++c)f+=a[c]<<8,a[c]=f%o,f=f/o|0;for(;f>0;)a.push(f%o),f=f/o|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};Mo.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=E0[e];if(!r){r=E0[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),s=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,f=a;c<s.length;++c)f+=s[c]*i,s[c]=f&255,f>>=8;for(;f>0;)s.push(f&255),f>>=8}for(var u=0;t[u]===o&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function Wl(t,e){var r=0,n=e.length,i=e.charAt(0),o=[0];for(r=0;r<t.length();++r){for(var s=0,a=t.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=o.length-1;r>=0;--r)c+=e[o[r]];return c}});var _t=j((Wx,I0)=>{var A0=dt(),C0=B0(),b=I0.exports=A0.util=A0.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){b.nextTick=process.nextTick,typeof setImmediate=="function"?b.setImmediate=setImmediate:b.setImmediate=b.nextTick;return}if(typeof setImmediate=="function"){b.setImmediate=function(){return setImmediate.apply(void 0,arguments)},b.nextTick=function(a){return setImmediate(a)};return}if(b.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var f=e.slice();e.length=0,f.forEach(function(u){u()})}};var s=a,t="forge.setImmediate",e=[];b.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(f){f()})}).observe(i,{attributes:!0});var o=b.setImmediate;b.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),o(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}b.nextTick=b.setImmediate})();b.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;b.globalScope=function(){return b.isNodejs?globalThis:typeof self>"u"?window:self}();b.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};b.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};b.isArrayBufferView=function(t){return t&&b.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Bn(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}b.ByteBuffer=Fo;function Fo(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(b.isArrayBuffer(t)||b.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Fo||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}b.ByteStringBuffer=Fo;var Yl=4096;b.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>Yl&&(this.data.substr(0,1),this._constructedStringLength=0)};b.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};b.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};b.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};b.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};b.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};b.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(b.encodeUtf8(t))};b.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};b.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};b.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};b.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};b.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};b.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};b.ByteStringBuffer.prototype.putInt=function(t,e){Bn(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};b.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};b.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};b.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};b.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};b.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};b.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};b.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};b.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};b.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};b.ByteStringBuffer.prototype.getInt=function(t){Bn(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};b.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};b.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};b.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};b.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};b.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};b.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};b.ByteStringBuffer.prototype.copy=function(){var t=b.createBuffer(this.data);return t.read=this.read,t};b.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};b.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};b.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};b.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};b.ByteStringBuffer.prototype.toString=function(){return b.decodeUtf8(this.bytes())};function $l(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=b.isArrayBuffer(t),n=b.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}b.DataBuffer=$l;b.DataBuffer.prototype.length=function(){return this.write-this.read};b.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};b.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};b.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};b.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};b.DataBuffer.prototype.putBytes=function(t,e){if(b.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(b.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof b.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&b.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof b.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var o;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=b.binary.hex.decode(t,o,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=b.binary.base64.decode(t,o,this.write),this;if(e==="utf8"&&(t=b.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=b.binary.raw.decode(o),this;if(e==="utf16")return this.accommodate(t.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=b.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};b.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};b.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};b.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};b.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};b.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};b.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};b.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};b.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};b.DataBuffer.prototype.putInt=function(t,e){Bn(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};b.DataBuffer.prototype.putSignedInt=function(t,e){return Bn(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};b.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};b.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};b.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};b.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};b.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};b.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};b.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};b.DataBuffer.prototype.getInt=function(t){Bn(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};b.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};b.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};b.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};b.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};b.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};b.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};b.DataBuffer.prototype.copy=function(){return new b.DataBuffer(this)};b.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};b.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};b.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};b.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};b.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return b.binary.raw.encode(e);if(t==="hex")return b.binary.hex.encode(e);if(t==="base64")return b.binary.base64.encode(e);if(t==="utf8")return b.text.utf8.decode(e);if(t==="utf16")return b.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};b.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=b.encodeUtf8(t)),new b.ByteBuffer(t)};b.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};b.xorBytes=function(t,e,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o,n};b.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};b.bytesToHex=function(t){return b.createBuffer(t).toHex()};b.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Je=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_0="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";b.encode64=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.length;)i=t.charCodeAt(a++),o=t.charCodeAt(a++),s=t.charCodeAt(a++),r+=Qe.charAt(i>>2),r+=Qe.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Qe.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Qe.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};b.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,o,s=0;s<t.length;)r=Je[t.charCodeAt(s++)-43],n=Je[t.charCodeAt(s++)-43],i=Je[t.charCodeAt(s++)-43],o=Je[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(e+=String.fromCharCode((i&3)<<6|o)));return e};b.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};b.decodeUtf8=function(t){return decodeURIComponent(escape(t))};b.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:C0.encode,decode:C0.decode}};b.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};b.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};b.binary.hex.encode=b.bytesToHex;b.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,o=r;for(t.length&1&&(i=1,n[o++]=parseInt(t[0],16));i<t.length;i+=2)n[o++]=parseInt(t.substr(i,2),16);return e?o-r:n};b.binary.base64.encode=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.byteLength;)i=t[a++],o=t[a++],s=t[a++],r+=Qe.charAt(i>>2),r+=Qe.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Qe.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Qe.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};b.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,s,a,c=0,f=r;c<t.length;)i=Je[t.charCodeAt(c++)-43],o=Je[t.charCodeAt(c++)-43],s=Je[t.charCodeAt(c++)-43],a=Je[t.charCodeAt(c++)-43],n[f++]=i<<2|o>>4,s!==64&&(n[f++]=(o&15)<<4|s>>2,a!==64&&(n[f++]=(s&3)<<6|a));return e?f-r:n.subarray(0,f)};b.binary.base58.encode=function(t,e){return b.binary.baseN.encode(t,_0,e)};b.binary.base58.decode=function(t,e){return b.binary.baseN.decode(t,_0,e)};b.text={utf8:{},utf16:{}};b.text.utf8.encode=function(t,e,r){t=b.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};b.text.utf8.decode=function(t){return b.decodeUtf8(String.fromCharCode.apply(null,t))};b.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,s=r,a=0;a<t.length;++a)i[s++]=t.charCodeAt(a),o+=2;return e?o-r:n};b.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};b.deflate=function(t,e,r){if(e=b.decode64(t.deflate(b.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};b.inflate=function(t,e,r){var n=t.inflate(b.encode64(e)).rval;return n===null?null:b.decode64(n)};var Vo=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=b.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},qo=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(b.decode64(r))),r},Zl=function(t,e,r,n){var i=qo(t,e);i===null&&(i={}),i[r]=n,Vo(t,e,i)},Xl=function(t,e,r){var n=qo(t,e);return n!==null&&(n=r in n?n[r]:null),n},Ql=function(t,e,r){var n=qo(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),Vo(t,e,n)}},Jl=function(t,e){Vo(t,e,null)},vi=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,s=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),o=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),o=!0)}catch(c){s=c}if(o)break}if(!o)throw s;return n};b.setItem=function(t,e,r,n,i){vi(Zl,arguments,i)};b.getItem=function(t,e,r,n){return vi(Xl,arguments,n)};b.removeItem=function(t,e,r,n){vi(Ql,arguments,n)};b.clearItems=function(t,e,r){vi(Jl,arguments,r)};b.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};b.format=function(t){for(var e=/%./g,r,n,i=0,o=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&o.push(n),s=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(t.substring(s)),o.join("")};b.formatNumber=function(t,e,r,n){var i=t,o=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",f=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",u=f.length>3?f.length%3:0;return c+(u?f.substr(0,u)+a:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-f).toFixed(o).slice(2):"")};b.formatSize=function(t){return t>=1073741824?t=b.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=b.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=b.formatNumber(t/1024,0)+" KiB":t=b.formatNumber(t,0)+" bytes",t};b.bytesFromIP=function(t){return t.indexOf(".")!==-1?b.bytesFromIPv4(t):t.indexOf(":")!==-1?b.bytesFromIPv6(t):null};b.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=b.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};b.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=b.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=b.hexToBytes(t[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};b.bytesToIP=function(t){return t.length===4?b.bytesToIPv4(t):t.length===16?b.bytesToIPv6(t):null};b.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};b.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var o=b.bytesToHex(t[i]+t[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var s=r[r.length-1],a=e.length;!s||a!==s.end+1?r.push({start:a,end:a}):(s.end=a,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(o)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};b.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in b&&!t.update)return e(null,b.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return b.cores=navigator.hardwareConcurrency,e(null,b.cores);if(typeof Worker>"u")return b.cores=1,e(null,b.cores);if(typeof Blob>"u")return b.cores=2,e(null,b.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,a,c){if(a===0){var f=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return b.cores=Math.max(1,f),URL.revokeObjectURL(r),e(null,b.cores)}i(c,function(u,h){s.push(o(c,h)),n(s,a-1,c)})}function i(s,a){for(var c=[],f=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===s){for(var g=0;g<s;++g)c[g].terminate();a(null,f)}}),c.push(h)}for(var u=0;u<s;++u)c[u].postMessage(u)}function o(s,a){for(var c=[],f=0;f<s;++f)for(var u=a[f],h=c[f]=[],l=0;l<s;++l)if(f!==l){var g=a[l];(u.st>g.st&&u.st<g.et||g.st>u.st&&g.st<u.et)&&h.push(l)}return c.reduce(function(d,p){return Math.max(d,p.length)},0)}}});var wi=j((Yx,T0)=>{var An=dt();An.pki=An.pki||{};var Ho=T0.exports=An.pki.oids=An.oids=An.oids||{};function N(t,e){Ho[t]=e,Ho[e]=t}function ht(t,e){Ho[t]=e}N("1.2.840.113549.1.1.1","rsaEncryption");N("1.2.840.113549.1.1.4","md5WithRSAEncryption");N("1.2.840.113549.1.1.5","sha1WithRSAEncryption");N("1.2.840.113549.1.1.7","RSAES-OAEP");N("1.2.840.113549.1.1.8","mgf1");N("1.2.840.113549.1.1.9","pSpecified");N("1.2.840.113549.1.1.10","RSASSA-PSS");N("1.2.840.113549.1.1.11","sha256WithRSAEncryption");N("1.2.840.113549.1.1.12","sha384WithRSAEncryption");N("1.2.840.113549.1.1.13","sha512WithRSAEncryption");N("1.3.101.112","EdDSA25519");N("1.2.840.10040.4.3","dsa-with-sha1");N("1.3.14.3.2.7","desCBC");N("1.3.14.3.2.26","sha1");N("1.3.14.3.2.29","sha1WithRSASignature");N("2.16.840.1.101.3.4.2.1","sha256");N("2.16.840.1.101.3.4.2.2","sha384");N("2.16.840.1.101.3.4.2.3","sha512");N("2.16.840.1.101.3.4.2.4","sha224");N("2.16.840.1.101.3.4.2.5","sha512-224");N("2.16.840.1.101.3.4.2.6","sha512-256");N("1.2.840.113549.2.2","md2");N("1.2.840.113549.2.5","md5");N("1.2.840.113549.1.7.1","data");N("1.2.840.113549.1.7.2","signedData");N("1.2.840.113549.1.7.3","envelopedData");N("1.2.840.113549.1.7.4","signedAndEnvelopedData");N("1.2.840.113549.1.7.5","digestedData");N("1.2.840.113549.1.7.6","encryptedData");N("1.2.840.113549.1.9.1","emailAddress");N("1.2.840.113549.1.9.2","unstructuredName");N("1.2.840.113549.1.9.3","contentType");N("1.2.840.113549.1.9.4","messageDigest");N("1.2.840.113549.1.9.5","signingTime");N("1.2.840.113549.1.9.6","counterSignature");N("1.2.840.113549.1.9.7","challengePassword");N("1.2.840.113549.1.9.8","unstructuredAddress");N("1.2.840.113549.1.9.14","extensionRequest");N("1.2.840.113549.1.9.20","friendlyName");N("1.2.840.113549.1.9.21","localKeyId");N("1.2.840.113549.1.9.22.1","x509Certificate");N("1.2.840.113549.1.12.10.1.1","keyBag");N("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");N("1.2.840.113549.1.12.10.1.3","certBag");N("1.2.840.113549.1.12.10.1.4","crlBag");N("1.2.840.113549.1.12.10.1.5","secretBag");N("1.2.840.113549.1.12.10.1.6","safeContentsBag");N("1.2.840.113549.1.5.13","pkcs5PBES2");N("1.2.840.113549.1.5.12","pkcs5PBKDF2");N("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");N("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");N("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");N("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");N("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");N("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");N("1.2.840.113549.2.7","hmacWithSHA1");N("1.2.840.113549.2.8","hmacWithSHA224");N("1.2.840.113549.2.9","hmacWithSHA256");N("1.2.840.113549.2.10","hmacWithSHA384");N("1.2.840.113549.2.11","hmacWithSHA512");N("1.2.840.113549.3.7","des-EDE3-CBC");N("2.16.840.1.101.3.4.1.2","aes128-CBC");N("2.16.840.1.101.3.4.1.22","aes192-CBC");N("2.16.840.1.101.3.4.1.42","aes256-CBC");N("2.5.4.3","commonName");N("2.5.4.4","surname");N("2.5.4.5","serialNumber");N("2.5.4.6","countryName");N("2.5.4.7","localityName");N("2.5.4.8","stateOrProvinceName");N("2.5.4.9","streetAddress");N("2.5.4.10","organizationName");N("2.5.4.11","organizationalUnitName");N("2.5.4.12","title");N("2.5.4.13","description");N("2.5.4.15","businessCategory");N("2.5.4.17","postalCode");N("2.5.4.42","givenName");N("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");N("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");N("2.16.840.1.113730.1.1","nsCertType");N("2.16.840.1.113730.1.13","nsComment");ht("2.5.29.1","authorityKeyIdentifier");ht("2.5.29.2","keyAttributes");ht("2.5.29.3","certificatePolicies");ht("2.5.29.4","keyUsageRestriction");ht("2.5.29.5","policyMapping");ht("2.5.29.6","subtreesConstraint");ht("2.5.29.7","subjectAltName");ht("2.5.29.8","issuerAltName");ht("2.5.29.9","subjectDirectoryAttributes");ht("2.5.29.10","basicConstraints");ht("2.5.29.11","nameConstraints");ht("2.5.29.12","policyConstraints");ht("2.5.29.13","basicConstraints");N("2.5.29.14","subjectKeyIdentifier");N("2.5.29.15","keyUsage");ht("2.5.29.16","privateKeyUsagePeriod");N("2.5.29.17","subjectAltName");N("2.5.29.18","issuerAltName");N("2.5.29.19","basicConstraints");ht("2.5.29.20","cRLNumber");ht("2.5.29.21","cRLReason");ht("2.5.29.22","expirationDate");ht("2.5.29.23","instructionCode");ht("2.5.29.24","invalidityDate");ht("2.5.29.25","cRLDistributionPoints");ht("2.5.29.26","issuingDistributionPoint");ht("2.5.29.27","deltaCRLIndicator");ht("2.5.29.28","issuingDistributionPoint");ht("2.5.29.29","certificateIssuer");ht("2.5.29.30","nameConstraints");N("2.5.29.31","cRLDistributionPoints");N("2.5.29.32","certificatePolicies");ht("2.5.29.33","policyMappings");ht("2.5.29.34","policyConstraints");N("2.5.29.35","authorityKeyIdentifier");ht("2.5.29.36","policyConstraints");N("2.5.29.37","extKeyUsage");ht("2.5.29.46","freshestCRL");ht("2.5.29.54","inhibitAnyPolicy");N("1.3.6.1.4.1.11129.2.4.2","timestampList");N("1.3.6.1.5.5.7.1.1","authorityInfoAccess");N("1.3.6.1.5.5.7.3.1","serverAuth");N("1.3.6.1.5.5.7.3.2","clientAuth");N("1.3.6.1.5.5.7.3.3","codeSigning");N("1.3.6.1.5.5.7.3.4","emailProtection");N("1.3.6.1.5.5.7.3.8","timeStamping")});var _n=j(($x,R0)=>{var mt=dt();_t();wi();var V=R0.exports=mt.asn1=mt.asn1||{};V.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};V.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};V.create=function(t,e,r,n,i){if(mt.util.isArray(n)){for(var o=[],s=0;s<n.length;++s)n[s]!==void 0&&o.push(n[s]);n=o}var a={tagClass:t,type:e,constructed:r,composed:r||mt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=V.copy(a)),a};V.copy=function(t,e){var r;if(mt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(V.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:V.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};V.equals=function(t,e,r){if(mt.util.isArray(t)){if(!mt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!V.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&V.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};V.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Cn(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var jl=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;Cn(t,e,o),n=t.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};V.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=mt.util.createBuffer(t));var r=t.length(),n=Ei(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function Ei(t,e,r,n){var i;Cn(t,e,2);var o=t.getByte();e--;var s=o&192,a=o&31;i=t.length();var c=jl(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=t.length(),f.remaining=e,f.requested=c,f}c=e}var u,h,l=(o&32)===32;if(l)if(u=[],c===void 0)for(;;){if(Cn(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(Ei(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),u.push(Ei(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(u===void 0&&s===V.Class.UNIVERSAL&&a===V.Type.BITSTRING&&(h=t.bytes(c)),u===void 0&&n.decodeBitStrings&&s===V.Class.UNIVERSAL&&a===V.Type.BITSTRING&&c>1){var g=t.read,d=e,p=0;if(a===V.Type.BITSTRING&&(Cn(t,e,1),p=t.getByte(),e--),p===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},x=Ei(t,e,r+1,y),S=i-t.length();e-=S,a==V.Type.BITSTRING&&S++;var m=x.tagClass;S===c&&(m===V.Class.UNIVERSAL||m===V.Class.CONTEXT_SPECIFIC)&&(u=[x])}catch{}u===void 0&&(t.read=g,e=d)}if(u===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===V.Type.BMPSTRING)for(u="";c>0;c-=2)Cn(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(c),e-=c}var _=h===void 0?null:{bitStringContents:h};return V.create(s,a,l,u,_)}V.toDer=function(t){var e=mt.util.createBuffer(),r=t.tagClass|t.type,n=mt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=V.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var o=0;o<t.value.length;++o)t.value[o]!==void 0&&n.putBuffer(V.toDer(t.value[o]))}else if(t.type===V.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)n.putInt16(t.value.charCodeAt(o));else t.type===V.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),a="";do a+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)e.putByte(a.charCodeAt(o))}return e.putBuffer(n),e};V.oidToDer=function(t){var e=t.split("."),r=mt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,o,s,a=2;a<e.length;++a){n=!0,i=[],o=parseInt(e[a],10);do s=o&127,o=o>>>7,n||(s|=128),i.push(s),n=!1;while(o>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};V.derToOid=function(t){var e;typeof t=="string"&&(t=mt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};V.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),f=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),f+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,0),f&&(c=t.charAt(f),c==="+"||c==="-")){var u=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10),l=u*60+h;l*=6e4,c==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};V.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,f=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var g=parseInt(t.substr(h+1,2),10),d=parseInt(t.substr(h+4,2),10);f=g*60+d,f*=6e4,l==="+"&&(f*=-1),u=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,c),e.setTime(+e+f)):(e.setFullYear(r,n,i),e.setHours(o,s,a,c)),e};V.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};V.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};V.integerToDer=function(t){var e=mt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};V.derToInteger=function(t){typeof t=="string"&&(t=mt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};V.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&mt.util.isArray(e.value))for(var o=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[o]&&(i=V.validate(t.value[o],e.value[s],r,n),i?++o:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var L0=/[^\\u0000-\\u00ff]/;V.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",o=0;o<e*r;++o)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case V.Class.UNIVERSAL:n+="Universal:";break;case V.Class.APPLICATION:n+="Application:";break;case V.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case V.Class.PRIVATE:n+="Private:";break}if(t.tagClass===V.Class.UNIVERSAL)switch(n+=t.type,t.type){case V.Type.NONE:n+=" (None)";break;case V.Type.BOOLEAN:n+=" (Boolean)";break;case V.Type.INTEGER:n+=" (Integer)";break;case V.Type.BITSTRING:n+=" (Bit string)";break;case V.Type.OCTETSTRING:n+=" (Octet string)";break;case V.Type.NULL:n+=" (Null)";break;case V.Type.OID:n+=" (Object Identifier)";break;case V.Type.ODESC:n+=" (Object Descriptor)";break;case V.Type.EXTERNAL:n+=" (External or Instance of)";break;case V.Type.REAL:n+=" (Real)";break;case V.Type.ENUMERATED:n+=" (Enumerated)";break;case V.Type.EMBEDDED:n+=" (Embedded PDV)";break;case V.Type.UTF8:n+=" (UTF8)";break;case V.Type.ROID:n+=" (Relative Object Identifier)";break;case V.Type.SEQUENCE:n+=" (Sequence)";break;case V.Type.SET:n+=" (Set)";break;case V.Type.PRINTABLESTRING:n+=" (Printable String)";break;case V.Type.IA5String:n+=" (IA5String (ASCII))";break;case V.Type.UTCTIME:n+=" (UTC time)";break;case V.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case V.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,a="",o=0;o<t.value.length;++o)t.value[o]!==void 0&&(s+=1,a+=V.prettyPrint(t.value[o],e+1,r),o+1<t.value.length&&(a+=","));n+=i+"Sub values: "+s+a}else{if(n+=i+"Value: ",t.type===V.Type.OID){var c=V.derToOid(t.value);n+=c,mt.pki&&mt.pki.oids&&c in mt.pki.oids&&(n+=" ("+mt.pki.oids[c]+") ")}if(t.type===V.Type.INTEGER)try{n+=V.derToInteger(t.value)}catch{n+="0x"+mt.util.bytesToHex(t.value)}else if(t.type===V.Type.BITSTRING){if(t.value.length>1?n+="0x"+mt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var f=t.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(t.type===V.Type.OCTETSTRING)L0.test(t.value)||(n+="("+t.value+") "),n+="0x"+mt.util.bytesToHex(t.value);else if(t.type===V.Type.UTF8)try{n+=mt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+mt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===V.Type.PRINTABLESTRING||t.type===V.Type.IA5String?n+=t.value:L0.test(t.value)?n+="0x"+mt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Go=j((Zx,D0)=>{var kt=dt();_t();D0.exports=kt.cipher=kt.cipher||{};kt.cipher.algorithms=kt.cipher.algorithms||{};kt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=kt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new kt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};kt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=kt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new kt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};kt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),kt.cipher.algorithms[t]=e};kt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in kt.cipher.algorithms?kt.cipher.algorithms[t]:null};var zo=kt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};zo.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=kt.util.createBuffer(),this.output=t.output||kt.util.createBuffer(),this.mode.start(e)};zo.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};zo.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Yo=j((Xx,k0)=>{var Nt=dt();_t();Nt.cipher=Nt.cipher||{};var nt=k0.exports=Nt.cipher.modes=Nt.cipher.modes||{};nt.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};nt.ecb.prototype.start=function(t){};nt.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};nt.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};nt.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};nt.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};nt.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};nt.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Si(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};nt.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};nt.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};nt.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};nt.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};nt.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Nt.util.createBuffer(),this._partialBytes=0};nt.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Si(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};nt.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};nt.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};nt.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Nt.util.createBuffer(),this._partialBytes=0};nt.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Si(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};nt.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};nt.ofb.prototype.decrypt=nt.ofb.prototype.encrypt;nt.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Nt.util.createBuffer(),this._partialBytes=0};nt.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Si(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};nt.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Bi(this._inBlock)};nt.ctr.prototype.decrypt=nt.ctr.prototype.encrypt;nt.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Nt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};nt.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Nt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Nt.util.createBuffer(t.additionalData):r=Nt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Nt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Wo(n*8)))}this._inBlock=this._j0.slice(0),Bi(this._inBlock),this._partialBytes=0,r=Nt.util.createBuffer(r),this._aDataLength=Wo(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};nt.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Bi(this._inBlock)};nt.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Bi(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};nt.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Nt.util.createBuffer();var n=this._aDataLength.concat(Wo(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};nt.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var o=t[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};nt.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};nt.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,o=this._m[r][i];e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3]}return e};nt.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};nt.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],c=s/n|0,f=(n-1-s%n)*e;a[c]=1<<e-1<<f,o[s]=this.generateSubHashTable(this.multiply(a,t),e)}return o};nt.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],c=i[s];i[o+s]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var f=i[o^n];i[o]=[t[0]^f[0],t[1]^f[1],t[2]^f[2],t[3]^f[3]]}return i};function Si(t,e){if(typeof t=="string"&&(t=Nt.util.createBuffer(t)),Nt.util.isArray(t)&&t.length>4){var r=t;t=Nt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Nt.util.isArray(t)){for(var i=[],o=e/4,n=0;n<o;++n)i.push(t.getInt32());t=i}return t}function Bi(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Wo(t){return[t/4294967296|0,t&4294967295]}});var Qo=j((Qx,K0)=>{var yt=dt();Go();Yo();_t();K0.exports=yt.aes=yt.aes||{};yt.aes.startEncrypting=function(t,e,r,n){var i=Ai({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};yt.aes.createEncryptionCipher=function(t,e){return Ai({key:t,output:null,decrypt:!1,mode:e})};yt.aes.startDecrypting=function(t,e,r,n){var i=Ai({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};yt.aes.createDecryptionCipher=function(t,e){return Ai({key:t,output:null,decrypt:!0,mode:e})};yt.aes.Algorithm=function(t,e){Xo||P0();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Zo(r._w,n,i,!1)},decrypt:function(n,i){return Zo(r._w,n,i,!0)}}}),r._init=!1};yt.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=yt.util.createBuffer(e);else if(yt.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=yt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!yt.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!yt.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=U0(e,t.decrypt&&!s),this._init=!0}};yt.aes._expandKey=function(t,e){return Xo||P0(),U0(t,e)};yt.aes._updateBlock=Zo;zr("AES-ECB",yt.cipher.modes.ecb);zr("AES-CBC",yt.cipher.modes.cbc);zr("AES-CFB",yt.cipher.modes.cfb);zr("AES-OFB",yt.cipher.modes.ofb);zr("AES-CTR",yt.cipher.modes.ctr);zr("AES-GCM",yt.cipher.modes.gcm);function zr(t,e){var r=function(){return new yt.aes.Algorithm(t,e)};yt.cipher.registerAlgorithm(t,r)}var Xo=!1,Hr=4,Yt,$o,N0,pr,le;function P0(){Xo=!0,N0=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Yt=new Array(256),$o=new Array(256),pr=new Array(4),le=new Array(4);for(var e=0;e<4;++e)pr[e]=new Array(256),le[e]=new Array(256);for(var r=0,n=0,i,o,s,a,c,f,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Yt[r]=a,$o[a]=r,c=t[a],i=t[r],o=t[i],s=t[o],f=c<<24^a<<16^a<<8^(a^c),u=(i^o^s)<<24^(r^s)<<16^(r^o^s)<<8^(r^i^s);for(var h=0;h<4;++h)pr[h][r]=f,le[h][a]=u,f=f<<24|f>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function U0(t,e){for(var r=t.slice(0),n,i=1,o=r.length,s=o+6+1,a=Hr*s,c=o;c<a;++c)n=r[c-1],c%o===0?(n=Yt[n>>>16&255]<<24^Yt[n>>>8&255]<<16^Yt[n&255]<<8^Yt[n>>>24]^N0[i]<<24,i++):o>6&&c%o===4&&(n=Yt[n>>>24]<<24^Yt[n>>>16&255]<<16^Yt[n>>>8&255]<<8^Yt[n&255]),r[c]=r[c-o]^n;if(e){var f,u=le[0],h=le[1],l=le[2],g=le[3],d=r.slice(0);a=r.length;for(var c=0,p=a-Hr;c<a;c+=Hr,p-=Hr)if(c===0||c===a-Hr)d[c]=r[p],d[c+1]=r[p+3],d[c+2]=r[p+2],d[c+3]=r[p+1];else for(var y=0;y<Hr;++y)f=r[p+y],d[c+(3&-y)]=u[Yt[f>>>24]]^h[Yt[f>>>16&255]]^l[Yt[f>>>8&255]]^g[Yt[f&255]];r=d}return r}function Zo(t,e,r,n){var i=t.length/4-1,o,s,a,c,f;n?(o=le[0],s=le[1],a=le[2],c=le[3],f=$o):(o=pr[0],s=pr[1],a=pr[2],c=pr[3],f=Yt);var u,h,l,g,d,p,y;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],g=e[n?1:3]^t[3];for(var x=3,S=1;S<i;++S)d=o[u>>>24]^s[h>>>16&255]^a[l>>>8&255]^c[g&255]^t[++x],p=o[h>>>24]^s[l>>>16&255]^a[g>>>8&255]^c[u&255]^t[++x],y=o[l>>>24]^s[g>>>16&255]^a[u>>>8&255]^c[h&255]^t[++x],g=o[g>>>24]^s[u>>>16&255]^a[h>>>8&255]^c[l&255]^t[++x],u=d,h=p,l=y;r[0]=f[u>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[g&255]^t[++x],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[g>>>8&255]<<8^f[u&255]^t[++x],r[2]=f[l>>>24]<<24^f[g>>>16&255]<<16^f[u>>>8&255]<<8^f[h&255]^t[++x],r[n?1:3]=f[g>>>24]<<24^f[u>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^t[++x]}function Ai(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=yt.cipher.createDecipher(r,t.key):n=yt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof yt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var F0=j((Jx,M0)=>{var wt=dt();Go();Yo();_t();M0.exports=wt.des=wt.des||{};wt.des.startEncrypting=function(t,e,r,n){var i=Ci({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};wt.des.createEncryptionCipher=function(t,e){return Ci({key:t,output:null,decrypt:!1,mode:e})};wt.des.startDecrypting=function(t,e,r,n){var i=Ci({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};wt.des.createDecryptionCipher=function(t,e){return Ci({key:t,output:null,decrypt:!0,mode:e})};wt.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return O0(r._keys,n,i,!1)},decrypt:function(n,i){return O0(r._keys,n,i,!0)}}}),r._init=!1};wt.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=wt.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=cd(e),this._init=!0}};me("DES-ECB",wt.cipher.modes.ecb);me("DES-CBC",wt.cipher.modes.cbc);me("DES-CFB",wt.cipher.modes.cfb);me("DES-OFB",wt.cipher.modes.ofb);me("DES-CTR",wt.cipher.modes.ctr);me("3DES-ECB",wt.cipher.modes.ecb);me("3DES-CBC",wt.cipher.modes.cbc);me("3DES-CFB",wt.cipher.modes.cfb);me("3DES-OFB",wt.cipher.modes.ofb);me("3DES-CTR",wt.cipher.modes.ctr);function me(t,e){var r=function(){return new wt.des.Algorithm(t,e)};wt.cipher.registerAlgorithm(t,r)}var td=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],ed=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],rd=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],nd=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],id=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],od=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],sd=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],ad=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function cd(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=t.length()>8?3:1,y=[],x=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],S=0,m,_=0;_<p;_++){var B=t.getInt32(),E=t.getInt32();m=(B>>>4^E)&252645135,E^=m,B^=m<<4,m=(E>>>-16^B)&65535,B^=m,E^=m<<-16,m=(B>>>2^E)&858993459,E^=m,B^=m<<2,m=(E>>>-16^B)&65535,B^=m,E^=m<<-16,m=(B>>>1^E)&1431655765,E^=m,B^=m<<1,m=(E>>>8^B)&16711935,B^=m,E^=m<<8,m=(B>>>1^E)&1431655765,E^=m,B^=m<<1,m=B<<8|E>>>20&240,B=E<<24|E<<8&16711680|E>>>8&65280|E>>>24&240,E=m;for(var L=0;L<x.length;++L){x[L]?(B=B<<2|B>>>26,E=E<<2|E>>>26):(B=B<<1|B>>>27,E=E<<1|E>>>27),B&=-15,E&=-15;var T=e[B>>>28]|r[B>>>24&15]|n[B>>>20&15]|i[B>>>16&15]|o[B>>>12&15]|s[B>>>8&15]|a[B>>>4&15],P=c[E>>>28]|f[E>>>24&15]|u[E>>>20&15]|h[E>>>16&15]|l[E>>>12&15]|g[E>>>8&15]|d[E>>>4&15];m=(P>>>16^T)&65535,y[S++]=T^m,y[S++]=P^m<<16}}return y}function O0(t,e,r,n){var i=t.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,a=e[0],c=e[1];s=(a>>>4^c)&252645135,c^=s,a^=s<<4,s=(a>>>16^c)&65535,c^=s,a^=s<<16,s=(c>>>2^a)&858993459,a^=s,c^=s<<2,s=(c>>>8^a)&16711935,a^=s,c^=s<<8,s=(a>>>1^c)&1431655765,c^=s,a^=s<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var f=0;f<i;f+=3){for(var u=o[f+1],h=o[f+2],l=o[f];l!=u;l+=h){var g=c^t[l],d=(c>>>4|c<<28)^t[l+1];s=a,a=c,c=s^(ed[g>>>24&63]|nd[g>>>16&63]|od[g>>>8&63]|ad[g&63]|td[d>>>24&63]|rd[d>>>16&63]|id[d>>>8&63]|sd[d&63])}s=a,a=c,c=s}a=a>>>1|a<<31,c=c>>>1|c<<31,s=(a>>>1^c)&1431655765,c^=s,a^=s<<1,s=(c>>>8^a)&16711935,a^=s,c^=s<<8,s=(c>>>2^a)&858993459,a^=s,c^=s<<2,s=(a>>>16^c)&65535,c^=s,a^=s<<16,s=(a>>>4^c)&252645135,c^=s,a^=s<<4,r[0]=a,r[1]=c}function Ci(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=wt.cipher.createDecipher(r,t.key):n=wt.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof wt.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var yr=j((jx,V0)=>{var _i=dt();V0.exports=_i.md=_i.md||{};_i.md.algorithms=_i.md.algorithms||{}});var H0=j((tm,q0)=>{var Ue=dt();yr();_t();var fd=q0.exports=Ue.hmac=Ue.hmac||{};fd.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(o,s){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in Ue.md.algorithms)e=Ue.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else e=o;if(s===null)s=t;else{if(typeof s=="string")s=Ue.util.createBuffer(s);else if(Ue.util.isArray(s)){var a=s;s=Ue.util.createBuffer();for(var c=0;c<a.length;++c)s.putByte(a[c])}var f=s.length();f>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=Ue.util.createBuffer(),n=Ue.util.createBuffer(),f=s.length();for(var c=0;c<f;++c){var a=s.at(c);r.putByte(54^a),n.putByte(92^a)}if(f<e.blockLength)for(var a=e.blockLength-f,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(o){e.update(o)},i.getMac=function(){var o=e.digest().bytes();return e.start(),e.update(n),e.update(o),e.digest()},i.digest=i.getMac,i}});var Ii=j(()=>{});var G0=j((nm,z0)=>{var $t=dt();H0();yr();_t();var ud=$t.pkcs5=$t.pkcs5||{},Ke;$t.util.isNodejs&&!$t.options.usePureJavaScript&&(Ke=Ii());z0.exports=$t.pbkdf2=ud.pbkdf2=function(t,e,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),$t.util.isNodejs&&!$t.options.usePureJavaScript&&Ke.pbkdf2&&(i===null||typeof i!="object")&&(Ke.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?Ke.pbkdf2Sync.length===4?Ke.pbkdf2(t,e,r,n,function(m,_){if(m)return o(m);o(null,_.toString("binary"))}):Ke.pbkdf2(t,e,r,n,i,function(m,_){if(m)return o(m);o(null,_.toString("binary"))}):Ke.pbkdf2Sync.length===4?Ke.pbkdf2Sync(t,e,r,n).toString("binary"):Ke.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in $t.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=$t.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var a=new Error("Derived key is too long.");if(o)return o(a);throw a}var c=Math.ceil(n/s),f=n-(c-1)*s,u=$t.hmac.create();u.start(i,t);var h="",l,g,d;if(!o){for(var p=1;p<=c;++p){u.start(null,null),u.update(e),u.update($t.util.int32ToBytes(p)),l=d=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(d),g=u.digest().getBytes(),l=$t.util.xorBytes(l,g,s),d=g;h+=p<c?l:l.substr(0,f)}return h}var p=1,y;function x(){if(p>c)return o(null,h);u.start(null,null),u.update(e),u.update($t.util.int32ToBytes(p)),l=d=u.digest().getBytes(),y=2,S()}function S(){if(y<=r)return u.start(null,null),u.update(d),g=u.digest().getBytes(),l=$t.util.xorBytes(l,g,s),d=g,++y,$t.util.setImmediate(S);h+=p<c?l:l.substr(0,f),++p,x()}x()}});var $0=j((im,Y0)=>{var Li=dt();_t();var W0=Y0.exports=Li.pem=Li.pem||{};W0.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Ti(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Ti(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Ti(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=Ti(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Li.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};W0.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(t),!!o;){var s=o[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var a={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Li.util.decode64(o[3])};if(e.push(a),!!o[2]){for(var c=o[2].split(i),f=0;o&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;u+=l,f=h}if(o=u.match(n),o){for(var g={name:o[1],values:[]},d=o[2].split(","),p=0;p<d.length;++p)g.values.push(hd(d[p]));if(a.procType)if(!a.contentDomain&&g.name==="Content-Domain")a.contentDomain=d[0]||"";else if(!a.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:d[0],parameters:d[1]||null}}else a.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:d[0],type:d[1]}}}++f}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Ti(t){for(var e=t.name+": ",r=[],n=function(c,f){return" "+f},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var o=0,s=-1,i=0;i<e.length;++i,++o)if(o>65&&s!==-1){var a=e[s];a===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+a+e.substr(s+1),o=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function hd(t){return t.replace(/^\s+/,"")}});var tc=j((om,j0)=>{var be=dt();yr();_t();var X0=j0.exports=be.sha256=be.sha256||{};be.md.sha256=be.md.algorithms.sha256=X0;X0.create=function(){Q0||ld();var t=null,e=be.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=be.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=be.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Z0(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=be.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(Jo.substr(0,n.blockLength-s));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Z0(h,r,i);var l=be.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Jo=null,Q0=!1,J0=null;function ld(){Jo=String.fromCharCode(128),Jo+=be.util.fillString(String.fromCharCode(0),64),J0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Q0=!0}function Z0(t,e,r){for(var n,i,o,s,a,c,f,u,h,l,g,d,p,y,x,S=r.length();S>=64;){for(f=0;f<16;++f)e[f]=r.getInt32();for(;f<64;++f)n=e[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[f-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[f]=n+e[f-7]+i+e[f-16]|0;for(u=t.h0,h=t.h1,l=t.h2,g=t.h3,d=t.h4,p=t.h5,y=t.h6,x=t.h7,f=0;f<64;++f)s=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),a=y^d&(p^y),o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|l&(u^h),n=x+s+a+J0[f]+e[f],i=o+c,x=y,y=p,p=d,d=g+n>>>0,g=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+g|0,t.h4=t.h4+d|0,t.h5=t.h5+p|0,t.h6=t.h6+y|0,t.h7=t.h7+x|0,S-=64}}});var rc=j((sm,ec)=>{var ve=dt();_t();var Ri=null;ve.util.isNodejs&&!ve.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Ri=Ii());var dd=ec.exports=ve.prng=ve.prng||{};dd.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(f,u){if(!u)return e.generateSync(f);var h=e.plugin.cipher,l=e.plugin.increment,g=e.plugin.formatKey,d=e.plugin.formatSeed,p=ve.util.createBuffer();e.key=null,y();function y(x){if(x)return u(x);if(p.length()>=f)return u(null,p.getBytes(f));if(e.generated>1048575&&(e.key=null),e.key===null)return ve.util.nextTick(function(){o(y)});var S=h(e.key,e.seed);e.generated+=S.length,p.putBytes(S),e.key=g(h(e.key,l(e.seed))),e.seed=d(h(e.key,e.seed)),ve.util.setImmediate(y)}},e.generateSync=function(f){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,g=e.plugin.formatSeed;e.key=null;for(var d=ve.util.createBuffer();d.length()<f;){e.generated>1048575&&(e.key=null),e.key===null&&s();var p=u(e.key,e.seed);e.generated+=p.length,d.putBytes(p),e.key=l(u(e.key,h(e.seed))),e.seed=g(u(e.key,e.seed))}return d.getBytes(f)};function o(f){if(e.pools[0].messageLength>=32)return a(),f();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return f(h);e.collect(l),a(),f()})}function s(){if(e.pools[0].messageLength>=32)return a();var f=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(f)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var f=e.plugin.md.create();f.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(f.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=f.digest().getBytes(),f.start(),f.update(e.keyBytes);var l=f.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function c(f){var u=null,h=ve.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(B){return l.getRandomValues(B)});var g=ve.util.createBuffer();if(u)for(;g.length()<f;){var d=Math.max(1,Math.min(f-g.length(),65536)/4),p=new Uint32Array(Math.floor(d));try{u(p);for(var y=0;y<p.length;++y)g.putInt32(p[y])}catch(B){if(!(typeof QuotaExceededError<"u"&&B instanceof QuotaExceededError))throw B}}if(g.length()<f)for(var x,S,m,_=Math.floor(Math.random()*65536);g.length()<f;){S=16807*(_&65535),x=16807*(_>>16),S+=(x&32767)<<16,S+=x>>15,S=(S&2147483647)+(S>>31),_=S&4294967295;for(var y=0;y<3;++y)m=_>>>(y<<3),m^=Math.floor(Math.random()*256),g.putByte(m&255)}return g.getBytes(f)}return Ri?(e.seedFile=function(f,u){Ri.randomBytes(f,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(f){return Ri.randomBytes(f).toString()}):(e.seedFile=function(f,u){try{u(null,c(f))}catch(h){u(h)}},e.seedFileSync=c),e.collect=function(f){for(var u=f.length,h=0;h<u;++h)e.pools[e.pool].update(f.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(f,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(f>>l&255);e.collect(h)},e.registerWorker=function(f){if(f===self)e.seedFile=function(h,l){function g(d){var p=d.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",g),l(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(g,d){f.postMessage({forge:{prng:{err:g,bytes:d}}})})};f.addEventListener("message",u)}},e}});var In=j((am,jo)=>{var Pt=dt();Qo();tc();rc();_t();(function(){if(Pt.random&&Pt.random.getBytes){jo.exports=Pt.random;return}(function(t){var e={},r=new Array(4),n=Pt.util.createBuffer();e.formatKey=function(h){var l=Pt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Pt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Pt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Pt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Pt.md.sha256;function i(){var h=Pt.prng.create(e);return h.getBytes=function(l,g){return h.generate(l,g)},h.getBytesSync=function(l){return h.generate(l)},h}var o=i(),s=null,a=Pt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(s=function(h){return c.getRandomValues(h)}),Pt.options.usePureJavaScript||!Pt.util.isNodejs&&!s){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var u in navigator)try{typeof navigator[u]=="string"&&(f+=navigator[u])}catch{}o.collect(f),f=null}t&&(t().mousemove(function(h){o.collectInt(h.clientX,16),o.collectInt(h.clientY,16)}),t().keypress(function(h){o.collectInt(h.charCode,8)}))}if(!Pt.random)Pt.random=o;else for(var u in o)Pt.random[u]=o[u];Pt.random.createInstance=i,jo.exports=Pt.random})(typeof jQuery<"u"?jQuery:null)})()});var sc=j((cm,oc)=>{var Zt=dt();_t();var ts=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],nc=[1,2,3,5],pd=function(t,e){return t<<e&65535|(t&65535)>>16-e},yd=function(t,e){return(t&65535)>>e|t<<16-e&65535};oc.exports=Zt.rc2=Zt.rc2||{};Zt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Zt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,o=Math.ceil(i/8),s=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(ts[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-o,ts[r.at(128-o)&s]),a=127-o;a>=0;a--)r.setAt(a,ts[r.at(a+1)^r.at(a+o)]);return r};var ic=function(t,e,r){var n=!1,i=null,o=null,s=null,a,c,f,u,h=[];for(t=Zt.rc2.expandKey(t,e),f=0;f<64;f++)h.push(t.getInt16Le());r?(a=function(d){for(f=0;f<4;f++)d[f]+=h[u]+(d[(f+3)%4]&d[(f+2)%4])+(~d[(f+3)%4]&d[(f+1)%4]),d[f]=pd(d[f],nc[f]),u++},c=function(d){for(f=0;f<4;f++)d[f]+=h[d[(f+3)%4]&63]}):(a=function(d){for(f=3;f>=0;f--)d[f]=yd(d[f],nc[f]),d[f]-=h[u]+(d[(f+3)%4]&d[(f+2)%4])+(~d[(f+3)%4]&d[(f+1)%4]),u--},c=function(d){for(f=3;f>=0;f--)d[f]-=h[d[(f+3)%4]&63]});var l=function(d){var p=[];for(f=0;f<4;f++){var y=i.getInt16Le();s!==null&&(r?y^=s.getInt16Le():s.putInt16Le(y)),p.push(y&65535)}u=r?0:63;for(var x=0;x<d.length;x++)for(var S=0;S<d[x][0];S++)d[x][1](p);for(f=0;f<4;f++)s!==null&&(r?s.putInt16Le(p[f]):p[f]^=s.getInt16Le()),o.putInt16Le(p[f])},g=null;return g={start:function(d,p){d&&typeof d=="string"&&(d=Zt.util.createBuffer(d)),n=!1,i=Zt.util.createBuffer(),o=p||new Zt.util.createBuffer,s=d,g.output=o},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)l([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(d){var p=!0;if(r)if(d)p=d(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(p&&(n=!0,g.update()),!r&&(p=i.length()===0,p))if(d)p=d(8,o,!r);else{var x=o.length(),S=o.at(x-1);S>x?p=!1:o.truncate(S)}return p}},g};Zt.rc2.startEncrypting=function(t,e,r){var n=Zt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Zt.rc2.createEncryptionCipher=function(t,e){return ic(t,e,!0)};Zt.rc2.startDecrypting=function(t,e,r){var n=Zt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Zt.rc2.createDecryptionCipher=function(t,e){return ic(t,e,!1)}});var Ni=j((fm,pc)=>{var es=dt();pc.exports=es.jsbn=es.jsbn||{};var Oe,gd=0xdeadbeefcafe,ac=(gd&16777215)==15715070;function k(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}es.jsbn.BigInteger=k;function st(){return new k(null)}function xd(t,e,r,n,i,o){for(;--o>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function md(t,e,r,n,i,o){for(var s=e&32767,a=e>>15;--o>=0;){var c=this.data[t]&32767,f=this.data[t++]>>15,u=a*c+f*s;c=s*c+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(u>>>15)+a*f+(i>>>30),r.data[n++]=c&1073741823}return i}function cc(t,e,r,n,i,o){for(var s=e&16383,a=e>>14;--o>=0;){var c=this.data[t]&16383,f=this.data[t++]>>14,u=a*c+f*s;c=s*c+((u&16383)<<14)+r.data[n]+i,i=(c>>28)+(u>>14)+a*f,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(k.prototype.am=cc,Oe=28):ac&&navigator.appName=="Microsoft Internet Explorer"?(k.prototype.am=md,Oe=30):ac&&navigator.appName!="Netscape"?(k.prototype.am=xd,Oe=26):(k.prototype.am=cc,Oe=28);k.prototype.DB=Oe;k.prototype.DM=(1<<Oe)-1;k.prototype.DV=1<<Oe;var rs=52;k.prototype.FV=Math.pow(2,rs);k.prototype.F1=rs-Oe;k.prototype.F2=2*Oe-rs;var bd="0123456789abcdefghijklmnopqrstuvwxyz",Di=new Array,Gr,ne;Gr="0".charCodeAt(0);for(ne=0;ne<=9;++ne)Di[Gr++]=ne;Gr="a".charCodeAt(0);for(ne=10;ne<36;++ne)Di[Gr++]=ne;Gr="A".charCodeAt(0);for(ne=10;ne<36;++ne)Di[Gr++]=ne;function fc(t){return bd.charAt(t)}function uc(t,e){var r=Di[t.charCodeAt(e)];return r??-1}function vd(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function wd(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function je(t){var e=st();return e.fromInt(t),e}function Ed(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=r==8?t[n]&255:uc(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&t[0]&128&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&k.ZERO.subTo(this,this)}function Sd(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Bd(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=fc(n));s>=0;)a<e?(n=(this.data[s]&(1<<a)-1)<<e-a,n|=this.data[--s]>>(a+=this.DB-e)):(n=this.data[s]>>(a-=e)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=fc(n));return i?o:"0"}function Ad(){var t=st();return k.ZERO.subTo(this,t),t}function Cd(){return this.s<0?this.negate():this}function _d(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function ki(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Id(){return this.t<=0?0:this.DB*(this.t-1)+ki(this.data[this.t-1]^this.s&this.DM)}function Td(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Ld(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Rd(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(t/this.DB),s=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+o+1]=this.data[a]>>n|s,s=(this.data[a]&i)<<r;for(a=o-1;a>=0;--a)e.data[a]=0;e.data[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function Dd(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&o)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function kd(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Nd(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&k.ZERO.subTo(e,e)}function Pd(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Ud(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=st());var o=st(),s=this.s,a=t.s,c=this.DB-ki(n.data[n.t-1]);c>0?(n.lShiftTo(c,o),i.lShiftTo(c,r)):(n.copyTo(o),i.copyTo(r));var f=o.t,u=o.data[f-1];if(u!=0){var h=u*(1<<this.F1)+(f>1?o.data[f-2]>>this.F2:0),l=this.FV/h,g=(1<<this.F1)/h,d=1<<this.F2,p=r.t,y=p-f,x=e??st();for(o.dlShiftTo(y,x),r.compareTo(x)>=0&&(r.data[r.t++]=1,r.subTo(x,r)),k.ONE.dlShiftTo(f,x),x.subTo(o,o);o.t<f;)o.data[o.t++]=0;for(;--y>=0;){var S=r.data[--p]==u?this.DM:Math.floor(r.data[p]*l+(r.data[p-1]+d)*g);if((r.data[p]+=o.am(0,S,r,y,0,f))<S)for(o.dlShiftTo(y,x),r.subTo(x,r);r.data[p]<--S;)r.subTo(x,r)}e!=null&&(r.drShiftTo(f,e),s!=a&&k.ZERO.subTo(e,e)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),s<0&&k.ZERO.subTo(r,r)}}}function Kd(t){var e=st();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(k.ZERO)>0&&t.subTo(e,e),e}function gr(t){this.m=t}function Od(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Md(t){return t}function Fd(t){t.divRemTo(this.m,null,t)}function Vd(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function qd(t,e){t.squareTo(e),this.reduce(e)}gr.prototype.convert=Od;gr.prototype.revert=Md;gr.prototype.reduce=Fd;gr.prototype.mulTo=Vd;gr.prototype.sqrTo=qd;function Hd(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function xr(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function zd(t){var e=st();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(k.ZERO)>0&&this.m.subTo(e,e),e}function Gd(t){var e=st();return t.copyTo(e),this.reduce(e),e}function Wd(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Yd(t,e){t.squareTo(e),this.reduce(e)}function $d(t,e,r){t.multiplyTo(e,r),this.reduce(r)}xr.prototype.convert=zd;xr.prototype.revert=Gd;xr.prototype.reduce=Wd;xr.prototype.mulTo=$d;xr.prototype.sqrTo=Yd;function Zd(){return(this.t>0?this.data[0]&1:this.s)==0}function Xd(t,e){if(t>4294967295||t<1)return k.ONE;var r=st(),n=st(),i=e.convert(this),o=ki(t)-1;for(i.copyTo(r);--o>=0;)if(e.sqrTo(r,n),(t&1<<o)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Qd(t,e){var r;return t<256||e.isEven()?r=new gr(e):r=new xr(e),this.exp(t,r)}k.prototype.copyTo=vd;k.prototype.fromInt=wd;k.prototype.fromString=Ed;k.prototype.clamp=Sd;k.prototype.dlShiftTo=Td;k.prototype.drShiftTo=Ld;k.prototype.lShiftTo=Rd;k.prototype.rShiftTo=Dd;k.prototype.subTo=kd;k.prototype.multiplyTo=Nd;k.prototype.squareTo=Pd;k.prototype.divRemTo=Ud;k.prototype.invDigit=Hd;k.prototype.isEven=Zd;k.prototype.exp=Xd;k.prototype.toString=Bd;k.prototype.negate=Ad;k.prototype.abs=Cd;k.prototype.compareTo=_d;k.prototype.bitLength=Id;k.prototype.mod=Kd;k.prototype.modPowInt=Qd;k.ZERO=je(0);k.ONE=je(1);function Jd(){var t=st();return this.copyTo(t),t}function jd(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function tp(){return this.t==0?this.s:this.data[0]<<24>>24}function ep(){return this.t==0?this.s:this.data[0]<<16>>16}function rp(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function np(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function ip(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=je(r),i=st(),o=st(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function op(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,o=0,s=0,a=0;a<t.length;++a){var c=uc(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+c,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),i&&k.ZERO.subTo(this,this)}function sp(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(k.ONE.shiftLeft(t-1),ns,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(k.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function ap(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function cp(t){return this.compareTo(t)==0}function fp(t){return this.compareTo(t)<0?this:t}function up(t){return this.compareTo(t)>0?this:t}function hp(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function lp(t,e){return t&e}function dp(t){var e=st();return this.bitwiseTo(t,lp,e),e}function ns(t,e){return t|e}function pp(t){var e=st();return this.bitwiseTo(t,ns,e),e}function hc(t,e){return t^e}function yp(t){var e=st();return this.bitwiseTo(t,hc,e),e}function lc(t,e){return t&~e}function gp(t){var e=st();return this.bitwiseTo(t,lc,e),e}function xp(){for(var t=st(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function mp(t){var e=st();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bp(t){var e=st();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function vp(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function wp(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+vp(this.data[t]);return this.s<0?this.t*this.DB:-1}function Ep(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Sp(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Ep(this.data[r]^e);return t}function Bp(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Ap(t,e){var r=k.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Cp(t){return this.changeBit(t,ns)}function _p(t){return this.changeBit(t,lc)}function Ip(t){return this.changeBit(t,hc)}function Tp(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Lp(t){var e=st();return this.addTo(t,e),e}function Rp(t){var e=st();return this.subTo(t,e),e}function Dp(t){var e=st();return this.multiplyTo(t,e),e}function kp(t){var e=st();return this.divRemTo(t,e,null),e}function Np(t){var e=st();return this.divRemTo(t,null,e),e}function Pp(t){var e=st(),r=st();return this.divRemTo(t,e,r),new Array(e,r)}function Up(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Kp(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Tn(){}function dc(t){return t}function Op(t,e,r){t.multiplyTo(e,r)}function Mp(t,e){t.squareTo(e)}Tn.prototype.convert=dc;Tn.prototype.revert=dc;Tn.prototype.mulTo=Op;Tn.prototype.sqrTo=Mp;function Fp(t){return this.exp(t,new Tn)}function Vp(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function qp(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Wr(t){this.r2=st(),this.q3=st(),k.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Hp(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=st();return t.copyTo(e),this.reduce(e),e}function zp(t){return t}function Gp(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Wp(t,e){t.squareTo(e),this.reduce(e)}function Yp(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Wr.prototype.convert=Hp;Wr.prototype.revert=zp;Wr.prototype.reduce=Gp;Wr.prototype.mulTo=Yp;Wr.prototype.sqrTo=Wp;function $p(t,e){var r=t.bitLength(),n,i=je(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new gr(e):e.isEven()?o=new Wr(e):o=new xr(e);var s=new Array,a=3,c=n-1,f=(1<<n)-1;if(s[1]=o.convert(this),n>1){var u=st();for(o.sqrTo(s[1],u);a<=f;)s[a]=st(),o.mulTo(u,s[a-2],s[a]),a+=2}var h=t.t-1,l,g=!0,d=st(),p;for(r=ki(t.data[h])-1;h>=0;){for(r>=c?l=t.data[h]>>r-c&f:(l=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=t.data[h-1]>>this.DB+r-c)),a=n;!(l&1);)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),g)s[l].copyTo(i),g=!1;else{for(;a>1;)o.sqrTo(i,d),o.sqrTo(d,i),a-=2;a>0?o.sqrTo(i,d):(p=i,i=d,d=p),o.mulTo(d,s[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)o.sqrTo(i,d),p=i,i=d,d=p,--r<0&&(r=this.DB-1,--h)}return o.revert(i)}function Zp(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function Xp(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Qp(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return k.ZERO;for(var r=t.clone(),n=this.clone(),i=je(1),o=je(0),s=je(0),a=je(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),e&&s.subTo(i,s),a.subTo(o,a))}if(n.compareTo(k.ONE)!=0)return k.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var de=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Jp=(1<<26)/de[de.length-1];function jp(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=de[de.length-1]){for(e=0;e<de.length;++e)if(r.data[0]==de[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<de.length;){for(var n=de[e],i=e+1;i<de.length&&n<Jp;)n*=de[i++];for(n=r.modInt(n);e<i;)if(n%de[e++]==0)return!1}return r.millerRabin(t)}function ty(t){var e=this.subtract(k.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=ey(),o,s=0;s<t;++s){do o=new k(this.bitLength(),i);while(o.compareTo(k.ONE)<=0||o.compareTo(e)>=0);var a=o.modPow(n,this);if(a.compareTo(k.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(k.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function ey(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}k.prototype.chunkSize=rp;k.prototype.toRadix=ip;k.prototype.fromRadix=op;k.prototype.fromNumber=sp;k.prototype.bitwiseTo=hp;k.prototype.changeBit=Ap;k.prototype.addTo=Tp;k.prototype.dMultiply=Up;k.prototype.dAddOffset=Kp;k.prototype.multiplyLowerTo=Vp;k.prototype.multiplyUpperTo=qp;k.prototype.modInt=Xp;k.prototype.millerRabin=ty;k.prototype.clone=Jd;k.prototype.intValue=jd;k.prototype.byteValue=tp;k.prototype.shortValue=ep;k.prototype.signum=np;k.prototype.toByteArray=ap;k.prototype.equals=cp;k.prototype.min=fp;k.prototype.max=up;k.prototype.and=dp;k.prototype.or=pp;k.prototype.xor=yp;k.prototype.andNot=gp;k.prototype.not=xp;k.prototype.shiftLeft=mp;k.prototype.shiftRight=bp;k.prototype.getLowestSetBit=wp;k.prototype.bitCount=Sp;k.prototype.testBit=Bp;k.prototype.setBit=Cp;k.prototype.clearBit=_p;k.prototype.flipBit=Ip;k.prototype.add=Lp;k.prototype.subtract=Rp;k.prototype.multiply=Dp;k.prototype.divide=kp;k.prototype.remainder=Np;k.prototype.divideAndRemainder=Pp;k.prototype.modPow=$p;k.prototype.modInverse=Qp;k.prototype.pow=Fp;k.prototype.gcd=Zp;k.prototype.isProbablePrime=jp});var bc=j((um,mc)=>{var we=dt();yr();_t();var gc=mc.exports=we.sha1=we.sha1||{};we.md.sha1=we.md.algorithms.sha1=gc;gc.create=function(){xc||ry();var t=null,e=we.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=we.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=we.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),yc(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=we.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(is.substr(0,n.blockLength-s));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,i.putInt32(f>>>0),f=a>>>0;i.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};yc(h,r,i);var l=we.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var is=null,xc=!1;function ry(){is=String.fromCharCode(128),is+=we.util.fillString(String.fromCharCode(0),64),xc=!0}function yc(t,e,r){for(var n,i,o,s,a,c,f,u,h=r.length();h>=64;){for(i=t.h0,o=t.h1,s=t.h2,a=t.h3,c=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,f=a^o&(s^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=a^o&(s^a),n=(i<<5|i>>>27)+f+c+1518500249+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=o^s^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=o^s^a,n=(i<<5|i>>>27)+f+c+1859775393+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=o&s|a&(o^s),n=(i<<5|i>>>27)+f+c+2400959708+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=o^s^a,n=(i<<5|i>>>27)+f+c+3395469782+n,c=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+s|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,h-=64}}});var Ec=j((hm,wc)=>{var Ee=dt();_t();In();bc();var vc=wc.exports=Ee.pkcs1=Ee.pkcs1||{};vc.encode_rsa_oaep=function(t,e,r){var n,i,o,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),o?o.start():o=Ee.md.sha1.create(),s||(s=o);var a=Math.ceil(t.n.bitLength()/8),c=a-2*o.digestLength-2;if(e.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=e.length,f.maxLength=c,f}n||(n=""),o.update(n,"raw");for(var u=o.digest(),h="",l=c-e.length,g=0;g<l;g++)h+="\0";var d=u.getBytes()+h+""+e;if(!i)i=Ee.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=i.length,f.digestLength=o.digestLength,f}var p=Pi(i,a-o.digestLength-1,s),y=Ee.util.xorBytes(d,p,d.length),x=Pi(y,o.digestLength,s),S=Ee.util.xorBytes(i,x,i.length);return"\0"+S+y};vc.decode_rsa_oaep=function(t,e,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=s,y}if(i===void 0?i=Ee.md.sha1.create():i.start(),o||(o=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=e.charAt(0),f=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=Pi(u,i.digestLength,o),l=Ee.util.xorBytes(f,h,f.length),g=Pi(l,s-i.digestLength-1,o),d=Ee.util.xorBytes(u,g,u.length),p=d.substring(0,i.digestLength),y=c!=="\0",x=0;x<i.digestLength;++x)y|=a.charAt(x)!==p.charAt(x);for(var S=1,m=i.digestLength,_=i.digestLength;_<d.length;_++){var B=d.charCodeAt(_),E=B&1^1,L=S?65534:0;y|=B&L,S=S&E,m+=S}if(y||d.charCodeAt(m)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(m+1)};function Pi(t,e,r){r||(r=Ee.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),o=0;o<i;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var Sc=j((lm,os)=>{var tr=dt();_t();Ni();In();(function(){if(tr.prime){os.exports=tr.prime;return}var t=os.exports=tr.prime=tr.prime||{},e=tr.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,g){typeof l=="function"&&(g=l,l={}),l=l||{};var d=l.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var p=l.prng||tr.random,y={nextBytes:function(x){for(var S=p.getBytesSync(x.length),m=0;m<x.length;++m)x[m]=S.charCodeAt(m)}};if(d.name==="PRIMEINC")return o(h,y,d.options,g);throw new Error("Invalid prime generation algorithm: "+d.name)};function o(h,l,g,d){return"workers"in g?c(h,l,g,d):s(h,l,g,d)}function s(h,l,g,d){var p=f(h,l),y=0,x=u(p.bitLength());"millerRabinTests"in g&&(x=g.millerRabinTests);var S=10;"maxBlockTime"in g&&(S=g.maxBlockTime),a(p,h,l,y,x,S,d)}function a(h,l,g,d,p,y,x){var S=+new Date;do{if(h.bitLength()>l&&(h=f(l,g)),h.isProbablePrime(p))return x(null,h);h.dAddOffset(r[d++%8],0)}while(y<0||+new Date-S<y);tr.util.setImmediate(function(){a(h,l,g,d,p,y,x)})}function c(h,l,g,d){if(typeof Worker>"u")return s(h,l,g,d);var p=f(h,l),y=g.workers,x=g.workLoad||100,S=x*30/8,m=g.workerScript||"forge/prime.worker.js";if(y===-1)return tr.util.estimateCores(function(B,E){B&&(E=2),y=E-1,_()});_();function _(){y=Math.max(1,y);for(var B=[],E=0;E<y;++E)B[E]=new Worker(m);for(var L=y,E=0;E<y;++E)B[E].addEventListener("message",P);var T=!1;function P(M){if(!T){--L;var K=M.data;if(K.found){for(var F=0;F<B.length;++F)B[F].terminate();return T=!0,d(null,new e(K.prime,16))}p.bitLength()>h&&(p=f(h,l));var H=p.toString(16);M.target.postMessage({hex:H,workLoad:x}),p.dAddOffset(S,0)}}}}function f(h,l){var g=new e(h,l),d=h-1;return g.testBit(d)||g.bitwiseTo(e.ONE.shiftLeft(d),i,g),g.dAddOffset(31-g.mod(n).byteValue(),0),g}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Ki=j((dm,Lc)=>{var W=dt();_n();Ni();wi();Ec();Sc();In();_t();typeof ot>"u"&&(ot=W.jsbn.BigInteger);var ot,ss=W.util.isNodejs?Ii():null,w=W.asn1,ie=W.util;W.pki=W.pki||{};Lc.exports=W.pki.rsa=W.rsa=W.rsa||{};var Q=W.pki,ny=[6,4,2,4,2,4,6,2],iy={name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},oy={name:"RSAPrivateKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},sy={name:"RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},ay=W.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},cy={name:"DigestInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:w.Class.UNIVERSAL,type:w.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},fy=function(t){var e;if(t.algorithm in Q.oids)e=Q.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=w.oidToDer(e).getBytes(),i=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]),o=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[]);o.value.push(w.create(w.Class.UNIVERSAL,w.Type.OID,!1,n)),o.value.push(w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,""));var s=w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(o),i.value.push(s),w.toDer(i).getBytes()},Ic=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(ot.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(ot.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new ot(W.util.bytesToHex(W.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(ot.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);var s=i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};Q.rsa.encrypt=function(t,e,r){var n=r,i,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Tc(t,e,r)):(i=W.util.createBuffer(),i.putBytes(t));for(var s=new ot(i.toHex(),16),a=Ic(s,e,n),c=a.toString(16),f=W.util.createBuffer(),u=o-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(W.util.hexToBytes(c)),f.getBytes()};Q.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=t.length,o.expected=i,o}var s=new ot(W.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Ic(s,e,r),c=a.toString(16),f=W.util.createBuffer(),u=i-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(W.util.hexToBytes(c)),n!==!1?Ui(f.getBytes(),e,r):f.getBytes()};Q.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||W.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),f=0;f<a.length;++f)a[f]=c.charCodeAt(f)}},o=r.algorithm||"PRIMEINC",s;if(o==="PRIMEINC")s={algorithm:o,state:0,bits:t,rng:i,eInt:e||65537,e:new ot(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+o);return s};Q.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new ot(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},o=+new Date,s,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,f=c-1;t.pqState===0?(t.num=new ot(c,t.rng),t.num.testBit(f)||t.num.bitwiseTo(ot.ONE.shiftLeft(f),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(hy(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(ny[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(ot.ONE).gcd(t.e).compareTo(ot.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(ot.ONE),t.q1=t.q.subtract(ot.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(ot.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:Q.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:Q.rsa.setPublicKey(t.n,t.e)}}s=+new Date,a+=s-o,o=s}return t.keys!==null};Q.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!W.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(Bc("generateKeyPair"))return ss.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,f){if(a)return n(a);n(null,{privateKey:Q.privateKeyFromPem(f),publicKey:Q.publicKeyFromPem(c)})});if(Ac("generateKey")&&Ac("exportKey"))return ie.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:_c(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return ie.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=Q.privateKeyFromAsn1(w.fromDer(W.util.createBuffer(a)));n(null,{privateKey:c,publicKey:Q.setRsaPublicKey(c.n,c.e)})}});if(Cc("generateKey")&&Cc("exportKey")){var i=ie.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:_c(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,f=ie.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(u){var h=u.target.result,l=Q.privateKeyFromAsn1(w.fromDer(W.util.createBuffer(h)));n(null,{privateKey:l,publicKey:Q.setRsaPublicKey(l.n,l.e)})},f.onerror=function(u){n(u)}},i.onerror=function(a){n(a)};return}}else if(Bc("generateKeyPairSync")){var o=ss.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Q.privateKeyFromPem(o.privateKey),publicKey:Q.publicKeyFromPem(o.publicKey)}}}var s=Q.rsa.createKeyPairGenerationState(t,e,r);if(!n)return Q.rsa.stepKeyPairGenerationState(s,0),s.keys;uy(s,r,n)};Q.setRsaPublicKey=Q.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,f){return Tc(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return W.pkcs1.encode_rsa_oaep(c,a,o)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return Q.rsa.encrypt(s,r,!0)},r.verify=function(n,i,o,s){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:function(c,f){f=Ui(f,r,!0);var u=w.fromDer(f,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!w.validate(u,cy,h,l)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=l,g}var d=w.derToOid(h.algorithmIdentifier);if(!(d===W.oids.md2||d===W.oids.md5||d===W.oids.sha1||d===W.oids.sha224||d===W.oids.sha256||d===W.oids.sha384||d===W.oids.sha512||d===W.oids["sha512-224"]||d===W.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=d,g}if((d===W.oids.md2||d===W.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:function(c,f){return f=Ui(f,r,!0),c===f}});var a=Q.rsa.decrypt(i,r,!0,!1);return o.verify(n,a,r.n.bitLength())},r};Q.setRsaPrivateKey=Q.rsa.setPrivateKey=function(t,e,r,n,i,o,s,a){var c={n:t,e,d:r,p:n,q:i,dP:o,dQ:s,qInv:a};return c.decrypt=function(f,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=Q.rsa.decrypt(f,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Ui};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(g,d){return W.pkcs1.decode_rsa_oaep(d,g,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,c,!1)},c.sign=function(f,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:fy},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return f}},h=1);var l=u.encode(f,c.n.bitLength());return Q.rsa.encrypt(l,c,h)},c};Q.wrapRsaPrivateKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(Q.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,w.toDer(t).getBytes())])};Q.privateKeyFromAsn1=function(t){var e={},r=[];if(w.validate(t,iy,e,r)&&(t=w.fromDer(W.util.createBuffer(e.privateKey))),e={},r=[],!w.validate(t,oy,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,s,a,c,f,u,h;return i=W.util.createBuffer(e.privateKeyModulus).toHex(),o=W.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=W.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=W.util.createBuffer(e.privateKeyPrime1).toHex(),c=W.util.createBuffer(e.privateKeyPrime2).toHex(),f=W.util.createBuffer(e.privateKeyExponent1).toHex(),u=W.util.createBuffer(e.privateKeyExponent2).toHex(),h=W.util.createBuffer(e.privateKeyCoefficient).toHex(),Q.setRsaPrivateKey(new ot(i,16),new ot(o,16),new ot(s,16),new ot(a,16),new ot(c,16),new ot(f,16),new ot(u,16),new ot(h,16))};Q.privateKeyToAsn1=Q.privateKeyToRSAPrivateKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,w.integerToDer(0).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.e)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.d)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.p)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.q)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.dP)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.dQ)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.qInv))])};Q.publicKeyFromAsn1=function(t){var e={},r=[];if(w.validate(t,ay,e,r)){var n=w.derToOid(e.publicKeyOid);if(n!==Q.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!w.validate(t,sy,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=W.util.createBuffer(e.publicKeyModulus).toHex(),s=W.util.createBuffer(e.publicKeyExponent).toHex();return Q.setRsaPublicKey(new ot(o,16),new ot(s,16))};Q.publicKeyToAsn1=Q.publicKeyToSubjectPublicKeyInfo=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(Q.oids.rsaEncryption).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")]),w.create(w.Class.UNIVERSAL,w.Type.BITSTRING,!1,[Q.publicKeyToRSAPublicKey(t)])])};Q.publicKeyToRSAPublicKey=function(t){return w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.n)),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,Se(t.e))])};function Tc(t,e,r){var n=W.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var s=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<s;++c)n.putByte(a)}else for(;s>0;){for(var f=0,u=W.random.getBytes(s),c=0;c<s;++c)a=u.charCodeAt(c),a===0?++f:n.putByte(a);s=f}return n.putByte(0),n.putBytes(t),n}function Ui(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),o=W.util.createBuffer(t),s=o.getByte(),a=o.getByte();if(s!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var f=0;f<c;++f)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++c}else if(a===2)for(c=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++c}var u=o.getByte();if(u!==0||c!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function uy(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){o(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return s(a,t.q);o(t.qBits,s)})}function o(a,c){W.prime.generateProbablePrime(a,n,c)}function s(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var f=t.p;t.p=t.q,t.q=f}if(t.p.subtract(ot.ONE).gcd(t.e).compareTo(ot.ONE)!==0){t.p=null,i();return}if(t.q.subtract(ot.ONE).gcd(t.e).compareTo(ot.ONE)!==0){t.q=null,o(t.qBits,s);return}if(t.p1=t.p.subtract(ot.ONE),t.q1=t.q.subtract(ot.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(ot.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,o(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:Q.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:Q.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Se(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=W.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function hy(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function Bc(t){return W.util.isNodejs&&typeof ss[t]=="function"}function Ac(t){return typeof ie.globalScope<"u"&&typeof ie.globalScope.crypto=="object"&&typeof ie.globalScope.crypto.subtle=="object"&&typeof ie.globalScope.crypto.subtle[t]=="function"}function Cc(t){return typeof ie.globalScope<"u"&&typeof ie.globalScope.msCrypto=="object"&&typeof ie.globalScope.msCrypto.subtle=="object"&&typeof ie.globalScope.msCrypto.subtle[t]=="function"}function _c(t){for(var e=W.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Uc=j((pm,Pc)=>{var z=dt();Qo();_n();F0();yr();wi();G0();$0();In();sc();Ki();_t();typeof Rc>"u"&&(Rc=z.jsbn.BigInteger);var Rc,C=z.asn1,et=z.pki=z.pki||{};Pc.exports=et.pbe=z.pbe=z.pbe||{};var mr=et.oids,ly={name:"EncryptedPrivateKeyInfo",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},dy={name:"PBES2Algorithms",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:C.Class.UNIVERSAL,type:C.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},py={name:"pkcs-12PbeParams",tagClass:C.Class.UNIVERSAL,type:C.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:C.Class.UNIVERSAL,type:C.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:C.Class.UNIVERSAL,type:C.Type.INTEGER,constructed:!1,capture:"iterations"}]};et.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=z.random.getBytesSync(r.saltSize),i=r.count,o=C.integerToDer(i),s,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,u,h;switch(r.algorithm){case"aes128":s=16,f=16,u=mr["aes128-CBC"],h=z.aes.createEncryptionCipher;break;case"aes192":s=24,f=16,u=mr["aes192-CBC"],h=z.aes.createEncryptionCipher;break;case"aes256":s=32,f=16,u=mr["aes256-CBC"],h=z.aes.createEncryptionCipher;break;case"des":s=8,f=8,u=mr.desCBC,h=z.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var g="hmacWith"+r.prfAlgorithm.toUpperCase(),d=Nc(g),p=z.pkcs5.pbkdf2(e,n,i,s,d),y=z.random.getBytesSync(f),x=h(p);x.start(y),x.update(C.toDer(t)),x.finish(),c=x.output.getBytes();var S=yy(n,o,s,g);a=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(mr.pkcs5PBES2).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(mr.pkcs5PBKDF2).getBytes()),S]),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(u).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){s=24;var m=new z.util.ByteBuffer(n),p=et.pbe.generatePkcs12Key(e,m,1,i,s),y=et.pbe.generatePkcs12Key(e,m,2,i,s),x=z.des.createEncryptionCipher(p);x.start(y),x.update(C.toDer(t)),x.finish(),c=x.output.getBytes(),a=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(mr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,n),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,o.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var _=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[a,C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,c)]);return _};et.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!C.validate(t,ly,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=C.derToOid(n.encryptionOid),a=et.pbe.getCipher(s,n.encryptionParams,e),c=z.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=C.fromDer(a.output)),r};et.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:C.toDer(t).getBytes()};return z.pem.encode(r,{maxline:e})};et.encryptedPrivateKeyFromPem=function(t){var e=z.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return C.fromDer(e.body)};et.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=et.wrapRsaPrivateKey(et.privateKeyToAsn1(t));return n=et.encryptPrivateKeyInfo(n,e,r),et.encryptedPrivateKeyToPem(n)}var i,o,s,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,o=z.random.getBytesSync(16),a=z.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,o=z.random.getBytesSync(16),a=z.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,o=z.random.getBytesSync(16),a=z.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,o=z.random.getBytesSync(8),a=z.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,o=z.random.getBytesSync(8),a=z.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var f=z.pbe.opensslDeriveBytes(e,o.substr(0,8),s),u=a(f);u.start(o),u.update(C.toDer(et.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:z.util.bytesToHex(o).toUpperCase()},body:u.output.getBytes()};return z.pem.encode(h)};et.decryptRsaPrivateKey=function(t,e){var r=null,n=z.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,s;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,s=z.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,s=z.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,s=z.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,s=z.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,s=z.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,s=function(h){return z.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":o=8,s=function(h){return z.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":o=16,s=function(h){return z.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=z.util.hexToBytes(n.dekInfo.parameters),c=z.pbe.opensslDeriveBytes(e,a.substr(0,8),o),f=s(c);if(f.start(a),f.update(z.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=et.decryptPrivateKeyInfo(C.fromDer(r),e):r=C.fromDer(r),r!==null&&(r=et.privateKeyFromAsn1(r)),r};et.pbe.generatePkcs12Key=function(t,e,r,n,i,o){var s,a;if(typeof o>"u"||o===null){if(!("sha1"in z.md))throw new Error('"sha1" hash algorithm unavailable.');o=z.md.sha1.create()}var c=o.digestLength,f=o.blockLength,u=new z.util.ByteBuffer,h=new z.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),g=e.length(),d=new z.util.ByteBuffer;d.fillWithByte(r,f);var p=f*Math.ceil(g/f),y=new z.util.ByteBuffer;for(a=0;a<p;a++)y.putByte(e.at(a%g));var x=f*Math.ceil(l/f),S=new z.util.ByteBuffer;for(a=0;a<x;a++)S.putByte(h.at(a%l));var m=y;m.putBuffer(S);for(var _=Math.ceil(i/c),B=1;B<=_;B++){var E=new z.util.ByteBuffer;E.putBytes(d.bytes()),E.putBytes(m.bytes());for(var L=0;L<n;L++)o.start(),o.update(E.getBytes()),E=o.digest();var T=new z.util.ByteBuffer;for(a=0;a<f;a++)T.putByte(E.at(a%c));var P=Math.ceil(g/f)+Math.ceil(l/f),M=new z.util.ByteBuffer;for(s=0;s<P;s++){var K=new z.util.ByteBuffer(m.getBytes(f)),F=511;for(a=T.length()-1;a>=0;a--)F=F>>8,F+=T.at(a)+K.at(a),K.setAt(a,F&255);M.putBuffer(K)}m=M,u.putBuffer(E)}return u.truncate(u.length()-i),u};et.pbe.getCipher=function(t,e,r){switch(t){case et.oids.pkcs5PBES2:return et.pbe.getCipherForPBES2(t,e,r);case et.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case et.oids["pbewithSHAAnd40BitRC2-CBC"]:return et.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};et.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!C.validate(e,dy,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(t=C.derToOid(n.kdfOid),t!==et.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=t,o.supportedOids=["pkcs5PBKDF2"],o}if(t=C.derToOid(n.encOid),t!==et.oids["aes128-CBC"]&&t!==et.oids["aes192-CBC"]&&t!==et.oids["aes256-CBC"]&&t!==et.oids["des-EDE3-CBC"]&&t!==et.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=t,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var s=n.kdfSalt,a=z.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,f;switch(et.oids[t]){case"aes128-CBC":c=16,f=z.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=z.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=z.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=z.des.createDecryptionCipher;break;case"desCBC":c=8,f=z.des.createDecryptionCipher;break}var u=kc(n.prfOid),h=z.pkcs5.pbkdf2(r,s,a,c,u),l=n.encIv,g=f(h);return g.start(l),g};et.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!C.validate(e,py,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=z.util.createBuffer(n.salt),a=z.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,f,u;switch(t){case et.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,u=z.des.startDecrypting;break;case et.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,u=function(p,y){var x=z.rc2.createDecryptionCipher(p,40);return x.start(y,null),x};break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=t,o}var h=kc(n.prfOid),l=et.pbe.generatePkcs12Key(r,s,1,a,c,h);h.start();var g=et.pbe.generatePkcs12Key(r,s,2,a,f,h);return u(l,g)};et.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in z.md))throw new Error('"md5" hash algorithm unavailable.');n=z.md.md5.create()}e===null&&(e="");for(var i=[Dc(n,t+e)],o=16,s=1;o<r;++s,o+=16)i.push(Dc(n,i[s-1]+t+e));return i.join("").substr(0,r)};function Dc(t,e){return t.start().update(e).digest().getBytes()}function kc(t){var e;if(!t)e="hmacWithSHA1";else if(e=et.oids[C.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Nc(e)}function Nc(t){var e=z.md;switch(t){case"hmacWithSHA224":e=z.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function yy(t,e,r,n){var i=C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OCTETSTRING,!1,t),C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(C.create(C.Class.UNIVERSAL,C.Type.INTEGER,!1,z.util.hexToBytes(r.toString(16))),C.create(C.Class.UNIVERSAL,C.Type.SEQUENCE,!0,[C.create(C.Class.UNIVERSAL,C.Type.OID,!1,C.oidToDer(et.oids[n]).getBytes()),C.create(C.Class.UNIVERSAL,C.Type.NULL,!1,"")])),i}});var hf=j((fb,uf)=>{"use strict";uf.exports=E1;function E1(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(u){if(o)if(o=!1,u)c(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{t.apply(e||null,r)}catch(f){o&&(o=!1,c(f))}})}});var yf=j(pf=>{"use strict";var Vi=pf;Vi.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var rn=new Array(64),df=new Array(123);for(pe=0;pe<64;)df[rn[pe]=pe<26?pe+65:pe<52?pe+71:pe<62?pe-4:pe-59|43]=pe++;var pe;Vi.encode=function(e,r,n){for(var i=null,o=[],s=0,a=0,c;r<n;){var f=e[r++];switch(a){case 0:o[s++]=rn[f>>2],c=(f&3)<<4,a=1;break;case 1:o[s++]=rn[c|f>>4],c=(f&15)<<2,a=2;break;case 2:o[s++]=rn[c|f>>6],o[s++]=rn[f&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=rn[c],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var lf="invalid encoding";Vi.decode=function(e,r,n){for(var i=n,o=0,s,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&o>1)break;if((c=df[c])===void 0)throw Error(lf);switch(o){case 0:s=c,o=1;break;case 1:r[n++]=s<<2|(c&48)>>4,s=c,o=2;break;case 2:r[n++]=(s&15)<<4|(c&60)>>2,s=c,o=3;break;case 3:r[n++]=(s&3)<<6|c,o=0;break}}if(o===1)throw Error(lf);return n-i};Vi.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var xf=j((hb,gf)=>{"use strict";gf.exports=qi;function qi(){this._listeners={}}qi.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};qi.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};qi.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Bf=j((lb,Sf)=>{"use strict";Sf.exports=mf(mf);function mf(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3]}function o(c,f,u){e[0]=c,f[u]=r[3],f[u+1]=r[2],f[u+2]=r[1],f[u+3]=r[0]}t.writeFloatLE=n?i:o,t.writeFloatBE=n?o:i;function s(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],e[0]}function a(c,f){return r[3]=c[f],r[2]=c[f+1],r[1]=c[f+2],r[0]=c[f+3],e[0]}t.readFloatLE=n?s:a,t.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var c=Math.floor(Math.log(i)/Math.LN2),f=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|f)>>>0,o,s)}}t.writeFloatLE=e.bind(null,bf),t.writeFloatBE=e.bind(null,vf);function r(n,i,o){var s=n(i,o),a=(s>>31)*2+1,c=s>>>23&255,f=s&8388607;return c===255?f?NaN:a*(1/0):c===0?a*1401298464324817e-60*f:a*Math.pow(2,c-150)*(f+8388608)}t.readFloatLE=r.bind(null,wf),t.readFloatBE=r.bind(null,Ef)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3],f[u+4]=r[4],f[u+5]=r[5],f[u+6]=r[6],f[u+7]=r[7]}function o(c,f,u){e[0]=c,f[u]=r[7],f[u+1]=r[6],f[u+2]=r[5],f[u+3]=r[4],f[u+4]=r[3],f[u+5]=r[2],f[u+6]=r[1],f[u+7]=r[0]}t.writeDoubleLE=n?i:o,t.writeDoubleBE=n?o:i;function s(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],r[4]=c[f+4],r[5]=c[f+5],r[6]=c[f+6],r[7]=c[f+7],e[0]}function a(c,f){return r[7]=c[f],r[6]=c[f+1],r[5]=c[f+2],r[4]=c[f+3],r[3]=c[f+4],r[2]=c[f+5],r[1]=c[f+6],r[0]=c[f+7],e[0]}t.readDoubleLE=n?s:a,t.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,c){var f=s<0?1:0;if(f&&(s=-s),s===0)n(0,a,c+i),n(1/s>0?0:2147483648,a,c+o);else if(isNaN(s))n(0,a,c+i),n(2146959360,a,c+o);else if(s>17976931348623157e292)n(0,a,c+i),n((f<<31|2146435072)>>>0,a,c+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,a,c+i),n((f<<31|u/4294967296)>>>0,a,c+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,a,c+i),n((f<<31|h+1023<<20|u*1048576&1048575)>>>0,a,c+o)}}}t.writeDoubleLE=e.bind(null,bf,0,4),t.writeDoubleBE=e.bind(null,vf,4,0);function r(n,i,o,s,a){var c=n(s,a+i),f=n(s,a+o),u=(f>>31)*2+1,h=f>>>20&2047,l=4294967296*(f&1048575)+c;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,wf,0,4),t.readDoubleBE=r.bind(null,Ef,4,0)}(),t}function bf(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function vf(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function wf(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Ef(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Af=j((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var _f=j(Cf=>{"use strict";var Ls=Cf;Ls.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Ls.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var o=null,s=[],a=0,c;r<n;)c=e[r++],c<128?s[a++]=c:c>191&&c<224?s[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[a++]=55296+(c>>10),s[a++]=56320+(c&1023)):s[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};Ls.write=function(e,r,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=o&63|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=o&63|128);return n-i}});var Tf=j((pb,If)=>{"use strict";If.exports=S1;function S1(t,e,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(c){if(c<1||c>i)return t(c);s+c>n&&(o=t(n),s=0);var f=e.call(o,s,s+=c);return s&7&&(s=(s|7)+1),f}}});var Rf=j((yb,Lf)=>{"use strict";Lf.exports=Kt;var Nn=wr();function Kt(t,e){this.lo=t>>>0,this.hi=e>>>0}var vr=Kt.zero=new Kt(0,0);vr.toNumber=function(){return 0};vr.zzEncode=vr.zzDecode=function(){return this};vr.length=function(){return 1};var B1=Kt.zeroHash="\0\0\0\0\0\0\0\0";Kt.fromNumber=function(e){if(e===0)return vr;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Kt(n,i)};Kt.from=function(e){if(typeof e=="number")return Kt.fromNumber(e);if(Nn.isString(e))if(Nn.Long)e=Nn.Long.fromString(e);else return Kt.fromNumber(parseInt(e,10));return e.low||e.high?new Kt(e.low>>>0,e.high>>>0):vr};Kt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Kt.prototype.toLong=function(e){return Nn.Long?new Nn.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var ir=String.prototype.charCodeAt;Kt.fromHash=function(e){return e===B1?vr:new Kt((ir.call(e,0)|ir.call(e,1)<<8|ir.call(e,2)<<16|ir.call(e,3)<<24)>>>0,(ir.call(e,4)|ir.call(e,5)<<8|ir.call(e,6)<<16|ir.call(e,7)<<24)>>>0)};Kt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Kt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Kt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Kt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var wr=j(Rs=>{"use strict";var G=Rs;G.asPromise=hf();G.base64=yf();G.EventEmitter=xf();G.float=Bf();G.inquire=Af();G.utf8=_f();G.pool=Tf();G.LongBits=Rf();G.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);G.global=G.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Rs;G.emptyArray=Object.freeze?Object.freeze([]):[];G.emptyObject=Object.freeze?Object.freeze({}):{};G.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};G.isString=function(e){return typeof e=="string"||e instanceof String};G.isObject=function(e){return e&&typeof e=="object"};G.isset=G.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};G.Buffer=function(){try{var t=G.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();G._Buffer_from=null;G._Buffer_allocUnsafe=null;G.newBuffer=function(e){return typeof e=="number"?G.Buffer?G._Buffer_allocUnsafe(e):new G.Array(e):G.Buffer?G._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};G.Array=typeof Uint8Array<"u"?Uint8Array:Array;G.Long=G.global.dcodeIO&&G.global.dcodeIO.Long||G.global.Long||G.inquire("long");G.key2Re=/^true|false|0|1$/;G.key32Re=/^-?(?:0|[1-9][0-9]*)$/;G.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;G.longToHash=function(e){return e?G.LongBits.from(e).toHash():G.LongBits.zeroHash};G.longFromHash=function(e,r){var n=G.LongBits.fromHash(e);return G.Long?G.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function Df(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}G.merge=Df;G.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function kf(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Df(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}G.newError=kf;G.ProtocolError=kf("ProtocolError");G.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(r[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};G.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};G.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};G._configure=function(){var t=G.Buffer;if(!t){G._Buffer_from=G._Buffer_allocUnsafe=null;return}G._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},G._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Ns=j((xb,Of)=>{"use strict";Of.exports=At;var ye=wr(),ks,Uf=ye.LongBits,A1=ye.utf8;function ge(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function At(t){this.buf=t,this.pos=0,this.len=t.length}var Nf=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new At(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new At(e);throw Error("illegal buffer")},Kf=function(){return ye.Buffer?function(r){return(At.create=function(i){return ye.Buffer.isBuffer(i)?new ks(i):Nf(i)})(r)}:Nf};At.create=Kf();At.prototype._slice=ye.Array.prototype.subarray||ye.Array.prototype.slice;At.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,ge(this,10);return e}}();At.prototype.int32=function(){return this.uint32()|0};At.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Ds(){var t=new Uf(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw ge(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw ge(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}At.prototype.bool=function(){return this.uint32()!==0};function Hi(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}At.prototype.fixed32=function(){if(this.pos+4>this.len)throw ge(this,4);return Hi(this.buf,this.pos+=4)};At.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ge(this,4);return Hi(this.buf,this.pos+=4)|0};function Pf(){if(this.pos+8>this.len)throw ge(this,8);return new Uf(Hi(this.buf,this.pos+=4),Hi(this.buf,this.pos+=4))}At.prototype.float=function(){if(this.pos+4>this.len)throw ge(this,4);var e=ye.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};At.prototype.double=function(){if(this.pos+8>this.len)throw ge(this,4);var e=ye.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};At.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw ge(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(r,n);if(r===n){var i=ye.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,n)};At.prototype.string=function(){var e=this.bytes();return A1.read(e,0,e.length)};At.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw ge(this,e);this.pos+=e}else do if(this.pos>=this.len)throw ge(this);while(this.buf[this.pos++]&128);return this};At.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};At._configure=function(t){ks=t,At.create=Kf(),ks._configure();var e=ye.Long?"toLong":"toNumber";ye.merge(At.prototype,{int64:function(){return Ds.call(this)[e](!1)},uint64:function(){return Ds.call(this)[e](!0)},sint64:function(){return Ds.call(this).zzDecode()[e](!1)},fixed64:function(){return Pf.call(this)[e](!0)},sfixed64:function(){return Pf.call(this)[e](!1)}})}});var qf=j((mb,Vf)=>{"use strict";Vf.exports=Er;var Ff=Ns();(Er.prototype=Object.create(Ff.prototype)).constructor=Er;var Mf=wr();function Er(t){Ff.call(this,t)}Er._configure=function(){Mf.Buffer&&(Er.prototype._slice=Mf.Buffer.prototype.slice)};Er.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Er._configure()});var Vs=j((bb,Wf)=>{"use strict";Wf.exports=at;var oe=wr(),Ps,zi=oe.LongBits,Hf=oe.base64,zf=oe.utf8;function Pn(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Ks(){}function C1(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function at(){this.len=0,this.head=new Pn(Ks,0,0),this.tail=this.head,this.states=null}var Gf=function(){return oe.Buffer?function(){return(at.create=function(){return new Ps})()}:function(){return new at}};at.create=Gf();at.alloc=function(e){return new oe.Array(e)};oe.Array!==Array&&(at.alloc=oe.pool(at.alloc,oe.Array.prototype.subarray));at.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Pn(e,r,n),this.len+=r,this};function Os(t,e,r){e[r]=t&255}function _1(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Ms(t,e){this.len=t,this.next=void 0,this.val=e}Ms.prototype=Object.create(Pn.prototype);Ms.prototype.fn=_1;at.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Ms((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};at.prototype.int32=function(e){return e<0?this._push(Fs,10,zi.fromNumber(e)):this.uint32(e)};at.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Fs(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}at.prototype.uint64=function(e){var r=zi.from(e);return this._push(Fs,r.length(),r)};at.prototype.int64=at.prototype.uint64;at.prototype.sint64=function(e){var r=zi.from(e).zzEncode();return this._push(Fs,r.length(),r)};at.prototype.bool=function(e){return this._push(Os,1,e?1:0)};function Us(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}at.prototype.fixed32=function(e){return this._push(Us,4,e>>>0)};at.prototype.sfixed32=at.prototype.fixed32;at.prototype.fixed64=function(e){var r=zi.from(e);return this._push(Us,4,r.lo)._push(Us,4,r.hi)};at.prototype.sfixed64=at.prototype.fixed64;at.prototype.float=function(e){return this._push(oe.float.writeFloatLE,4,e)};at.prototype.double=function(e){return this._push(oe.float.writeDoubleLE,8,e)};var I1=oe.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};at.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Os,1,0);if(oe.isString(e)){var n=at.alloc(r=Hf.length(e));Hf.decode(e,n,0),e=n}return this.uint32(r)._push(I1,r,e)};at.prototype.string=function(e){var r=zf.length(e);return r?this.uint32(r)._push(zf.write,r,e):this._push(Os,1,0)};at.prototype.fork=function(){return this.states=new C1(this),this.head=this.tail=new Pn(Ks,0,0),this.len=0,this};at.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Pn(Ks,0,0),this.len=0),this};at.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};at.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};at._configure=function(t){Ps=t,at.create=Gf(),Ps._configure()}});var Zf=j((vb,$f)=>{"use strict";$f.exports=Ae;var Yf=Vs();(Ae.prototype=Object.create(Yf.prototype)).constructor=Ae;var or=wr();function Ae(){Yf.call(this)}Ae._configure=function(){Ae.alloc=or._Buffer_allocUnsafe,Ae.writeBytesBuffer=or.Buffer&&or.Buffer.prototype instanceof Uint8Array&&or.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Ae.prototype.bytes=function(e){or.isString(e)&&(e=or._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Ae.writeBytesBuffer,r,e),this};function T1(t,e,r){t.length<40?or.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Ae.prototype.string=function(e){var r=or.Buffer.byteLength(e);return this.uint32(r),r&&this._push(T1,r,e),this};Ae._configure()});var au=j((vv,su)=>{var bt=dt();yr();_t();var Kn=su.exports=bt.sha512=bt.sha512||{};bt.md.sha512=bt.md.algorithms.sha512=Kn;var iu=bt.sha384=bt.sha512.sha384=bt.sha512.sha384||{};iu.create=function(){return Kn.create("SHA-384")};bt.md.sha384=bt.md.algorithms.sha384=iu;bt.sha512.sha256=bt.sha512.sha256||{create:function(){return Kn.create("SHA-512/256")}};bt.md["sha512/256"]=bt.md.algorithms["sha512/256"]=bt.sha512.sha256;bt.sha512.sha224=bt.sha512.sha224||{create:function(){return Kn.create("SHA-512/224")}};bt.md["sha512/224"]=bt.md.algorithms["sha512/224"]=bt.sha512.sha224;Kn.create=function(t){if(ou||M1(),typeof t>"u"&&(t="SHA-512"),!(t in _r))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=_r[t],r=null,n=bt.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,f=0;f<c;++f)a.fullMessageLength.push(0);n=bt.util.createBuffer(),r=new Array(e.length);for(var f=0;f<e.length;++f)r[f]=e[f].slice(0);return a},a.start(),a.update=function(c,f){f==="utf8"&&(c=bt.util.encodeUtf8(c));var u=c.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(c),nu(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=bt.util.createBuffer();c.putBytes(n.bytes());var f=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=f&a.blockLength-1;c.putBytes(Zs.substr(0,a.blockLength-u));for(var h,l,g=a.fullMessageLength[0]*8,d=0;d<a.fullMessageLength.length-1;++d)h=a.fullMessageLength[d+1]*8,l=h/4294967296>>>0,g+=l,c.putInt32(g>>>0),g=h>>>0;c.putInt32(g);for(var p=new Array(r.length),d=0;d<r.length;++d)p[d]=r[d].slice(0);nu(p,i,c);var y=bt.util.createBuffer(),x;t==="SHA-512"?x=p.length:t==="SHA-384"?x=p.length-2:x=p.length-4;for(var d=0;d<x;++d)y.putInt32(p[d][0]),(d!==x-1||t!=="SHA-512/224")&&y.putInt32(p[d][1]);return y},a};var Zs=null,ou=!1,Xs=null,_r=null;function M1(){Zs=String.fromCharCode(128),Zs+=bt.util.fillString(String.fromCharCode(0),128),Xs=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],_r={},_r["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],_r["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],_r["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],_r["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],ou=!0}function nu(t,e,r){for(var n,i,o,s,a,c,f,u,h,l,g,d,p,y,x,S,m,_,B,E,L,T,P,M,K,F,H,Z,A,D,I,R,v,U,O,q=r.length();q>=128;){for(A=0;A<16;++A)e[A][0]=r.getInt32()>>>0,e[A][1]=r.getInt32()>>>0;for(;A<80;++A)R=e[A-2],D=R[0],I=R[1],n=((D>>>19|I<<13)^(I>>>29|D<<3)^D>>>6)>>>0,i=((D<<13|I>>>19)^(I<<3|D>>>29)^(D<<26|I>>>6))>>>0,U=e[A-15],D=U[0],I=U[1],o=((D>>>1|I<<31)^(D>>>8|I<<24)^D>>>7)>>>0,s=((D<<31|I>>>1)^(D<<24|I>>>8)^(D<<25|I>>>7))>>>0,v=e[A-7],O=e[A-16],I=i+v[1]+s+O[1],e[A][0]=n+v[0]+o+O[0]+(I/4294967296>>>0)>>>0,e[A][1]=I>>>0;for(p=t[0][0],y=t[0][1],x=t[1][0],S=t[1][1],m=t[2][0],_=t[2][1],B=t[3][0],E=t[3][1],L=t[4][0],T=t[4][1],P=t[5][0],M=t[5][1],K=t[6][0],F=t[6][1],H=t[7][0],Z=t[7][1],A=0;A<80;++A)f=((L>>>14|T<<18)^(L>>>18|T<<14)^(T>>>9|L<<23))>>>0,u=((L<<18|T>>>14)^(L<<14|T>>>18)^(T<<23|L>>>9))>>>0,h=(K^L&(P^K))>>>0,l=(F^T&(M^F))>>>0,a=((p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25))>>>0,c=((p<<4|y>>>28)^(y<<30|p>>>2)^(y<<25|p>>>7))>>>0,g=(p&x|m&(p^x))>>>0,d=(y&S|_&(y^S))>>>0,I=Z+u+l+Xs[A][1]+e[A][1],n=H+f+h+Xs[A][0]+e[A][0]+(I/4294967296>>>0)>>>0,i=I>>>0,I=c+d,o=a+g+(I/4294967296>>>0)>>>0,s=I>>>0,H=K,Z=F,K=P,F=M,P=L,M=T,I=E+i,L=B+n+(I/4294967296>>>0)>>>0,T=I>>>0,B=m,E=_,m=x,_=S,x=p,S=y,I=i+s,p=n+o+(I/4294967296>>>0)>>>0,y=I>>>0;I=t[0][1]+y,t[0][0]=t[0][0]+p+(I/4294967296>>>0)>>>0,t[0][1]=I>>>0,I=t[1][1]+S,t[1][0]=t[1][0]+x+(I/4294967296>>>0)>>>0,t[1][1]=I>>>0,I=t[2][1]+_,t[2][0]=t[2][0]+m+(I/4294967296>>>0)>>>0,t[2][1]=I>>>0,I=t[3][1]+E,t[3][0]=t[3][0]+B+(I/4294967296>>>0)>>>0,t[3][1]=I>>>0,I=t[4][1]+T,t[4][0]=t[4][0]+L+(I/4294967296>>>0)>>>0,t[4][1]=I>>>0,I=t[5][1]+M,t[5][0]=t[5][0]+P+(I/4294967296>>>0)>>>0,t[5][1]=I>>>0,I=t[6][1]+F,t[6][0]=t[6][0]+K+(I/4294967296>>>0)>>>0,t[6][1]=I>>>0,I=t[7][1]+Z,t[7][0]=t[7][0]+H+(I/4294967296>>>0)>>>0,t[7][1]=I>>>0,q-=128}}});var Mu=j((n8,Ou)=>{var un=1e3,hn=un*60,ln=hn*60,Rr=ln*24,yg=Rr*7,gg=Rr*365.25;Ou.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return xg(t);if(r==="number"&&isFinite(t))return e.long?bg(t):mg(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function xg(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*gg;case"weeks":case"week":case"w":return r*yg;case"days":case"day":case"d":return r*Rr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*ln;case"minutes":case"minute":case"mins":case"min":case"m":return r*hn;case"seconds":case"second":case"secs":case"sec":case"s":return r*un;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function mg(t){var e=Math.abs(t);return e>=Rr?Math.round(t/Rr)+"d":e>=ln?Math.round(t/ln)+"h":e>=hn?Math.round(t/hn)+"m":e>=un?Math.round(t/un)+"s":t+"ms"}function bg(t){var e=Math.abs(t);return e>=Rr?Xi(t,e,Rr,"day"):e>=ln?Xi(t,e,ln,"hour"):e>=hn?Xi(t,e,hn,"minute"):e>=un?Xi(t,e,un,"second"):t+" ms"}function Xi(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var Vu=j((i8,Fu)=>{function vg(t){r.debug=r,r.default=r,r.coerce=c,r.disable=o,r.enable=i,r.enabled=s,r.humanize=Mu(),r.destroy=f,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,l=null,g,d;function p(...y){if(!p.enabled)return;let x=p,S=Number(new Date),m=S-(h||S);x.diff=m,x.prev=h,x.curr=S,h=S,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let _=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(E,L)=>{if(E==="%%")return"%";_++;let T=r.formatters[L];if(typeof T=="function"){let P=y[_];E=T.call(x,P),y.splice(_,1),_--}return E}),r.formatArgs.call(x,y),(x.log||r.log).apply(x,y)}return p.namespace=u,p.useColors=r.useColors(),p.color=r.selectColor(u),p.extend=n,p.destroy=r.destroy,Object.defineProperty(p,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(g!==r.namespaces&&(g=r.namespaces,d=r.enabled(u)),d),set:y=>{l=y}}),typeof r.init=="function"&&r.init(p),p}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),g=l.length;for(h=0;h<g;h++)l[h]&&(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function o(){let u=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),u}function s(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Fu.exports=vg});var qu=j((jt,Qi)=>{jt.formatArgs=Eg;jt.save=Sg;jt.load=Bg;jt.useColors=wg;jt.storage=Ag();jt.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();jt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function wg(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Eg(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Qi.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}jt.log=console.debug||console.log||(()=>{});function Sg(t){try{t?jt.storage.setItem("debug",t):jt.storage.removeItem("debug")}catch{}}function Bg(){let t;try{t=jt.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function Ag(){try{return localStorage}catch{}}Qi.exports=Vu()(jt);var{formatters:Cg}=Qi.exports;Cg.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Lg={};Rt(Lg,{noise:()=>Tg,pureJsCrypto:()=>bi});function ze(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Te(t=0){return globalThis.Buffer?.alloc!=null?ze(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function ee(t=0){return globalThis.Buffer?.allocUnsafe!=null?ze(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}var ch=Math.pow(2,7),fh=Math.pow(2,14),uh=Math.pow(2,21),io=Math.pow(2,28),oo=Math.pow(2,35),so=Math.pow(2,42),ao=Math.pow(2,49),ut=128,Gt=127;function ar(t){if(t<ch)return 1;if(t<fh)return 2;if(t<uh)return 3;if(t<io)return 4;if(t<oo)return 5;if(t<so)return 6;if(t<ao)return 7;if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function hh(t,e,r=0){switch(ar(t)){case 8:e[r++]=t&255|ut,t/=128;case 7:e[r++]=t&255|ut,t/=128;case 6:e[r++]=t&255|ut,t/=128;case 5:e[r++]=t&255|ut,t/=128;case 4:e[r++]=t&255|ut,t>>>=7;case 3:e[r++]=t&255|ut,t>>>=7;case 2:e[r++]=t&255|ut,t>>>=7;case 1:{e[r++]=t&255,t>>>=7;break}default:throw new Error("unreachable")}return e}function lh(t,e,r=0){switch(ar(t)){case 8:e.set(r++,t&255|ut),t/=128;case 7:e.set(r++,t&255|ut),t/=128;case 6:e.set(r++,t&255|ut),t/=128;case 5:e.set(r++,t&255|ut),t/=128;case 4:e.set(r++,t&255|ut),t>>>=7;case 3:e.set(r++,t&255|ut),t>>>=7;case 2:e.set(r++,t&255|ut),t>>>=7;case 1:{e.set(r++,t&255),t>>>=7;break}default:throw new Error("unreachable")}return e}function dh(t,e){let r=t[e],n=0;if(n+=r&Gt,r<ut||(r=t[e+1],n+=(r&Gt)<<7,r<ut)||(r=t[e+2],n+=(r&Gt)<<14,r<ut)||(r=t[e+3],n+=(r&Gt)<<21,r<ut)||(r=t[e+4],n+=(r&Gt)*io,r<ut)||(r=t[e+5],n+=(r&Gt)*oo,r<ut)||(r=t[e+6],n+=(r&Gt)*so,r<ut)||(r=t[e+7],n+=(r&Gt)*ao,r<ut))return n;throw new RangeError("Could not decode varint")}function ph(t,e){let r=t.get(e),n=0;if(n+=r&Gt,r<ut||(r=t.get(e+1),n+=(r&Gt)<<7,r<ut)||(r=t.get(e+2),n+=(r&Gt)<<14,r<ut)||(r=t.get(e+3),n+=(r&Gt)<<21,r<ut)||(r=t.get(e+4),n+=(r&Gt)*io,r<ut)||(r=t.get(e+5),n+=(r&Gt)*oo,r<ut)||(r=t.get(e+6),n+=(r&Gt)*so,r<ut)||(r=t.get(e+7),n+=(r&Gt)*ao,r<ut))return n;throw new RangeError("Could not decode varint")}function wa(t,e,r=0){return e==null&&(e=ee(ar(t))),e instanceof Uint8Array?hh(t,e,r):lh(t,e,r)}function Yn(t,e=0){return t instanceof Uint8Array?dh(t,e):ph(t,e)}function Tt(t,e){e==null&&(e=t.reduce((i,o)=>i+o.length,0));let r=ee(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return ze(r)}function Dt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Sa=Symbol.for("@achingbrain/uint8arraylist");function Ea(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let i=r+n.byteLength;if(e<i)return{buf:n,index:e-r};r=i}throw new RangeError("index is out of bounds")}function $n(t){return!!t?.[Sa]}var ce=class t{constructor(...e){Object.defineProperty(this,Sa,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if($n(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if($n(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=Ea(this.bufs,e);return r.buf[r.index]}set(e,r){let n=Ea(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if($n(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return Tt(n,i)}subarray(e,r){let{bufs:n,length:i}=this._subList(e,r);return n.length===1?n[0]:Tt(n,i)}sublist(e,r){let{bufs:n,length:i}=this._subList(e,r),o=new t;return o.length=i,o.bufs=n,o}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],a=i,c=a+s.byteLength;if(i=c,e>=c)continue;let f=e>=a&&e<c,u=r>a&&r<=c;if(f&&u){if(e===a&&r===c){n.push(s);break}let h=e-a;n.push(s.subarray(h,h+(r-e)));break}if(f){if(e===0){n.push(s);continue}n.push(s.subarray(e-a));continue}if(u){if(r===c){n.push(s);break}n.push(s.subarray(0,r-a));break}n.push(s)}return{bufs:n,length:r-e}}indexOf(e,r=0){if(!$n(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),e.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let h=0;h<o;h++)s[h]=-1;for(let h=0;h<i;h++)s[n[h]]=h;let a=s,c=this.byteLength-n.byteLength,f=n.byteLength-1,u;for(let h=r;h<=c;h+=u){u=0;for(let l=f;l>=0;l--){let g=this.get(h+l);if(n[l]!==g){u=Math.max(1,l-a[g]);break}}if(u===0)return h}return-1}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=ee(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=Te(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=Te(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=Te(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=ee(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=Te(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=Te(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=Te(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=Te(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=Te(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof t)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Dt(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new t;return n.bufs=e,r==null&&(r=e.reduce((i,o)=>i+o.byteLength,0)),n.length=r,n}};function Zn(t){return t[Symbol.asyncIterator]!=null}var Xn=t=>{let e=ar(t),r=ee(e);return wa(t,r),Xn.bytes=e,r};Xn.bytes=0;function Qn(t,e){e=e??{};let r=e.lengthEncoder??Xn;function*n(i){let o=r(i.byteLength);o instanceof Uint8Array?yield o:yield*o,i instanceof Uint8Array?yield i:yield*i}return Zn(t)?async function*(){for await(let i of t)yield*n(i)}():function*(){for(let i of t)yield*n(i)}()}Qn.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??Xn;return new ce(r(t.byteLength),t)};var Dr=Ct(Ca(),1);var gh=8,xh=1024*1024*4,cr;(function(t){t[t.LENGTH=0]="LENGTH",t[t.DATA=1]="DATA"})(cr||(cr={}));var fo=t=>{let e=Yn(t);return fo.bytes=ar(e),e};fo.bytes=0;function pn(t,e){let r=new ce,n=cr.LENGTH,i=-1,o=e?.lengthDecoder??fo,s=e?.maxLengthLength??gh,a=e?.maxDataLength??xh;function*c(){for(;r.byteLength>0;){if(n===cr.LENGTH)try{if(i=o(r),i<0)throw(0,Dr.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw(0,Dr.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let f=o.bytes;r.consume(f),e?.onLength!=null&&e.onLength(i),n=cr.DATA}catch(f){if(f instanceof RangeError){if(r.byteLength>s)throw(0,Dr.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw f}if(n===cr.DATA){if(r.byteLength<i)break;let f=r.sublist(0,i);r.consume(i),e?.onData!=null&&e.onData(f),yield f,n=cr.LENGTH}}}return Zn(t)?async function*(){for await(let f of t)r.append(f),yield*c();if(r.byteLength>0)throw(0,Dr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let f of t)r.append(f),yield*c();if(r.byteLength>0)throw(0,Dr.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}pn.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:o,value:s}=await t.next(r);if(o===!0)return;s!=null&&(yield s)}catch(o){if(o.code==="ERR_UNDER_READ")return{done:!0,value:null};throw o}finally{r=1}}();return pn(n,{...e??{},onLength:o=>{r=o}})};function kr(){let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}var Jn=class{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},Nr=class{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Jn(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let r=this.head;this.head=r.next=new Jn(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};var uo=class extends Error{type;code;constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function Pr(t={}){return bh(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function bh(t,e){e=e??{};let r=e.onEnd,n=new Nr,i,o,s,a=kr(),c=async()=>{try{return n.isEmpty()?s?{done:!0}:await new Promise((y,x)=>{o=S=>{o=null,n.push(S);try{y(t(n))}catch(m){x(m)}return i}}):t(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=kr()})}},f=y=>o!=null?o(y):(n.push(y),i),u=y=>(n=new Nr,o!=null?o({error:y}):(n.push({error:y}),i)),h=y=>{if(s)return i;if(e?.objectMode!==!0&&y?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return f({done:!1,value:y})},l=y=>s?i:(s=!0,y!=null?u(y):f({done:!0})),g=()=>(n=new Nr,l(),{done:!0}),d=y=>(l(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:c,return:g,throw:d,push:h,end:l,get readableLength(){return n.size},onEmpty:async y=>{let x=y?.signal;if(x?.throwIfAborted(),n.isEmpty())return;let S,m;x!=null&&(S=new Promise((_,B)=>{m=()=>{B(new uo)},x.addEventListener("abort",m)}));try{await Promise.race([a.promise,S])}finally{m!=null&&x!=null&&x?.removeEventListener("abort",m)}}},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(y){return p.throw(y),r!=null&&(r(y),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(y){return p.end(y),r!=null&&(r(y),r=void 0),i},get readableLength(){return p.readableLength}},i}var jn=class extends Error{code;constructor(e,r){super(e),this.code=r}},ho=class extends jn{type;constructor(e){super(e,"ABORT_ERR"),this.type="aborted"}};function _a(t){let e=Pr();t.sink(e).catch(o=>{e.end(o)}),t.sink=async o=>{for await(let s of o)e.push(s);e.end()};let r=t.source;t.source[Symbol.iterator]!=null?r=t.source[Symbol.iterator]():t.source[Symbol.asyncIterator]!=null&&(r=t.source[Symbol.asyncIterator]());let n=new ce;return{read:async(o,s)=>{s?.signal?.throwIfAborted();let a,c=new Promise((f,u)=>{a=()=>{u(new ho("Read aborted"))},s?.signal?.addEventListener("abort",a)});try{if(o==null){let{done:u,value:h}=await Promise.race([r.next(),c]);return u===!0?new ce:h}for(;n.byteLength<o;){let{value:u,done:h}=await Promise.race([r.next(),c]);if(h===!0)throw new jn("unexpected end of input","ERR_UNEXPECTED_EOF");n.append(u)}let f=n.sublist(0,o);return n.consume(o),f}finally{a!=null&&s?.signal?.removeEventListener("abort",a)}},write:async(o,s)=>{s?.signal?.throwIfAborted(),o instanceof Uint8Array?e.push(o):e.push(o.subarray()),await e.onEmpty(s)},unwrap:()=>{let o=t.source;return t.source=async function*(){yield*n,yield*o}(),t}}}var ti=class extends Error{code;constructor(e,r){super(e),this.code=r}},Ia=t=>Yn(t);Ia.bytes=0;function lo(t,e){let r=_a(t);return{read:async i=>{let o=-1,s=new ce,a=e?.lengthDecoder??Ia;for(;;){s.append(await r.read(1,i));try{o=a(s)}catch(c){if(c instanceof RangeError)continue;throw c}if(o>-1)break;if(e?.maxLengthLength!=null&&s.byteLength>e.maxLengthLength)throw new ti("message length length too long","ERR_MSG_LENGTH_TOO_LONG")}if(e?.maxDataLength!=null&&o>e.maxDataLength)throw new ti("message length too long","ERR_MSG_DATA_TOO_LONG");return r.read(o,i)},write:async(i,o)=>{await r.write(Qn.single(i,e),o)},unwrap:()=>r.unwrap()}}function po(){let t=kr(),e=!1;return{sink:async r=>{if(e)throw new Error("already piped");e=!0,t.resolve(r)},source:async function*(){yield*await t.promise}()}}function Ta(){let t=po(),e=po();return[{source:t.source,sink:e.sink},{source:e.source,sink:t.sink}]}function vh(t){return t[Symbol.asyncIterator]!=null}function wh(...t){let e=[];for(let r of t)vh(r)||e.push(r);return e.length===t.length?function*(){for(let r of e)yield*r}():async function*(){let r=Pr({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async n=>{for await(let i of n)r.push(i)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var La=wh;function Ra(t,...e){if(t==null)throw new Error("Empty pipeline");if(yo(t)){let n=t;t=()=>n.source}else if(ka(t)||Da(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&yo(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)yo(r[n])&&(r[n]=Sh(r[n]));return Eh(...r)}var Eh=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},Da=t=>t?.[Symbol.asyncIterator]!=null,ka=t=>t?.[Symbol.iterator]!=null,yo=t=>t==null?!1:t.sink!=null&&t.source!=null,Sh=t=>e=>{let r=t.sink(e);if(r?.then!=null){let n=Pr({objectMode:!0});r.then(()=>{n.end()},s=>{n.end(s)});let i,o=t.source;if(Da(o))i=async function*(){yield*o,n.end()};else if(ka(o))i=function*(){yield*o,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return La(n,i())}return t.source};var Na=!!globalThis.process?.env?.DUMP_SESSION_KEYS;var Bh=t=>t instanceof Uint8Array;var Le=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Pa=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Ah=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ah)throw new Error("Non little-endian hardware is not supported");function ei(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function ri(t){if(typeof t=="string"&&(t=ei(t)),!Bh(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}var Ch=t=>Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object;function Ua(t,e){if(e!==void 0&&(typeof e!="object"||!Ch(e)))throw new Error("options must be object or undefined");return Object.assign(t,e)}function fr(t,e){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");if(typeof e=="number"&&t.length!==e)throw new Error(`Uint8Array length ${e} expected`)}function Ka(t,e){if(t.length!==e.length)throw new Error("equalBytes: Different size of Uint8Arrays");let r=!0;for(let n=0;n<t.length;n++)r&&(r=t[n]===e[n]);return r}function go(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,f=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+f,a,n)}function xo(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function _h(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Oa(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Ih(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("hash must be wrapped by utils.wrapConstructor");xo(t.outputLen),xo(t.blockLen)}function Th(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Lh(t,e){Oa(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Rh={number:xo,bool:_h,bytes:Oa,hash:Ih,exists:Th,output:Lh},Wt=Rh;var Vt=(t,e)=>t[e++]&255|(t[e++]&255)<<8,mo=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=ri(e),fr(e,32);let r=Vt(e,0),n=Vt(e,2),i=Vt(e,4),o=Vt(e,6),s=Vt(e,8),a=Vt(e,10),c=Vt(e,12),f=Vt(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|o<<9)&8191,this.r[4]=(o>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Vt(e,16+2*u)}process(e,r,n=!1){let i=n?0:2048,{h:o,r:s}=this,a=s[0],c=s[1],f=s[2],u=s[3],h=s[4],l=s[5],g=s[6],d=s[7],p=s[8],y=s[9],x=Vt(e,r+0),S=Vt(e,r+2),m=Vt(e,r+4),_=Vt(e,r+6),B=Vt(e,r+8),E=Vt(e,r+10),L=Vt(e,r+12),T=Vt(e,r+14),P=o[0]+(x&8191),M=o[1]+((x>>>13|S<<3)&8191),K=o[2]+((S>>>10|m<<6)&8191),F=o[3]+((m>>>7|_<<9)&8191),H=o[4]+((_>>>4|B<<12)&8191),Z=o[5]+(B>>>1&8191),A=o[6]+((B>>>14|E<<2)&8191),D=o[7]+((E>>>11|L<<5)&8191),I=o[8]+((L>>>8|T<<8)&8191),R=o[9]+(T>>>5|i),v=0,U=v+P*a+M*(5*y)+K*(5*p)+F*(5*d)+H*(5*g);v=U>>>13,U&=8191,U+=Z*(5*l)+A*(5*h)+D*(5*u)+I*(5*f)+R*(5*c),v+=U>>>13,U&=8191;let O=v+P*c+M*a+K*(5*y)+F*(5*p)+H*(5*d);v=O>>>13,O&=8191,O+=Z*(5*g)+A*(5*l)+D*(5*h)+I*(5*u)+R*(5*f),v+=O>>>13,O&=8191;let q=v+P*f+M*c+K*a+F*(5*y)+H*(5*p);v=q>>>13,q&=8191,q+=Z*(5*d)+A*(5*g)+D*(5*l)+I*(5*h)+R*(5*u),v+=q>>>13,q&=8191;let Y=v+P*u+M*f+K*c+F*a+H*(5*y);v=Y>>>13,Y&=8191,Y+=Z*(5*p)+A*(5*d)+D*(5*g)+I*(5*l)+R*(5*h),v+=Y>>>13,Y&=8191;let $=v+P*h+M*u+K*f+F*c+H*a;v=$>>>13,$&=8191,$+=Z*(5*y)+A*(5*p)+D*(5*d)+I*(5*g)+R*(5*l),v+=$>>>13,$&=8191;let rt=v+P*l+M*h+K*u+F*f+H*c;v=rt>>>13,rt&=8191,rt+=Z*a+A*(5*y)+D*(5*p)+I*(5*d)+R*(5*g),v+=rt>>>13,rt&=8191;let X=v+P*g+M*l+K*h+F*u+H*f;v=X>>>13,X&=8191,X+=Z*c+A*a+D*(5*y)+I*(5*p)+R*(5*d),v+=X>>>13,X&=8191;let J=v+P*d+M*g+K*l+F*h+H*u;v=J>>>13,J&=8191,J+=Z*f+A*c+D*a+I*(5*y)+R*(5*p),v+=J>>>13,J&=8191;let pt=v+P*p+M*d+K*g+F*l+H*h;v=pt>>>13,pt&=8191,pt+=Z*u+A*f+D*c+I*a+R*(5*y),v+=pt>>>13,pt&=8191;let lt=v+P*y+M*p+K*d+F*g+H*l;v=lt>>>13,lt&=8191,lt+=Z*h+A*u+D*f+I*c+R*a,v+=lt>>>13,lt&=8191,v=(v<<2)+v|0,v=v+U|0,U=v&8191,v=v>>>13,O+=v,o[0]=U,o[1]=O,o[2]=q,o[3]=Y,o[4]=$,o[5]=rt,o[6]=X,o[7]=J,o[8]=pt,o[9]=lt}finalize(){let{h:e,pad:r}=this,n=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let o=(i^1)-1;for(let a=0;a<10;a++)n[a]&=o;o=~o;for(let a=0;a<10;a++)e[a]=e[a]&o|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let s=e[0]+r[0];e[0]=s&65535;for(let a=1;a<8;a++)s=(e[a]+r[a]|0)+(s>>>16)|0,e[a]=s&65535}update(e){Wt.exists(this);let{buffer:r,blockLen:n}=this;e=ri(e);let i=e.length;for(let o=0;o<i;){let s=Math.min(n-this.pos,i-o);if(s===n){for(;n<=i-o;o+=n)this.process(e,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){Wt.exists(this),Wt.output(e,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let o=0;for(let s=0;s<8;s++)e[o++]=n[s]>>>0,e[o++]=n[s]>>>8;return e}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}};function Dh(t){let e=(n,i)=>t(i).update(ri(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}var Ma=Dh(t=>new mo(t));var kh=ei("expand 16-byte k"),Nh=ei("expand 32-byte k"),Ph=Le(kh),Uh=Le(Nh),ni=t=>!(t.byteOffset%4),Fa=t=>{let{core:e,rounds:r,counterRight:n,counterLen:i,allow128bitKeys:o,extendNonceFn:s,blockLen:a}=Ua({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},t);Wt.number(i),Wt.number(r),Wt.number(a),Wt.bool(n),Wt.bool(o);let c=a/4;if(a%4!==0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(f,u,h,l,g=0)=>{if(Wt.bytes(f),Wt.bytes(u),Wt.bytes(h),l||(l=new Uint8Array(h.length)),Wt.bytes(l),Wt.number(g),g<0||g>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(l.length<h.length)throw new Error(`Salsa/ChaCha: output (${l.length}) is shorter than data (${h.length})`);let d=[],p,y;if(f.length===32)ni(f)?p=f:(p=f.slice(),d.push(p)),y=Uh;else if(f.length===16&&o)p=new Uint8Array(32),p.set(f),p.set(f,16),y=Ph,d.push(p);else throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${f.length}`);if(ni(u)||(u=u.slice(),d.push(u)),s){if(u.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");p=s(y,p,u.subarray(0,16),new Uint8Array(32)),d.push(p),u=u.subarray(16)}let x=16-i;if(u.length!==x)throw new Error(`Salsa/ChaCha: nonce must be ${x} or 16 bytes`);if(x!==12){let P=new Uint8Array(12);P.set(u,n?0:12-u.length),d.push(u=P)}let S=new Uint8Array(a),m=Le(S),_=Le(p),B=Le(u),E=ni(h)&&Le(h),L=ni(l)&&Le(l);d.push(m);let T=h.length;for(let P=0,M=g;P<T;M++){if(e(y,_,B,m,M,r),M>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");let K=Math.min(a,T-P);if(K===a&&L&&E){let F=P/4;if(P%4!==0)throw new Error("Salsa/ChaCha: invalid block position");for(let H=0;H<c;H++)L[F+H]=E[F+H]^m[H];P+=a;continue}for(let F=0;F<K;F++)l[P+F]=h[P+F]^S[F];P+=K}for(let P=0;P<d.length;P++)d[P].fill(0);return l}};var ct=(t,e)=>t<<e|t>>>32-e;function Kh(t,e,r,n,i,o=20){let s=t[0],a=t[1],c=t[2],f=t[3],u=e[0],h=e[1],l=e[2],g=e[3],d=e[4],p=e[5],y=e[6],x=e[7],S=i,m=r[0],_=r[1],B=r[2],E=s,L=a,T=c,P=f,M=u,K=h,F=l,H=g,Z=d,A=p,D=y,I=x,R=S,v=m,U=_,O=B;for(let Y=0;Y<o;Y+=2)E=E+M|0,R=ct(R^E,16),Z=Z+R|0,M=ct(M^Z,12),E=E+M|0,R=ct(R^E,8),Z=Z+R|0,M=ct(M^Z,7),L=L+K|0,v=ct(v^L,16),A=A+v|0,K=ct(K^A,12),L=L+K|0,v=ct(v^L,8),A=A+v|0,K=ct(K^A,7),T=T+F|0,U=ct(U^T,16),D=D+U|0,F=ct(F^D,12),T=T+F|0,U=ct(U^T,8),D=D+U|0,F=ct(F^D,7),P=P+H|0,O=ct(O^P,16),I=I+O|0,H=ct(H^I,12),P=P+H|0,O=ct(O^P,8),I=I+O|0,H=ct(H^I,7),E=E+K|0,O=ct(O^E,16),D=D+O|0,K=ct(K^D,12),E=E+K|0,O=ct(O^E,8),D=D+O|0,K=ct(K^D,7),L=L+F|0,R=ct(R^L,16),I=I+R|0,F=ct(F^I,12),L=L+F|0,R=ct(R^L,8),I=I+R|0,F=ct(F^I,7),T=T+H|0,v=ct(v^T,16),Z=Z+v|0,H=ct(H^Z,12),T=T+H|0,v=ct(v^T,8),Z=Z+v|0,H=ct(H^Z,7),P=P+M|0,U=ct(U^P,16),A=A+U|0,M=ct(M^A,12),P=P+M|0,U=ct(U^P,8),A=A+U|0,M=ct(M^A,7);let q=0;n[q++]=s+E|0,n[q++]=a+L|0,n[q++]=c+T|0,n[q++]=f+P|0,n[q++]=u+M|0,n[q++]=h+K|0,n[q++]=l+F|0,n[q++]=g+H|0,n[q++]=d+Z|0,n[q++]=p+A|0,n[q++]=y+D|0,n[q++]=x+I|0,n[q++]=S+R|0,n[q++]=m+v|0,n[q++]=_+U|0,n[q++]=B+O|0}var Oh=Fa({core:Kh,counterRight:!1,counterLen:4,allow128bitKeys:!1});var Mh=new Uint8Array(16),Va=(t,e)=>{t.update(e);let r=e.length%16;r&&t.update(Mh.subarray(r))},qa=(t,e,r,n,i)=>{let o=t(e,r,new Uint8Array(32)),s=Ma.create(o);i&&Va(s,i),Va(s,n);let a=new Uint8Array(16),c=Pa(a);go(c,0,BigInt(i?i.length:0),!0),go(c,8,BigInt(n.length),!0),s.update(a);let f=s.digest();return o.fill(0),f},Fh=t=>(e,r,n)=>(fr(e,32),fr(r),{tagLength:16,encrypt:(o,s)=>{let a=o.length,c=a+16;s?fr(s,c):s=new Uint8Array(c),t(e,r,o,s,1);let f=qa(t,e,r,s.subarray(0,-16),n);return s.set(f,a),s},decrypt:(o,s)=>{let a=o.length,c=a-16;if(a<16)throw new Error("encrypted data must be at least 16 bytes");s?fr(s,c):s=new Uint8Array(c);let f=o.subarray(0,-16),u=o.subarray(-16),h=qa(t,e,r,f,n);if(!Ka(u,h))throw new Error("invalid tag");return t(e,r,f,s,1),s}}),bo=Fh(Oh);function ii(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function vo(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function yn(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ii(t.outputLen),ii(t.blockLen)}function Ur(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ha(t,e){vo(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var oi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var za=t=>t instanceof Uint8Array;var si=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),fe=(t,e)=>t<<32-e|t>>>e,Vh=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Vh)throw new Error("Non little-endian hardware is not supported");function wo(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Ge(t){if(typeof t=="string"&&(t=wo(t)),!za(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function ai(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!za(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var Kr=class{clone(){return this._cloneInto()}},K2={}.toString;function ci(t){let e=n=>t().update(Ge(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ur(t=32){if(oi&&typeof oi.getRandomValues=="function")return oi.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function qh(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,f=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+f,a,n)}var Or=class extends Kr{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=si(this.buffer)}update(e){Ur(this);let{view:r,buffer:n,blockLen:i}=this;e=Ge(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let c=si(e);for(;i<=o-s;s+=i)this.process(c,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ur(this),Ha(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)r[h]=0;qh(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=si(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<f;h++)a.setUint32(4*h,u[h],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};var fi=BigInt(4294967295),Eo=BigInt(32);function Ga(t,e=!1){return e?{h:Number(t&fi),l:Number(t>>Eo&fi)}:{h:Number(t>>Eo&fi)|0,l:Number(t&fi)|0}}function Hh(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=Ga(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}var zh=(t,e)=>BigInt(t>>>0)<<Eo|BigInt(e>>>0),Gh=(t,e,r)=>t>>>r,Wh=(t,e,r)=>t<<32-r|e>>>r,Yh=(t,e,r)=>t>>>r|e<<32-r,$h=(t,e,r)=>t<<32-r|e>>>r,Zh=(t,e,r)=>t<<64-r|e>>>r-32,Xh=(t,e,r)=>t>>>r-32|e<<64-r,Qh=(t,e)=>e,Jh=(t,e)=>t,jh=(t,e,r)=>t<<r|e>>>32-r,tl=(t,e,r)=>e<<r|t>>>32-r,el=(t,e,r)=>e<<r-32|t>>>64-r,rl=(t,e,r)=>t<<r-32|e>>>64-r;function nl(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var il=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),ol=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,sl=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),al=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,cl=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),fl=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0;var ul={fromBig:Ga,split:Hh,toBig:zh,shrSH:Gh,shrSL:Wh,rotrSH:Yh,rotrSL:$h,rotrBH:Zh,rotrBL:Xh,rotr32H:Qh,rotr32L:Jh,rotlSH:jh,rotlSL:tl,rotlBH:el,rotlBL:rl,add:nl,add3L:il,add3H:ol,add4L:sl,add4H:al,add5H:fl,add5L:cl},tt=ul;var[hl,ll]=(()=>tt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),We=new Uint32Array(80),Ye=new Uint32Array(80),So=class extends Or{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:c,Eh:f,El:u,Fh:h,Fl:l,Gh:g,Gl:d,Hh:p,Hl:y}=this;return[e,r,n,i,o,s,a,c,f,u,h,l,g,d,p,y]}set(e,r,n,i,o,s,a,c,f,u,h,l,g,d,p,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=g|0,this.Gl=d|0,this.Hh=p|0,this.Hl=y|0}process(e,r){for(let m=0;m<16;m++,r+=4)We[m]=e.getUint32(r),Ye[m]=e.getUint32(r+=4);for(let m=16;m<80;m++){let _=We[m-15]|0,B=Ye[m-15]|0,E=tt.rotrSH(_,B,1)^tt.rotrSH(_,B,8)^tt.shrSH(_,B,7),L=tt.rotrSL(_,B,1)^tt.rotrSL(_,B,8)^tt.shrSL(_,B,7),T=We[m-2]|0,P=Ye[m-2]|0,M=tt.rotrSH(T,P,19)^tt.rotrBH(T,P,61)^tt.shrSH(T,P,6),K=tt.rotrSL(T,P,19)^tt.rotrBL(T,P,61)^tt.shrSL(T,P,6),F=tt.add4L(L,K,Ye[m-7],Ye[m-16]),H=tt.add4H(F,E,M,We[m-7],We[m-16]);We[m]=H|0,Ye[m]=F|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:c,Dh:f,Dl:u,Eh:h,El:l,Fh:g,Fl:d,Gh:p,Gl:y,Hh:x,Hl:S}=this;for(let m=0;m<80;m++){let _=tt.rotrSH(h,l,14)^tt.rotrSH(h,l,18)^tt.rotrBH(h,l,41),B=tt.rotrSL(h,l,14)^tt.rotrSL(h,l,18)^tt.rotrBL(h,l,41),E=h&g^~h&p,L=l&d^~l&y,T=tt.add5L(S,B,L,ll[m],Ye[m]),P=tt.add5H(T,x,_,E,hl[m],We[m]),M=T|0,K=tt.rotrSH(n,i,28)^tt.rotrBH(n,i,34)^tt.rotrBH(n,i,39),F=tt.rotrSL(n,i,28)^tt.rotrBL(n,i,34)^tt.rotrBL(n,i,39),H=n&o^n&a^o&a,Z=i&s^i&c^s&c;x=p|0,S=y|0,p=g|0,y=d|0,g=h|0,d=l|0,{h,l}=tt.add(f|0,u|0,P|0,M|0),f=a|0,u=c|0,a=o|0,c=s|0,o=n|0,s=i|0;let A=tt.add3L(M,F,Z);n=tt.add3H(A,P,K,H),i=A|0}({h:n,l:i}=tt.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=tt.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:c}=tt.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=tt.add(this.Dh|0,this.Dl|0,f|0,u|0),{h,l}=tt.add(this.Eh|0,this.El|0,h|0,l|0),{h:g,l:d}=tt.add(this.Fh|0,this.Fl|0,g|0,d|0),{h:p,l:y}=tt.add(this.Gh|0,this.Gl|0,p|0,y|0),{h:x,l:S}=tt.add(this.Hh|0,this.Hl|0,x|0,S|0),this.set(n,i,o,s,a,c,f,u,h,l,g,d,p,y,x,S)}roundClean(){We.fill(0),Ye.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Bo=ci(()=>new So);var li={};Rt(li,{bitGet:()=>bl,bitLen:()=>ml,bitMask:()=>gn,bitSet:()=>vl,bytesToHex:()=>Re,bytesToNumberBE:()=>De,bytesToNumberLE:()=>ue,concatBytes:()=>Ne,createHmacDrbg:()=>_o,ensureBytes:()=>gt,equalBytes:()=>gl,hexToBytes:()=>hr,hexToNumber:()=>Co,numberToBytesBE:()=>$e,numberToBytesLE:()=>ke,numberToHexUnpadded:()=>$a,numberToVarBytesBE:()=>yl,utf8ToBytes:()=>xl,validateObject:()=>re});var Ya=BigInt(0),ui=BigInt(1),dl=BigInt(2),hi=t=>t instanceof Uint8Array,pl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Re(t){if(!hi(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=pl[t[r]];return e}function $a(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Co(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function hr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,o=t.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function De(t){return Co(Re(t))}function ue(t){if(!hi(t))throw new Error("Uint8Array expected");return Co(Re(Uint8Array.from(t).reverse()))}function $e(t,e){return hr(t.toString(16).padStart(e*2,"0"))}function ke(t,e){return $e(t,e).reverse()}function yl(t){return hr($a(t))}function gt(t,e,r){let n;if(typeof e=="string")try{n=hr(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(hi(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Ne(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!hi(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function gl(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function xl(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function ml(t){let e;for(e=0;t>Ya;t>>=ui,e+=1);return e}function bl(t,e){return t>>BigInt(e)&ui}var vl=(t,e,r)=>t|(r?ui:Ya)<<BigInt(e),gn=t=>(dl<<BigInt(t-1))-ui,Ao=t=>new Uint8Array(t),Wa=t=>Uint8Array.from(t);function _o(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Ao(t),i=Ao(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...h)=>r(i,n,...h),c=(h=Ao())=>{i=a(Wa([0]),h),n=a(),h.length!==0&&(i=a(Wa([1]),h),n=a())},f=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,l=[];for(;h<e;){n=a();let g=n.slice();l.push(g),h+=n.length}return Ne(...l)};return(h,l)=>{s(),c(h);let g;for(;!(g=l(f()));)c();return s(),g}}var wl={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function re(t,e,r={}){let n=(i,o,s)=>{let a=wl[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let c=t[i];if(!(s&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}var Lt=BigInt(0),vt=BigInt(1),lr=BigInt(2),El=BigInt(3),Io=BigInt(4),Za=BigInt(5),Xa=BigInt(8),Sl=BigInt(9),Bl=BigInt(16);function ft(t,e){let r=t%e;return r>=Lt?r:e+r}function To(t,e,r){if(r<=Lt||e<Lt)throw new Error("Expected power/modulo > 0");if(r===vt)return Lt;let n=vt;for(;e>Lt;)e&vt&&(n=n*t%r),t=t*t%r,e>>=vt;return n}function xt(t,e,r){let n=t;for(;e-- >Lt;)n*=n,n%=r;return n}function di(t,e){if(t===Lt||e<=Lt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=ft(t,e),n=e,i=Lt,o=vt,s=vt,a=Lt;for(;r!==Lt;){let f=n/r,u=n%r,h=i-s*f,l=o-a*f;n=r,r=u,i=s,o=a,s=h,a=l}if(n!==vt)throw new Error("invert: does not exist");return ft(i,e)}function Al(t){let e=(t-vt)/lr,r,n,i;for(r=t-vt,n=0;r%lr===Lt;r/=lr,n++);for(i=lr;i<t&&To(i,e,t)!==t-vt;i++);if(n===1){let s=(t+vt)/Io;return function(c,f){let u=c.pow(f,s);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}let o=(r+vt)/lr;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,u=a.pow(a.mul(a.ONE,i),r),h=a.pow(c,o),l=a.pow(c,r);for(;!a.eql(l,a.ONE);){if(a.eql(l,a.ZERO))return a.ZERO;let g=1;for(let p=a.sqr(l);g<f&&!a.eql(p,a.ONE);g++)p=a.sqr(p);let d=a.pow(u,vt<<BigInt(f-g-1));u=a.sqr(d),h=a.mul(h,d),l=a.mul(l,u),f=g}return h}}function Cl(t){if(t%Io===El){let e=(t+vt)/Io;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%Xa===Za){let e=(t-Za)/Xa;return function(n,i){let o=n.mul(i,lr),s=n.pow(o,e),a=n.mul(i,s),c=n.mul(n.mul(a,lr),s),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),i))throw new Error("Cannot find square root");return f}}return t%Bl,Al(t)}var Qa=(t,e)=>(ft(t,e)&vt)===vt,_l=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Lo(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=_l.reduce((n,i)=>(n[i]="function",n),e);return re(t,r)}function Il(t,e,r){if(r<Lt)throw new Error("Expected power > 0");if(r===Lt)return t.ONE;if(r===vt)return e;let n=t.ONE,i=e;for(;r>Lt;)r&vt&&(n=t.mul(n,i)),i=t.sqr(i),r>>=vt;return n}function Tl(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}function Ro(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function pi(t,e,r=!1,n={}){if(t<=Lt)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=Ro(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=Cl(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:gn(i),ZERO:Lt,ONE:vt,create:c=>ft(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Lt<=c&&c<t},is0:c=>c===Lt,isOdd:c=>(c&vt)===vt,neg:c=>ft(-c,t),eql:(c,f)=>c===f,sqr:c=>ft(c*c,t),add:(c,f)=>ft(c+f,t),sub:(c,f)=>ft(c-f,t),mul:(c,f)=>ft(c*f,t),pow:(c,f)=>Il(a,c,f),div:(c,f)=>ft(c*di(f,t),t),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>di(c,t),sqrt:n.sqrt||(c=>s(a,c)),invertBatch:c=>Tl(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>r?ke(c,o):$e(c,o),fromBytes:c=>{if(c.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${c.length}`);return r?ue(c):De(c)}});return Object.freeze(a)}function Ja(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function ja(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function Do(t){let e=ja(t);return e+Math.ceil(e/2)}function t0(t,e,r=!1){let n=t.length,i=ja(e),o=Do(e);if(n<16||n<o||n>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=r?De(t):ue(t),a=ft(s,e-vt)+vt;return r?ke(a,i):$e(a,i)}var Rl=BigInt(0),ko=BigInt(1);function yi(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>Rl;)o&ko&&(s=s.add(a)),a=a.double(),o>>=ko;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),c=[],f=i,u=f;for(let h=0;h<s;h++){u=f,c.push(u);for(let l=1;l<a;l++)u=u.add(f),c.push(u);f=u.double()}return c},wNAF(i,o,s){let{windows:a,windowSize:c}=n(i),f=t.ZERO,u=t.BASE,h=BigInt(2**i-1),l=2**i,g=BigInt(i);for(let d=0;d<a;d++){let p=d*c,y=Number(s&h);s>>=g,y>c&&(y-=l,s+=ko);let x=p,S=p+Math.abs(y)-1,m=d%2!==0,_=y<0;y===0?u=u.add(r(m,o[x])):f=f.add(r(_,o[S]))}return{p:f,f:u}},wNAFCached(i,o,s,a){let c=i._WINDOW_SIZE||1,f=o.get(i);return f||(f=this.precomputeWindow(i,c),c!==1&&o.set(i,a(f))),this.wNAF(c,f,s)}}}function xn(t){return Lo(t.Fp),re(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ro(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var he=BigInt(0),Qt=BigInt(1),gi=BigInt(2),Dl=BigInt(8),kl={zip215:!0};function Nl(t){let e=xn(t);return re(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function xi(t){let e=Nl(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=e,f=gi<<BigInt(a*8)-Qt,u=r.create,h=e.uvRatio||((R,v)=>{try{return{isValid:!0,value:r.sqrt(R*r.inv(v))}}catch{return{isValid:!1,value:he}}}),l=e.adjustScalarBytes||(R=>R),g=e.domain||((R,v,U)=>{if(v.length||U)throw new Error("Contexts/pre-hash are not supported");return R}),d=R=>typeof R=="bigint"&&he<R,p=(R,v)=>d(R)&&d(v)&&R<v,y=R=>R===he||p(R,f);function x(R,v){if(p(R,v))return R;throw new Error(`Expected valid scalar < ${v}, got ${typeof R} ${R}`)}function S(R){return R===he?R:x(R,n)}let m=new Map;function _(R){if(!(R instanceof B))throw new Error("ExtendedPoint expected")}class B{constructor(v,U,O,q){if(this.ex=v,this.ey=U,this.ez=O,this.et=q,!y(v))throw new Error("x required");if(!y(U))throw new Error("y required");if(!y(O))throw new Error("z required");if(!y(q))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(v){if(v instanceof B)throw new Error("extended point not allowed");let{x:U,y:O}=v||{};if(!y(U)||!y(O))throw new Error("invalid affine point");return new B(U,O,Qt,u(U*O))}static normalizeZ(v){let U=r.invertBatch(v.map(O=>O.ez));return v.map((O,q)=>O.toAffine(U[q])).map(B.fromAffine)}_setWindowSize(v){this._WINDOW_SIZE=v,m.delete(this)}assertValidity(){let{a:v,d:U}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:O,ey:q,ez:Y,et:$}=this,rt=u(O*O),X=u(q*q),J=u(Y*Y),pt=u(J*J),lt=u(rt*v),Mt=u(J*u(lt+X)),Ft=u(pt+u(U*u(rt*X)));if(Mt!==Ft)throw new Error("bad point: equation left != right (1)");let It=u(O*q),zt=u(Y*$);if(It!==zt)throw new Error("bad point: equation left != right (2)")}equals(v){_(v);let{ex:U,ey:O,ez:q}=this,{ex:Y,ey:$,ez:rt}=v,X=u(U*rt),J=u(Y*q),pt=u(O*rt),lt=u($*q);return X===J&&pt===lt}is0(){return this.equals(B.ZERO)}negate(){return new B(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:v}=e,{ex:U,ey:O,ez:q}=this,Y=u(U*U),$=u(O*O),rt=u(gi*u(q*q)),X=u(v*Y),J=U+O,pt=u(u(J*J)-Y-$),lt=X+$,Mt=lt-rt,Ft=X-$,It=u(pt*Mt),zt=u(lt*Ft),Ie=u(pt*Ft),sr=u(Mt*lt);return new B(It,zt,sr,Ie)}add(v){_(v);let{a:U,d:O}=e,{ex:q,ey:Y,ez:$,et:rt}=this,{ex:X,ey:J,ez:pt,et:lt}=v;if(U===BigInt(-1)){let da=u((Y-q)*(J+X)),pa=u((Y+q)*(J-X)),no=u(pa-da);if(no===he)return this.double();let ya=u($*gi*lt),ga=u(rt*gi*pt),xa=ga+ya,ma=pa+da,ba=ga-ya,Ju=u(xa*no),ju=u(ma*ba),th=u(xa*ba),eh=u(no*ma);return new B(Ju,ju,eh,th)}let Mt=u(q*X),Ft=u(Y*J),It=u(rt*O*lt),zt=u($*pt),Ie=u((q+Y)*(X+J)-Mt-Ft),sr=zt-It,dn=zt+It,la=u(Ft-U*Mt),$u=u(Ie*sr),Zu=u(dn*la),Xu=u(Ie*la),Qu=u(sr*dn);return new B($u,Zu,Qu,Xu)}subtract(v){return this.add(v.negate())}wNAF(v){return T.wNAFCached(this,m,v,B.normalizeZ)}multiply(v){let{p:U,f:O}=this.wNAF(x(v,n));return B.normalizeZ([U,O])[0]}multiplyUnsafe(v){let U=S(v);return U===he?L:this.equals(L)||U===Qt?this:this.equals(E)?this.wNAF(U).p:T.unsafeLadder(this,U)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return T.unsafeLadder(this,n).is0()}toAffine(v){let{ex:U,ey:O,ez:q}=this,Y=this.is0();v==null&&(v=Y?Dl:r.inv(q));let $=u(U*v),rt=u(O*v),X=u(q*v);if(Y)return{x:he,y:Qt};if(X!==Qt)throw new Error("invZ was invalid");return{x:$,y:rt}}clearCofactor(){let{h:v}=e;return v===Qt?this:this.multiplyUnsafe(v)}static fromHex(v,U=!1){let{d:O,a:q}=e,Y=r.BYTES;v=gt("pointHex",v,Y);let $=v.slice(),rt=v[Y-1];$[Y-1]=rt&-129;let X=ue($);X===he||(U?x(X,f):x(X,r.ORDER));let J=u(X*X),pt=u(J-Qt),lt=u(O*J-q),{isValid:Mt,value:Ft}=h(pt,lt);if(!Mt)throw new Error("Point.fromHex: invalid y coordinate");let It=(Ft&Qt)===Qt,zt=(rt&128)!==0;if(!U&&Ft===he&&zt)throw new Error("Point.fromHex: x=0 and x_0=1");return zt!==It&&(Ft=u(-Ft)),B.fromAffine({x:Ft,y:X})}static fromPrivateKey(v){return K(v).point}toRawBytes(){let{x:v,y:U}=this.toAffine(),O=ke(U,r.BYTES);return O[O.length-1]|=v&Qt?128:0,O}toHex(){return Re(this.toRawBytes())}}B.BASE=new B(e.Gx,e.Gy,Qt,u(e.Gx*e.Gy)),B.ZERO=new B(he,Qt,Qt,he);let{BASE:E,ZERO:L}=B,T=yi(B,a*8);function P(R){return ft(R,n)}function M(R){return P(ue(R))}function K(R){let v=a;R=gt("private key",R,v);let U=gt("hashed private key",o(R),2*v),O=l(U.slice(0,v)),q=U.slice(v,2*v),Y=M(O),$=E.multiply(Y),rt=$.toRawBytes();return{head:O,prefix:q,scalar:Y,point:$,pointBytes:rt}}function F(R){return K(R).pointBytes}function H(R=new Uint8Array,...v){let U=Ne(...v);return M(o(g(U,gt("context",R),!!i)))}function Z(R,v,U={}){R=gt("message",R),i&&(R=i(R));let{prefix:O,scalar:q,pointBytes:Y}=K(v),$=H(U.context,O,R),rt=E.multiply($).toRawBytes(),X=H(U.context,rt,Y,R),J=P($+X*q);S(J);let pt=Ne(rt,ke(J,r.BYTES));return gt("result",pt,a*2)}let A=kl;function D(R,v,U,O=A){let{context:q,zip215:Y}=O,$=r.BYTES;R=gt("signature",R,2*$),v=gt("message",v),i&&(v=i(v));let rt=ue(R.slice($,2*$)),X,J,pt;try{X=B.fromHex(U,Y),J=B.fromHex(R.slice(0,$),Y),pt=E.multiplyUnsafe(rt)}catch{return!1}if(!Y&&X.isSmallOrder())return!1;let lt=H(q,J.toRawBytes(),X.toRawBytes(),v);return J.add(X.multiplyUnsafe(lt)).subtract(pt).clearCofactor().equals(B.ZERO)}return E._setWindowSize(8),{CURVE:e,getPublicKey:F,sign:Z,verify:D,ExtendedPoint:B,utils:{getExtendedPublicKey:K,randomPrivateKey:()=>s(r.BYTES),precompute(R=8,v=B.BASE){return v._setWindowSize(R),v.multiply(BigInt(3)),v}}}}var mn=BigInt(0),No=BigInt(1);function Pl(t){return re(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function e0(t){let e=Pl(t),{P:r}=e,n=m=>ft(m,r),i=e.montgomeryBits,o=Math.ceil(i/8),s=e.nByteLength,a=e.adjustScalarBytes||(m=>m),c=e.powPminus2||(m=>To(m,r-BigInt(2),r));function f(m,_,B){let E=n(m*(_-B));return _=n(_-E),B=n(B+E),[_,B]}function u(m){if(typeof m=="bigint"&&mn<=m&&m<r)return m;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(e.a-BigInt(2))/BigInt(4);function l(m,_){let B=u(m),E=u(_),L=B,T=No,P=mn,M=B,K=No,F=mn,H;for(let A=BigInt(i-1);A>=mn;A--){let D=E>>A&No;F^=D,H=f(F,T,M),T=H[0],M=H[1],H=f(F,P,K),P=H[0],K=H[1],F=D;let I=T+P,R=n(I*I),v=T-P,U=n(v*v),O=R-U,q=M+K,Y=M-K,$=n(Y*I),rt=n(q*v),X=$+rt,J=$-rt;M=n(X*X),K=n(L*n(J*J)),T=n(R*U),P=n(O*(R+n(h*O)))}H=f(F,T,M),T=H[0],M=H[1],H=f(F,P,K),P=H[0],K=H[1];let Z=c(P);return n(T*Z)}function g(m){return ke(n(m),o)}function d(m){let _=gt("u coordinate",m,o);return s===o&&(_[s-1]&=127),ue(_)}function p(m){let _=gt("scalar",m);if(_.length!==o&&_.length!==s)throw new Error(`Expected ${o} or ${s} bytes, got ${_.length}`);return ue(a(_))}function y(m,_){let B=d(_),E=p(m),L=l(B,E);if(L===mn)throw new Error("Invalid private or public key received");return g(L)}let x=g(e.Gu);function S(m){return y(m,x)}return{scalarMult:y,scalarMultBase:S,getSharedSecret:(m,_)=>y(m,_),getPublicKey:m=>S(m),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:x}}var bn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),r0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),fx=BigInt(0),Ul=BigInt(1),Po=BigInt(2),Kl=BigInt(5),n0=BigInt(10),Ol=BigInt(20),Ml=BigInt(40),i0=BigInt(80);function o0(t){let e=bn,n=t*t%e*t%e,i=xt(n,Po,e)*n%e,o=xt(i,Ul,e)*t%e,s=xt(o,Kl,e)*o%e,a=xt(s,n0,e)*s%e,c=xt(a,Ol,e)*a%e,f=xt(c,Ml,e)*c%e,u=xt(f,i0,e)*f%e,h=xt(u,i0,e)*f%e,l=xt(h,n0,e)*s%e;return{pow_p_5_8:xt(l,Po,e)*t%e,b2:n}}function s0(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Fl(t,e){let r=bn,n=ft(e*e*e,r),i=ft(n*n*e,r),o=o0(t*i).pow_p_5_8,s=ft(t*n*o,r),a=ft(e*s*s,r),c=s,f=ft(s*r0,r),u=a===t,h=a===ft(-t,r),l=a===ft(-t*r0,r);return u&&(s=c),(h||l)&&(s=f),Qa(s,r)&&(s=ft(-s,r)),{isValid:u||h,value:s}}var Pe=pi(bn,void 0,!0),Uo={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Pe,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Bo,randomBytes:ur,adjustScalarBytes:s0,uvRatio:Fl},Mr=xi(Uo);function a0(t,e,r){if(e.length>255)throw new Error("Context is too big");return ai(wo("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var ux=xi({...Uo,domain:a0}),hx=xi({...Uo,domain:a0,prehash:Bo}),vn=(()=>e0({P:bn,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let e=bn,{pow_p_5_8:r,b2:n}=o0(t);return ft(xt(r,BigInt(3),e)*n,e)},adjustScalarBytes:s0,randomBytes:ur}))();var Vl=(Pe.ORDER+BigInt(3))/BigInt(8),lx=Pe.pow(Po,Vl),dx=Pe.sqrt(Pe.neg(Pe.ONE)),px=(Pe.ORDER-BigInt(5))/BigInt(8),yx=BigInt(486662);var gx=Ja(Pe,Pe.neg(BigInt(486664)));var xx=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),mx=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),bx=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),vx=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var wx=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var mi=class extends Kr{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,yn(e);let n=Ge(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return Ur(this),this.iHash.update(e),this}digestInto(e){Ur(this),vo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Fr=(t,e,r)=>new mi(t,e).update(r).digest();Fr.create=(t,e)=>new mi(t,e);function f0(t,e,r){return yn(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Fr(t,Ge(r),Ge(e))}var Ko=new Uint8Array([0]),c0=new Uint8Array;function u0(t,e,r,n=32){if(yn(t),ii(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(n/t.outputLen);r===void 0&&(r=c0);let o=new Uint8Array(i*t.outputLen),s=Fr.create(t,e),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let f=0;f<i;f++)Ko[0]=f+1,a.update(f===0?c0:c).update(r).update(Ko).digestInto(c),o.set(c,t.outputLen*f),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),Ko.fill(0),o.slice(0,n)}var ql=(t,e,r)=>t&e^~t&r,Hl=(t,e,r)=>t&e^t&r^e&r,zl=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ze=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Xe=new Uint32Array(64),Oo=class extends Or{constructor(){super(64,32,8,!1),this.A=Ze[0]|0,this.B=Ze[1]|0,this.C=Ze[2]|0,this.D=Ze[3]|0,this.E=Ze[4]|0,this.F=Ze[5]|0,this.G=Ze[6]|0,this.H=Ze[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:c}=this;return[e,r,n,i,o,s,a,c]}set(e,r,n,i,o,s,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)Xe[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let l=Xe[h-15],g=Xe[h-2],d=fe(l,7)^fe(l,18)^l>>>3,p=fe(g,17)^fe(g,19)^g>>>10;Xe[h]=p+Xe[h-7]+d+Xe[h-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:c,G:f,H:u}=this;for(let h=0;h<64;h++){let l=fe(a,6)^fe(a,11)^fe(a,25),g=u+l+ql(a,c,f)+zl[h]+Xe[h]|0,p=(fe(n,2)^fe(n,13)^fe(n,22))+Hl(n,i,o)|0;u=f,f=c,c=a,a=s+g|0,s=o,o=i,i=n,n=g+p|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,c,f,u)}roundClean(){Xe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Vr=ci(()=>new Oo);var bi={hashSHA256(t){return Vr(t)},getHKDF(t,e){let r=f0(Vr,e,t),i=u0(Vr,r,void 0,96),o=i.subarray(0,32),s=i.subarray(32,64),a=i.subarray(64,96);return[o,s,a]},generateX25519KeyPair(){let t=vn.utils.randomPrivateKey();return{publicKey:vn.getPublicKey(t),privateKey:t}},generateX25519KeyPairFromSeed(t){return{publicKey:vn.getPublicKey(t),privateKey:t}},generateX25519SharedKey(t,e){return vn.getSharedSecret(t,e)},chaCha20Poly1305Encrypt(t,e,r,n){return bo(n,e,r).encrypt(t)},chaCha20Poly1305Decrypt(t,e,r,n,i){return bo(n,e,r).decrypt(t,i)}};var Gl=t=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t),qr=t=>{let e=Gl(2);return new DataView(e.buffer,e.byteOffset,e.byteLength).setUint16(0,t,!1),e};qr.bytes=2;var wn=t=>{if(t.length<2)throw RangeError("Could not decode int16BE");return t instanceof Uint8Array?new DataView(t.buffer,t.byteOffset,t.byteLength).getUint16(0,!1):t.getUint16(0)};wn.bytes=2;function h0(t){return Tt([t.ne,t.ciphertext],t.ne.length+t.ciphertext.length)}function l0(t){return Tt([t.ne,t.ns,t.ciphertext],t.ne.length+t.ns.length+t.ciphertext.length)}function d0(t){return Tt([t.ns,t.ciphertext],t.ns.length+t.ciphertext.length)}function p0(t){if(t.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:t.subarray(0,32),ciphertext:t.subarray(32,t.length),ns:new Uint8Array(0)}}function y0(t){if(t.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:t.subarray(0,32),ns:t.subarray(32,80),ciphertext:t.subarray(80,t.length)}}function g0(t){if(t.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:t.subarray(0,48),ciphertext:t.subarray(48,t.length)}}var m0=16;function b0(t,e){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65519){let o=i+65519;o>n.length&&(o=n.length);let s=t.encrypt(n.subarray(i,o),t.session);e?.encryptedPackets.increment(),yield qr(s.byteLength),yield s}}}function v0(t,e){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65535){let o=i+65535;if(o>n.length&&(o=n.length),o-m0<i)throw new Error("Invalid chunk");let s=n.subarray(i,o),a=n.subarray(i,o-m0),{plaintext:c,valid:f}=t.decrypt(s,t.session,a);if(!f)throw e?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");e?.decryptedPackets.increment(),yield c}}}var it=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}},Sn=class t extends Error{code;constructor(e="Unexpected Peer"){super(e),this.code=t.code}static code="ERR_UNEXPECTED_PEER"},dr=class t extends Error{code;constructor(e="Invalid crypto exchange"){super(e),this.code=t.code}static code="ERR_INVALID_CRYPTO_EXCHANGE"};var mw=Ct(_n(),1),bw=Ct(Uc(),1);var cg=Ct(dt(),1);var hs={};Rt(hs,{base10:()=>wy});function gy(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var p=0,y=0,x=0,S=d.length;x!==S&&d[x]===0;)x++,p++;for(var m=(S-x)*u+1>>>0,_=new Uint8Array(m);x!==S;){for(var B=d[x],E=0,L=m-1;(B!==0||E<y)&&L!==-1;L--,E++)B+=256*_[L]>>>0,_[L]=B%a>>>0,B=B/a>>>0;if(B!==0)throw new Error("Non-zero carry");y=E,x++}for(var T=m-y;T!==m&&_[T]===0;)T++;for(var P=c.repeat(p);T<m;++T)P+=t.charAt(_[T]);return P}function l(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var p=0;if(d[p]!==" "){for(var y=0,x=0;d[p]===c;)y++,p++;for(var S=(d.length-p)*f+1>>>0,m=new Uint8Array(S);d[p];){var _=r[d.charCodeAt(p)];if(_===255)return;for(var B=0,E=S-1;(_!==0||B<x)&&E!==-1;E--,B++)_+=a*m[E]>>>0,m[E]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");x=B,p++}if(d[p]!==" "){for(var L=S-x;L!==S&&m[L]===0;)L++;for(var T=new Uint8Array(y+(S-L)),P=y;L!==S;)T[P++]=m[L++];return T}}}function g(d){var p=l(d);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var xy=gy,my=xy,Kc=my;var gm=new Uint8Array(0);var Oc=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Me=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Mc=t=>new TextEncoder().encode(t),Fc=t=>new TextDecoder().decode(t);var as=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},cs=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return qc(this,e)}},fs=class{constructor(e){this.decoders=e}or(e){return qc(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},qc=(t,e)=>new fs({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),us=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new as(e,r,n),this.decoder=new cs(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Yr=({name:t,prefix:e,encode:r,decode:n})=>new us(t,e,r,n),er=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Kc(r,e);return Yr({prefix:t,name:e,encode:n,decode:o=>Me(i(o))})},by=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,c=0,f=0;for(let u=0;u<o;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,s[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},vy=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},Bt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Yr({prefix:e,name:t,encode(i){return vy(i,n,r)},decode(i){return by(i,n,r,t)}});var wy=er({prefix:"9",name:"base10",alphabet:"0123456789"});var ls={};Rt(ls,{base16:()=>Ey,base16upper:()=>Sy});var Ey=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Sy=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ds={};Rt(ds,{base2:()=>By});var By=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ps={};Rt(ps,{base256emoji:()=>Ty});var Hc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ay=Hc.reduce((t,e,r)=>(t[r]=e,t),[]),Cy=Hc.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function _y(t){return t.reduce((e,r)=>(e+=Ay[r],e),"")}function Iy(t){let e=[];for(let r of t){let n=Cy[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Ty=Yr({prefix:"\u{1F680}",name:"base256emoji",encode:_y,decode:Iy});var ys={};Rt(ys,{base32:()=>rr,base32hex:()=>ky,base32hexpad:()=>Py,base32hexpadupper:()=>Uy,base32hexupper:()=>Ny,base32pad:()=>Ry,base32padupper:()=>Dy,base32upper:()=>Ly,base32z:()=>Ky});var rr=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ly=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ry=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Dy=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ky=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ny=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Py=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Uy=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ky=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var gs={};Rt(gs,{base36:()=>Oy,base36upper:()=>My});var Oy=er({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),My=er({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var xs={};Rt(xs,{base58btc:()=>qt,base58flickr:()=>Fy});var qt=er({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Fy=er({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ms={};Rt(ms,{base64:()=>$r,base64pad:()=>Vy,base64url:()=>qy,base64urlpad:()=>Hy});var $r=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Vy=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qy=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Hy=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var bs={};Rt(bs,{base8:()=>zy});var zy=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var vs={};Rt(vs,{identity:()=>Gy});var Gy=Yr({prefix:"\0",name:"identity",encode:t=>Fc(t),decode:t=>Mc(t)});var Rm=new TextEncoder,Dm=new TextDecoder;var Es={};Rt(Es,{identity:()=>nr});var $y=Wc,zc=128,Zy=127,Xy=~Zy,Qy=Math.pow(2,31);function Wc(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Qy;)e[r++]=t&255|zc,t/=128;for(;t&Xy;)e[r++]=t&255|zc,t>>>=7;return e[r]=t|0,Wc.bytes=r-n+1,e}var Jy=ws,jy=128,Gc=127;function ws(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw ws.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&Gc)<<i:(s&Gc)*Math.pow(2,i),i+=7}while(s>=jy);return ws.bytes=o-n,r}var t1=Math.pow(2,7),e1=Math.pow(2,14),r1=Math.pow(2,21),n1=Math.pow(2,28),i1=Math.pow(2,35),o1=Math.pow(2,42),s1=Math.pow(2,49),a1=Math.pow(2,56),c1=Math.pow(2,63),f1=function(t){return t<t1?1:t<e1?2:t<r1?3:t<n1?4:t<i1?5:t<o1?6:t<s1?7:t<a1?8:t<c1?9:10},u1={encode:$y,decode:Jy,encodingLength:f1},h1=u1,Ln=h1;var Rn=(t,e=0)=>[Ln.decode(t,e),Ln.decode.bytes],Zr=(t,e,r=0)=>(Ln.encode(t,e,r),e),Xr=t=>Ln.encodingLength(t);var Be=(t,e)=>{let r=e.byteLength,n=Xr(t),i=n+Xr(r),o=new Uint8Array(i+r);return Zr(t,o,0),Zr(r,o,n),o.set(e,i),new Qr(t,r,e,o)},Dn=t=>{let e=Me(t),[r,n]=Rn(e),[i,o]=Rn(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Qr(r,i,s,e)},Yc=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Oc(t.bytes,r.bytes)}},Qr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var $c=0,l1="identity",Zc=Me,d1=t=>Be($c,Zc(t)),nr={code:$c,name:l1,encode:Zc,digest:d1};var As={};Rt(As,{sha256:()=>Ht,sha512:()=>p1});var Bs=({name:t,code:e,encode:r})=>new Ss(t,e,r),Ss=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Be(this.code,r):r.then(n=>Be(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Qc=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Ht=Bs({name:"sha2-256",code:18,encode:Qc("SHA-256")}),p1=Bs({name:"sha2-512",code:19,encode:Qc("SHA-512")});var Jc=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return g1(r,Cs(t),e||qt.encoder);default:return x1(r,Cs(t),e||rr.encoder)}};var jc=new WeakMap,Cs=t=>{let e=jc.get(t);if(e==null){let r=new Map;return jc.set(t,r),r}return e},br=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==kn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==m1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Be(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Yc(e.multihash,n.multihash)}toString(e){return Jc(this,e)}toJSON(){return{"/":Jc(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s||tf(n,i,o.bytes))}else if(r[b1]===!0){let{version:n,multihash:i,code:o}=r,s=Dn(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==kn)throw new Error(`Version 0 CID must use dag-pb (code: ${kn}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=tf(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,kn,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=Me(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new Qr(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Rn(e.subarray(r));return r+=l,h},i=n(),o=kn;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),c=n(),f=r+c,u=f-s;return{version:i,codec:o,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,i]=y1(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Cs(o).set(n,e),o}},y1=(t,e)=>{switch(t[0]){case"Q":{let r=e||qt;return[qt.prefix,r.decode(`${qt.prefix}${t}`)]}case qt.prefix:{let r=e||qt;return[qt.prefix,r.decode(t)]}case rr.prefix:{let r=e||rr;return[rr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},g1=(t,e,r)=>{let{prefix:n}=r;if(n!==qt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},x1=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},kn=112,m1=18,tf=(t,e,r)=>{let n=Xr(t),i=n+Xr(e),o=new Uint8Array(i+r.byteLength);return Zr(t,o,0),Zr(e,o,n),o.set(r,i),o},b1=Symbol.for("@ipld/js-cid/CID");var jr={...vs,...ds,...bs,...hs,...ls,...ys,...gs,...xs,...ms,...ps},$m={...As,...Es};function rf(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var ef=rf("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),_s=rf("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=ee(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),v1={utf8:ef,"utf-8":ef,hex:jr.base16,latin1:_s,ascii:_s,binary:_s,...jr},Mi=v1;function Ut(t,e="utf8"){let r=Mi[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ze(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var $s={};Rt($s,{Ed25519PrivateKey:()=>Cr,Ed25519PublicKey:()=>Un,generateKeyPair:()=>P1,generateKeyPairFromSeed:()=>tu,unmarshalEd25519PrivateKey:()=>k1,unmarshalEd25519PublicKey:()=>N1});var tn=32,Fe=64,Fi=32;async function nf(){let t=Mr.utils.randomPrivateKey(),e=Mr.getPublicKey(t);return{privateKey:cf(t,e),publicKey:e}}async function of(t){if(t.length!==Fi)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=Mr.getPublicKey(e);return{privateKey:cf(e,r),publicKey:r}}async function sf(t,e){let r=t.subarray(0,Fi);return Mr.sign(e,r)}async function af(t,e,r){return Mr.verify(e,r,t)}function cf(t,e){let r=new Uint8Array(Fe);for(let n=0;n<Fi;n++)r[n]=t[n],r[Fi+n]=e[n];return r}var Xt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Is={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Ts(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",o=t?.saltLength??16,s=t?.iterations??32767,a=Xt.get();r*=8;async function c(h,l){let g=a.getRandomValues(new Uint8Array(o)),d=a.getRandomValues(new Uint8Array(n)),p={name:e,iv:d};typeof l=="string"&&(l=Ut(l));let y;if(l.length===0){y=await a.subtle.importKey("jwk",Is,{name:"AES-GCM"},!0,["encrypt"]);try{let S={name:"PBKDF2",salt:g,iterations:s,hash:{name:i}},m=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(S,m,{name:e,length:r},!0,["encrypt"])}catch{y=await a.subtle.importKey("jwk",Is,{name:"AES-GCM"},!0,["encrypt"])}}else{let S={name:"PBKDF2",salt:g,iterations:s,hash:{name:i}},m=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(S,m,{name:e,length:r},!0,["encrypt"])}let x=await a.subtle.encrypt(p,y,h);return Tt([g,p.iv,new Uint8Array(x)])}async function f(h,l){let g=h.subarray(0,o),d=h.subarray(o,o+n),p=h.subarray(o+n),y={name:e,iv:d};typeof l=="string"&&(l=Ut(l));let x;if(l.length===0)try{let m={name:"PBKDF2",salt:g,iterations:s,hash:{name:i}},_=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(m,_,{name:e,length:r},!0,["decrypt"])}catch{x=await a.subtle.importKey("jwk",Is,{name:"AES-GCM"},!0,["decrypt"])}else{let m={name:"PBKDF2",salt:g,iterations:s,hash:{name:i}},_=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);x=await a.subtle.deriveKey(m,_,{name:e,length:r},!0,["decrypt"])}let S=await a.subtle.decrypt(y,x,p);return new Uint8Array(S)}return{encrypt:c,decrypt:f}}async function en(t,e){let n=await Ts().encrypt(t,e);return $r.encode(n)}var qs=Ct(Ns(),1),Xf=Ct(qf(),1),Qf=Ct(wr(),1),Hs=Ct(Vs(),1),Jf=Ct(Zf(),1);function L1(){Qf.default._configure(),qs.default._configure(Xf.default),Hs.default._configure(Jf.default)}L1();var jf=["uint64","int64","sint64","fixed64","sfixed64"];function R1(t){for(let e of jf){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function zs(t){return R1(new qs.default(t))}function D1(t){for(let e of jf){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function Gs(){return D1(Hs.default.create())}function Sr(t,e){let r=zs(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Br(t,e){let r=Gs();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var nn;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(nn||(nn={}));function Gi(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Ws(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return Gi("enum",nn.VARINT,r,n)}function Ar(t,e){return Gi("message",nn.LENGTH_DELIMITED,t,e)}var Et;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(Et||(Et={}));var Ys;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Ys||(Ys={}));(function(t){t.codec=()=>Ws(Ys)})(Et||(Et={}));var Ce;(function(t){let e;t.codec=()=>(e==null&&(e=Ar((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Et.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=Et.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Br(r,t.codec()),t.decode=r=>Sr(r,t.codec())})(Ce||(Ce={}));var _e;(function(t){let e;t.codec=()=>(e==null&&(e=Ar((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Et.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Type=Et.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Br(r,t.codec()),t.decode=r=>Sr(r,t.codec())})(_e||(_e={}));var Un=class{_key;constructor(e){this._key=on(e,tn)}async verify(e,r){return af(this._key,r,e)}marshal(){return this._key}get bytes(){return Ce.encode({Type:Et.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ht.digest(this.bytes);return e}},Cr=class{_key;_publicKey;constructor(e,r){this._key=on(e,Fe),this._publicKey=on(r,tn)}async sign(e){return sf(this._key,e)}get public(){return new Un(this._publicKey)}marshal(){return this._key}get bytes(){return _e.encode({Type:Et.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ht.digest(this.bytes);return e}async id(){let e=nr.digest(this.public.bytes);return qt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return en(this.bytes,e);throw new it(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function k1(t){if(t.length>Fe){t=on(t,Fe+tn);let n=t.subarray(0,Fe),i=t.subarray(Fe,t.length);return new Cr(n,i)}t=on(t,Fe);let e=t.subarray(0,Fe),r=t.subarray(tn);return new Cr(e,r)}function N1(t){return t=on(t,tn),new Un(t)}async function P1(){let{privateKey:t,publicKey:e}=await nf();return new Cr(t,e)}async function tu(t){let{privateKey:e,publicKey:r}=await of(t);return new Cr(e,r)}function on(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new it(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}function St(t,e="utf8"){let r=Mi[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Wb=Ct(_t(),1),Yb=Ct(Ni(),1),eu=Ct(dt(),1);function xe(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Tt([new Uint8Array(e-r.length),r])}return St(r,"base64url")}function Jt(t){let e=ru(t);return new eu.default.jsbn.BigInteger(St(e,"base16"),16)}function ru(t,e){let r=Ut(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Tt([new Uint8Array(e-r.length),r])}return r}var U1={"P-256":256,"P-384":384,"P-521":521},K1=Object.keys(U1),iv=K1.join(" / ");var js={};Rt(js,{MAX_KEY_SIZE:()=>Fn,RsaPrivateKey:()=>sn,RsaPublicKey:()=>Mn,fromJwk:()=>$1,generateKeyPair:()=>Z1,unmarshalRsaPrivateKey:()=>W1,unmarshalRsaPublicKey:()=>Y1});var On=Ct(dt(),1);var qv=Ct(au(),1);function Yi(t){if(isNaN(t)||t<=0)throw new it("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return ur(t)}var Bv=Ct(Ki(),1),Qs=Ct(dt(),1);function cu(t,e){return e.map(r=>Jt(t[r]))}function fu(t){return Qs.default.pki.setRsaPrivateKey(...cu(t,["n","e","d","p","q","dp","dq","qi"]))}function uu(t){return Qs.default.pki.setRsaPublicKey(...cu(t,["n","e"]))}var Ir={};Rt(Ir,{jwkToPkcs1:()=>V1,jwkToPkix:()=>H1,pkcs1ToJwk:()=>F1,pkixToJwk:()=>q1});var _v=Ct(_n(),1),Iv=Ct(Ki(),1);var Ve=Ct(dt(),1);function F1(t){let e=Ve.default.asn1.fromDer(St(t,"ascii")),r=Ve.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:xe(r.n),e:xe(r.e),d:xe(r.d),p:xe(r.p),q:xe(r.q),dp:xe(r.dP),dq:xe(r.dQ),qi:xe(r.qInv),alg:"RS256"}}function V1(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new it("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ve.default.pki.privateKeyToAsn1({n:Jt(t.n),e:Jt(t.e),d:Jt(t.d),p:Jt(t.p),q:Jt(t.q),dP:Jt(t.dp),dQ:Jt(t.dq),qInv:Jt(t.qi)});return Ut(Ve.default.asn1.toDer(e).getBytes(),"ascii")}function q1(t){let e=Ve.default.asn1.fromDer(St(t,"ascii")),r=Ve.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:xe(r.n),e:xe(r.e)}}function H1(t){if(t.n==null||t.e==null)throw new it("JWK was missing components","ERR_INVALID_PARAMETERS");let e=Ve.default.pki.publicKeyToAsn1({n:Jt(t.n),e:Jt(t.e)});return Ut(Ve.default.asn1.toDer(e).getBytes(),"ascii")}async function hu(t){let e=await Xt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await pu(e);return{privateKey:r[0],publicKey:r[1]}}async function Js(t){let r=[await Xt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await z1(t)],n=await pu({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function lu(t,e){let r=await Xt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Xt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function du(t,e,r){let n=await Xt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Xt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function pu(t){if(t.privateKey==null||t.publicKey==null)throw new it("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Xt.get().subtle.exportKey("jwk",t.privateKey),Xt.get().subtle.exportKey("jwk",t.publicKey)])}async function z1(t){return Xt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function yu(t,e,r,n){let i=e?uu(t):fu(t),o=St(Uint8Array.from(r),"ascii"),s=n(o,i);return Ut(s,"ascii")}function gu(t,e){return yu(t,!0,e,(r,n)=>n.encrypt(r))}function xu(t,e){return yu(t,!1,e,(r,n)=>n.decrypt(r))}function $i(t){if(t.kty!=="RSA")throw new it("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new it("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Ut(t.n,"base64url").length*8}var Fn=8192,Mn=class{_key;constructor(e){this._key=e}async verify(e,r){return du(this._key,r,e)}marshal(){return Ir.jwkToPkix(this._key)}get bytes(){return Ce.encode({Type:Et.RSA,Data:this.marshal()}).subarray()}encrypt(e){return gu(this._key,e)}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ht.digest(this.bytes);return e}},sn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Yi(16)}async sign(e){return lu(this._key,e)}get public(){if(this._publicKey==null)throw new it("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Mn(this._publicKey)}decrypt(e){return xu(this._key,e)}marshal(){return Ir.jwkToPkcs1(this._key)}get bytes(){return _e.encode({Type:Et.RSA,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ht.digest(this.bytes);return e}async id(){let e=await this.public.hash();return St(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new On.default.util.ByteBuffer(this.marshal()),i=On.default.asn1.fromDer(n),o=On.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return On.default.pki.encryptRsaPrivateKey(o,e,s)}else{if(r==="libp2p-key")return en(this.bytes,e);throw new it(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function W1(t){let e=Ir.pkcs1ToJwk(t);if($i(e)>Fn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await Js(e);return new sn(r.privateKey,r.publicKey)}function Y1(t){let e=Ir.pkixToJwk(t);if($i(e)>Fn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Mn(e)}async function $1(t){if($i(t)>Fn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await Js(t);return new sn(e.privateKey,e.publicKey)}async function Z1(t){if(t>Fn)throw new it("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await hu(t);return new sn(e.privateKey,e.publicKey)}var na={};Rt(na,{Secp256k1PrivateKey:()=>qn,Secp256k1PublicKey:()=>Vn,generateKeyPair:()=>ag,unmarshalSecp256k1PrivateKey:()=>og,unmarshalSecp256k1PublicKey:()=>sg});function X1(t){let e=xn(t);re(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:Q1,hexToBytes:J1}=li,Tr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=Tr;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Q1(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=Tr,r=typeof t=="string"?J1(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=Tr._parseInt(r.subarray(2)),{d:s,l:a}=Tr._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=f=>Number.parseInt(f[0],16)&8?"00"+f:f,r=f=>{let u=f.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),c=r(s);return`30${r(s+o+4)}02${c}${i}02${a}${n}`}},qe=BigInt(0),se=BigInt(1),$v=BigInt(2),mu=BigInt(3),Zv=BigInt(4);function j1(t){let e=X1(t),{Fp:r}=e,n=e.toBytes||((d,p,y)=>{let x=p.toAffine();return Ne(Uint8Array.from([4]),r.toBytes(x.x),r.toBytes(x.y))}),i=e.fromBytes||(d=>{let p=d.subarray(1),y=r.fromBytes(p.subarray(0,r.BYTES)),x=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:y,y:x}});function o(d){let{a:p,b:y}=e,x=r.sqr(d),S=r.mul(x,d);return r.add(r.add(S,r.mul(d,p)),y)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(d){return typeof d=="bigint"&&qe<d&&d<e.n}function a(d){if(!s(d))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(d){let{allowedPrivateKeyLengths:p,nByteLength:y,wrapPrivateKey:x,n:S}=e;if(p&&typeof d!="bigint"){if(d instanceof Uint8Array&&(d=Re(d)),typeof d!="string"||!p.includes(d.length))throw new Error("Invalid key");d=d.padStart(y*2,"0")}let m;try{m=typeof d=="bigint"?d:De(gt("private key",d,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof d}`)}return x&&(m=ft(m,S)),a(m),m}let f=new Map;function u(d){if(!(d instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,y,x){if(this.px=p,this.py=y,this.pz=x,p==null||!r.isValid(p))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(x==null||!r.isValid(x))throw new Error("z required")}static fromAffine(p){let{x:y,y:x}=p||{};if(!p||!r.isValid(y)||!r.isValid(x))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");let S=m=>r.eql(m,r.ZERO);return S(y)&&S(x)?h.ZERO:new h(y,x,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){let y=r.invertBatch(p.map(x=>x.pz));return p.map((x,S)=>x.toAffine(y[S])).map(h.fromAffine)}static fromHex(p){let y=h.fromAffine(i(gt("pointHex",p)));return y.assertValidity(),y}static fromPrivateKey(p){return h.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,f.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:p,y}=this.toAffine();if(!r.isValid(p)||!r.isValid(y))throw new Error("bad point: x or y not FE");let x=r.sqr(y),S=o(p);if(!r.eql(x,S))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);let{px:y,py:x,pz:S}=this,{px:m,py:_,pz:B}=p,E=r.eql(r.mul(y,B),r.mul(m,S)),L=r.eql(r.mul(x,B),r.mul(_,S));return E&&L}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:p,b:y}=e,x=r.mul(y,mu),{px:S,py:m,pz:_}=this,B=r.ZERO,E=r.ZERO,L=r.ZERO,T=r.mul(S,S),P=r.mul(m,m),M=r.mul(_,_),K=r.mul(S,m);return K=r.add(K,K),L=r.mul(S,_),L=r.add(L,L),B=r.mul(p,L),E=r.mul(x,M),E=r.add(B,E),B=r.sub(P,E),E=r.add(P,E),E=r.mul(B,E),B=r.mul(K,B),L=r.mul(x,L),M=r.mul(p,M),K=r.sub(T,M),K=r.mul(p,K),K=r.add(K,L),L=r.add(T,T),T=r.add(L,T),T=r.add(T,M),T=r.mul(T,K),E=r.add(E,T),M=r.mul(m,_),M=r.add(M,M),T=r.mul(M,K),B=r.sub(B,T),L=r.mul(M,P),L=r.add(L,L),L=r.add(L,L),new h(B,E,L)}add(p){u(p);let{px:y,py:x,pz:S}=this,{px:m,py:_,pz:B}=p,E=r.ZERO,L=r.ZERO,T=r.ZERO,P=e.a,M=r.mul(e.b,mu),K=r.mul(y,m),F=r.mul(x,_),H=r.mul(S,B),Z=r.add(y,x),A=r.add(m,_);Z=r.mul(Z,A),A=r.add(K,F),Z=r.sub(Z,A),A=r.add(y,S);let D=r.add(m,B);return A=r.mul(A,D),D=r.add(K,H),A=r.sub(A,D),D=r.add(x,S),E=r.add(_,B),D=r.mul(D,E),E=r.add(F,H),D=r.sub(D,E),T=r.mul(P,A),E=r.mul(M,H),T=r.add(E,T),E=r.sub(F,T),T=r.add(F,T),L=r.mul(E,T),F=r.add(K,K),F=r.add(F,K),H=r.mul(P,H),A=r.mul(M,A),F=r.add(F,H),H=r.sub(K,H),H=r.mul(P,H),A=r.add(A,H),K=r.mul(F,A),L=r.add(L,K),K=r.mul(D,A),E=r.mul(Z,E),E=r.sub(E,K),K=r.mul(Z,F),T=r.mul(D,T),T=r.add(T,K),new h(E,L,T)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return g.wNAFCached(this,f,p,y=>{let x=r.invertBatch(y.map(S=>S.pz));return y.map((S,m)=>S.toAffine(x[m])).map(h.fromAffine)})}multiplyUnsafe(p){let y=h.ZERO;if(p===qe)return y;if(a(p),p===se)return this;let{endo:x}=e;if(!x)return g.unsafeLadder(this,p);let{k1neg:S,k1:m,k2neg:_,k2:B}=x.splitScalar(p),E=y,L=y,T=this;for(;m>qe||B>qe;)m&se&&(E=E.add(T)),B&se&&(L=L.add(T)),T=T.double(),m>>=se,B>>=se;return S&&(E=E.negate()),_&&(L=L.negate()),L=new h(r.mul(L.px,x.beta),L.py,L.pz),E.add(L)}multiply(p){a(p);let y=p,x,S,{endo:m}=e;if(m){let{k1neg:_,k1:B,k2neg:E,k2:L}=m.splitScalar(y),{p:T,f:P}=this.wNAF(B),{p:M,f:K}=this.wNAF(L);T=g.constTimeNegate(_,T),M=g.constTimeNegate(E,M),M=new h(r.mul(M.px,m.beta),M.py,M.pz),x=T.add(M),S=P.add(K)}else{let{p:_,f:B}=this.wNAF(y);x=_,S=B}return h.normalizeZ([x,S])[0]}multiplyAndAddUnsafe(p,y,x){let S=h.BASE,m=(B,E)=>E===qe||E===se||!B.equals(S)?B.multiplyUnsafe(E):B.multiply(E),_=m(this,y).add(m(p,x));return _.is0()?void 0:_}toAffine(p){let{px:y,py:x,pz:S}=this,m=this.is0();p==null&&(p=m?r.ONE:r.inv(S));let _=r.mul(y,p),B=r.mul(x,p),E=r.mul(S,p);if(m)return{x:r.ZERO,y:r.ZERO};if(!r.eql(E,r.ONE))throw new Error("invZ was invalid");return{x:_,y:B}}isTorsionFree(){let{h:p,isTorsionFree:y}=e;if(p===se)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:p,clearCofactor:y}=e;return p===se?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return Re(this.toRawBytes(p))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let l=e.nBitLength,g=yi(h,e.endo?Math.ceil(l/2):l);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}function tg(t){let e=xn(t);return re(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function bu(t){let e=tg(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(A){return qe<A&&A<r.ORDER}function a(A){return ft(A,n)}function c(A){return di(A,n)}let{ProjectivePoint:f,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=j1({...e,toBytes(A,D,I){let R=D.toAffine(),v=r.toBytes(R.x),U=Ne;return I?U(Uint8Array.from([D.hasEvenY()?2:3]),v):U(Uint8Array.from([4]),v,r.toBytes(R.y))},fromBytes(A){let D=A.length,I=A[0],R=A.subarray(1);if(D===i&&(I===2||I===3)){let v=De(R);if(!s(v))throw new Error("Point is not on curve");let U=h(v),O=r.sqrt(U),q=(O&se)===se;return(I&1)===1!==q&&(O=r.neg(O)),{x:v,y:O}}else if(D===o&&I===4){let v=r.fromBytes(R.subarray(0,r.BYTES)),U=r.fromBytes(R.subarray(r.BYTES,2*r.BYTES));return{x:v,y:U}}else throw new Error(`Point of length ${D} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),g=A=>Re($e(A,e.nByteLength));function d(A){let D=n>>se;return A>D}function p(A){return d(A)?a(-A):A}let y=(A,D,I)=>De(A.slice(D,I));class x{constructor(D,I,R){this.r=D,this.s=I,this.recovery=R,this.assertValidity()}static fromCompact(D){let I=e.nByteLength;return D=gt("compactSignature",D,I*2),new x(y(D,0,I),y(D,I,2*I))}static fromDER(D){let{r:I,s:R}=Tr.toSig(gt("DER",D));return new x(I,R)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(D){return new x(this.r,this.s,D)}recoverPublicKey(D){let{r:I,s:R,recovery:v}=this,U=L(gt("msgHash",D));if(v==null||![0,1,2,3].includes(v))throw new Error("recovery id invalid");let O=v===2||v===3?I+e.n:I;if(O>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let q=v&1?"03":"02",Y=f.fromHex(q+g(O)),$=c(O),rt=a(-U*$),X=a(R*$),J=f.BASE.multiplyAndAddUnsafe(Y,rt,X);if(!J)throw new Error("point at infinify");return J.assertValidity(),J}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return hr(this.toDERHex())}toDERHex(){return Tr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hr(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}let S={isValidPrivateKey(A){try{return u(A),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let A=Do(e.n);return t0(e.randomBytes(A),e.n)},precompute(A=8,D=f.BASE){return D._setWindowSize(A),D.multiply(BigInt(3)),D}};function m(A,D=!0){return f.fromPrivateKey(A).toRawBytes(D)}function _(A){let D=A instanceof Uint8Array,I=typeof A=="string",R=(D||I)&&A.length;return D?R===i||R===o:I?R===2*i||R===2*o:A instanceof f}function B(A,D,I=!0){if(_(A))throw new Error("first arg must be private key");if(!_(D))throw new Error("second arg must be public key");return f.fromHex(D).multiply(u(A)).toRawBytes(I)}let E=e.bits2int||function(A){let D=De(A),I=A.length*8-e.nBitLength;return I>0?D>>BigInt(I):D},L=e.bits2int_modN||function(A){return a(E(A))},T=gn(e.nBitLength);function P(A){if(typeof A!="bigint")throw new Error("bigint expected");if(!(qe<=A&&A<T))throw new Error(`bigint expected < 2^${e.nBitLength}`);return $e(A,e.nByteLength)}function M(A,D,I=K){if(["recovered","canonical"].some(lt=>lt in I))throw new Error("sign() legacy options not supported");let{hash:R,randomBytes:v}=e,{lowS:U,prehash:O,extraEntropy:q}=I;U==null&&(U=!0),A=gt("msgHash",A),O&&(A=gt("prehashed msgHash",R(A)));let Y=L(A),$=u(D),rt=[P($),P(Y)];if(q!=null){let lt=q===!0?v(r.BYTES):q;rt.push(gt("extraEntropy",lt))}let X=Ne(...rt),J=Y;function pt(lt){let Mt=E(lt);if(!l(Mt))return;let Ft=c(Mt),It=f.BASE.multiply(Mt).toAffine(),zt=a(It.x);if(zt===qe)return;let Ie=a(Ft*a(J+zt*$));if(Ie===qe)return;let sr=(It.x===zt?0:2)|Number(It.y&se),dn=Ie;return U&&d(Ie)&&(dn=p(Ie),sr^=1),new x(zt,dn,sr)}return{seed:X,k2sig:pt}}let K={lowS:e.lowS,prehash:!1},F={lowS:e.lowS,prehash:!1};function H(A,D,I=K){let{seed:R,k2sig:v}=M(A,D,I),U=e;return _o(U.hash.outputLen,U.nByteLength,U.hmac)(R,v)}f.BASE._setWindowSize(8);function Z(A,D,I,R=F){let v=A;if(D=gt("msgHash",D),I=gt("publicKey",I),"strict"in R)throw new Error("options.strict was renamed to lowS");let{lowS:U,prehash:O}=R,q,Y;try{if(typeof v=="string"||v instanceof Uint8Array)try{q=x.fromDER(v)}catch(It){if(!(It instanceof Tr.Err))throw It;q=x.fromCompact(v)}else if(typeof v=="object"&&typeof v.r=="bigint"&&typeof v.s=="bigint"){let{r:It,s:zt}=v;q=new x(It,zt)}else throw new Error("PARSE");Y=f.fromHex(I)}catch(It){if(It.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(U&&q.hasHighS())return!1;O&&(D=e.hash(D));let{r:$,s:rt}=q,X=L(D),J=c(rt),pt=a(X*J),lt=a($*J),Mt=f.BASE.multiplyAndAddUnsafe(Y,pt,lt)?.toAffine();return Mt?a(Mt.x)===$:!1}return{CURVE:e,getPublicKey:m,getSharedSecret:B,sign:H,verify:Z,ProjectivePoint:f,Signature:x,utils:S}}function eg(t){return{hash:t,hmac:(e,...r)=>Fr(t,e,ai(...r)),randomBytes:ur}}function vu(t,e){let r=n=>bu({...t,...eg(n)});return Object.freeze({...r(e),create:r})}var Su=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),wu=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),rg=BigInt(1),ta=BigInt(2),Eu=(t,e)=>(t+e/ta)/e;function ng(t){let e=Su,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),f=t*t*t%e,u=f*f*t%e,h=xt(u,r,e)*u%e,l=xt(h,r,e)*u%e,g=xt(l,ta,e)*f%e,d=xt(g,i,e)*g%e,p=xt(d,o,e)*d%e,y=xt(p,a,e)*p%e,x=xt(y,c,e)*y%e,S=xt(x,a,e)*p%e,m=xt(S,r,e)*u%e,_=xt(m,s,e)*d%e,B=xt(_,n,e)*f%e,E=xt(B,ta,e);if(!ea.eql(ea.sqr(E),t))throw new Error("Cannot find square root");return E}var ea=pi(Su,void 0,void 0,{sqrt:ng}),He=vu({a:BigInt(0),b:BigInt(7),Fp:ea,n:wu,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=wu,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-rg*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Eu(o*t,e),c=Eu(-n*t,e),f=ft(t-a*r-c*i,e),u=ft(-a*n-c*o,e),h=f>s,l=u>s;if(h&&(f=e-f),l&&(u=e-u),f>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:f,k2neg:l,k2:u}}}},Vr),iw=BigInt(0);var ow=He.ProjectivePoint;function Bu(){return He.utils.randomPrivateKey()}async function Au(t,e){let{digest:r}=await Ht.digest(e);try{return He.sign(r,t).toDERRawBytes()}catch(n){throw new it(String(n),"ERR_INVALID_INPUT")}}async function Cu(t,e,r){try{let{digest:n}=await Ht.digest(r);return He.verify(e,n,t)}catch(n){throw new it(String(n),"ERR_INVALID_INPUT")}}function _u(t){return He.ProjectivePoint.fromHex(t).toRawBytes(!0)}function Iu(t){try{He.getPublicKey(t,!0)}catch(e){throw new it(String(e),"ERR_INVALID_PRIVATE_KEY")}}function ra(t){try{He.ProjectivePoint.fromHex(t)}catch(e){throw new it(String(e),"ERR_INVALID_PUBLIC_KEY")}}function Tu(t){try{return He.getPublicKey(t,!0)}catch(e){throw new it(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Vn=class{_key;constructor(e){ra(e),this._key=e}async verify(e,r){return Cu(this._key,r,e)}marshal(){return _u(this._key)}get bytes(){return Ce.encode({Type:Et.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ht.digest(this.bytes);return e}},qn=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??Tu(e),Iu(this._key),ra(this._publicKey)}async sign(e){return Au(this._key,e)}get public(){return new Vn(this._publicKey)}marshal(){return this._key}get bytes(){return _e.encode({Type:Et.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Dt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ht.digest(this.bytes);return e}async id(){let e=await this.public.hash();return St(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return en(this.bytes,e);throw new it(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function og(t){return new qn(t)}function sg(t){return new Vn(t)}async function ag(){let t=Bu();return new qn(t)}var Lr={rsa:js,ed25519:$s,secp256k1:na};function Lu(t){let e=Object.keys(Lr).join(" / ");return new it(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Ru(t){let e=Ce.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case Et.RSA:return Lr.rsa.unmarshalRsaPublicKey(r);case Et.Ed25519:return Lr.ed25519.unmarshalEd25519PublicKey(r);case Et.Secp256k1:return Lr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Lu(e.Type??"RSA")}}async function Du(t){let e=_e.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case Et.RSA:return Lr.rsa.unmarshalRsaPrivateKey(r);case Et.Ed25519:return Lr.ed25519.unmarshalEd25519PrivateKey(r);case Et.Secp256k1:return Lr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Lu(e.Type??"RSA")}}var ku=Symbol.for("@libp2p/peer-id");var fg=Symbol.for("nodejs.util.inspect.custom"),Nu=Object.values(jr).map(t=>t.decoder).reduce((t,e)=>t.or(e),jr.identity.decoder),Pu=114,ia=36,oa=37,Hn=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[ku]=!0;toString(){return this.string==null&&(this.string=qt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return br.createV1(Pu,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Dt(this.multihash.bytes,e);if(typeof e=="string")return ug(e).equals(this);if(e?.multihash?.bytes!=null)return Dt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[fg](){return`PeerId(${this.toString()})`}},an=class extends Hn{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},cn=class extends Hn{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},fn=class extends Hn{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function ug(t,e){if(e=e??Nu,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Dn(qt.decode(`z${t}`));return t.startsWith("12D")?new cn({multihash:r}):t.startsWith("16U")?new fn({multihash:r}):new an({multihash:r})}return hg(Nu.decode(t))}function hg(t){try{let e=Dn(t);if(e.code===nr.code){if(e.digest.length===ia)return new cn({multihash:e});if(e.digest.length===oa)return new fn({multihash:e})}if(e.code===Ht.code)return new an({multihash:e})}catch{return lg(br.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function lg(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==Pu)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Ht.code)return new an({multihash:t.multihash});if(e.code===nr.code){if(e.digest.length===ia)return new cn({multihash:t.multihash});if(e.digest.length===oa)return new fn({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function sa(t,e){return t.length===ia?new cn({multihash:Be(nr.code,t),privateKey:e}):t.length===oa?new fn({multihash:Be(nr.code,t),privateKey:e}):new an({multihash:await Ht.digest(t),publicKey:t,privateKey:e})}var Zi;(function(t){let e;t.codec=()=>(e==null&&(e=Ar((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.webtransportCerthashes!=null)for(let o of r.webtransportCerthashes)n.uint32(10),n.bytes(o);i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={webtransportCerthashes:[]},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.webtransportCerthashes.push(r.bytes());break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Br(r,t.codec()),t.decode=r=>Sr(r,t.codec())})(Zi||(Zi={}));var zn;(function(t){let e;t.codec=()=>(e==null&&(e=Ar((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),(i.writeDefaults===!0||r.identityKey!=null&&r.identityKey.byteLength>0)&&(n.uint32(10),n.bytes(r.identityKey??new Uint8Array(0))),(i.writeDefaults===!0||r.identitySig!=null&&r.identitySig.byteLength>0)&&(n.uint32(18),n.bytes(r.identitySig??new Uint8Array(0))),r.extensions!=null&&(n.uint32(34),Zi.codec().encode(r.extensions,n,{writeDefaults:!1})),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.identityKey=r.bytes();break;case 2:i.identitySig=r.bytes();break;case 4:i.extensions=Zi.codec().decode(r,r.uint32());break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Br(r,t.codec()),t.decode=r=>Sr(r,t.codec())})(zn||(zn={}));async function Uu(t,e,r){let n=await pg(t,Ku(e));if(t.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return dg(t.publicKey,n,r)}function dg(t,e,r){return zn.encode({identityKey:t,identitySig:e,extensions:r??{webtransportCerthashes:[]}}).subarray()}async function pg(t,e){if(t.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return(await Du(t.privateKey)).sign(e)}async function aa(t){return sa(t.identityKey)}function ca(t){return zn.decode(t)}function Ku(t){let e=Ut("noise-libp2p-static-key:");return Tt([e,t],e.length+t.length)}async function fa(t,e,r){let n=await sa(e.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);let i=Ku(t);if(n.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(e.identitySig==null)throw new Error("Signature was missing from message");if(!await Ru(n.publicKey).verify(i,e.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function Gn(t){return!(!(t instanceof Uint8Array)||t.length!==32)}var te=Ct(qu(),1);te.default.formatters.b=t=>t==null?"undefined":qt.baseEncode(t);te.default.formatters.t=t=>t==null?"undefined":rr.baseEncode(t);te.default.formatters.m=t=>t==null?"undefined":$r.baseEncode(t);te.default.formatters.p=t=>t==null?"undefined":t.toString();te.default.formatters.c=t=>t==null?"undefined":t.toString();te.default.formatters.k=t=>t==null?"undefined":t.toString();te.default.formatters.a=t=>t==null?"undefined":t.toString();function _g(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function Hu(t){let e=_g(`${t}:trace`);return te.default.enabled(`${t}:trace`)&&te.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,te.default)(`${t}:trace`)),Object.assign((0,te.default)(t),{error:(0,te.default)(`${t}:error`),trace:e})}var Ot=Hu("libp2p:noise");var ae;Na?ae=Ot:ae=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function zu(t){ae(`LOCAL_STATIC_PUBLIC_KEY ${St(t.publicKey,"hex")}`),ae(`LOCAL_STATIC_PRIVATE_KEY ${St(t.privateKey,"hex")}`)}function ua(t){t?(ae(`LOCAL_PUBLIC_EPHEMERAL_KEY ${St(t.publicKey,"hex")}`),ae(`LOCAL_PRIVATE_EPHEMERAL_KEY ${St(t.privateKey,"hex")}`)):ae("Missing local ephemeral keys.")}function Gu(t){ae(`REMOTE_STATIC_PUBLIC_KEY ${St(t,"hex")}`)}function ha(t){ae(`REMOTE_EPHEMERAL_PUBLIC_KEY ${St(t,"hex")}`)}function Wu(t){t.cs1&&t.cs2?(ae(`CIPHER_STATE_1 ${t.cs1.n.getUint64()} ${St(t.cs1.k,"hex")}`),ae(`CIPHER_STATE_2 ${t.cs2.n.getUint64()} ${St(t.cs2.k,"hex")}`)):ae("Missing cipher state.")}var Ig="Cipherstate has reached maximum n, a new handshake must be performed",Ji=class{n;bytes;view;constructor(e=0){this.n=e,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error(Ig)}};var ji=class{crypto;constructor(e){this.crypto=e}encryptWithAd(e,r,n){let i=this.encrypt(e.k,e.n,r,n);return e.n.increment(),i}decryptWithAd(e,r,n,i){let{plaintext:o,valid:s}=this.decrypt(e.k,e.n,r,n,i);return s&&e.n.increment(),{plaintext:o,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){let r=this.createEmptyKey();return Dt(r,e)}encrypt(e,r,n,i){return r.assertValue(),this.crypto.chaCha20Poly1305Encrypt(i,r.getBytes(),n,e)}encryptAndHash(e,r){let n;return this.hasKey(e.cs)?n=this.encryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,n),n}decrypt(e,r,n,i,o){r.assertValue();let s=this.crypto.chaCha20Poly1305Decrypt(i,r.getBytes(),n,e,o);return s?{plaintext:s,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,r){let n,i=!0;return this.hasKey(e.cs)?{plaintext:n,valid:i}=this.decryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,r),{plaintext:n,valid:i}}dh(e,r){try{let n=this.crypto.generateX25519SharedKey(e,r);return n.length===32?n:n.subarray(0,32)}catch(n){let i=n;return Ot.error(i),new Uint8Array(32)}}mixHash(e,r){e.h=this.getHash(e.h,r)}getHash(e,r){return this.crypto.hashSHA256(Tt([e,r],e.length+r.length))}mixKey(e,r){let[n,i]=this.crypto.getHKDF(e.ck,r);e.cs=this.initializeKey(i),e.ck=n}initializeKey(e){return{k:e,n:new Ji}}initializeSymmetric(e){let r=Ut(e,"utf-8"),n=this.hashProtocolName(r),i=n,o=this.createEmptyKey();return{cs:this.initializeKey(o),ck:i,h:n}}hashProtocolName(e){if(e.length<=32){let r=new Uint8Array(32);return r.set(e),r}else return this.getHash(e,new Uint8Array(0))}split(e){let[r,n]=this.crypto.getHKDF(e.ck,new Uint8Array(0)),i=this.initializeKey(r),o=this.initializeKey(n);return{cs1:i,cs2:o}}writeMessageRegular(e,r){let n=this.encryptWithAd(e,new Uint8Array(0),r),i=this.createEmptyKey(),o=new Uint8Array(0);return{ne:i,ns:o,ciphertext:n}}readMessageRegular(e,r){return this.decryptWithAd(e,new Uint8Array(0),r.ciphertext)}};var to=class extends ji{initializeInitiator(e,r,n,i){let o="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,e);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,psk:i,re:a}}initializeResponder(e,r,n,i){let o="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,e);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,psk:i,re:a}}writeMessageA(e,r,n){let i=new Uint8Array(0);n!==void 0?e.e=n:e.e=this.crypto.generateX25519KeyPair();let o=e.e.publicKey;this.mixHash(e.ss,o);let s=this.encryptAndHash(e.ss,r);return{ne:o,ns:i,ciphertext:s}}writeMessageB(e,r){e.e=this.crypto.generateX25519KeyPair();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let i=e.s.publicKey,o=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,r);return{ne:n,ns:o,ciphertext:s}}writeMessageC(e,r){let n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,r),a={ne:this.createEmptyKey(),ns:i,ciphertext:o},{cs1:c,cs2:f}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:f}}readMessageA(e,r){return Gn(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,r.ciphertext)}readMessageB(e,r){if(Gn(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);i&&Gn(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:o,valid:s}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:o,valid:i&&s}}readMessageC(e,r){let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);if(i&&Gn(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:o,valid:s}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:o,valid:i&&s,cs1:a,cs2:c}}initSession(e,r,n){let i=this.createEmptyKey(),o=new Uint8Array(32),s;return e?s=this.initializeInitiator(r,n,o,i):s=this.initializeResponder(r,n,o,i),{hs:s,i:e,mc:0}}sendMessage(e,r,n){let i;if(e.mc===0)i=this.writeMessageA(e.hs,r,n);else if(e.mc===1)i=this.writeMessageB(e.hs,r);else if(e.mc===2){let{h:o,messageBuffer:s,cs1:a,cs2:c}=this.writeMessageC(e.hs,r);i=s,e.h=o,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,r){let n=new Uint8Array(0),i=!1;if(e.mc===0)({plaintext:n,valid:i}=this.readMessageA(e.hs,r));else if(e.mc===1)({plaintext:n,valid:i}=this.readMessageB(e.hs,r));else if(e.mc===2){let{h:o,plaintext:s,valid:a,cs1:c,cs2:f}=this.readMessageC(e.hs,r);n=s,i=a,e.h=o,e.cs1=c,e.cs2=f}return e.mc++,{plaintext:n,valid:i}}};var eo=class{isInitiator;session;remotePeer;remoteExtensions={webtransportCerthashes:[]};payload;connection;xx;staticKeypair;prologue;constructor(e,r,n,i,o,s,a,c){this.isInitiator=e,this.payload=r,this.prologue=n,this.staticKeypair=o,this.connection=s,a&&(this.remotePeer=a),this.xx=c??new to(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(zu(this.session.hs.s),this.isInitiator){Ot.trace("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,new Uint8Array(0));await this.connection.write(h0(e)),Ot.trace("Stage 0 - Initiator finished sending first message."),ua(this.session.hs.e)}else{Ot.trace("Stage 0 - Responder waiting to receive first message...");let e=p0((await this.connection.read()).subarray()),{valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new dr("xx handshake stage 0 validation fail");Ot.trace("Stage 0 - Responder received first message."),ha(this.session.hs.re)}}async exchange(){if(this.isInitiator){Ot.trace("Stage 1 - Initiator waiting to receive first message from responder...");let e=y0((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new dr("xx handshake stage 1 validation fail");Ot.trace("Stage 1 - Initiator received the message."),ha(this.session.hs.re),Gu(this.session.hs.rs),Ot.trace("Initiator going to check remote's signature...");try{let i=ca(r);this.remotePeer=this.remotePeer||await aa(i),await fa(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let o=i;throw new Sn(`Error occurred while verifying signed payload: ${o.message}`)}Ot.trace("All good with the signature!")}else{Ot.trace("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(l0(e)),Ot.trace("Stage 1 - Responder sent the second handshake message with signed payload."),ua(this.session.hs.e)}}async finish(){if(this.isInitiator){Ot.trace("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(d0(e)),Ot.trace("Stage 2 - Initiator sent message with signed payload.")}else{Ot.trace("Stage 2 - Responder waiting for third handshake message...");let e=g0((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new dr("xx handshake stage 2 validation fail");Ot.trace("Stage 2 - Responder received the message, finished handshake.");try{let i=ca(r);this.remotePeer=this.remotePeer||await aa(i),await fa(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let o=i;throw new Sn(`Error occurred while verifying signed payload: ${o.message}`)}}Wu(this.session)}encrypt(e,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,new Uint8Array(0),e)}decrypt(e,r,n){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,new Uint8Array(0),e,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new dr("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}};function Yu(t){return{xxHandshakeSuccesses:t.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:t.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:t.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:t.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:t.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}var ro=class{protocol="/noise";crypto;prologue;staticKeys;extensions;metrics;constructor(e={}){let{staticNoiseKey:r,extensions:n,crypto:i,prologueBytes:o,metrics:s}=e;this.crypto=i??bi,this.extensions=n,this.metrics=s?Yu(s):void 0,r?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(r):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=o??new Uint8Array(0)}async secureOutbound(e,r,n){let i=lo(r,{lengthEncoder:qr,lengthDecoder:wn,maxDataLength:65535}),o=await this.performHandshake({connection:i,isInitiator:!0,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(i,o),remoteExtensions:o.remoteExtensions,remotePeer:o.remotePeer}}async secureInbound(e,r,n){let i=lo(r,{lengthEncoder:qr,lengthDecoder:wn,maxDataLength:65535}),o=await this.performHandshake({connection:i,isInitiator:!1,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(i,o),remotePeer:o.remotePeer,remoteExtensions:o.remoteExtensions}}async performHandshake(e){let r=await Uu(e.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(e,r)}async performXXHandshake(e,r){let{isInitiator:n,remotePeer:i,connection:o}=e,s=new eo(n,r,this.prologue,this.crypto,this.staticKeys,o,i);try{await s.propose(),await s.exchange(),await s.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(a){if(this.metrics?.xxHandshakeErrors.increment(),a instanceof Error)throw a.message=`Error occurred during XX handshake: ${a.message}`,a}return s}async createSecureConnection(e,r){let[n,i]=Ta(),o=e.unwrap();return await Ra(n,b0(r,this.metrics),o,s=>pn(s,{lengthDecoder:wn}),v0(r,this.metrics),n),i}};function Tg(t={}){return()=>new ro(t)}return ah(Lg);})();
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PNoise}));
