var OK=Object.create;var uh=Object.defineProperty;var UK=Object.getOwnPropertyDescriptor;var kK=Object.getOwnPropertyNames;var MK=Object.getPrototypeOf,FK=Object.prototype.hasOwnProperty;var VK=(t,e,r)=>e in t?uh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Re=(t,e)=>()=>(t&&(e=t(t=0)),e);var k=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),T=(t,e)=>{for(var r in e)uh(t,r,{get:e[r],enumerable:!0})},OT=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of kK(e))!FK.call(t,o)&&o!==r&&uh(t,o,{get:()=>e[o],enumerable:!(n=UK(e,o))||n.enumerable});return t};var J=(t,e,r)=>(r=t!=null?OK(MK(t)):{},OT(e||!t||!t.__esModule?uh(r,"default",{value:t,enumerable:!0}):r,t)),_b=t=>OT(uh({},"__esModule",{value:!0}),t);var ln=(t,e,r)=>(VK(t,typeof e!="symbol"?e+"":e,r),r);var li=k((aEe,Ib)=>{"use strict";var Bc=typeof Reflect=="object"?Reflect:null,UT=Bc&&typeof Bc.apply=="function"?Bc.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},p0;Bc&&typeof Bc.ownKeys=="function"?p0=Bc.ownKeys:Object.getOwnPropertySymbols?p0=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:p0=function(e){return Object.getOwnPropertyNames(e)};function zK(t){console&&console.warn&&console.warn(t)}var MT=Number.isNaN||function(e){return e!==e};function Fe(){Fe.init.call(this)}Ib.exports=Fe;Ib.exports.once=HK;Fe.EventEmitter=Fe;Fe.prototype._events=void 0;Fe.prototype._eventsCount=0;Fe.prototype._maxListeners=void 0;var kT=10;function m0(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Fe,"defaultMaxListeners",{enumerable:!0,get:function(){return kT},set:function(t){if(typeof t!="number"||t<0||MT(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");kT=t}});Fe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Fe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||MT(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function FT(t){return t._maxListeners===void 0?Fe.defaultMaxListeners:t._maxListeners}Fe.prototype.getMaxListeners=function(){return FT(this)};Fe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var o=e==="error",s=this._events;if(s!==void 0)o=o&&s.error===void 0;else if(!o)return!1;if(o){var i;if(r.length>0&&(i=r[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")UT(c,this,r);else for(var u=c.length,l=qT(c,u),n=0;n<u;++n)UT(l[n],this,r);return!0};function VT(t,e,r,n){var o,s,i;if(m0(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),i=s[e]),i===void 0)i=s[e]=r,++t._eventsCount;else if(typeof i=="function"?i=s[e]=n?[r,i]:[i,r]:n?i.unshift(r):i.push(r),o=FT(t),o>0&&i.length>o&&!i.warned){i.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=i.length,zK(a)}return t}Fe.prototype.addListener=function(e,r){return VT(this,e,r,!1)};Fe.prototype.on=Fe.prototype.addListener;Fe.prototype.prependListener=function(e,r){return VT(this,e,r,!0)};function $K(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function zT(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},o=$K.bind(n);return o.listener=r,n.wrapFn=o,o}Fe.prototype.once=function(e,r){return m0(r),this.on(e,zT(this,e,r)),this};Fe.prototype.prependOnceListener=function(e,r){return m0(r),this.prependListener(e,zT(this,e,r)),this};Fe.prototype.removeListener=function(e,r){var n,o,s,i,a;if(m0(r),o=this._events,o===void 0)return this;if(n=o[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,i=n.length-1;i>=0;i--)if(n[i]===r||n[i].listener===r){a=n[i].listener,s=i;break}if(s<0)return this;s===0?n.shift():KK(n,s),n.length===1&&(o[e]=n[0]),o.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};Fe.prototype.off=Fe.prototype.removeListener;Fe.prototype.removeAllListeners=function(e){var r,n,o;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),i;for(o=0;o<s.length;++o)i=s[o],i!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(o=r.length-1;o>=0;o--)this.removeListener(e,r[o]);return this};function $T(t,e,r){var n=t._events;if(n===void 0)return[];var o=n[e];return o===void 0?[]:typeof o=="function"?r?[o.listener||o]:[o]:r?qK(o):qT(o,o.length)}Fe.prototype.listeners=function(e){return $T(this,e,!0)};Fe.prototype.rawListeners=function(e){return $T(this,e,!1)};Fe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):KT.call(t,e)};Fe.prototype.listenerCount=KT;function KT(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Fe.prototype.eventNames=function(){return this._eventsCount>0?p0(this._events):[]};function qT(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function KK(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function qK(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function HK(t,e){return new Promise(function(r,n){function o(i){t.removeListener(e,s),n(i)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",o),r([].slice.call(arguments))}HT(t,e,s,{once:!0}),e!=="error"&&GK(t,o,{once:!0})})}function GK(t,e,r){typeof t.on=="function"&&HT(t,"error",e,r)}function HT(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function o(s){n.once&&t.removeEventListener(e,o),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var Oe=k((cEe,GT)=>{GT.exports={options:{usePureJavaScript:!1}}});var YT=k((uEe,jT)=>{var Db={};jT.exports=Db;var WT={};Db.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=WK(t,e);else{var o=0,s=e.length,i=e.charAt(0),a=[0];for(o=0;o<t.length;++o){for(var c=0,u=t[o];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(o=0;t[o]===0&&o<t.length-1;++o)n+=i;for(o=a.length-1;o>=0;--o)n+=e[a[o]]}if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join(`\r
`)}return n};Db.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=WT[e];if(!r){r=WT[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var o=e.length,s=e.charAt(0),i=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,u=a;c<i.length;++c)u+=i[c]*o,i[c]=u&255,u>>=8;for(;u>0;)i.push(u&255),u>>=8}for(var l=0;t[l]===s&&l<t.length-1;++l)i.push(0);return typeof Buffer<"u"?Buffer.from(i.reverse()):new Uint8Array(i.reverse())};function WK(t,e){var r=0,n=e.length,o=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var i=0,a=t.at(r);i<s.length;++i)a+=s[i]<<8,s[i]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=o;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Ut=k((lEe,ZT)=>{var QT=Oe(),XT=YT(),I=ZT.exports=QT.util=QT.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){I.nextTick=process.nextTick,typeof setImmediate=="function"?I.setImmediate=setImmediate:I.setImmediate=I.nextTick;return}if(typeof setImmediate=="function"){I.setImmediate=function(){return setImmediate.apply(void 0,arguments)},I.nextTick=function(a){return setImmediate(a)};return}if(I.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var i=a,t="forge.setImmediate",e=[];I.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,o=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(o,{attributes:!0});var s=I.setImmediate;I.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&o.setAttribute("a",n=!n))}}I.nextTick=I.setImmediate})();I.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;I.globalScope=function(){return I.isNodejs?global:typeof self>"u"?window:self}();I.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};I.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};I.isArrayBufferView=function(t){return t&&I.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function lh(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}I.ByteBuffer=Rb;function Rb(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(I.isArrayBuffer(t)||I.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Rb||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}I.ByteStringBuffer=Rb;var jK=4096;I.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>jK&&(this.data.substr(0,1),this._constructedStringLength=0)};I.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};I.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};I.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};I.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};I.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};I.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(I.encodeUtf8(t))};I.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};I.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};I.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};I.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};I.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};I.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};I.ByteStringBuffer.prototype.putInt=function(t,e){lh(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};I.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};I.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};I.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};I.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};I.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};I.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};I.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};I.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};I.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};I.ByteStringBuffer.prototype.getInt=function(t){lh(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};I.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};I.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};I.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};I.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};I.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};I.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};I.ByteStringBuffer.prototype.copy=function(){var t=I.createBuffer(this.data);return t.read=this.read,t};I.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};I.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};I.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};I.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};I.ByteStringBuffer.prototype.toString=function(){return I.decodeUtf8(this.bytes())};function YK(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=I.isArrayBuffer(t),n=I.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}I.DataBuffer=YK;I.DataBuffer.prototype.length=function(){return this.write-this.read};I.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};I.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};I.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};I.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};I.DataBuffer.prototype.putBytes=function(t,e){if(I.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var o=new Uint8Array(this.data.buffer,this.write);return o.set(r),this.write+=n,this}if(I.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var o=new Uint8Array(this.data.buffer);return o.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof I.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&I.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var o=new Uint8Array(t.data.byteLength,this.write);return o.set(r),this.write+=r.byteLength,this}if(t instanceof I.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=I.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=I.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=I.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=I.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=I.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};I.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};I.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};I.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};I.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};I.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};I.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};I.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};I.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};I.DataBuffer.prototype.putInt=function(t,e){lh(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};I.DataBuffer.prototype.putSignedInt=function(t,e){return lh(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};I.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};I.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};I.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};I.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};I.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};I.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};I.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};I.DataBuffer.prototype.getInt=function(t){lh(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};I.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};I.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};I.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};I.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};I.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};I.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};I.DataBuffer.prototype.copy=function(){return new I.DataBuffer(this)};I.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};I.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};I.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};I.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};I.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return I.binary.raw.encode(e);if(t==="hex")return I.binary.hex.encode(e);if(t==="base64")return I.binary.base64.encode(e);if(t==="utf8")return I.text.utf8.decode(e);if(t==="utf16")return I.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};I.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=I.encodeUtf8(t)),new I.ByteBuffer(t)};I.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};I.xorBytes=function(t,e,r){for(var n="",o="",s="",i=0,a=0;r>0;--r,++i)o=t.charCodeAt(i)^e.charCodeAt(i),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(o),++a;return n+=s,n};I.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};I.bytesToHex=function(t){return I.createBuffer(t).toHex()};I.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var fi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",hi=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],JT="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";I.encode64=function(t,e){for(var r="",n="",o,s,i,a=0;a<t.length;)o=t.charCodeAt(a++),s=t.charCodeAt(a++),i=t.charCodeAt(a++),r+=fi.charAt(o>>2),r+=fi.charAt((o&3)<<4|s>>4),isNaN(s)?r+="==":(r+=fi.charAt((s&15)<<2|i>>6),r+=isNaN(i)?"=":fi.charAt(i&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};I.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,o,s,i=0;i<t.length;)r=hi[t.charCodeAt(i++)-43],n=hi[t.charCodeAt(i++)-43],o=hi[t.charCodeAt(i++)-43],s=hi[t.charCodeAt(i++)-43],e+=String.fromCharCode(r<<2|n>>4),o!==64&&(e+=String.fromCharCode((n&15)<<4|o>>2),s!==64&&(e+=String.fromCharCode((o&3)<<6|s)));return e};I.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};I.decodeUtf8=function(t){return decodeURIComponent(escape(t))};I.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:XT.encode,decode:XT.decode}};I.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};I.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var o=r,s=0;s<t.length;++s)n[o++]=t.charCodeAt(s);return e?o-r:n};I.binary.hex.encode=I.bytesToHex;I.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var o=0,s=r;for(t.length&1&&(o=1,n[s++]=parseInt(t[0],16));o<t.length;o+=2)n[s++]=parseInt(t.substr(o,2),16);return e?s-r:n};I.binary.base64.encode=function(t,e){for(var r="",n="",o,s,i,a=0;a<t.byteLength;)o=t[a++],s=t[a++],i=t[a++],r+=fi.charAt(o>>2),r+=fi.charAt((o&3)<<4|s>>4),isNaN(s)?r+="==":(r+=fi.charAt((s&15)<<2|i>>6),r+=isNaN(i)?"=":fi.charAt(i&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};I.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var o,s,i,a,c=0,u=r;c<t.length;)o=hi[t.charCodeAt(c++)-43],s=hi[t.charCodeAt(c++)-43],i=hi[t.charCodeAt(c++)-43],a=hi[t.charCodeAt(c++)-43],n[u++]=o<<2|s>>4,i!==64&&(n[u++]=(s&15)<<4|i>>2,a!==64&&(n[u++]=(i&3)<<6|a));return e?u-r:n.subarray(0,u)};I.binary.base58.encode=function(t,e){return I.binary.baseN.encode(t,JT,e)};I.binary.base58.decode=function(t,e){return I.binary.baseN.decode(t,JT,e)};I.text={utf8:{},utf16:{}};I.text.utf8.encode=function(t,e,r){t=I.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var o=r,s=0;s<t.length;++s)n[o++]=t.charCodeAt(s);return e?o-r:n};I.text.utf8.decode=function(t){return I.decodeUtf8(String.fromCharCode.apply(null,t))};I.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var o=new Uint16Array(n.buffer);r=r||0;for(var s=r,i=r,a=0;a<t.length;++a)o[i++]=t.charCodeAt(a),s+=2;return e?s-r:n};I.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};I.deflate=function(t,e,r){if(e=I.decode64(t.deflate(I.encode64(e)).rval),r){var n=2,o=e.charCodeAt(1);o&32&&(n=6),e=e.substring(n,e.length-4)}return e};I.inflate=function(t,e,r){var n=t.inflate(I.encode64(e)).rval;return n===null?null:I.decode64(n)};var Lb=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=I.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var o=new Error(n.error.message);throw o.id=n.error.id,o.name=n.error.name,o}},Bb=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(I.decode64(r))),r},QK=function(t,e,r,n){var o=Bb(t,e);o===null&&(o={}),o[r]=n,Lb(t,e,o)},XK=function(t,e,r){var n=Bb(t,e);return n!==null&&(n=r in n?n[r]:null),n},JK=function(t,e,r){var n=Bb(t,e);if(n!==null&&r in n){delete n[r];var o=!0;for(var s in n){o=!1;break}o&&(n=null),Lb(t,e,n)}},ZK=function(t,e){Lb(t,e,null)},g0=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var o,s=!1,i=null;for(var a in r){o=r[a];try{if(o==="flash"||o==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=o==="flash"}(o==="web"||o==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(c){i=c}if(s)break}if(!s)throw i;return n};I.setItem=function(t,e,r,n,o){g0(QK,arguments,o)};I.getItem=function(t,e,r,n){return g0(XK,arguments,n)};I.removeItem=function(t,e,r,n){g0(JK,arguments,n)};I.clearItems=function(t,e,r){g0(ZK,arguments,r)};I.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};I.format=function(t){for(var e=/%./g,r,n,o=0,s=[],i=0;r=e.exec(t);){n=t.substring(i,e.lastIndex-2),n.length>0&&s.push(n),i=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":o<arguments.length?s.push(arguments[o+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(i)),s.join("")};I.formatNumber=function(t,e,r,n){var o=t,s=isNaN(e=Math.abs(e))?2:e,i=r===void 0?",":r,a=n===void 0?".":n,c=o<0?"-":"",u=parseInt(o=Math.abs(+o||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?i+Math.abs(o-u).toFixed(s).slice(2):"")};I.formatSize=function(t){return t>=1073741824?t=I.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=I.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=I.formatNumber(t/1024,0)+" KiB":t=I.formatNumber(t,0)+" bytes",t};I.bytesFromIP=function(t){return t.indexOf(".")!==-1?I.bytesFromIPv4(t):t.indexOf(":")!==-1?I.bytesFromIPv6(t):null};I.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=I.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};I.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(i){return i.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=I.createBuffer(),o=0;o<8;++o){if(!t[o]||t[o].length===0){n.fillWithByte(0,r),r=0;continue}var s=I.hexToBytes(t[o]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};I.bytesToIP=function(t){return t.length===4?I.bytesToIPv4(t):t.length===16?I.bytesToIPv6(t):null};I.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};I.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,o=0;o<t.length;o+=2){for(var s=I.bytesToHex(t[o]+t[o+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var i=r[r.length-1],a=e.length;!i||a!==i.end+1?r.push({start:a,end:a}):(i.end=a,i.end-i.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};I.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in I&&!t.update)return e(null,I.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return I.cores=navigator.hardwareConcurrency,e(null,I.cores);if(typeof Worker>"u")return I.cores=1,e(null,I.cores);if(typeof Blob>"u")return I.cores=2,e(null,I.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(i){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(i,a,c){if(a===0){var u=Math.floor(i.reduce(function(l,h){return l+h},0)/i.length);return I.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,I.cores)}o(c,function(l,h){i.push(s(c,h)),n(i,a-1,c)})}function o(i,a){for(var c=[],u=[],l=0;l<i;++l){var h=new Worker(r);h.addEventListener("message",function(p){if(u.push(p.data),u.length===i){for(var m=0;m<i;++m)c[m].terminate();a(null,u)}}),c.push(h)}for(var l=0;l<i;++l)c[l].postMessage(l)}function s(i,a){for(var c=[],u=0;u<i;++u)for(var l=a[u],h=c[u]=[],p=0;p<i;++p)if(u!==p){var m=a[p];(l.st>m.st&&l.st<m.et||m.st>l.st&&m.st<l.et)&&h.push(p)}return c.reduce(function(f,d){return Math.max(f,d.length)},0)}}});var y0=k((fEe,e_)=>{var fh=Oe();fh.pki=fh.pki||{};var Pb=e_.exports=fh.pki.oids=fh.oids=fh.oids||{};function M(t,e){Pb[t]=e,Pb[e]=t}function Le(t,e){Pb[t]=e}M("1.2.840.113549.1.1.1","rsaEncryption");M("1.2.840.113549.1.1.4","md5WithRSAEncryption");M("1.2.840.113549.1.1.5","sha1WithRSAEncryption");M("1.2.840.113549.1.1.7","RSAES-OAEP");M("1.2.840.113549.1.1.8","mgf1");M("1.2.840.113549.1.1.9","pSpecified");M("1.2.840.113549.1.1.10","RSASSA-PSS");M("1.2.840.113549.1.1.11","sha256WithRSAEncryption");M("1.2.840.113549.1.1.12","sha384WithRSAEncryption");M("1.2.840.113549.1.1.13","sha512WithRSAEncryption");M("1.3.101.112","EdDSA25519");M("1.2.840.10040.4.3","dsa-with-sha1");M("1.3.14.3.2.7","desCBC");M("1.3.14.3.2.26","sha1");M("1.3.14.3.2.29","sha1WithRSASignature");M("2.16.840.1.101.3.4.2.1","sha256");M("2.16.840.1.101.3.4.2.2","sha384");M("2.16.840.1.101.3.4.2.3","sha512");M("2.16.840.1.101.3.4.2.4","sha224");M("2.16.840.1.101.3.4.2.5","sha512-224");M("2.16.840.1.101.3.4.2.6","sha512-256");M("1.2.840.113549.2.2","md2");M("1.2.840.113549.2.5","md5");M("1.2.840.113549.1.7.1","data");M("1.2.840.113549.1.7.2","signedData");M("1.2.840.113549.1.7.3","envelopedData");M("1.2.840.113549.1.7.4","signedAndEnvelopedData");M("1.2.840.113549.1.7.5","digestedData");M("1.2.840.113549.1.7.6","encryptedData");M("1.2.840.113549.1.9.1","emailAddress");M("1.2.840.113549.1.9.2","unstructuredName");M("1.2.840.113549.1.9.3","contentType");M("1.2.840.113549.1.9.4","messageDigest");M("1.2.840.113549.1.9.5","signingTime");M("1.2.840.113549.1.9.6","counterSignature");M("1.2.840.113549.1.9.7","challengePassword");M("1.2.840.113549.1.9.8","unstructuredAddress");M("1.2.840.113549.1.9.14","extensionRequest");M("1.2.840.113549.1.9.20","friendlyName");M("1.2.840.113549.1.9.21","localKeyId");M("1.2.840.113549.1.9.22.1","x509Certificate");M("1.2.840.113549.1.12.10.1.1","keyBag");M("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");M("1.2.840.113549.1.12.10.1.3","certBag");M("1.2.840.113549.1.12.10.1.4","crlBag");M("1.2.840.113549.1.12.10.1.5","secretBag");M("1.2.840.113549.1.12.10.1.6","safeContentsBag");M("1.2.840.113549.1.5.13","pkcs5PBES2");M("1.2.840.113549.1.5.12","pkcs5PBKDF2");M("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");M("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");M("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");M("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");M("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");M("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");M("1.2.840.113549.2.7","hmacWithSHA1");M("1.2.840.113549.2.8","hmacWithSHA224");M("1.2.840.113549.2.9","hmacWithSHA256");M("1.2.840.113549.2.10","hmacWithSHA384");M("1.2.840.113549.2.11","hmacWithSHA512");M("1.2.840.113549.3.7","des-EDE3-CBC");M("2.16.840.1.101.3.4.1.2","aes128-CBC");M("2.16.840.1.101.3.4.1.22","aes192-CBC");M("2.16.840.1.101.3.4.1.42","aes256-CBC");M("2.5.4.3","commonName");M("2.5.4.4","surname");M("2.5.4.5","serialNumber");M("2.5.4.6","countryName");M("2.5.4.7","localityName");M("2.5.4.8","stateOrProvinceName");M("2.5.4.9","streetAddress");M("2.5.4.10","organizationName");M("2.5.4.11","organizationalUnitName");M("2.5.4.12","title");M("2.5.4.13","description");M("2.5.4.15","businessCategory");M("2.5.4.17","postalCode");M("2.5.4.42","givenName");M("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");M("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");M("2.16.840.1.113730.1.1","nsCertType");M("2.16.840.1.113730.1.13","nsComment");Le("2.5.29.1","authorityKeyIdentifier");Le("2.5.29.2","keyAttributes");Le("2.5.29.3","certificatePolicies");Le("2.5.29.4","keyUsageRestriction");Le("2.5.29.5","policyMapping");Le("2.5.29.6","subtreesConstraint");Le("2.5.29.7","subjectAltName");Le("2.5.29.8","issuerAltName");Le("2.5.29.9","subjectDirectoryAttributes");Le("2.5.29.10","basicConstraints");Le("2.5.29.11","nameConstraints");Le("2.5.29.12","policyConstraints");Le("2.5.29.13","basicConstraints");M("2.5.29.14","subjectKeyIdentifier");M("2.5.29.15","keyUsage");Le("2.5.29.16","privateKeyUsagePeriod");M("2.5.29.17","subjectAltName");M("2.5.29.18","issuerAltName");M("2.5.29.19","basicConstraints");Le("2.5.29.20","cRLNumber");Le("2.5.29.21","cRLReason");Le("2.5.29.22","expirationDate");Le("2.5.29.23","instructionCode");Le("2.5.29.24","invalidityDate");Le("2.5.29.25","cRLDistributionPoints");Le("2.5.29.26","issuingDistributionPoint");Le("2.5.29.27","deltaCRLIndicator");Le("2.5.29.28","issuingDistributionPoint");Le("2.5.29.29","certificateIssuer");Le("2.5.29.30","nameConstraints");M("2.5.29.31","cRLDistributionPoints");M("2.5.29.32","certificatePolicies");Le("2.5.29.33","policyMappings");Le("2.5.29.34","policyConstraints");M("2.5.29.35","authorityKeyIdentifier");Le("2.5.29.36","policyConstraints");M("2.5.29.37","extKeyUsage");Le("2.5.29.46","freshestCRL");Le("2.5.29.54","inhibitAnyPolicy");M("1.3.6.1.4.1.11129.2.4.2","timestampList");M("1.3.6.1.5.5.7.1.1","authorityInfoAccess");M("1.3.6.1.5.5.7.3.1","serverAuth");M("1.3.6.1.5.5.7.3.2","clientAuth");M("1.3.6.1.5.5.7.3.3","codeSigning");M("1.3.6.1.5.5.7.3.4","emailProtection");M("1.3.6.1.5.5.7.3.8","timeStamping")});var dh=k((hEe,r_)=>{var et=Oe();Ut();y0();var H=r_.exports=et.asn1=et.asn1||{};H.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};H.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};H.create=function(t,e,r,n,o){if(et.util.isArray(n)){for(var s=[],i=0;i<n.length;++i)n[i]!==void 0&&s.push(n[i]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||et.util.isArray(n),value:n};return o&&"bitStringContents"in o&&(a.bitStringContents=o.bitStringContents,a.original=H.copy(a)),a};H.copy=function(t,e){var r;if(et.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(H.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:H.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};H.equals=function(t,e,r){if(et.util.isArray(t)){if(!et.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!H.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var o=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&H.equals(t.value,e.value);return r&&r.includeBitStringContents&&(o=o&&t.bitStringContents===e.bitStringContents),o};H.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function hh(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var eq=function(t,e){var r=t.getByte();if(e--,r!==128){var n,o=r&128;if(!o)n=r;else{var s=r&127;hh(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};H.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=et.util.createBuffer(t));var r=t.length(),n=b0(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var o=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw o.byteCount=r,o.remaining=t.length(),o}return n};function b0(t,e,r,n){var o;hh(t,e,2);var s=t.getByte();e--;var i=s&192,a=s&31;o=t.length();var c=eq(t,e);if(e-=o-t.length(),c!==void 0&&c>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var l,h,p=(s&32)===32;if(p)if(l=[],c===void 0)for(;;){if(hh(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}o=t.length(),l.push(b0(t,e,r+1,n)),e-=o-t.length()}else for(;c>0;)o=t.length(),l.push(b0(t,c,r+1,n)),e-=o-t.length(),c-=o-t.length();if(l===void 0&&i===H.Class.UNIVERSAL&&a===H.Type.BITSTRING&&(h=t.bytes(c)),l===void 0&&n.decodeBitStrings&&i===H.Class.UNIVERSAL&&a===H.Type.BITSTRING&&c>1){var m=t.read,f=e,d=0;if(a===H.Type.BITSTRING&&(hh(t,e,1),d=t.getByte(),e--),d===0)try{o=t.length();var g={strict:!0,decodeBitStrings:!0},y=b0(t,e,r+1,g),b=o-t.length();e-=b,a==H.Type.BITSTRING&&b++;var w=y.tagClass;b===c&&(w===H.Class.UNIVERSAL||w===H.Class.CONTEXT_SPECIFIC)&&(l=[y])}catch{}l===void 0&&(t.read=m,e=f)}if(l===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===H.Type.BMPSTRING)for(l="";c>0;c-=2)hh(t,e,2),l+=String.fromCharCode(t.getInt16()),e-=2;else l=t.getBytes(c),e-=c}var x=h===void 0?null:{bitStringContents:h};return H.create(i,a,p,l,x)}H.toDer=function(t){var e=et.util.createBuffer(),r=t.tagClass|t.type,n=et.util.createBuffer(),o=!1;if("bitStringContents"in t&&(o=!0,t.original&&(o=H.equals(t,t.original))),o)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(H.toDer(t.value[s]))}else if(t.type===H.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===H.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)===0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var i=n.length(),a="";do a+=String.fromCharCode(i&255),i=i>>>8;while(i>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};H.oidToDer=function(t){var e=t.split("."),r=et.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,o,s,i,a=2;a<e.length;++a){n=!0,o=[],s=parseInt(e[a],10);do i=s&127,s=s>>>7,n||(i|=128),o.push(i),n=!1;while(s>0);for(var c=o.length-1;c>=0;--c)r.putByte(o[c])}return r};H.derToOid=function(t){var e;typeof t=="string"&&(t=et.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};H.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,o=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),i=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,o),e.setUTCHours(s,i,a,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var l=parseInt(t.substr(u+1,2),10),h=parseInt(t.substr(u+4,2),10),p=l*60+h;p*=6e4,c==="+"?e.setTime(+e-p):e.setTime(+e+p)}return e};H.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),i=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,u=0,l=!1;t.charAt(t.length-1)==="Z"&&(l=!0);var h=t.length-5,p=t.charAt(h);if(p==="+"||p==="-"){var m=parseInt(t.substr(h+1,2),10),f=parseInt(t.substr(h+4,2),10);u=m*60+f,u*=6e4,p==="+"&&(u*=-1),l=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),l?(e.setUTCFullYear(r,n,o),e.setUTCHours(s,i,a,c),e.setTime(+e+u)):(e.setFullYear(r,n,o),e.setHours(s,i,a,c)),e};H.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};H.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};H.integerToDer=function(t){var e=et.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};H.derToInteger=function(t){typeof t=="string"&&(t=et.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};H.validate=function(t,e,r,n){var o=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(o=!0,e.value&&et.util.isArray(e.value))for(var s=0,i=0;o&&i<e.value.length;++i)o=e.value[i].optional||!1,t.value[s]&&(o=H.validate(t.value[s],e.value[i],r,n),o?++s:e.value[i].optional&&(o=!0)),!o&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(o&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return o};var t_=/[^\\u0000-\\u00ff]/;H.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var o="",s=0;s<e*r;++s)o+=" ";switch(n+=o+"Tag: ",t.tagClass){case H.Class.UNIVERSAL:n+="Universal:";break;case H.Class.APPLICATION:n+="Application:";break;case H.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case H.Class.PRIVATE:n+="Private:";break}if(t.tagClass===H.Class.UNIVERSAL)switch(n+=t.type,t.type){case H.Type.NONE:n+=" (None)";break;case H.Type.BOOLEAN:n+=" (Boolean)";break;case H.Type.INTEGER:n+=" (Integer)";break;case H.Type.BITSTRING:n+=" (Bit string)";break;case H.Type.OCTETSTRING:n+=" (Octet string)";break;case H.Type.NULL:n+=" (Null)";break;case H.Type.OID:n+=" (Object Identifier)";break;case H.Type.ODESC:n+=" (Object Descriptor)";break;case H.Type.EXTERNAL:n+=" (External or Instance of)";break;case H.Type.REAL:n+=" (Real)";break;case H.Type.ENUMERATED:n+=" (Enumerated)";break;case H.Type.EMBEDDED:n+=" (Embedded PDV)";break;case H.Type.UTF8:n+=" (UTF8)";break;case H.Type.ROID:n+=" (Relative Object Identifier)";break;case H.Type.SEQUENCE:n+=" (Sequence)";break;case H.Type.SET:n+=" (Set)";break;case H.Type.PRINTABLESTRING:n+=" (Printable String)";break;case H.Type.IA5String:n+=" (IA5String (ASCII))";break;case H.Type.UTCTIME:n+=" (UTC time)";break;case H.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case H.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=o+"Constructed: "+t.constructed+`
`,t.composed){for(var i=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(i+=1,a+=H.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=o+"Sub values: "+i+a}else{if(n+=o+"Value: ",t.type===H.Type.OID){var c=H.derToOid(t.value);n+=c,et.pki&&et.pki.oids&&c in et.pki.oids&&(n+=" ("+et.pki.oids[c]+") ")}if(t.type===H.Type.INTEGER)try{n+=H.derToInteger(t.value)}catch{n+="0x"+et.util.bytesToHex(t.value)}else if(t.type===H.Type.BITSTRING){if(t.value.length>1?n+="0x"+et.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(t.type===H.Type.OCTETSTRING)t_.test(t.value)||(n+="("+t.value+") "),n+="0x"+et.util.bytesToHex(t.value);else if(t.type===H.Type.UTF8)try{n+=et.util.decodeUtf8(t.value)}catch(l){if(l.message==="URI malformed")n+="0x"+et.util.bytesToHex(t.value)+" (malformed UTF8)";else throw l}else t.type===H.Type.PRINTABLESTRING||t.type===H.Type.IA5String?n+=t.value:t_.test(t.value)?n+="0x"+et.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Ob=k((dEe,n_)=>{var or=Oe();Ut();n_.exports=or.cipher=or.cipher||{};or.cipher.algorithms=or.cipher.algorithms||{};or.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=or.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new or.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};or.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=or.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new or.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};or.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),or.cipher.algorithms[t]=e};or.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in or.cipher.algorithms?or.cipher.algorithms[t]:null};var Nb=or.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Nb.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=or.util.createBuffer(),this.output=t.output||or.util.createBuffer(),this.mode.start(e)};Nb.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Nb.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var kb=k((pEe,o_)=>{var sr=Oe();Ut();sr.cipher=sr.cipher||{};var me=o_.exports=sr.cipher.modes=sr.cipher.modes||{};me.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};me.ecb.prototype.start=function(t){};me.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};me.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};me.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};me.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};me.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};me.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=w0(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};me.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};me.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};me.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};me.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};me.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=sr.util.createBuffer(),this._partialBytes=0};me.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=w0(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};me.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=t.getInt32()^this._outBlock[o],e.putInt32(this._inBlock[o]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=t.getInt32()^this._outBlock[o],this._partialOutput.putInt32(this._partialBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};me.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=t.getInt32(),e.putInt32(this._inBlock[o]^this._outBlock[o]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[o]^this._outBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};me.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=sr.util.createBuffer(),this._partialBytes=0};me.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=w0(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};me.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(t.getInt32()^this._outBlock[o]),this._inBlock[o]=this._outBlock[o];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._outBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};me.ofb.prototype.decrypt=me.ofb.prototype.encrypt;me.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=sr.util.createBuffer(),this._partialBytes=0};me.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=w0(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};me.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var o=0;o<this._ints;++o)e.putInt32(t.getInt32()^this._outBlock[o]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}x0(this._inBlock)};me.ctr.prototype.decrypt=me.ctr.prototype.encrypt;me.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=sr.util.createBuffer(),this._partialBytes=0,this._R=3774873600};me.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=sr.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=sr.util.createBuffer(t.additionalData):r=sr.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=sr.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ub(n*8)))}this._inBlock=this._j0.slice(0),x0(this._inBlock),this._partialBytes=0,r=sr.util.createBuffer(r),this._aDataLength=Ub(r.length()*8);var o=r.length()%this.blockSize;for(o&&r.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};me.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s<=0||r){if(r){var i=n%this.blockSize;this._cipherLength+=i,this._partialOutput.truncate(this.blockSize-i)}else this._cipherLength+=this.blockSize;for(var o=0;o<this._ints;++o)this._outBlock[o]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),x0(this._inBlock)};me.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),x0(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^this._hashBlock[o]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};me.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=sr.util.createBuffer();var n=this._aDataLength.concat(Ub(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var o=[];this.cipher.encrypt(this._j0,o);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^o[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};me.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),o=0;o<128;++o){var s=t[o/32|0]&1<<31-o%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};me.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};me.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,o=t[n]>>>(7-r%8)*4&15,s=this._m[r][o];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};me.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};me.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,o=16*r,s=new Array(o),i=0;i<o;++i){var a=[0,0,0,0],c=i/n|0,u=(n-1-i%n)*e;a[c]=1<<e-1<<u,s[i]=this.generateSubHashTable(this.multiply(a,t),e)}return s};me.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,o=new Array(r);o[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(o[2*s],o[s]=[]),s>>=1;for(s=2;s<n;){for(var i=1;i<s;++i){var a=o[s],c=o[i];o[s+i]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(o[0]=[0,0,0,0],s=n+1;s<r;++s){var u=o[s^n];o[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return o};function w0(t,e){if(typeof t=="string"&&(t=sr.util.createBuffer(t)),sr.util.isArray(t)&&t.length>4){var r=t;t=sr.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!sr.util.isArray(t)){for(var o=[],s=e/4,n=0;n<s;++n)o.push(t.getInt32());t=o}return t}function x0(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Ub(t){return[t/4294967296|0,t&4294967295]}});var v0=k((mEe,c_)=>{var We=Oe();Ob();kb();Ut();c_.exports=We.aes=We.aes||{};We.aes.startEncrypting=function(t,e,r,n){var o=E0({key:t,output:r,decrypt:!1,mode:n});return o.start(e),o};We.aes.createEncryptionCipher=function(t,e){return E0({key:t,output:null,decrypt:!1,mode:e})};We.aes.startDecrypting=function(t,e,r,n){var o=E0({key:t,output:r,decrypt:!0,mode:n});return o.start(e),o};We.aes.createDecryptionCipher=function(t,e){return E0({key:t,output:null,decrypt:!0,mode:e})};We.aes.Algorithm=function(t,e){Vb||i_();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,o){return Fb(r._w,n,o,!1)},decrypt:function(n,o){return Fb(r._w,n,o,!0)}}}),r._init=!1};We.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=We.util.createBuffer(e);else if(We.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=We.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!We.util.isArray(e)){r=e,e=[];var o=r.length();if(o===16||o===24||o===32){o=o>>>2;for(var n=0;n<o;++n)e.push(r.getInt32())}}if(!We.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,i=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=a_(e,t.decrypt&&!i),this._init=!0}};We.aes._expandKey=function(t,e){return Vb||i_(),a_(t,e)};We.aes._updateBlock=Fb;Nc("AES-ECB",We.cipher.modes.ecb);Nc("AES-CBC",We.cipher.modes.cbc);Nc("AES-CFB",We.cipher.modes.cfb);Nc("AES-OFB",We.cipher.modes.ofb);Nc("AES-CTR",We.cipher.modes.ctr);Nc("AES-GCM",We.cipher.modes.gcm);function Nc(t,e){var r=function(){return new We.aes.Algorithm(t,e)};We.cipher.registerAlgorithm(t,r)}var Vb=!1,Pc=4,Mr,Mb,s_,Ea,Xn;function i_(){Vb=!0,s_=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Mr=new Array(256),Mb=new Array(256),Ea=new Array(4),Xn=new Array(4);for(var e=0;e<4;++e)Ea[e]=new Array(256),Xn[e]=new Array(256);for(var r=0,n=0,o,s,i,a,c,u,l,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Mr[r]=a,Mb[a]=r,c=t[a],o=t[r],s=t[o],i=t[s],u=c<<24^a<<16^a<<8^(a^c),l=(o^s^i)<<24^(r^i)<<16^(r^s^i)<<8^(r^o^i);for(var h=0;h<4;++h)Ea[h][r]=u,Xn[h][a]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;r===0?r=n=1:(r=o^t[t[t[o^i]]],n^=t[t[n]])}}function a_(t,e){for(var r=t.slice(0),n,o=1,s=r.length,i=s+6+1,a=Pc*i,c=s;c<a;++c)n=r[c-1],c%s===0?(n=Mr[n>>>16&255]<<24^Mr[n>>>8&255]<<16^Mr[n&255]<<8^Mr[n>>>24]^s_[o]<<24,o++):s>6&&c%s===4&&(n=Mr[n>>>24]<<24^Mr[n>>>16&255]<<16^Mr[n>>>8&255]<<8^Mr[n&255]),r[c]=r[c-s]^n;if(e){var u,l=Xn[0],h=Xn[1],p=Xn[2],m=Xn[3],f=r.slice(0);a=r.length;for(var c=0,d=a-Pc;c<a;c+=Pc,d-=Pc)if(c===0||c===a-Pc)f[c]=r[d],f[c+1]=r[d+3],f[c+2]=r[d+2],f[c+3]=r[d+1];else for(var g=0;g<Pc;++g)u=r[d+g],f[c+(3&-g)]=l[Mr[u>>>24]]^h[Mr[u>>>16&255]]^p[Mr[u>>>8&255]]^m[Mr[u&255]];r=f}return r}function Fb(t,e,r,n){var o=t.length/4-1,s,i,a,c,u;n?(s=Xn[0],i=Xn[1],a=Xn[2],c=Xn[3],u=Mb):(s=Ea[0],i=Ea[1],a=Ea[2],c=Ea[3],u=Mr);var l,h,p,m,f,d,g;l=e[0]^t[0],h=e[n?3:1]^t[1],p=e[2]^t[2],m=e[n?1:3]^t[3];for(var y=3,b=1;b<o;++b)f=s[l>>>24]^i[h>>>16&255]^a[p>>>8&255]^c[m&255]^t[++y],d=s[h>>>24]^i[p>>>16&255]^a[m>>>8&255]^c[l&255]^t[++y],g=s[p>>>24]^i[m>>>16&255]^a[l>>>8&255]^c[h&255]^t[++y],m=s[m>>>24]^i[l>>>16&255]^a[h>>>8&255]^c[p&255]^t[++y],l=f,h=d,p=g;r[0]=u[l>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[m&255]^t[++y],r[n?3:1]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[m>>>8&255]<<8^u[l&255]^t[++y],r[2]=u[p>>>24]<<24^u[m>>>16&255]<<16^u[l>>>8&255]<<8^u[h&255]^t[++y],r[n?1:3]=u[m>>>24]<<24^u[l>>>16&255]<<16^u[h>>>8&255]<<8^u[p&255]^t[++y]}function E0(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=We.cipher.createDecipher(r,t.key):n=We.cipher.createCipher(r,t.key);var o=n.start;return n.start=function(s,i){var a=null;i instanceof We.util.ByteBuffer&&(a=i,i={}),i=i||{},i.output=a,i.iv=s,o.call(n,i)},n}});var f_=k((gEe,l_)=>{var st=Oe();Ob();kb();Ut();l_.exports=st.des=st.des||{};st.des.startEncrypting=function(t,e,r,n){var o=S0({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return o.start(e),o};st.des.createEncryptionCipher=function(t,e){return S0({key:t,output:null,decrypt:!1,mode:e})};st.des.startDecrypting=function(t,e,r,n){var o=S0({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return o.start(e),o};st.des.createDecryptionCipher=function(t,e){return S0({key:t,output:null,decrypt:!0,mode:e})};st.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,o){return u_(r._keys,n,o,!1)},decrypt:function(n,o){return u_(r._keys,n,o,!0)}}}),r._init=!1};st.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=st.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=uq(e),this._init=!0}};So("DES-ECB",st.cipher.modes.ecb);So("DES-CBC",st.cipher.modes.cbc);So("DES-CFB",st.cipher.modes.cfb);So("DES-OFB",st.cipher.modes.ofb);So("DES-CTR",st.cipher.modes.ctr);So("3DES-ECB",st.cipher.modes.ecb);So("3DES-CBC",st.cipher.modes.cbc);So("3DES-CFB",st.cipher.modes.cfb);So("3DES-OFB",st.cipher.modes.ofb);So("3DES-CTR",st.cipher.modes.ctr);function So(t,e){var r=function(){return new st.des.Algorithm(t,e)};st.cipher.registerAlgorithm(t,r)}var tq=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],rq=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],nq=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],oq=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],sq=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],iq=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],aq=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],cq=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function uq(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],i=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],m=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],f=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=t.length()>8?3:1,g=[],y=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,w,x=0;x<d;x++){var E=t.getInt32(),S=t.getInt32();w=(E>>>4^S)&252645135,S^=w,E^=w<<4,w=(S>>>-16^E)&65535,E^=w,S^=w<<-16,w=(E>>>2^S)&858993459,S^=w,E^=w<<2,w=(S>>>-16^E)&65535,E^=w,S^=w<<-16,w=(E>>>1^S)&1431655765,S^=w,E^=w<<1,w=(S>>>8^E)&16711935,E^=w,S^=w<<8,w=(E>>>1^S)&1431655765,S^=w,E^=w<<1,w=E<<8|S>>>20&240,E=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=w;for(var v=0;v<y.length;++v){y[v]?(E=E<<2|E>>>26,S=S<<2|S>>>26):(E=E<<1|E>>>27,S=S<<1|S>>>27),E&=-15,S&=-15;var A=e[E>>>28]|r[E>>>24&15]|n[E>>>20&15]|o[E>>>16&15]|s[E>>>12&15]|i[E>>>8&15]|a[E>>>4&15],_=c[S>>>28]|u[S>>>24&15]|l[S>>>20&15]|h[S>>>16&15]|p[S>>>12&15]|m[S>>>8&15]|f[S>>>4&15];w=(_>>>16^A)&65535,g[b++]=A^w,g[b++]=_^w<<16}}return g}function u_(t,e,r,n){var o=t.length===32?3:9,s;o===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var i,a=e[0],c=e[1];i=(a>>>4^c)&252645135,c^=i,a^=i<<4,i=(a>>>16^c)&65535,c^=i,a^=i<<16,i=(c>>>2^a)&858993459,a^=i,c^=i<<2,i=(c>>>8^a)&16711935,a^=i,c^=i<<8,i=(a>>>1^c)&1431655765,c^=i,a^=i<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<o;u+=3){for(var l=s[u+1],h=s[u+2],p=s[u];p!=l;p+=h){var m=c^t[p],f=(c>>>4|c<<28)^t[p+1];i=a,a=c,c=i^(rq[m>>>24&63]|oq[m>>>16&63]|iq[m>>>8&63]|cq[m&63]|tq[f>>>24&63]|nq[f>>>16&63]|sq[f>>>8&63]|aq[f&63])}i=a,a=c,c=i}a=a>>>1|a<<31,c=c>>>1|c<<31,i=(a>>>1^c)&1431655765,c^=i,a^=i<<1,i=(c>>>8^a)&16711935,a^=i,c^=i<<8,i=(c>>>2^a)&858993459,a^=i,c^=i<<2,i=(a>>>16^c)&65535,c^=i,a^=i<<16,i=(a>>>4^c)&252645135,c^=i,a^=i<<4,r[0]=a,r[1]=c}function S0(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=st.cipher.createDecipher(r,t.key):n=st.cipher.createCipher(r,t.key);var o=n.start;return n.start=function(s,i){var a=null;i instanceof st.util.ByteBuffer&&(a=i,i={}),i=i||{},i.output=a,i.iv=s,o.call(n,i)},n}});var va=k((yEe,h_)=>{var A0=Oe();h_.exports=A0.md=A0.md||{};A0.md.algorithms=A0.md.algorithms||{}});var p_=k((bEe,d_)=>{var Jo=Oe();va();Ut();var lq=d_.exports=Jo.hmac=Jo.hmac||{};lq.create=function(){var t=null,e=null,r=null,n=null,o={};return o.start=function(s,i){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Jo.md.algorithms)e=Jo.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(i===null)i=t;else{if(typeof i=="string")i=Jo.util.createBuffer(i);else if(Jo.util.isArray(i)){var a=i;i=Jo.util.createBuffer();for(var c=0;c<a.length;++c)i.putByte(a[c])}var u=i.length();u>e.blockLength&&(e.start(),e.update(i.bytes()),i=e.digest()),r=Jo.util.createBuffer(),n=Jo.util.createBuffer(),u=i.length();for(var c=0;c<u;++c){var a=i.at(c);r.putByte(54^a),n.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=i,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},o.update=function(s){e.update(s)},o.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},o.digest=o.getMac,o}});var ph=k(()=>{});var zb=k((EEe,m_)=>{var Fr=Oe();p_();va();Ut();var fq=Fr.pkcs5=Fr.pkcs5||{},Zo;Fr.util.isNodejs&&!Fr.options.usePureJavaScript&&(Zo=ph());m_.exports=Fr.pbkdf2=fq.pbkdf2=function(t,e,r,n,o,s){if(typeof o=="function"&&(s=o,o=null),Fr.util.isNodejs&&!Fr.options.usePureJavaScript&&Zo.pbkdf2&&(o===null||typeof o!="object")&&(Zo.pbkdf2Sync.length>4||!o||o==="sha1"))return typeof o!="string"&&(o="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?Zo.pbkdf2Sync.length===4?Zo.pbkdf2(t,e,r,n,function(w,x){if(w)return s(w);s(null,x.toString("binary"))}):Zo.pbkdf2(t,e,r,n,o,function(w,x){if(w)return s(w);s(null,x.toString("binary"))}):Zo.pbkdf2Sync.length===4?Zo.pbkdf2Sync(t,e,r,n).toString("binary"):Zo.pbkdf2Sync(t,e,r,n,o).toString("binary");if((typeof o>"u"||o===null)&&(o="sha1"),typeof o=="string"){if(!(o in Fr.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=Fr.md[o].create()}var i=o.digestLength;if(n>4294967295*i){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/i),u=n-(c-1)*i,l=Fr.hmac.create();l.start(o,t);var h="",p,m,f;if(!s){for(var d=1;d<=c;++d){l.start(null,null),l.update(e),l.update(Fr.util.int32ToBytes(d)),p=f=l.digest().getBytes();for(var g=2;g<=r;++g)l.start(null,null),l.update(f),m=l.digest().getBytes(),p=Fr.util.xorBytes(p,m,i),f=m;h+=d<c?p:p.substr(0,u)}return h}var d=1,g;function y(){if(d>c)return s(null,h);l.start(null,null),l.update(e),l.update(Fr.util.int32ToBytes(d)),p=f=l.digest().getBytes(),g=2,b()}function b(){if(g<=r)return l.start(null,null),l.update(f),m=l.digest().getBytes(),p=Fr.util.xorBytes(p,m,i),f=m,++g,Fr.util.setImmediate(b);h+=d<c?p:p.substr(0,u),++d,y()}y()}});var b_=k((vEe,y_)=>{var T0=Oe();Ut();var g_=y_.exports=T0.pem=T0.pem||{};g_.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=C0(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=C0(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=C0(n)),t.headers)for(var o=0;o<t.headers.length;++o)r+=C0(t.headers[o]);return t.procType&&(r+=`\r
`),r+=T0.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};g_.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/,s;s=r.exec(t),!!s;){var i=s[1];i==="NEW CERTIFICATE REQUEST"&&(i="CERTIFICATE REQUEST");var a={type:i,procType:null,contentDomain:null,dekInfo:null,headers:[],body:T0.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var c=s[2].split(o),u=0;s&&u<c.length;){for(var l=c[u].replace(/\s+$/,""),h=u+1;h<c.length;++h){var p=c[h];if(!/\s/.test(p[0]))break;l+=p,u=h}if(s=l.match(n),s){for(var m={name:s[1],values:[]},f=s[2].split(","),d=0;d<f.length;++d)m.values.push(hq(f[d]));if(a.procType)if(!a.contentDomain&&m.name==="Content-Domain")a.contentDomain=f[0]||"";else if(!a.dekInfo&&m.name==="DEK-Info"){if(m.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:f[0],parameters:f[1]||null}}else a.headers.push(m);else{if(m.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(m.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:f[0],type:f[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function C0(t){for(var e=t.name+": ",r=[],n=function(c,u){return" "+u},o=0;o<t.values.length;++o)r.push(t.values[o].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,i=-1,o=0;o<e.length;++o,++s)if(s>65&&i!==-1){var a=e[i];a===","?(++i,e=e.substr(0,i)+`\r
 `+e.substr(i)):e=e.substr(0,i)+`\r
`+a+e.substr(i+1),s=o-i-1,i=-1,++o}else(e[o]===" "||e[o]==="	"||e[o]===",")&&(i=o);return e}function hq(t){return t.replace(/^\s+/,"")}});var A_=k((SEe,S_)=>{var Ao=Oe();va();Ut();var x_=S_.exports=Ao.sha256=Ao.sha256||{};Ao.md.sha256=Ao.md.algorithms.sha256=x_;x_.create=function(){E_||dq();var t=null,e=Ao.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=Ao.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=Ao.util.encodeUtf8(o));var i=o.length;n.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=i[1],i[1]=i[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,i[0]=i[1]/4294967296>>>0;return e.putBytes(o),w_(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=Ao.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,i=s&n.blockLength-1;o.putBytes($b.substr(0,n.blockLength-i));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,o.putInt32(u>>>0),u=a>>>0;o.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};w_(h,r,o);var p=Ao.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p.putInt32(h.h5),p.putInt32(h.h6),p.putInt32(h.h7),p},n};var $b=null,E_=!1,v_=null;function dq(){$b=String.fromCharCode(128),$b+=Ao.util.fillString(String.fromCharCode(0),64),v_=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],E_=!0}function w_(t,e,r){for(var n,o,s,i,a,c,u,l,h,p,m,f,d,g,y,b=r.length();b>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,o=e[u-15],o=(o>>>7|o<<25)^(o>>>18|o<<14)^o>>>3,e[u]=n+e[u-7]+o+e[u-16]|0;for(l=t.h0,h=t.h1,p=t.h2,m=t.h3,f=t.h4,d=t.h5,g=t.h6,y=t.h7,u=0;u<64;++u)i=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7),a=g^f&(d^g),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&h|p&(l^h),n=y+i+a+v_[u]+e[u],o=s+c,y=g,g=d,d=f,f=m+n>>>0,m=p,p=h,h=l,l=n+o>>>0;t.h0=t.h0+l|0,t.h1=t.h1+h|0,t.h2=t.h2+p|0,t.h3=t.h3+m|0,t.h4=t.h4+f|0,t.h5=t.h5+d|0,t.h6=t.h6+g|0,t.h7=t.h7+y|0,b-=64}}});var T_=k((AEe,C_)=>{var Co=Oe();Ut();var _0=null;Co.util.isNodejs&&!Co.options.usePureJavaScript&&!process.versions["node-webkit"]&&(_0=ph());var pq=C_.exports=Co.prng=Co.prng||{};pq.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),o=0;o<32;++o)n[o]=r.create();e.pools=n,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var h=e.plugin.cipher,p=e.plugin.increment,m=e.plugin.formatKey,f=e.plugin.formatSeed,d=Co.util.createBuffer();e.key=null,g();function g(y){if(y)return l(y);if(d.length()>=u)return l(null,d.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Co.util.nextTick(function(){s(g)});var b=h(e.key,e.seed);e.generated+=b.length,d.putBytes(b),e.key=m(h(e.key,p(e.seed))),e.seed=f(h(e.key,e.seed)),Co.util.setImmediate(g)}},e.generateSync=function(u){var l=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,m=e.plugin.formatSeed;e.key=null;for(var f=Co.util.createBuffer();f.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&i();var d=l(e.key,e.seed);e.generated+=d.length,f.putBytes(d),e.key=p(l(e.key,h(e.seed))),e.seed=m(l(e.key,e.seed))}return f.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(h,p){if(h)return u(h);e.collect(p),a(),u()})}function i(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,h=0;h<32;++h)e.reseeds%l===0&&(u.update(e.pools[h].digest().getBytes()),e.pools[h].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var p=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(p),e.generated=0}function c(u){var l=null,h=Co.util.globalScope,p=h.crypto||h.msCrypto;p&&p.getRandomValues&&(l=function(E){return p.getRandomValues(E)});var m=Co.util.createBuffer();if(l)for(;m.length()<u;){var f=Math.max(1,Math.min(u-m.length(),65536)/4),d=new Uint32Array(Math.floor(f));try{l(d);for(var g=0;g<d.length;++g)m.putInt32(d[g])}catch(E){if(!(typeof QuotaExceededError<"u"&&E instanceof QuotaExceededError))throw E}}if(m.length()<u)for(var y,b,w,x=Math.floor(Math.random()*65536);m.length()<u;){b=16807*(x&65535),y=16807*(x>>16),b+=(y&32767)<<16,b+=y>>15,b=(b&2147483647)+(b>>31),x=b&4294967295;for(var g=0;g<3;++g)w=x>>>(g<<3),w^=Math.floor(Math.random()*256),m.putByte(w&255)}return m.getBytes(u)}return _0?(e.seedFile=function(u,l){_0.randomBytes(u,function(h,p){if(h)return l(h);l(null,p.toString())})},e.seedFileSync=function(u){return _0.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(h){l(h)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,h=0;h<l;++h)e.pools[e.pool].update(u.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var h="",p=0;p<l;p+=8)h+=String.fromCharCode(u>>p&255);e.collect(h)},e.registerWorker=function(u){if(u===self)e.seedFile=function(h,p){function m(f){var d=f.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",m),p(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",m),self.postMessage({forge:{prng:{needed:h}}})};else{var l=function(h){var p=h.data;p.forge&&p.forge.prng&&e.seedFile(p.forge.prng.needed,function(m,f){u.postMessage({forge:{prng:{err:m,bytes:f}}})})};u.addEventListener("message",l)}},e}});var mh=k((CEe,Kb)=>{var ir=Oe();v0();A_();T_();Ut();(function(){if(ir.random&&ir.random.getBytes){Kb.exports=ir.random;return}(function(t){var e={},r=new Array(4),n=ir.util.createBuffer();e.formatKey=function(h){var p=ir.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),ir.aes._expandKey(h,!1)},e.formatSeed=function(h){var p=ir.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),h},e.cipher=function(h,p){return ir.aes._updateBlock(h,p,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=ir.md.sha256;function o(){var h=ir.prng.create(e);return h.getBytes=function(p,m){return h.generate(p,m)},h.getBytesSync=function(p){return h.generate(p)},h}var s=o(),i=null,a=ir.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(i=function(h){return c.getRandomValues(h)}),ir.options.usePureJavaScript||!ir.util.isNodejs&&!i){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch{}s.collect(u),u=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!ir.random)ir.random=s;else for(var l in s)ir.random[l]=s[l];ir.random.createInstance=o,Kb.exports=ir.random})(typeof jQuery<"u"?jQuery:null)})()});var R_=k((TEe,D_)=>{var Yr=Oe();Ut();var qb=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],__=[1,2,3,5],mq=function(t,e){return t<<e&65535|(t&65535)>>16-e},gq=function(t,e){return(t&65535)>>e|t<<16-e&65535};D_.exports=Yr.rc2=Yr.rc2||{};Yr.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Yr.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),o=e,s=Math.ceil(o/8),i=255>>(o&7),a;for(a=n;a<128;a++)r.putByte(qb[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,qb[r.at(128-s)&i]),a=127-s;a>=0;a--)r.setAt(a,qb[r.at(a+1)^r.at(a+s)]);return r};var I_=function(t,e,r){var n=!1,o=null,s=null,i=null,a,c,u,l,h=[];for(t=Yr.rc2.expandKey(t,e),u=0;u<64;u++)h.push(t.getInt16Le());r?(a=function(f){for(u=0;u<4;u++)f[u]+=h[l]+(f[(u+3)%4]&f[(u+2)%4])+(~f[(u+3)%4]&f[(u+1)%4]),f[u]=mq(f[u],__[u]),l++},c=function(f){for(u=0;u<4;u++)f[u]+=h[f[(u+3)%4]&63]}):(a=function(f){for(u=3;u>=0;u--)f[u]=gq(f[u],__[u]),f[u]-=h[l]+(f[(u+3)%4]&f[(u+2)%4])+(~f[(u+3)%4]&f[(u+1)%4]),l--},c=function(f){for(u=3;u>=0;u--)f[u]-=h[f[(u+3)%4]&63]});var p=function(f){var d=[];for(u=0;u<4;u++){var g=o.getInt16Le();i!==null&&(r?g^=i.getInt16Le():i.putInt16Le(g)),d.push(g&65535)}l=r?0:63;for(var y=0;y<f.length;y++)for(var b=0;b<f[y][0];b++)f[y][1](d);for(u=0;u<4;u++)i!==null&&(r?i.putInt16Le(d[u]):d[u]^=i.getInt16Le()),s.putInt16Le(d[u])},m=null;return m={start:function(f,d){f&&typeof f=="string"&&(f=Yr.util.createBuffer(f)),n=!1,o=Yr.util.createBuffer(),s=d||new Yr.util.createBuffer,i=f,m.output=s},update:function(f){for(n||o.putBuffer(f);o.length()>=8;)p([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(f){var d=!0;if(r)if(f)d=f(8,o,!r);else{var g=o.length()===8?8:8-o.length();o.fillWithByte(g,g)}if(d&&(n=!0,m.update()),!r&&(d=o.length()===0,d))if(f)d=f(8,s,!r);else{var y=s.length(),b=s.at(y-1);b>y?d=!1:s.truncate(b)}return d}},m};Yr.rc2.startEncrypting=function(t,e,r){var n=Yr.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Yr.rc2.createEncryptionCipher=function(t,e){return I_(t,e,!0)};Yr.rc2.startDecrypting=function(t,e,r){var n=Yr.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Yr.rc2.createDecryptionCipher=function(t,e){return I_(t,e,!1)}});var R0=k((_Ee,M_)=>{var Hb=Oe();M_.exports=Hb.jsbn=Hb.jsbn||{};var es,yq=0xdeadbeefcafe,L_=(yq&16777215)==15715070;function U(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Hb.jsbn.BigInteger=U;function ve(){return new U(null)}function bq(t,e,r,n,o,s){for(;--s>=0;){var i=e*this.data[t++]+r.data[n]+o;o=Math.floor(i/67108864),r.data[n++]=i&67108863}return o}function wq(t,e,r,n,o,s){for(var i=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,l=a*c+u*i;c=i*c+((l&32767)<<15)+r.data[n]+(o&1073741823),o=(c>>>30)+(l>>>15)+a*u+(o>>>30),r.data[n++]=c&1073741823}return o}function B_(t,e,r,n,o,s){for(var i=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,l=a*c+u*i;c=i*c+((l&16383)<<14)+r.data[n]+o,o=(c>>28)+(l>>14)+a*u,r.data[n++]=c&268435455}return o}typeof navigator>"u"?(U.prototype.am=B_,es=28):L_&&navigator.appName=="Microsoft Internet Explorer"?(U.prototype.am=wq,es=30):L_&&navigator.appName!="Netscape"?(U.prototype.am=bq,es=26):(U.prototype.am=B_,es=28);U.prototype.DB=es;U.prototype.DM=(1<<es)-1;U.prototype.DV=1<<es;var Gb=52;U.prototype.FV=Math.pow(2,Gb);U.prototype.F1=Gb-es;U.prototype.F2=2*es-Gb;var xq="0123456789abcdefghijklmnopqrstuvwxyz",I0=new Array,Oc,kn;Oc="0".charCodeAt(0);for(kn=0;kn<=9;++kn)I0[Oc++]=kn;Oc="a".charCodeAt(0);for(kn=10;kn<36;++kn)I0[Oc++]=kn;Oc="A".charCodeAt(0);for(kn=10;kn<36;++kn)I0[Oc++]=kn;function P_(t){return xq.charAt(t)}function N_(t,e){var r=I0[t.charCodeAt(e)];return r??-1}function Eq(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function vq(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function di(t){var e=ve();return e.fromInt(t),e}function Sq(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,o=!1,s=0;--n>=0;){var i=r==8?t[n]&255:N_(t,n);if(i<0){t.charAt(n)=="-"&&(o=!0);continue}o=!1,s==0?this.data[this.t++]=i:s+r>this.DB?(this.data[this.t-1]|=(i&(1<<this.DB-s)-1)<<s,this.data[this.t++]=i>>this.DB-s):this.data[this.t-1]|=i<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&U.ZERO.subTo(this,this)}function Aq(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Cq(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,o=!1,s="",i=this.t,a=this.DB-i*this.DB%e;if(i-- >0)for(a<this.DB&&(n=this.data[i]>>a)>0&&(o=!0,s=P_(n));i>=0;)a<e?(n=(this.data[i]&(1<<a)-1)<<e-a,n|=this.data[--i]>>(a+=this.DB-e)):(n=this.data[i]>>(a-=e)&r,a<=0&&(a+=this.DB,--i)),n>0&&(o=!0),o&&(s+=P_(n));return o?s:"0"}function Tq(){var t=ve();return U.ZERO.subTo(this,t),t}function _q(){return this.s<0?this.negate():this}function Iq(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function D0(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Dq(){return this.t<=0?0:this.DB*(this.t-1)+D0(this.data[this.t-1]^this.s&this.DM)}function Rq(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Lq(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Bq(t,e){var r=t%this.DB,n=this.DB-r,o=(1<<n)-1,s=Math.floor(t/this.DB),i=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|i,i=(this.data[a]&o)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=i,e.t=this.t+s+1,e.s=this.s,e.clamp()}function Pq(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,o=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var i=r+1;i<this.t;++i)e.data[i-r-1]|=(this.data[i]&s)<<o,e.data[i-r]=this.data[i]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<o),e.t=this.t-r,e.clamp()}function Nq(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Oq(t,e){var r=this.abs(),n=t.abs(),o=r.t;for(e.t=o+n.t;--o>=0;)e.data[o]=0;for(o=0;o<n.t;++o)e.data[o+r.t]=r.am(0,n.data[o],e,o,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&U.ZERO.subTo(e,e)}function Uq(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function kq(t,e,r){var n=t.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ve());var s=ve(),i=this.s,a=t.s,c=this.DB-D0(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),o.lShiftTo(c,r)):(n.copyTo(s),o.copyTo(r));var u=s.t,l=s.data[u-1];if(l!=0){var h=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),p=this.FV/h,m=(1<<this.F1)/h,f=1<<this.F2,d=r.t,g=d-u,y=e??ve();for(s.dlShiftTo(g,y),r.compareTo(y)>=0&&(r.data[r.t++]=1,r.subTo(y,r)),U.ONE.dlShiftTo(u,y),y.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--g>=0;){var b=r.data[--d]==l?this.DM:Math.floor(r.data[d]*p+(r.data[d-1]+f)*m);if((r.data[d]+=s.am(0,b,r,g,0,u))<b)for(s.dlShiftTo(g,y),r.subTo(y,r);r.data[d]<--b;)r.subTo(y,r)}e!=null&&(r.drShiftTo(u,e),i!=a&&U.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),i<0&&U.ZERO.subTo(r,r)}}}function Mq(t){var e=ve();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(U.ZERO)>0&&t.subTo(e,e),e}function Sa(t){this.m=t}function Fq(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Vq(t){return t}function zq(t){t.divRemTo(this.m,null,t)}function $q(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Kq(t,e){t.squareTo(e),this.reduce(e)}Sa.prototype.convert=Fq;Sa.prototype.revert=Vq;Sa.prototype.reduce=zq;Sa.prototype.mulTo=$q;Sa.prototype.sqrTo=Kq;function qq(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Aa(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Hq(t){var e=ve();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(U.ZERO)>0&&this.m.subTo(e,e),e}function Gq(t){var e=ve();return t.copyTo(e),this.reduce(e),e}function Wq(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function jq(t,e){t.squareTo(e),this.reduce(e)}function Yq(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Aa.prototype.convert=Hq;Aa.prototype.revert=Gq;Aa.prototype.reduce=Wq;Aa.prototype.mulTo=Yq;Aa.prototype.sqrTo=jq;function Qq(){return(this.t>0?this.data[0]&1:this.s)==0}function Xq(t,e){if(t>4294967295||t<1)return U.ONE;var r=ve(),n=ve(),o=e.convert(this),s=D0(t)-1;for(o.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,o,r);else{var i=r;r=n,n=i}return e.revert(r)}function Jq(t,e){var r;return t<256||e.isEven()?r=new Sa(e):r=new Aa(e),this.exp(t,r)}U.prototype.copyTo=Eq;U.prototype.fromInt=vq;U.prototype.fromString=Sq;U.prototype.clamp=Aq;U.prototype.dlShiftTo=Rq;U.prototype.drShiftTo=Lq;U.prototype.lShiftTo=Bq;U.prototype.rShiftTo=Pq;U.prototype.subTo=Nq;U.prototype.multiplyTo=Oq;U.prototype.squareTo=Uq;U.prototype.divRemTo=kq;U.prototype.invDigit=qq;U.prototype.isEven=Qq;U.prototype.exp=Xq;U.prototype.toString=Cq;U.prototype.negate=Tq;U.prototype.abs=_q;U.prototype.compareTo=Iq;U.prototype.bitLength=Dq;U.prototype.mod=Mq;U.prototype.modPowInt=Jq;U.ZERO=di(0);U.ONE=di(1);function Zq(){var t=ve();return this.copyTo(t),t}function eH(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function tH(){return this.t==0?this.s:this.data[0]<<24>>24}function rH(){return this.t==0?this.s:this.data[0]<<16>>16}function nH(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function oH(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function sH(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=di(r),o=ve(),s=ve(),i="";for(this.divRemTo(n,o,s);o.signum()>0;)i=(r+s.intValue()).toString(t).substr(1)+i,o.divRemTo(n,o,s);return s.intValue().toString(t)+i}function iH(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),o=!1,s=0,i=0,a=0;a<t.length;++a){var c=N_(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(o=!0);continue}i=e*i+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(i,0),s=0,i=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(i,0)),o&&U.ZERO.subTo(this,this)}function aH(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(U.ONE.shiftLeft(t-1),Wb,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(U.ONE.shiftLeft(t-1),this);else{var n=new Array,o=t&7;n.length=(t>>3)+1,e.nextBytes(n),o>0?n[0]&=(1<<o)-1:n[0]=0,this.fromString(n,256)}}function cH(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,o=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[o++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),o==0&&(this.s&128)!=(n&128)&&++o,(o>0||n!=this.s)&&(e[o++]=n);return e}function uH(t){return this.compareTo(t)==0}function lH(t){return this.compareTo(t)<0?this:t}function fH(t){return this.compareTo(t)>0?this:t}function hH(t,e,r){var n,o,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(o=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],o);r.t=this.t}else{for(o=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(o,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function dH(t,e){return t&e}function pH(t){var e=ve();return this.bitwiseTo(t,dH,e),e}function Wb(t,e){return t|e}function mH(t){var e=ve();return this.bitwiseTo(t,Wb,e),e}function O_(t,e){return t^e}function gH(t){var e=ve();return this.bitwiseTo(t,O_,e),e}function U_(t,e){return t&~e}function yH(t){var e=ve();return this.bitwiseTo(t,U_,e),e}function bH(){for(var t=ve(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function wH(t){var e=ve();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function xH(t){var e=ve();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function EH(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function vH(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+EH(this.data[t]);return this.s<0?this.t*this.DB:-1}function SH(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function AH(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=SH(this.data[r]^e);return t}function CH(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function TH(t,e){var r=U.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function _H(t){return this.changeBit(t,Wb)}function IH(t){return this.changeBit(t,U_)}function DH(t){return this.changeBit(t,O_)}function RH(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function LH(t){var e=ve();return this.addTo(t,e),e}function BH(t){var e=ve();return this.subTo(t,e),e}function PH(t){var e=ve();return this.multiplyTo(t,e),e}function NH(t){var e=ve();return this.divRemTo(t,e,null),e}function OH(t){var e=ve();return this.divRemTo(t,null,e),e}function UH(t){var e=ve(),r=ve();return this.divRemTo(t,e,r),new Array(e,r)}function kH(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function MH(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function gh(){}function k_(t){return t}function FH(t,e,r){t.multiplyTo(e,r)}function VH(t,e){t.squareTo(e)}gh.prototype.convert=k_;gh.prototype.revert=k_;gh.prototype.mulTo=FH;gh.prototype.sqrTo=VH;function zH(t){return this.exp(t,new gh)}function $H(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var o;for(o=r.t-this.t;n<o;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(o=Math.min(t.t,e);n<o;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function KH(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Uc(t){this.r2=ve(),this.q3=ve(),U.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function qH(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ve();return t.copyTo(e),this.reduce(e),e}function HH(t){return t}function GH(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function WH(t,e){t.squareTo(e),this.reduce(e)}function jH(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Uc.prototype.convert=qH;Uc.prototype.revert=HH;Uc.prototype.reduce=GH;Uc.prototype.mulTo=jH;Uc.prototype.sqrTo=WH;function YH(t,e){var r=t.bitLength(),n,o=di(1),s;if(r<=0)return o;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Sa(e):e.isEven()?s=new Uc(e):s=new Aa(e);var i=new Array,a=3,c=n-1,u=(1<<n)-1;if(i[1]=s.convert(this),n>1){var l=ve();for(s.sqrTo(i[1],l);a<=u;)i[a]=ve(),s.mulTo(l,i[a-2],i[a]),a+=2}var h=t.t-1,p,m=!0,f=ve(),d;for(r=D0(t.data[h])-1;h>=0;){for(r>=c?p=t.data[h]>>r-c&u:(p=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(p|=t.data[h-1]>>this.DB+r-c)),a=n;(p&1)==0;)p>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),m)i[p].copyTo(o),m=!1;else{for(;a>1;)s.sqrTo(o,f),s.sqrTo(f,o),a-=2;a>0?s.sqrTo(o,f):(d=o,o=f,f=d),s.mulTo(f,i[p],o)}for(;h>=0&&(t.data[h]&1<<r)==0;)s.sqrTo(o,f),d=o,o=f,f=d,--r<0&&(r=this.DB-1,--h)}return s.revert(o)}function QH(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var o=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(o<s&&(s=o),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e),(o=r.getLowestSetBit())>0&&r.rShiftTo(o,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function XH(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function JH(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return U.ZERO;for(var r=t.clone(),n=this.clone(),o=di(1),s=di(0),i=di(0),a=di(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!o.isEven()||!s.isEven())&&(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&o.subTo(i,o),s.subTo(a,s)):(n.subTo(r,n),e&&i.subTo(o,i),a.subTo(s,a))}if(n.compareTo(U.ONE)!=0)return U.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var Jn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ZH=(1<<26)/Jn[Jn.length-1];function eG(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Jn[Jn.length-1]){for(e=0;e<Jn.length;++e)if(r.data[0]==Jn[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Jn.length;){for(var n=Jn[e],o=e+1;o<Jn.length&&n<ZH;)n*=Jn[o++];for(n=r.modInt(n);e<o;)if(n%Jn[e++]==0)return!1}return r.millerRabin(t)}function tG(t){var e=this.subtract(U.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),o=rG(),s,i=0;i<t;++i){do s=new U(this.bitLength(),o);while(s.compareTo(U.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo(U.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(U.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function rG(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}U.prototype.chunkSize=nH;U.prototype.toRadix=sH;U.prototype.fromRadix=iH;U.prototype.fromNumber=aH;U.prototype.bitwiseTo=hH;U.prototype.changeBit=TH;U.prototype.addTo=RH;U.prototype.dMultiply=kH;U.prototype.dAddOffset=MH;U.prototype.multiplyLowerTo=$H;U.prototype.multiplyUpperTo=KH;U.prototype.modInt=XH;U.prototype.millerRabin=tG;U.prototype.clone=Zq;U.prototype.intValue=eH;U.prototype.byteValue=tH;U.prototype.shortValue=rH;U.prototype.signum=oH;U.prototype.toByteArray=cH;U.prototype.equals=uH;U.prototype.min=lH;U.prototype.max=fH;U.prototype.and=pH;U.prototype.or=mH;U.prototype.xor=gH;U.prototype.andNot=yH;U.prototype.not=bH;U.prototype.shiftLeft=wH;U.prototype.shiftRight=xH;U.prototype.getLowestSetBit=vH;U.prototype.bitCount=AH;U.prototype.testBit=CH;U.prototype.setBit=_H;U.prototype.clearBit=IH;U.prototype.flipBit=DH;U.prototype.add=LH;U.prototype.subtract=BH;U.prototype.multiply=PH;U.prototype.divide=NH;U.prototype.remainder=OH;U.prototype.divideAndRemainder=UH;U.prototype.modPow=YH;U.prototype.modInverse=JH;U.prototype.pow=zH;U.prototype.gcd=QH;U.prototype.isProbablePrime=eG});var K_=k((IEe,$_)=>{var To=Oe();va();Ut();var V_=$_.exports=To.sha1=To.sha1||{};To.md.sha1=To.md.algorithms.sha1=V_;V_.create=function(){z_||nG();var t=null,e=To.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=To.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=To.util.encodeUtf8(o));var i=o.length;n.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=i[1],i[1]=i[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,i[0]=i[1]/4294967296>>>0;return e.putBytes(o),F_(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=To.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,i=s&n.blockLength-1;o.putBytes(jb.substr(0,n.blockLength-i));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,o.putInt32(u>>>0),u=a>>>0;o.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};F_(h,r,o);var p=To.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p},n};var jb=null,z_=!1;function nG(){jb=String.fromCharCode(128),jb+=To.util.fillString(String.fromCharCode(0),64),z_=!0}function F_(t,e,r){for(var n,o,s,i,a,c,u,l,h=r.length();h>=64;){for(o=t.h0,s=t.h1,i=t.h2,a=t.h3,c=t.h4,l=0;l<16;++l)n=r.getInt32(),e[l]=n,u=a^s&(i^a),n=(o<<5|o>>>27)+u+c+1518500249+n,c=a,a=i,i=(s<<30|s>>>2)>>>0,s=o,o=n;for(;l<20;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=a^s&(i^a),n=(o<<5|o>>>27)+u+c+1518500249+n,c=a,a=i,i=(s<<30|s>>>2)>>>0,s=o,o=n;for(;l<32;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=s^i^a,n=(o<<5|o>>>27)+u+c+1859775393+n,c=a,a=i,i=(s<<30|s>>>2)>>>0,s=o,o=n;for(;l<40;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^i^a,n=(o<<5|o>>>27)+u+c+1859775393+n,c=a,a=i,i=(s<<30|s>>>2)>>>0,s=o,o=n;for(;l<60;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s&i|a&(s^i),n=(o<<5|o>>>27)+u+c+2400959708+n,c=a,a=i,i=(s<<30|s>>>2)>>>0,s=o,o=n;for(;l<80;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^i^a,n=(o<<5|o>>>27)+u+c+3395469782+n,c=a,a=i,i=(s<<30|s>>>2)>>>0,s=o,o=n;t.h0=t.h0+o|0,t.h1=t.h1+s|0,t.h2=t.h2+i|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,h-=64}}});var G_=k((DEe,H_)=>{var _o=Oe();Ut();mh();K_();var q_=H_.exports=_o.pkcs1=_o.pkcs1||{};q_.encode_rsa_oaep=function(t,e,r){var n,o,s,i;typeof r=="string"?(n=r,o=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,o=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(i=r.mgf1.md)),s?s.start():s=_o.md.sha1.create(),i||(i=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}n||(n=""),s.update(n,"raw");for(var l=s.digest(),h="",p=c-e.length,m=0;m<p;m++)h+="\0";var f=l.getBytes()+h+""+e;if(!o)o=_o.random.getBytes(s.digestLength);else if(o.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=o.length,u.digestLength=s.digestLength,u}var d=L0(o,a-s.digestLength-1,i),g=_o.util.xorBytes(f,d,f.length),y=L0(g,s.digestLength,i),b=_o.util.xorBytes(o,y,o.length);return"\0"+b+g};q_.decode_rsa_oaep=function(t,e,r){var n,o,s;typeof r=="string"?(n=r,o=arguments[3]||void 0):r&&(n=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var g=new Error("RSAES-OAEP encoded message length is invalid.");throw g.length=e.length,g.expectedLength=i,g}if(o===void 0?o=_o.md.sha1.create():o.start(),s||(s=o),i<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),o.update(n,"raw");for(var a=o.digest().getBytes(),c=e.charAt(0),u=e.substring(1,o.digestLength+1),l=e.substring(1+o.digestLength),h=L0(l,o.digestLength,s),p=_o.util.xorBytes(u,h,u.length),m=L0(p,i-o.digestLength-1,s),f=_o.util.xorBytes(l,m,l.length),d=f.substring(0,o.digestLength),g=c!=="\0",y=0;y<o.digestLength;++y)g|=a.charAt(y)!==d.charAt(y);for(var b=1,w=o.digestLength,x=o.digestLength;x<f.length;x++){var E=f.charCodeAt(x),S=E&1^1,v=b?65534:0;g|=E&v,b=b&S,w+=b}if(g||f.charCodeAt(w)!==1)throw new Error("Invalid RSAES-OAEP padding.");return f.substring(w+1)};function L0(t,e,r){r||(r=_o.md.sha1.create());for(var n="",o=Math.ceil(e/r.digestLength),s=0;s<o;++s){var i=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+i),n+=r.digest().getBytes()}return n.substring(0,e)}});var W_=k((REe,Yb)=>{var pi=Oe();Ut();R0();mh();(function(){if(pi.prime){Yb.exports=pi.prime;return}var t=Yb.exports=pi.prime=pi.prime||{},e=pi.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var o=function(h,p){return h|p};t.generateProbablePrime=function(h,p,m){typeof p=="function"&&(m=p,p={}),p=p||{};var f=p.algorithm||"PRIMEINC";typeof f=="string"&&(f={name:f}),f.options=f.options||{};var d=p.prng||pi.random,g={nextBytes:function(y){for(var b=d.getBytesSync(y.length),w=0;w<y.length;++w)y[w]=b.charCodeAt(w)}};if(f.name==="PRIMEINC")return s(h,g,f.options,m);throw new Error("Invalid prime generation algorithm: "+f.name)};function s(h,p,m,f){return"workers"in m?c(h,p,m,f):i(h,p,m,f)}function i(h,p,m,f){var d=u(h,p),g=0,y=l(d.bitLength());"millerRabinTests"in m&&(y=m.millerRabinTests);var b=10;"maxBlockTime"in m&&(b=m.maxBlockTime),a(d,h,p,g,y,b,f)}function a(h,p,m,f,d,g,y){var b=+new Date;do{if(h.bitLength()>p&&(h=u(p,m)),h.isProbablePrime(d))return y(null,h);h.dAddOffset(r[f++%8],0)}while(g<0||+new Date-b<g);pi.util.setImmediate(function(){a(h,p,m,f,d,g,y)})}function c(h,p,m,f){if(typeof Worker>"u")return i(h,p,m,f);var d=u(h,p),g=m.workers,y=m.workLoad||100,b=y*30/8,w=m.workerScript||"forge/prime.worker.js";if(g===-1)return pi.util.estimateCores(function(E,S){E&&(S=2),g=S-1,x()});x();function x(){g=Math.max(1,g);for(var E=[],S=0;S<g;++S)E[S]=new Worker(w);for(var v=g,S=0;S<g;++S)E[S].addEventListener("message",_);var A=!1;function _(z){if(!A){--v;var V=z.data;if(V.found){for(var K=0;K<E.length;++K)E[K].terminate();return A=!0,f(null,new e(V.prime,16))}d.bitLength()>h&&(d=u(h,p));var G=d.toString(16);z.target.postMessage({hex:G,workLoad:y}),d.dAddOffset(b,0)}}}}function u(h,p){var m=new e(h,p),f=h-1;return m.testBit(f)||m.bitwiseTo(e.ONE.shiftLeft(f),o,m),m.dAddOffset(31-m.mod(n).byteValue(),0),m}function l(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var P0=k((LEe,e5)=>{var ee=Oe();dh();R0();y0();G_();W_();mh();Ut();typeof be>"u"&&(be=ee.jsbn.BigInteger);var be,Qb=ee.util.isNodejs?ph():null,R=ee.asn1,Mn=ee.util;ee.pki=ee.pki||{};e5.exports=ee.pki.rsa=ee.rsa=ee.rsa||{};var ce=ee.pki,oG=[6,4,2,4,2,4,6,2],sG={name:"PrivateKeyInfo",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:R.Class.UNIVERSAL,type:R.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},iG={name:"RSAPrivateKey",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},aG={name:"RSAPublicKey",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},cG=ee.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:R.Class.UNIVERSAL,type:R.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},uG={name:"DigestInfo",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:R.Class.UNIVERSAL,type:R.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:R.Class.UNIVERSAL,type:R.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},lG=function(t){var e;if(t.algorithm in ce.oids)e=ce.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=R.oidToDer(e).getBytes(),o=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]),s=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[]);s.value.push(R.create(R.Class.UNIVERSAL,R.Type.OID,!1,n)),s.value.push(R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,""));var i=R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,t.digest().getBytes());return o.value.push(s),o.value.push(i),R.toDer(o).getBytes()},J_=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(be.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(be.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new be(ee.util.bytesToHex(ee.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(be.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var o=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);o.compareTo(s)<0;)o=o.add(e.p);var i=o.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return i=i.multiply(n.modInverse(e.n)).mod(e.n),i};ce.rsa.encrypt=function(t,e,r){var n=r,o,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,o=Z_(t,e,r)):(o=ee.util.createBuffer(),o.putBytes(t));for(var i=new be(o.toHex(),16),a=J_(i,e,n),c=a.toString(16),u=ee.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(ee.util.hexToBytes(c)),u.getBytes()};ce.rsa.decrypt=function(t,e,r,n){var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=o,s}var i=new be(ee.util.createBuffer(t).toHex(),16);if(i.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=J_(i,e,r),c=a.toString(16),u=ee.util.createBuffer(),l=o-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(ee.util.hexToBytes(c)),n!==!1?B0(u.getBytes(),e,r):u.getBytes()};ce.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||ee.random,o={nextBytes:function(a){for(var c=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",i;if(s==="PRIMEINC")i={algorithm:s,state:0,bits:t,rng:o,eInt:e||65537,e:new be(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},i.e.fromInt(i.eInt);else throw new Error("Invalid key generation algorithm: "+s);return i};ce.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new be(null);r.fromInt(30);for(var n=0,o=function(h,p){return h|p},s=+new Date,i,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new be(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo(be.ONE.shiftLeft(u),o,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(hG(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(oG[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(be.ONE).gcd(t.e).compareTo(be.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(be.ONE),t.q1=t.q.subtract(be.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(be.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var l=t.e.modInverse(t.phi);t.keys={privateKey:ce.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:ce.rsa.setPublicKey(t.n,t.e)}}i=+new Date,a+=i-s,s=i}return t.keys!==null};ce.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!ee.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(j_("generateKeyPair"))return Qb.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return n(a);n(null,{privateKey:ce.privateKeyFromPem(u),publicKey:ce.publicKeyFromPem(c)})});if(Y_("generateKey")&&Y_("exportKey"))return Mn.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:X_(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Mn.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=ce.privateKeyFromAsn1(R.fromDer(ee.util.createBuffer(a)));n(null,{privateKey:c,publicKey:ce.setRsaPublicKey(c.n,c.e)})}});if(Q_("generateKey")&&Q_("exportKey")){var o=Mn.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:X_(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);o.oncomplete=function(a){var c=a.target.result,u=Mn.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var h=l.target.result,p=ce.privateKeyFromAsn1(R.fromDer(ee.util.createBuffer(h)));n(null,{privateKey:p,publicKey:ce.setRsaPublicKey(p.n,p.e)})},u.onerror=function(l){n(l)}},o.onerror=function(a){n(a)};return}}else if(j_("generateKeyPairSync")){var s=Qb.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ce.privateKeyFromPem(s.privateKey),publicKey:ce.publicKeyFromPem(s.publicKey)}}}var i=ce.rsa.createKeyPairGenerationState(t,e,r);if(!n)return ce.rsa.stepKeyPairGenerationState(i,0),i.keys;fG(i,r,n)};ce.setRsaPublicKey=ce.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,o,s){if(typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSAES-PKCS1-V1_5"),o==="RSAES-PKCS1-V1_5")o={encode:function(a,c,u){return Z_(a,c,2).getBytes()}};else if(o==="RSA-OAEP"||o==="RSAES-OAEP")o={encode:function(a,c){return ee.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(o)!==-1)o={encode:function(a){return a}};else if(typeof o=="string")throw new Error('Unsupported encryption scheme: "'+o+'".');var i=o.encode(n,r,!0);return ce.rsa.encrypt(i,r,!0)},r.verify=function(n,o,s,i){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),i===void 0&&(i={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in i||(i._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,u){u=B0(u,r,!0);var l=R.fromDer(u,{parseAllBytes:i._parseAllDigestBytes}),h={},p=[];if(!R.validate(l,uG,h,p)){var m=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw m.errors=p,m}var f=R.derToOid(h.algorithmIdentifier);if(!(f===ee.oids.md2||f===ee.oids.md5||f===ee.oids.sha1||f===ee.oids.sha224||f===ee.oids.sha256||f===ee.oids.sha384||f===ee.oids.sha512||f===ee.oids["sha512-224"]||f===ee.oids["sha512-256"])){var m=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw m.oid=f,m}if((f===ee.oids.md2||f===ee.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,u){return u=B0(u,r,!0),c===u}});var a=ce.rsa.decrypt(o,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};ce.setRsaPrivateKey=ce.rsa.setPrivateKey=function(t,e,r,n,o,s,i,a){var c={n:t,e,d:r,p:n,q:o,dP:s,dQ:i,qInv:a};return c.decrypt=function(u,l,h){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var p=ce.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:B0};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(m,f){return ee.pkcs1.decode_rsa_oaep(f,m,h)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(m){return m}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(p,c,!1)},c.sign=function(u,l){var h=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:lG},h=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},h=1);var p=l.encode(u,c.n.bitLength());return ce.rsa.encrypt(p,c,h)},c};ce.wrapRsaPrivateKey=function(t){return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(0).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(ce.oids.rsaEncryption).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")]),R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,R.toDer(t).getBytes())])};ce.privateKeyFromAsn1=function(t){var e={},r=[];if(R.validate(t,sG,e,r)&&(t=R.fromDer(ee.util.createBuffer(e.privateKey))),e={},r=[],!R.validate(t,iG,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var o,s,i,a,c,u,l,h;return o=ee.util.createBuffer(e.privateKeyModulus).toHex(),s=ee.util.createBuffer(e.privateKeyPublicExponent).toHex(),i=ee.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=ee.util.createBuffer(e.privateKeyPrime1).toHex(),c=ee.util.createBuffer(e.privateKeyPrime2).toHex(),u=ee.util.createBuffer(e.privateKeyExponent1).toHex(),l=ee.util.createBuffer(e.privateKeyExponent2).toHex(),h=ee.util.createBuffer(e.privateKeyCoefficient).toHex(),ce.setRsaPrivateKey(new be(o,16),new be(s,16),new be(i,16),new be(a,16),new be(c,16),new be(u,16),new be(l,16),new be(h,16))};ce.privateKeyToAsn1=ce.privateKeyToRSAPrivateKey=function(t){return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(0).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.n)),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.e)),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.d)),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.p)),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.q)),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.dP)),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.dQ)),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.qInv))])};ce.publicKeyFromAsn1=function(t){var e={},r=[];if(R.validate(t,cG,e,r)){var n=R.derToOid(e.publicKeyOid);if(n!==ce.oids.rsaEncryption){var o=new Error("Cannot read public key. Unknown OID.");throw o.oid=n,o}t=e.rsaPublicKey}if(r=[],!R.validate(t,aG,e,r)){var o=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw o.errors=r,o}var s=ee.util.createBuffer(e.publicKeyModulus).toHex(),i=ee.util.createBuffer(e.publicKeyExponent).toHex();return ce.setRsaPublicKey(new be(s,16),new be(i,16))};ce.publicKeyToAsn1=ce.publicKeyToSubjectPublicKeyInfo=function(t){return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(ce.oids.rsaEncryption).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")]),R.create(R.Class.UNIVERSAL,R.Type.BITSTRING,!1,[ce.publicKeyToRSAPublicKey(t)])])};ce.publicKeyToRSAPublicKey=function(t){return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.n)),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,Io(t.e))])};function Z_(t,e,r){var n=ee.util.createBuffer(),o=Math.ceil(e.n.bitLength()/8);if(t.length>o-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=o-11,s}n.putByte(0),n.putByte(r);var i=o-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<i;++c)n.putByte(a)}else for(;i>0;){for(var u=0,l=ee.random.getBytes(i),c=0;c<i;++c)a=l.charCodeAt(c),a===0?++u:n.putByte(a);i=u}return n.putByte(0),n.putBytes(t),n}function B0(t,e,r,n){var o=Math.ceil(e.n.bitLength()/8),s=ee.util.createBuffer(t),i=s.getByte(),a=s.getByte();if(i!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=o-3-n;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==o-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function fG(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),o();function o(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return i(a,t.q);s(t.qBits,i)})}function s(a,c){ee.prime.generateProbablePrime(a,n,c)}function i(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(be.ONE).gcd(t.e).compareTo(be.ONE)!==0){t.p=null,o();return}if(t.q.subtract(be.ONE).gcd(t.e).compareTo(be.ONE)!==0){t.q=null,s(t.qBits,i);return}if(t.p1=t.p.subtract(be.ONE),t.q1=t.q.subtract(be.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(be.ONE)!==0){t.p=t.q=null,o();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,i);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:ce.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:ce.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Io(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=ee.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function hG(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function j_(t){return ee.util.isNodejs&&typeof Qb[t]=="function"}function Y_(t){return typeof Mn.globalScope<"u"&&typeof Mn.globalScope.crypto=="object"&&typeof Mn.globalScope.crypto.subtle=="object"&&typeof Mn.globalScope.crypto.subtle[t]=="function"}function Q_(t){return typeof Mn.globalScope<"u"&&typeof Mn.globalScope.msCrypto=="object"&&typeof Mn.globalScope.msCrypto.subtle=="object"&&typeof Mn.globalScope.msCrypto.subtle[t]=="function"}function X_(t){for(var e=ee.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var i5=k((BEe,s5)=>{var Y=Oe();v0();dh();f_();va();y0();zb();b_();mh();R_();P0();Ut();typeof t5>"u"&&(t5=Y.jsbn.BigInteger);var t5,B=Y.asn1,he=Y.pki=Y.pki||{};s5.exports=he.pbe=Y.pbe=Y.pbe||{};var Ca=he.oids,dG={name:"EncryptedPrivateKeyInfo",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},pG={name:"PBES2Algorithms",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:B.Class.UNIVERSAL,type:B.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},mG={name:"pkcs-12PbeParams",tagClass:B.Class.UNIVERSAL,type:B.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:B.Class.UNIVERSAL,type:B.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:B.Class.UNIVERSAL,type:B.Type.INTEGER,constructed:!1,capture:"iterations"}]};he.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=Y.random.getBytesSync(r.saltSize),o=r.count,s=B.integerToDer(o),i,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,l,h;switch(r.algorithm){case"aes128":i=16,u=16,l=Ca["aes128-CBC"],h=Y.aes.createEncryptionCipher;break;case"aes192":i=24,u=16,l=Ca["aes192-CBC"],h=Y.aes.createEncryptionCipher;break;case"aes256":i=32,u=16,l=Ca["aes256-CBC"],h=Y.aes.createEncryptionCipher;break;case"des":i=8,u=8,l=Ca.desCBC,h=Y.des.createEncryptionCipher;break;default:var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var m="hmacWith"+r.prfAlgorithm.toUpperCase(),f=o5(m),d=Y.pkcs5.pbkdf2(e,n,o,i,f),g=Y.random.getBytesSync(u),y=h(d);y.start(g),y.update(B.toDer(t)),y.finish(),c=y.output.getBytes();var b=gG(n,s,i,m);a=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Ca.pkcs5PBES2).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Ca.pkcs5PBKDF2).getBytes()),b]),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(l).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,g)])])])}else if(r.algorithm==="3des"){i=24;var w=new Y.util.ByteBuffer(n),d=he.pbe.generatePkcs12Key(e,w,1,o,i),g=he.pbe.generatePkcs12Key(e,w,2,o,i),y=Y.des.createEncryptionCipher(d);y.start(g),y.update(B.toDer(t)),y.finish(),c=y.output.getBytes(),a=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(Ca["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,n),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,s.getBytes())])])}else{var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var x=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[a,B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,c)]);return x};he.decryptPrivateKeyInfo=function(t,e){var r=null,n={},o=[];if(!B.validate(t,dG,n,o)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var i=B.derToOid(n.encryptionOid),a=he.pbe.getCipher(i,n.encryptionParams,e),c=Y.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=B.fromDer(a.output)),r};he.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:B.toDer(t).getBytes()};return Y.pem.encode(r,{maxline:e})};he.encryptedPrivateKeyFromPem=function(t){var e=Y.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return B.fromDer(e.body)};he.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=he.wrapRsaPrivateKey(he.privateKeyToAsn1(t));return n=he.encryptPrivateKeyInfo(n,e,r),he.encryptedPrivateKeyToPem(n)}var o,s,i,a;switch(r.algorithm){case"aes128":o="AES-128-CBC",i=16,s=Y.random.getBytesSync(16),a=Y.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC",i=24,s=Y.random.getBytesSync(16),a=Y.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC",i=32,s=Y.random.getBytesSync(16),a=Y.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC",i=24,s=Y.random.getBytesSync(8),a=Y.des.createEncryptionCipher;break;case"des":o="DES-CBC",i=8,s=Y.random.getBytesSync(8),a=Y.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=Y.pbe.opensslDeriveBytes(e,s.substr(0,8),i),l=a(u);l.start(s),l.update(B.toDer(he.privateKeyToAsn1(t))),l.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:Y.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return Y.pem.encode(h)};he.decryptRsaPrivateKey=function(t,e){var r=null,n=Y.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var o=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw o.headerType=o,o}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,i;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,i=Y.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,i=Y.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,i=Y.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,i=Y.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,i=Y.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,i=function(h){return Y.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,i=function(h){return Y.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,i=function(h){return Y.rc2.createDecryptionCipher(h,128)};break;default:var o=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw o.algorithm=n.dekInfo.algorithm,o}var a=Y.util.hexToBytes(n.dekInfo.parameters),c=Y.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=i(c);if(u.start(a),u.update(Y.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=he.decryptPrivateKeyInfo(B.fromDer(r),e):r=B.fromDer(r),r!==null&&(r=he.privateKeyFromAsn1(r)),r};he.pbe.generatePkcs12Key=function(t,e,r,n,o,s){var i,a;if(typeof s>"u"||s===null){if(!("sha1"in Y.md))throw new Error('"sha1" hash algorithm unavailable.');s=Y.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new Y.util.ByteBuffer,h=new Y.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var p=h.length(),m=e.length(),f=new Y.util.ByteBuffer;f.fillWithByte(r,u);var d=u*Math.ceil(m/u),g=new Y.util.ByteBuffer;for(a=0;a<d;a++)g.putByte(e.at(a%m));var y=u*Math.ceil(p/u),b=new Y.util.ByteBuffer;for(a=0;a<y;a++)b.putByte(h.at(a%p));var w=g;w.putBuffer(b);for(var x=Math.ceil(o/c),E=1;E<=x;E++){var S=new Y.util.ByteBuffer;S.putBytes(f.bytes()),S.putBytes(w.bytes());for(var v=0;v<n;v++)s.start(),s.update(S.getBytes()),S=s.digest();var A=new Y.util.ByteBuffer;for(a=0;a<u;a++)A.putByte(S.at(a%c));var _=Math.ceil(m/u)+Math.ceil(p/u),z=new Y.util.ByteBuffer;for(i=0;i<_;i++){var V=new Y.util.ByteBuffer(w.getBytes(u)),K=511;for(a=A.length()-1;a>=0;a--)K=K>>8,K+=A.at(a)+V.at(a),V.setAt(a,K&255);z.putBuffer(V)}w=z,l.putBuffer(S)}return l.truncate(l.length()-o),l};he.pbe.getCipher=function(t,e,r){switch(t){case he.oids.pkcs5PBES2:return he.pbe.getCipherForPBES2(t,e,r);case he.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case he.oids["pbewithSHAAnd40BitRC2-CBC"]:return he.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};he.pbe.getCipherForPBES2=function(t,e,r){var n={},o=[];if(!B.validate(e,pG,n,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}if(t=B.derToOid(n.kdfOid),t!==he.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=B.derToOid(n.encOid),t!==he.oids["aes128-CBC"]&&t!==he.oids["aes192-CBC"]&&t!==he.oids["aes256-CBC"]&&t!==he.oids["des-EDE3-CBC"]&&t!==he.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var i=n.kdfSalt,a=Y.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(he.oids[t]){case"aes128-CBC":c=16,u=Y.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=Y.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=Y.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=Y.des.createDecryptionCipher;break;case"desCBC":c=8,u=Y.des.createDecryptionCipher;break}var l=n5(n.prfOid),h=Y.pkcs5.pbkdf2(r,i,a,c,l),p=n.encIv,m=u(h);return m.start(p),m};he.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},o=[];if(!B.validate(e,mG,n,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var i=Y.util.createBuffer(n.salt),a=Y.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,u,l;switch(t){case he.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=Y.des.startDecrypting;break;case he.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(d,g){var y=Y.rc2.createDecryptionCipher(d,40);return y.start(g,null),y};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=n5(n.prfOid),p=he.pbe.generatePkcs12Key(r,i,1,a,c,h);h.start();var m=he.pbe.generatePkcs12Key(r,i,2,a,u,h);return l(p,m)};he.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in Y.md))throw new Error('"md5" hash algorithm unavailable.');n=Y.md.md5.create()}e===null&&(e="");for(var o=[r5(n,t+e)],s=16,i=1;s<r;++i,s+=16)o.push(r5(n,o[i-1]+t+e));return o.join("").substr(0,r)};function r5(t,e){return t.start().update(e).digest().getBytes()}function n5(t){var e;if(!t)e="hmacWithSHA1";else if(e=he.oids[B.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return o5(e)}function o5(t){var e=Y.md;switch(t){case"hmacWithSHA224":e=Y.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function gG(t,e,r,n){var o=B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OCTETSTRING,!1,t),B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&o.value.push(B.create(B.Class.UNIVERSAL,B.Type.INTEGER,!1,Y.util.hexToBytes(r.toString(16))),B.create(B.Class.UNIVERSAL,B.Type.SEQUENCE,!0,[B.create(B.Class.UNIVERSAL,B.Type.OID,!1,B.oidToDer(he.oids[n]).getBytes()),B.create(B.Class.UNIVERSAL,B.Type.NULL,!1,"")])),o}});var eI=k((ASe,Z5)=>{"use strict";Z5.exports=Aj;function Aj(t,e){for(var r=new Array(arguments.length-1),n=0,o=2,s=!0;o<arguments.length;)r[n++]=arguments[o++];return new Promise(function(a,c){r[n]=function(l){if(s)if(s=!1,l)c(l);else{for(var h=new Array(arguments.length-1),p=0;p<h.length;)h[p++]=arguments[p];a.apply(null,h)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,c(u))}})}});var oI=k(nI=>{"use strict";var em=nI;em.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Qc=new Array(64),rI=new Array(123);for(no=0;no<64;)rI[Qc[no]=no<26?no+65:no<52?no+71:no<62?no-4:no-59|43]=no++;var no;em.encode=function(e,r,n){for(var o=null,s=[],i=0,a=0,c;r<n;){var u=e[r++];switch(a){case 0:s[i++]=Qc[u>>2],c=(u&3)<<4,a=1;break;case 1:s[i++]=Qc[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[i++]=Qc[c|u>>6],s[i++]=Qc[u&63],a=0;break}i>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),i=0)}return a&&(s[i++]=Qc[c],s[i++]=61,a===1&&(s[i++]=61)),o?(i&&o.push(String.fromCharCode.apply(String,s.slice(0,i))),o.join("")):String.fromCharCode.apply(String,s.slice(0,i))};var tI="invalid encoding";em.decode=function(e,r,n){for(var o=n,s=0,i,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=rI[c])===void 0)throw Error(tI);switch(s){case 0:i=c,s=1;break;case 1:r[n++]=i<<2|(c&48)>>4,i=c,s=2;break;case 2:r[n++]=(i&15)<<4|(c&60)>>2,i=c,s=3;break;case 3:r[n++]=(i&3)<<6|c,s=0;break}}if(s===1)throw Error(tI);return n-o};em.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var iI=k((TSe,sI)=>{"use strict";sI.exports=tm;function tm(){this._listeners={}}tm.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};tm.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],o=0;o<n.length;)n[o].fn===r?n.splice(o,1):++o;return this};tm.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],o=1;o<arguments.length;)n.push(arguments[o++]);for(o=0;o<r.length;)r[o].fn.apply(r[o++].ctx,n)}return this}});var dI=k((_Se,hI)=>{"use strict";hI.exports=aI(aI);function aI(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function o(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3]}function s(c,u,l){e[0]=c,u[l]=r[3],u[l+1]=r[2],u[l+2]=r[1],u[l+3]=r[0]}t.writeFloatLE=n?o:s,t.writeFloatBE=n?s:o;function i(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],e[0]}function a(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],e[0]}t.readFloatLE=n?i:a,t.readFloatBE=n?a:i}():function(){function e(n,o,s,i){var a=o<0?1:0;if(a&&(o=-o),o===0)n(1/o>0?0:2147483648,s,i);else if(isNaN(o))n(2143289344,s,i);else if(o>34028234663852886e22)n((a<<31|2139095040)>>>0,s,i);else if(o<11754943508222875e-54)n((a<<31|Math.round(o/1401298464324817e-60))>>>0,s,i);else{var c=Math.floor(Math.log(o)/Math.LN2),u=Math.round(o*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,s,i)}}t.writeFloatLE=e.bind(null,cI),t.writeFloatBE=e.bind(null,uI);function r(n,o,s){var i=n(o,s),a=(i>>31)*2+1,c=i>>>23&255,u=i&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}t.readFloatLE=r.bind(null,lI),t.readFloatBE=r.bind(null,fI)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function o(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3],u[l+4]=r[4],u[l+5]=r[5],u[l+6]=r[6],u[l+7]=r[7]}function s(c,u,l){e[0]=c,u[l]=r[7],u[l+1]=r[6],u[l+2]=r[5],u[l+3]=r[4],u[l+4]=r[3],u[l+5]=r[2],u[l+6]=r[1],u[l+7]=r[0]}t.writeDoubleLE=n?o:s,t.writeDoubleBE=n?s:o;function i(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],e[0]}function a(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],e[0]}t.readDoubleLE=n?i:a,t.readDoubleBE=n?a:i}():function(){function e(n,o,s,i,a,c){var u=i<0?1:0;if(u&&(i=-i),i===0)n(0,a,c+o),n(1/i>0?0:2147483648,a,c+s);else if(isNaN(i))n(0,a,c+o),n(2146959360,a,c+s);else if(i>17976931348623157e292)n(0,a,c+o),n((u<<31|2146435072)>>>0,a,c+s);else{var l;if(i<22250738585072014e-324)l=i/5e-324,n(l>>>0,a,c+o),n((u<<31|l/4294967296)>>>0,a,c+s);else{var h=Math.floor(Math.log(i)/Math.LN2);h===1024&&(h=1023),l=i*Math.pow(2,-h),n(l*4503599627370496>>>0,a,c+o),n((u<<31|h+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,cI,0,4),t.writeDoubleBE=e.bind(null,uI,4,0);function r(n,o,s,i,a){var c=n(i,a+o),u=n(i,a+s),l=(u>>31)*2+1,h=u>>>20&2047,p=4294967296*(u&1048575)+c;return h===2047?p?NaN:l*(1/0):h===0?l*5e-324*p:l*Math.pow(2,h-1075)*(p+4503599627370496)}t.readDoubleLE=r.bind(null,lI,0,4),t.readDoubleBE=r.bind(null,fI,4,0)}(),t}function cI(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function uI(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function lI(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function fI(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var pI=k((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var gI=k(mI=>{"use strict";var Vw=mI;Vw.length=function(e){for(var r=0,n=0,o=0;o<e.length;++o)n=e.charCodeAt(o),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(o+1)&64512)===56320?(++o,r+=4):r+=3;return r};Vw.read=function(e,r,n){var o=n-r;if(o<1)return"";for(var s=null,i=[],a=0,c;r<n;)c=e[r++],c<128?i[a++]=c:c>191&&c<224?i[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,i[a++]=55296+(c>>10),i[a++]=56320+(c&1023)):i[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,i)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,i.slice(0,a))),s.join("")):String.fromCharCode.apply(String,i.slice(0,a))};Vw.write=function(e,r,n){for(var o=n,s,i,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((i=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(i&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-o}});var bI=k((DSe,yI)=>{"use strict";yI.exports=Cj;function Cj(t,e,r){var n=r||8192,o=n>>>1,s=null,i=n;return function(c){if(c<1||c>o)return t(c);i+c>n&&(s=t(n),i=0);var u=e.call(s,i,i+=c);return i&7&&(i=(i|7)+1),u}}});var xI=k((RSe,wI)=>{"use strict";wI.exports=ar;var Ih=Ba();function ar(t,e){this.lo=t>>>0,this.hi=e>>>0}var La=ar.zero=new ar(0,0);La.toNumber=function(){return 0};La.zzEncode=La.zzDecode=function(){return this};La.length=function(){return 1};var Tj=ar.zeroHash="\0\0\0\0\0\0\0\0";ar.fromNumber=function(e){if(e===0)return La;var r=e<0;r&&(e=-e);var n=e>>>0,o=(e-n)/4294967296>>>0;return r&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new ar(n,o)};ar.from=function(e){if(typeof e=="number")return ar.fromNumber(e);if(Ih.isString(e))if(Ih.Long)e=Ih.Long.fromString(e);else return ar.fromNumber(parseInt(e,10));return e.low||e.high?new ar(e.low>>>0,e.high>>>0):La};ar.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};ar.prototype.toLong=function(e){return Ih.Long?new Ih.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Ei=String.prototype.charCodeAt;ar.fromHash=function(e){return e===Tj?La:new ar((Ei.call(e,0)|Ei.call(e,1)<<8|Ei.call(e,2)<<16|Ei.call(e,3)<<24)>>>0,(Ei.call(e,4)|Ei.call(e,5)<<8|Ei.call(e,6)<<16|Ei.call(e,7)<<24)>>>0)};ar.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};ar.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};ar.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};ar.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Ba=k(zw=>{"use strict";var Z=zw;Z.asPromise=eI();Z.base64=oI();Z.EventEmitter=iI();Z.float=dI();Z.inquire=pI();Z.utf8=gI();Z.pool=bI();Z.LongBits=xI();Z.isNode=Boolean(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);Z.global=Z.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||zw;Z.emptyArray=Object.freeze?Object.freeze([]):[];Z.emptyObject=Object.freeze?Object.freeze({}):{};Z.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Z.isString=function(e){return typeof e=="string"||e instanceof String};Z.isObject=function(e){return e&&typeof e=="object"};Z.isset=Z.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};Z.Buffer=function(){try{var t=Z.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();Z._Buffer_from=null;Z._Buffer_allocUnsafe=null;Z.newBuffer=function(e){return typeof e=="number"?Z.Buffer?Z._Buffer_allocUnsafe(e):new Z.Array(e):Z.Buffer?Z._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};Z.Array=typeof Uint8Array<"u"?Uint8Array:Array;Z.Long=Z.global.dcodeIO&&Z.global.dcodeIO.Long||Z.global.Long||Z.inquire("long");Z.key2Re=/^true|false|0|1$/;Z.key32Re=/^-?(?:0|[1-9][0-9]*)$/;Z.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;Z.longToHash=function(e){return e?Z.LongBits.from(e).toHash():Z.LongBits.zeroHash};Z.longFromHash=function(e,r){var n=Z.LongBits.fromHash(e);return Z.Long?Z.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function EI(t,e,r){for(var n=Object.keys(e),o=0;o<n.length;++o)(t[n[o]]===void 0||!r)&&(t[n[o]]=e[n[o]]);return t}Z.merge=EI;Z.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function vI(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&EI(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}Z.newError=vI;Z.ProtocolError=vI("ProtocolError");Z.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var o=Object.keys(this),s=o.length-1;s>-1;--s)if(r[o[s]]===1&&this[o[s]]!==void 0&&this[o[s]]!==null)return o[s]}};Z.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};Z.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};Z._configure=function(){var t=Z.Buffer;if(!t){Z._Buffer_from=Z._Buffer_allocUnsafe=null;return}Z._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},Z._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var qw=k((BSe,_I)=>{"use strict";_I.exports=kt;var Ro=Ba(),Kw,CI=Ro.LongBits,_j=Ro.utf8;function oo(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function kt(t){this.buf=t,this.pos=0,this.len=t.length}var SI=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new kt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new kt(e);throw Error("illegal buffer")},TI=function(){return Ro.Buffer?function(r){return(kt.create=function(o){return Ro.Buffer.isBuffer(o)?new Kw(o):SI(o)})(r)}:SI};kt.create=TI();kt.prototype._slice=Ro.Array.prototype.subarray||Ro.Array.prototype.slice;kt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,oo(this,10);return e}}();kt.prototype.int32=function(){return this.uint32()|0};kt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function $w(){var t=new CI(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw oo(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw oo(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}kt.prototype.bool=function(){return this.uint32()!==0};function rm(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}kt.prototype.fixed32=function(){if(this.pos+4>this.len)throw oo(this,4);return rm(this.buf,this.pos+=4)};kt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw oo(this,4);return rm(this.buf,this.pos+=4)|0};function AI(){if(this.pos+8>this.len)throw oo(this,8);return new CI(rm(this.buf,this.pos+=4),rm(this.buf,this.pos+=4))}kt.prototype.float=function(){if(this.pos+4>this.len)throw oo(this,4);var e=Ro.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};kt.prototype.double=function(){if(this.pos+8>this.len)throw oo(this,4);var e=Ro.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};kt.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw oo(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};kt.prototype.string=function(){var e=this.bytes();return _j.read(e,0,e.length)};kt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw oo(this,e);this.pos+=e}else do if(this.pos>=this.len)throw oo(this);while(this.buf[this.pos++]&128);return this};kt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};kt._configure=function(t){Kw=t,kt.create=TI(),Kw._configure();var e=Ro.Long?"toLong":"toNumber";Ro.merge(kt.prototype,{int64:function(){return $w.call(this)[e](!1)},uint64:function(){return $w.call(this)[e](!0)},sint64:function(){return $w.call(this).zzDecode()[e](!1)},fixed64:function(){return AI.call(this)[e](!0)},sfixed64:function(){return AI.call(this)[e](!1)}})}});var LI=k((PSe,RI)=>{"use strict";RI.exports=Pa;var DI=qw();(Pa.prototype=Object.create(DI.prototype)).constructor=Pa;var II=Ba();function Pa(t){DI.call(this,t)}Pa._configure=function(){II.Buffer&&(Pa.prototype._slice=II.Buffer.prototype.slice)};Pa.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Pa._configure()});var Xw=k((NSe,OI)=>{"use strict";OI.exports=Se;var zn=Ba(),Hw,nm=zn.LongBits,BI=zn.base64,PI=zn.utf8;function Dh(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Ww(){}function Ij(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Se(){this.len=0,this.head=new Dh(Ww,0,0),this.tail=this.head,this.states=null}var NI=function(){return zn.Buffer?function(){return(Se.create=function(){return new Hw})()}:function(){return new Se}};Se.create=NI();Se.alloc=function(e){return new zn.Array(e)};zn.Array!==Array&&(Se.alloc=zn.pool(Se.alloc,zn.Array.prototype.subarray));Se.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Dh(e,r,n),this.len+=r,this};function jw(t,e,r){e[r]=t&255}function Dj(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Yw(t,e){this.len=t,this.next=void 0,this.val=e}Yw.prototype=Object.create(Dh.prototype);Yw.prototype.fn=Dj;Se.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Yw((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Se.prototype.int32=function(e){return e<0?this._push(Qw,10,nm.fromNumber(e)):this.uint32(e)};Se.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Qw(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}Se.prototype.uint64=function(e){var r=nm.from(e);return this._push(Qw,r.length(),r)};Se.prototype.int64=Se.prototype.uint64;Se.prototype.sint64=function(e){var r=nm.from(e).zzEncode();return this._push(Qw,r.length(),r)};Se.prototype.bool=function(e){return this._push(jw,1,e?1:0)};function Gw(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Se.prototype.fixed32=function(e){return this._push(Gw,4,e>>>0)};Se.prototype.sfixed32=Se.prototype.fixed32;Se.prototype.fixed64=function(e){var r=nm.from(e);return this._push(Gw,4,r.lo)._push(Gw,4,r.hi)};Se.prototype.sfixed64=Se.prototype.fixed64;Se.prototype.float=function(e){return this._push(zn.float.writeFloatLE,4,e)};Se.prototype.double=function(e){return this._push(zn.float.writeDoubleLE,8,e)};var Rj=zn.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var o=0;o<e.length;++o)r[n+o]=e[o]};Se.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(jw,1,0);if(zn.isString(e)){var n=Se.alloc(r=BI.length(e));BI.decode(e,n,0),e=n}return this.uint32(r)._push(Rj,r,e)};Se.prototype.string=function(e){var r=PI.length(e);return r?this.uint32(r)._push(PI.write,r,e):this._push(jw,1,0)};Se.prototype.fork=function(){return this.states=new Ij(this),this.head=this.tail=new Dh(Ww,0,0),this.len=0,this};Se.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Dh(Ww,0,0),this.len=0),this};Se.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};Se.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};Se._configure=function(t){Hw=t,Se.create=NI(),Hw._configure()}});var MI=k((OSe,kI)=>{"use strict";kI.exports=Lo;var UI=Xw();(Lo.prototype=Object.create(UI.prototype)).constructor=Lo;var vi=Ba();function Lo(){UI.call(this)}Lo._configure=function(){Lo.alloc=vi._Buffer_allocUnsafe,Lo.writeBytesBuffer=vi.Buffer&&vi.Buffer.prototype instanceof Uint8Array&&vi.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var o=0;o<e.length;)r[n++]=e[o++]}};Lo.prototype.bytes=function(e){vi.isString(e)&&(e=vi._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Lo.writeBytesBuffer,r,e),this};function Lj(t,e,r){t.length<40?vi.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Lo.prototype.string=function(e){var r=vi.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Lj,r,e),this};Lo._configure()});var JI=k((OAe,XI)=>{var nt=Oe();va();Ut();var Lh=XI.exports=nt.sha512=nt.sha512||{};nt.md.sha512=nt.md.algorithms.sha512=Lh;var YI=nt.sha384=nt.sha512.sha384=nt.sha512.sha384||{};YI.create=function(){return Lh.create("SHA-384")};nt.md.sha384=nt.md.algorithms.sha384=YI;nt.sha512.sha256=nt.sha512.sha256||{create:function(){return Lh.create("SHA-512/256")}};nt.md["sha512/256"]=nt.md.algorithms["sha512/256"]=nt.sha512.sha256;nt.sha512.sha224=nt.sha512.sha224||{create:function(){return Lh.create("SHA-512/224")}};nt.md["sha512/224"]=nt.md.algorithms["sha512/224"]=nt.sha512.sha224;Lh.create=function(t){if(QI||Vj(),typeof t>"u"&&(t="SHA-512"),!(t in Oa))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Oa[t],r=null,n=nt.util.createBuffer(),o=new Array(80),s=0;s<80;++s)o[s]=new Array(2);var i=64;switch(t){case"SHA-384":i=48;break;case"SHA-512/256":i=32;break;case"SHA-512/224":i=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:i,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);n=nt.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=nt.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=l[1],l[1]=l[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,l[0]=l[1]/4294967296>>>0;return n.putBytes(c),jI(r,o,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=nt.util.createBuffer();c.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=u&a.blockLength-1;c.putBytes(ox.substr(0,a.blockLength-l));for(var h,p,m=a.fullMessageLength[0]*8,f=0;f<a.fullMessageLength.length-1;++f)h=a.fullMessageLength[f+1]*8,p=h/4294967296>>>0,m+=p,c.putInt32(m>>>0),m=h>>>0;c.putInt32(m);for(var d=new Array(r.length),f=0;f<r.length;++f)d[f]=r[f].slice(0);jI(d,o,c);var g=nt.util.createBuffer(),y;t==="SHA-512"?y=d.length:t==="SHA-384"?y=d.length-2:y=d.length-4;for(var f=0;f<y;++f)g.putInt32(d[f][0]),(f!==y-1||t!=="SHA-512/224")&&g.putInt32(d[f][1]);return g},a};var ox=null,QI=!1,sx=null,Oa=null;function Vj(){ox=String.fromCharCode(128),ox+=nt.util.fillString(String.fromCharCode(0),128),sx=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Oa={},Oa["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Oa["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Oa["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Oa["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],QI=!0}function jI(t,e,r){for(var n,o,s,i,a,c,u,l,h,p,m,f,d,g,y,b,w,x,E,S,v,A,_,z,V,K,G,se,L,O,P,N,D,F,q,W=r.length();W>=128;){for(L=0;L<16;++L)e[L][0]=r.getInt32()>>>0,e[L][1]=r.getInt32()>>>0;for(;L<80;++L)N=e[L-2],O=N[0],P=N[1],n=((O>>>19|P<<13)^(P>>>29|O<<3)^O>>>6)>>>0,o=((O<<13|P>>>19)^(P<<3|O>>>29)^(O<<26|P>>>6))>>>0,F=e[L-15],O=F[0],P=F[1],s=((O>>>1|P<<31)^(O>>>8|P<<24)^O>>>7)>>>0,i=((O<<31|P>>>1)^(O<<24|P>>>8)^(O<<25|P>>>7))>>>0,D=e[L-7],q=e[L-16],P=o+D[1]+i+q[1],e[L][0]=n+D[0]+s+q[0]+(P/4294967296>>>0)>>>0,e[L][1]=P>>>0;for(d=t[0][0],g=t[0][1],y=t[1][0],b=t[1][1],w=t[2][0],x=t[2][1],E=t[3][0],S=t[3][1],v=t[4][0],A=t[4][1],_=t[5][0],z=t[5][1],V=t[6][0],K=t[6][1],G=t[7][0],se=t[7][1],L=0;L<80;++L)u=((v>>>14|A<<18)^(v>>>18|A<<14)^(A>>>9|v<<23))>>>0,l=((v<<18|A>>>14)^(v<<14|A>>>18)^(A<<23|v>>>9))>>>0,h=(V^v&(_^V))>>>0,p=(K^A&(z^K))>>>0,a=((d>>>28|g<<4)^(g>>>2|d<<30)^(g>>>7|d<<25))>>>0,c=((d<<4|g>>>28)^(g<<30|d>>>2)^(g<<25|d>>>7))>>>0,m=(d&y|w&(d^y))>>>0,f=(g&b|x&(g^b))>>>0,P=se+l+p+sx[L][1]+e[L][1],n=G+u+h+sx[L][0]+e[L][0]+(P/4294967296>>>0)>>>0,o=P>>>0,P=c+f,s=a+m+(P/4294967296>>>0)>>>0,i=P>>>0,G=V,se=K,V=_,K=z,_=v,z=A,P=S+o,v=E+n+(P/4294967296>>>0)>>>0,A=P>>>0,E=w,S=x,w=y,x=b,y=d,b=g,P=o+i,d=n+s+(P/4294967296>>>0)>>>0,g=P>>>0;P=t[0][1]+g,t[0][0]=t[0][0]+d+(P/4294967296>>>0)>>>0,t[0][1]=P>>>0,P=t[1][1]+b,t[1][0]=t[1][0]+y+(P/4294967296>>>0)>>>0,t[1][1]=P>>>0,P=t[2][1]+x,t[2][0]=t[2][0]+w+(P/4294967296>>>0)>>>0,t[2][1]=P>>>0,P=t[3][1]+S,t[3][0]=t[3][0]+E+(P/4294967296>>>0)>>>0,t[3][1]=P>>>0,P=t[4][1]+A,t[4][0]=t[4][0]+v+(P/4294967296>>>0)>>>0,t[4][1]=P>>>0,P=t[5][1]+z,t[5][0]=t[5][0]+_+(P/4294967296>>>0)>>>0,t[5][1]=P>>>0,P=t[6][1]+K,t[6][0]=t[6][0]+V+(P/4294967296>>>0)>>>0,t[6][1]=P>>>0,P=t[7][1]+se,t[7][0]=t[7][0]+G+(P/4294967296>>>0)>>>0,t[7][1]=P>>>0,W-=128}}});var _D=k((u4e,TD)=>{var ru=1e3,nu=ru*60,ou=nu*60,Va=ou*24,gY=Va*7,yY=Va*365.25;TD.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return bY(t);if(r==="number"&&isFinite(t))return e.long?xY(t):wY(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function bY(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*yY;case"weeks":case"week":case"w":return r*gY;case"days":case"day":case"d":return r*Va;case"hours":case"hour":case"hrs":case"hr":case"h":return r*ou;case"minutes":case"minute":case"mins":case"min":case"m":return r*nu;case"seconds":case"second":case"secs":case"sec":case"s":return r*ru;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function wY(t){var e=Math.abs(t);return e>=Va?Math.round(t/Va)+"d":e>=ou?Math.round(t/ou)+"h":e>=nu?Math.round(t/nu)+"m":e>=ru?Math.round(t/ru)+"s":t+"ms"}function xY(t){var e=Math.abs(t);return e>=Va?lm(t,e,Va,"day"):e>=ou?lm(t,e,ou,"hour"):e>=nu?lm(t,e,nu,"minute"):e>=ru?lm(t,e,ru,"second"):t+" ms"}function lm(t,e,r,n){var o=e>=r*1.5;return Math.round(t/r)+" "+n+(o?"s":"")}});var DD=k((l4e,ID)=>{function EY(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=o,r.enabled=i,r.humanize=_D(),r.destroy=u,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let h=0;for(let p=0;p<l.length;p++)h=(h<<5)-h+l.charCodeAt(p),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(l){let h,p=null,m,f;function d(...g){if(!d.enabled)return;let y=d,b=Number(new Date),w=b-(h||b);y.diff=w,y.prev=h,y.curr=b,h=b,g[0]=r.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let x=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(S,v)=>{if(S==="%%")return"%";x++;let A=r.formatters[v];if(typeof A=="function"){let _=g[x];S=A.call(y,_),g.splice(x,1),x--}return S}),r.formatArgs.call(y,g),(y.log||r.log).apply(y,g)}return d.namespace=l,d.useColors=r.useColors(),d.color=r.selectColor(l),d.extend=n,d.destroy=r.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(m!==r.namespaces&&(m=r.namespaces,f=r.enabled(l)),f),set:g=>{p=g}}),typeof r.init=="function"&&r.init(d),d}function n(l,h){let p=r(this.namespace+(typeof h>"u"?":":h)+l);return p.log=this.log,p}function o(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let h,p=(typeof l=="string"?l:"").split(/[\s,]+/),m=p.length;for(h=0;h<m;h++)!p[h]||(l=p[h].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.slice(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),l}function i(l){if(l[l.length-1]==="*")return!0;let h,p;for(h=0,p=r.skips.length;h<p;h++)if(r.skips[h].test(l))return!1;for(h=0,p=r.names.length;h<p;h++)if(r.names[h].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}ID.exports=EY});var ao=k((pn,fm)=>{pn.formatArgs=SY;pn.save=AY;pn.load=CY;pn.useColors=vY;pn.storage=TY();pn.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();pn.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function vY(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function SY(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+fm.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(r++,o==="%c"&&(n=r))}),t.splice(n,0,e)}pn.log=console.debug||console.log||(()=>{});function AY(t){try{t?pn.storage.setItem("debug",t):pn.storage.removeItem("debug")}catch{}}function CY(){let t;try{t=pn.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function TY(){try{return localStorage}catch{}}fm.exports=DD()(pn);var{formatters:_Y}=fm.exports;_Y.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var nR=k((S3e,rR)=>{"use strict";rR.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var uR=k((aR,cR)=>{"use strict";var ym=nR(),{hasOwnProperty:sR}=Object.prototype,{propertyIsEnumerable:zQ}=Object,mu=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),$Q=aR,oR={concatArrays:!1,ignoreUndefined:!1},bm=t=>{let e=[];for(let r in t)sR.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let n of r)zQ.call(t,n)&&e.push(n)}return e};function gu(t){return Array.isArray(t)?KQ(t):ym(t)?qQ(t):t}function KQ(t){let e=t.slice(0,0);return bm(t).forEach(r=>{mu(e,r,gu(t[r]))}),e}function qQ(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return bm(t).forEach(r=>{mu(e,r,gu(t[r]))}),e}var iR=(t,e,r,n)=>(r.forEach(o=>{typeof e[o]>"u"&&n.ignoreUndefined||(o in t&&t[o]!==Object.getPrototypeOf(t)?mu(t,o,Gx(t[o],e[o],n)):mu(t,o,gu(e[o])))}),t),HQ=(t,e,r)=>{let n=t.slice(0,0),o=0;return[t,e].forEach(s=>{let i=[];for(let a=0;a<s.length;a++)!sR.call(s,a)||(i.push(String(a)),s===t?mu(n,o++,s[a]):mu(n,o++,gu(s[a])));n=iR(n,s,bm(s).filter(a=>!i.includes(a)),r)}),n};function Gx(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?HQ(t,e,r):!ym(e)||!ym(t)?gu(e):iR(t,e,bm(e),r)}cR.exports=function(...t){let e=Gx(gu(oR),this!==$Q&&this||{},oR),r={_:{}};for(let n of t)if(n!==void 0){if(!ym(n))throw new TypeError("`"+n+"` is not an Option Object");r=Gx(r,{_:n},e)}return r._}});var hR=k((C3e,fR)=>{"use strict";function GQ(t){return t>=55296&&t<=56319}function WQ(t){return t>=56320&&t<=57343}fR.exports=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var o=r.length,s=0,i,a,c=0;c<o;c+=1){if(i=r.charCodeAt(c),a=r[c],GQ(i)&&WQ(r.charCodeAt(c+1))&&(c+=1,a+=r[c]),s+=e(a),s===n)return r.slice(0,c+1);if(s>n)return r.slice(0,c-a.length+1)}return r}});var pR=k((T3e,dR)=>{"use strict";function jQ(t){return t>=55296&&t<=56319}function YQ(t){return t>=56320&&t<=57343}dR.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,o=null,s=null,i=0;i<r;i++)o=e.charCodeAt(i),YQ(o)?s!=null&&jQ(s)?n+=1:n+=3:o<=127?n+=1:o>=128&&o<=2047?n+=2:o>=2048&&o<=65535&&(n+=3),s=o;return n}});var gR=k((_3e,mR)=>{"use strict";var QQ=hR(),XQ=pR();mR.exports=QQ.bind(null,XQ)});var wR=k((I3e,bR)=>{"use strict";var JQ=gR(),ZQ=/[\/\?<>\\:\*\|"]/g,eX=/[\x00-\x1f\x80-\x9f]/g,tX=/^\.+$/,rX=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,nX=/[\. ]+$/;function yR(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(ZQ,e).replace(eX,e).replace(tX,e).replace(rX,e).replace(nX,e);return JQ(r,255)}bR.exports=function(t,e){var r=e&&e.replacement||"",n=yR(t,r);return r===""?n:yR(n,"")}});var tP=k((eRe,xE)=>{"use strict";var Sne=Object.prototype.hasOwnProperty,$r="~";function Td(){}Object.create&&(Td.prototype=Object.create(null),new Td().__proto__||($r=!1));function Ane(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function eP(t,e,r,n,o){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new Ane(r,n||t,o),i=$r?$r+e:e;return t._events[i]?t._events[i].fn?t._events[i]=[t._events[i],s]:t._events[i].push(s):(t._events[i]=s,t._eventsCount++),t}function Nm(t,e){--t._eventsCount===0?t._events=new Td:delete t._events[e]}function Lr(){this._events=new Td,this._eventsCount=0}Lr.prototype.eventNames=function(){var e=[],r,n;if(this._eventsCount===0)return e;for(n in r=this._events)Sne.call(r,n)&&e.push($r?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};Lr.prototype.listeners=function(e){var r=$r?$r+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,s=n.length,i=new Array(s);o<s;o++)i[o]=n[o].fn;return i};Lr.prototype.listenerCount=function(e){var r=$r?$r+e:e,n=this._events[r];return n?n.fn?1:n.length:0};Lr.prototype.emit=function(e,r,n,o,s,i){var a=$r?$r+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,n),!0;case 4:return c.fn.call(c.context,r,n,o),!0;case 5:return c.fn.call(c.context,r,n,o,s),!0;case 6:return c.fn.call(c.context,r,n,o,s,i),!0}for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var p=c.length,m;for(h=0;h<p;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),u){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,r);break;case 3:c[h].fn.call(c[h].context,r,n);break;case 4:c[h].fn.call(c[h].context,r,n,o);break;default:if(!l)for(m=1,l=new Array(u-1);m<u;m++)l[m-1]=arguments[m];c[h].fn.apply(c[h].context,l)}}return!0};Lr.prototype.on=function(e,r,n){return eP(this,e,r,n,!1)};Lr.prototype.once=function(e,r,n){return eP(this,e,r,n,!0)};Lr.prototype.removeListener=function(e,r,n,o){var s=$r?$r+e:e;if(!this._events[s])return this;if(!r)return Nm(this,s),this;var i=this._events[s];if(i.fn)i.fn===r&&(!o||i.once)&&(!n||i.context===n)&&Nm(this,s);else{for(var a=0,c=[],u=i.length;a<u;a++)(i[a].fn!==r||o&&!i[a].once||n&&i[a].context!==n)&&c.push(i[a]);c.length?this._events[s]=c.length===1?c[0]:c:Nm(this,s)}return this};Lr.prototype.removeAllListeners=function(e){var r;return e?(r=$r?$r+e:e,this._events[r]&&Nm(this,r)):(this._events=new Td,this._eventsCount=0),this};Lr.prototype.off=Lr.prototype.removeListener;Lr.prototype.addListener=Lr.prototype.on;Lr.prefixed=$r;Lr.EventEmitter=Lr;typeof xE<"u"&&(xE.exports=Lr)});var og=k((bPe,YP)=>{"use strict";function jP(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Coe(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return jP(t,r)}catch{r.message=t.message,r.stack=t.stack;let o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(t)),jP(new o,r)}}YP.exports=Coe});var tN=k(Ud=>{(function(){var t,e,r,n,o,s,i,a;a=function(c){var u,l,h,p;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,h=(c&255<<8)>>>8,p=c&255,[u,l,h,p].join(".")},i=function(c){var u,l,h,p,m,f;for(u=[],h=p=0;p<=3&&c.length!==0;h=++p){if(h>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}f=e(c),m=f[0],l=f[1],c=c.substring(l),u.push(m)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},r=function(c){return c.charCodeAt(0)},n=r("0"),s=r("a"),o=r("A"),e=function(c){var u,l,h,p,m;for(p=0,u=10,l="9",h=0,c.length>1&&c[h]==="0"&&(c[h+1]==="x"||c[h+1]==="X"?(h+=2,u=16):"0"<=c[h+1]&&c[h+1]<="9"&&(h++,u=8,l="7")),m=h;h<c.length;){if("0"<=c[h]&&c[h]<=l)p=p*u+(r(c[h])-n)>>>0;else if(u===16)if("a"<=c[h]&&c[h]<="f")p=p*u+(10+r(c[h])-s)>>>0;else if("A"<=c[h]&&c[h]<="F")p=p*u+(10+r(c[h])-o)>>>0;else break;else break;if(p>4294967295)throw new Error("too large");h++}if(h===m)throw new Error("empty octet");return[p,h]},t=function(){function c(u,l){var h,p,m,f;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(f=u.split("/",2),u=f[0],l=f[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=i(l)}catch(d){throw h=d,new Error("Invalid mask: "+l)}for(p=m=32;m>=0;p=--m)if(this.maskLong===4294967295<<32-p>>>0){this.bitmask=p;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(i(u)&this.maskLong)>>>0}catch(d){throw h=d,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(i(u)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,h,p;for(p=i(this.first),h=i(this.last),l=0;p<=h;)u(a(p),p,l),l++,p++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),Ud.ip2long=i,Ud.long2ip=a,Ud.Netmask=t}).call(Ud)});var sN=k((oN,cg)=>{(function(t){"use strict";let e="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${e}\\.${e}\\.${e}\\.${e}$`,"i"),threeOctet:new RegExp(`^${e}\\.${e}\\.${e}$`,"i"),twoOctet:new RegExp(`^${e}\\.${e}$`,"i"),longValue:new RegExp(`^${e}$`,"i")},n=new RegExp("^0[0-7]+$","i"),o=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",i="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${i})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${e}\\.${e}\\.${e}\\.${e}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${i})|(?:::)(?:${i})?)${e}\\.${e}\\.${e}\\.${e}(${s})?$`,"i")};function c(m,f){if(m.indexOf("::")!==m.lastIndexOf("::"))return null;let d=0,g=-1,y=(m.match(a.zoneIndex)||[])[0],b,w;for(y&&(y=y.substring(1),m=m.replace(/%.+$/,""));(g=m.indexOf(":",g+1))>=0;)d++;if(m.substr(0,2)==="::"&&d--,m.substr(-2,2)==="::"&&d--,d>f)return null;for(w=f-d,b=":";w--;)b+="0:";return m=m.replace("::",b),m[0]===":"&&(m=m.slice(1)),m[m.length-1]===":"&&(m=m.slice(0,-1)),f=function(){let x=m.split(":"),E=[];for(let S=0;S<x.length;S++)E.push(parseInt(x[S],16));return E}(),{parts:f,zoneId:y}}function u(m,f,d,g){if(m.length!==f.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let y=0,b;for(;g>0;){if(b=d-g,b<0&&(b=0),m[y]>>b!==f[y]>>b)return!1;g-=d,y+=1}return!0}function l(m){if(o.test(m))return parseInt(m,16);if(m[0]==="0"&&!isNaN(parseInt(m[1],10))){if(n.test(m))return parseInt(m,8);throw new Error(`ipaddr: cannot parse ${m} as octal`)}return parseInt(m,10)}function h(m,f){for(;m.length<f;)m=`0${m}`;return m}let p={};p.IPv4=function(){function m(f){if(f.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let d,g;for(d=0;d<f.length;d++)if(g=f[d],!(0<=g&&g<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=f}return m.prototype.SpecialRanges={unspecified:[[new m([0,0,0,0]),8]],broadcast:[[new m([255,255,255,255]),32]],multicast:[[new m([224,0,0,0]),4]],linkLocal:[[new m([169,254,0,0]),16]],loopback:[[new m([127,0,0,0]),8]],carrierGradeNat:[[new m([100,64,0,0]),10]],private:[[new m([10,0,0,0]),8],[new m([172,16,0,0]),12],[new m([192,168,0,0]),16]],reserved:[[new m([192,0,0,0]),24],[new m([192,0,2,0]),24],[new m([192,88,99,0]),24],[new m([198,18,0,0]),15],[new m([198,51,100,0]),24],[new m([203,0,113,0]),24],[new m([240,0,0,0]),4]]},m.prototype.kind=function(){return"ipv4"},m.prototype.match=function(f,d){let g;if(d===void 0&&(g=f,f=g[0],d=g[1]),f.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,f.octets,8,d)},m.prototype.prefixLengthFromSubnetMask=function(){let f=0,d=!1,g={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},y,b,w;for(y=3;y>=0;y-=1)if(b=this.octets[y],b in g){if(w=g[b],d&&w!==0)return null;w!==8&&(d=!0),f+=w}else return null;return 32-f},m.prototype.range=function(){return p.subnetMatch(this,this.SpecialRanges)},m.prototype.toByteArray=function(){return this.octets.slice(0)},m.prototype.toIPv4MappedAddress=function(){return p.IPv6.parse(`::ffff:${this.toString()}`)},m.prototype.toNormalizedString=function(){return this.toString()},m.prototype.toString=function(){return this.octets.join(".")},m}(),p.IPv4.broadcastAddressFromCIDR=function(m){try{let f=this.parseCIDR(m),d=f[0].toByteArray(),g=this.subnetMaskFromPrefixLength(f[1]).toByteArray(),y=[],b=0;for(;b<4;)y.push(parseInt(d[b],10)|parseInt(g[b],10)^255),b++;return new this(y)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},p.IPv4.isIPv4=function(m){return this.parser(m)!==null},p.IPv4.isValid=function(m){try{return new this(this.parser(m)),!0}catch{return!1}},p.IPv4.isValidFourPartDecimal=function(m){return!!(p.IPv4.isValid(m)&&m.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},p.IPv4.networkAddressFromCIDR=function(m){let f,d,g,y,b;try{for(f=this.parseCIDR(m),g=f[0].toByteArray(),b=this.subnetMaskFromPrefixLength(f[1]).toByteArray(),y=[],d=0;d<4;)y.push(parseInt(g[d],10)&parseInt(b[d],10)),d++;return new this(y)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},p.IPv4.parse=function(m){let f=this.parser(m);if(f===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(f)},p.IPv4.parseCIDR=function(m){let f;if(f=m.match(/^(.+)\/(\d+)$/)){let d=parseInt(f[2]);if(d>=0&&d<=32){let g=[this.parse(f[1]),d];return Object.defineProperty(g,"toString",{value:function(){return this.join("/")}}),g}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},p.IPv4.parser=function(m){let f,d,g;if(f=m.match(r.fourOctet))return function(){let y=f.slice(1,6),b=[];for(let w=0;w<y.length;w++)d=y[w],b.push(l(d));return b}();if(f=m.match(r.longValue)){if(g=l(f[1]),g>4294967295||g<0)throw new Error("ipaddr: address outside defined range");return function(){let y=[],b;for(b=0;b<=24;b+=8)y.push(g>>b&255);return y}().reverse()}else return(f=m.match(r.twoOctet))?function(){let y=f.slice(1,4),b=[];if(g=l(y[1]),g>16777215||g<0)throw new Error("ipaddr: address outside defined range");return b.push(l(y[0])),b.push(g>>16&255),b.push(g>>8&255),b.push(g&255),b}():(f=m.match(r.threeOctet))?function(){let y=f.slice(1,5),b=[];if(g=l(y[2]),g>65535||g<0)throw new Error("ipaddr: address outside defined range");return b.push(l(y[0])),b.push(l(y[1])),b.push(g>>8&255),b.push(g&255),b}():null},p.IPv4.subnetMaskFromPrefixLength=function(m){if(m=parseInt(m),m<0||m>32)throw new Error("ipaddr: invalid IPv4 prefix length");let f=[0,0,0,0],d=0,g=Math.floor(m/8);for(;d<g;)f[d]=255,d++;return g<4&&(f[g]=Math.pow(2,m%8)-1<<8-m%8),new this(f)},p.IPv6=function(){function m(f,d){let g,y;if(f.length===16)for(this.parts=[],g=0;g<=14;g+=2)this.parts.push(f[g]<<8|f[g+1]);else if(f.length===8)this.parts=f;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(g=0;g<this.parts.length;g++)if(y=this.parts[g],!(0<=y&&y<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");d&&(this.zoneId=d)}return m.prototype.SpecialRanges={unspecified:[new m([0,0,0,0,0,0,0,0]),128],linkLocal:[new m([65152,0,0,0,0,0,0,0]),10],multicast:[new m([65280,0,0,0,0,0,0,0]),8],loopback:[new m([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new m([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new m([0,0,0,0,0,65535,0,0]),96],rfc6145:[new m([0,0,0,0,65535,0,0,0]),96],rfc6052:[new m([100,65435,0,0,0,0,0,0]),96],"6to4":[new m([8194,0,0,0,0,0,0,0]),16],teredo:[new m([8193,0,0,0,0,0,0,0]),32],reserved:[[new m([8193,3512,0,0,0,0,0,0]),32]],benchmarking:[new m([8193,2,0,0,0,0,0,0]),48],amt:[new m([8193,3,0,0,0,0,0,0]),32],as112v6:[new m([8193,4,274,0,0,0,0,0]),48],deprecated:[new m([8193,16,0,0,0,0,0,0]),28],orchid2:[new m([8193,32,0,0,0,0,0,0]),28]},m.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},m.prototype.kind=function(){return"ipv6"},m.prototype.match=function(f,d){let g;if(d===void 0&&(g=f,f=g[0],d=g[1]),f.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,f.parts,16,d)},m.prototype.prefixLengthFromSubnetMask=function(){let f=0,d=!1,g={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},y,b;for(let w=7;w>=0;w-=1)if(y=this.parts[w],y in g){if(b=g[y],d&&b!==0)return null;b!==16&&(d=!0),f+=b}else return null;return 128-f},m.prototype.range=function(){return p.subnetMatch(this,this.SpecialRanges)},m.prototype.toByteArray=function(){let f,d=[],g=this.parts;for(let y=0;y<g.length;y++)f=g[y],d.push(f>>8),d.push(f&255);return d},m.prototype.toFixedLengthString=function(){let f=function(){let g=[];for(let y=0;y<this.parts.length;y++)g.push(h(this.parts[y].toString(16),4));return g}.call(this).join(":"),d="";return this.zoneId&&(d=`%${this.zoneId}`),f+d},m.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let f=this.parts.slice(-2),d=f[0],g=f[1];return new p.IPv4([d>>8,d&255,g>>8,g&255])},m.prototype.toNormalizedString=function(){let f=function(){let g=[];for(let y=0;y<this.parts.length;y++)g.push(this.parts[y].toString(16));return g}.call(this).join(":"),d="";return this.zoneId&&(d=`%${this.zoneId}`),f+d},m.prototype.toRFC5952String=function(){let f=/((^|:)(0(:|$)){2,})/g,d=this.toNormalizedString(),g=0,y=-1,b;for(;b=f.exec(d);)b[0].length>y&&(g=b.index,y=b[0].length);return y<0?d:`${d.substring(0,g)}::${d.substring(g+y)}`},m.prototype.toString=function(){return this.toRFC5952String()},m}(),p.IPv6.broadcastAddressFromCIDR=function(m){try{let f=this.parseCIDR(m),d=f[0].toByteArray(),g=this.subnetMaskFromPrefixLength(f[1]).toByteArray(),y=[],b=0;for(;b<16;)y.push(parseInt(d[b],10)|parseInt(g[b],10)^255),b++;return new this(y)}catch(f){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${f})`)}},p.IPv6.isIPv6=function(m){return this.parser(m)!==null},p.IPv6.isValid=function(m){if(typeof m=="string"&&m.indexOf(":")===-1)return!1;try{let f=this.parser(m);return new this(f.parts,f.zoneId),!0}catch{return!1}},p.IPv6.networkAddressFromCIDR=function(m){let f,d,g,y,b;try{for(f=this.parseCIDR(m),g=f[0].toByteArray(),b=this.subnetMaskFromPrefixLength(f[1]).toByteArray(),y=[],d=0;d<16;)y.push(parseInt(g[d],10)&parseInt(b[d],10)),d++;return new this(y)}catch(w){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${w})`)}},p.IPv6.parse=function(m){let f=this.parser(m);if(f.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(f.parts,f.zoneId)},p.IPv6.parseCIDR=function(m){let f,d,g;if((d=m.match(/^(.+)\/(\d+)$/))&&(f=parseInt(d[2]),f>=0&&f<=128))return g=[this.parse(d[1]),f],Object.defineProperty(g,"toString",{value:function(){return this.join("/")}}),g;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},p.IPv6.parser=function(m){let f,d,g,y,b,w;if(g=m.match(a.deprecatedTransitional))return this.parser(`::ffff:${g[1]}`);if(a.native.test(m))return c(m,8);if((g=m.match(a.transitional))&&(w=g[6]||"",f=c(g[1].slice(0,-1)+w,6),f.parts)){for(b=[parseInt(g[2]),parseInt(g[3]),parseInt(g[4]),parseInt(g[5])],d=0;d<b.length;d++)if(y=b[d],!(0<=y&&y<=255))return null;return f.parts.push(b[0]<<8|b[1]),f.parts.push(b[2]<<8|b[3]),{parts:f.parts,zoneId:f.zoneId}}return null},p.IPv6.subnetMaskFromPrefixLength=function(m){if(m=parseInt(m),m<0||m>128)throw new Error("ipaddr: invalid IPv6 prefix length");let f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=0,g=Math.floor(m/8);for(;d<g;)f[d]=255,d++;return g<16&&(f[g]=Math.pow(2,m%8)-1<<8-m%8),new this(f)},p.fromByteArray=function(m){let f=m.length;if(f===4)return new p.IPv4(m);if(f===16)return new p.IPv6(m);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},p.isValid=function(m){return p.IPv6.isValid(m)||p.IPv4.isValid(m)},p.parse=function(m){if(p.IPv6.isValid(m))return p.IPv6.parse(m);if(p.IPv4.isValid(m))return p.IPv4.parse(m);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},p.parseCIDR=function(m){try{return p.IPv6.parseCIDR(m)}catch{try{return p.IPv4.parseCIDR(m)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},p.process=function(m){let f=this.parse(m);return f.kind()==="ipv6"&&f.isIPv4MappedAddress()?f.toIPv4Address():f},p.subnetMatch=function(m,f,d){let g,y,b,w;d==null&&(d="unicast");for(y in f)if(Object.prototype.hasOwnProperty.call(f,y)){for(b=f[y],b[0]&&!(b[0]instanceof Array)&&(b=[b]),g=0;g<b.length;g++)if(w=b[g],m.kind()===w[0].kind()&&m.match.apply(m,w))return y}return d},typeof cg<"u"&&cg.exports?cg.exports=p:t.ipaddr=p})(oN)});var tO=k((GOe,eO)=>{var Cl=1e3,Tl=Cl*60,_l=Tl*60,tc=_l*24,yie=tc*7,bie=tc*365.25;eO.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return wie(t);if(r==="number"&&isFinite(t))return e.long?Eie(t):xie(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function wie(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*bie;case"weeks":case"week":case"w":return r*yie;case"days":case"day":case"d":return r*tc;case"hours":case"hour":case"hrs":case"hr":case"h":return r*_l;case"minutes":case"minute":case"mins":case"min":case"m":return r*Tl;case"seconds":case"second":case"secs":case"sec":case"s":return r*Cl;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function xie(t){var e=Math.abs(t);return e>=tc?Math.round(t/tc)+"d":e>=_l?Math.round(t/_l)+"h":e>=Tl?Math.round(t/Tl)+"m":e>=Cl?Math.round(t/Cl)+"s":t+"ms"}function Eie(t){var e=Math.abs(t);return e>=tc?xg(t,e,tc,"day"):e>=_l?xg(t,e,_l,"hour"):e>=Tl?xg(t,e,Tl,"minute"):e>=Cl?xg(t,e,Cl,"second"):t+" ms"}function xg(t,e,r,n){var o=e>=r*1.5;return Math.round(t/r)+" "+n+(o?"s":"")}});var oO=k((WOe,nO)=>{"use strict";nO.exports=rO;var vie=tO(),Ji=rO.prototype,Sie=new Date%1e9;function Aie(){return(Math.random()*1e9>>>0)+Sie++}function rO(t){t=t||{},this.id=t.id||Aie(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,n=this.items.length;n--;)e=this.items[n],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}Ji.has=function(t){return t in this._lookup};Ji.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};Ji.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};Ji.set=function(t,e,r){var n=this._lookup[t],o=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,o)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(o),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(o.meta=r.meta),r.refresh&&(o.refresh=r.ttl)),this};Ji.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};Ji.expire=function(t,e){var r=e||0,n=this._lookup[t];if(!n)return this;if(typeof r=="string"&&(r=vie(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(n.timeout),n.timeout=setTimeout(this.delete.bind(this,n.key),r),n.expires=Number(new Date)+r,this};Ji.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};Ji.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var Kd=k((pUe,hO)=>{hO.exports=class{constructor(e={}){this.points=e.points,this.duration=e.duration,this.blockDuration=e.blockDuration,this.execEvenly=e.execEvenly,this.execEvenlyMinDelayMs=e.execEvenlyMinDelayMs,this.keyPrefix=e.keyPrefix}get points(){return this._points}set points(e){this._points=e>=0?e:4}get duration(){return this._duration}set duration(e){this._duration=typeof e>"u"?1:e}get msDuration(){return this.duration*1e3}get blockDuration(){return this._blockDuration}set blockDuration(e){this._blockDuration=typeof e>"u"?0:e}get msBlockDuration(){return this.blockDuration*1e3}get execEvenly(){return this._execEvenly}set execEvenly(e){this._execEvenly=typeof e>"u"?!1:Boolean(e)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(e){this._execEvenlyMinDelayMs=typeof e>"u"?Math.ceil(this.msDuration/this.points):e}get keyPrefix(){return this._keyPrefix}set keyPrefix(e){if(typeof e>"u"&&(e="rlflx"),typeof e!="string")throw new Error("keyPrefix must be string");this._keyPrefix=e}_getKeySecDuration(e={}){return e&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?`${this.keyPrefix}:${e}`:e}parseKey(e){return e.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}}});var pO=k((gUe,dO)=>{dO.exports=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){let e=Date.now();Object.keys(this._keys).forEach(r=>{this._keys[r]<=e&&delete this._keys[r]}),this._addedKeysAmount=Object.keys(this._keys).length}add(e,r){this.addMs(e,r*1e3)}addMs(e,r){this._keys[e]=Date.now()+r,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(e){let r=this._keys[e];if(r&&r>=Date.now()){this.collectExpired();let n=Date.now();return r>=n?r-n:0}return 0}delete(e){e?delete this._keys[e]:Object.keys(this._keys).forEach(r=>{delete this._keys[r]})}}});var gO=k((yUe,mO)=>{var Iie=pO();mO.exports=Iie});var Sn=k((wUe,yO)=>{yO.exports=class{constructor(e,r,n,o){this.remainingPoints=typeof e>"u"?0:e,this.msBeforeNext=typeof r>"u"?0:r,this.consumedPoints=typeof n>"u"?0:n,this.isFirstInDuration=typeof o>"u"?!1:o}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(e){return this._msBeforeNext=e,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(e){return this._remainingPoints=e,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(e){return this._consumedPoints=e,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(e){this._isFirstInDuration=Boolean(e)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}}});var Dl=k((EUe,wO)=>{var oS=Kd(),Die=gO(),bO=Sn();wO.exports=class extends oS{constructor(e={}){super(e),this.inMemoryBlockOnConsumed=e.inMemoryBlockOnConsumed,this.inMemoryBlockDuration=e.inMemoryBlockDuration,this.insuranceLimiter=e.insuranceLimiter,this._inMemoryBlockedKeys=new Die}get client(){return this._client}set client(e){if(typeof e>"u")throw new Error("storeClient is not set");this._client=e}_afterConsume(e,r,n,o,s,i={}){let a=this._getRateLimiterRes(n,o,s);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&a.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(n,a.msBeforeNext),a.consumedPoints>this.points?r(a):e(a);if(a.consumedPoints>this.points){let c=Promise.resolve();this.blockDuration>0&&a.consumedPoints<=this.points+o&&(a.msBeforeNext=this.msBlockDuration,c=this._block(n,a.consumedPoints,this.msBlockDuration,i)),this.inMemoryBlockOnConsumed>0&&a.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(n,this.inMemoryBlockDuration),a.msBeforeNext=this.msInMemoryBlockDuration),c.then(()=>{r(a)}).catch(u=>{r(u)})}else if(this.execEvenly&&a.msBeforeNext>0&&!a.isFirstInDuration){let c=Math.ceil(a.msBeforeNext/(a.remainingPoints+2));c<this.execEvenlyMinDelayMs&&(c=a.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(e,c,a)}else e(a)}_handleError(e,r,n,o,s,i=!1,a={}){this.insuranceLimiter instanceof oS?this.insuranceLimiter[r](s,i,a).then(c=>{n(c)}).catch(c=>{o(c)}):o(e)}getInMemoryBlockMsBeforeExpire(e){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(e):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(e){if(this._inMemoryBlockOnConsumed=e?parseInt(e):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(e){if(this._inMemoryBlockDuration=e?parseInt(e):0,this.inMemoryBlockDuration>0&&this.inMemoryBlockOnConsumed===0)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return this._inMemoryBlockDuration*1e3}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(e){if(typeof e<"u"&&!(e instanceof oS))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=e,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(e,r,n={}){let o=r*1e3;return this._block(this.getKey(e),this.points+1,o,n)}set(e,r,n,o={}){let s=(n>=0?n:this.duration)*1e3;return this._block(this.getKey(e),r,s,o)}consume(e,r=1,n={}){return new Promise((o,s)=>{let i=this.getKey(e),a=this.getInMemoryBlockMsBeforeExpire(i);if(a>0)return s(new bO(0,a));this._upsert(i,r,this._getKeySecDuration(n)*1e3,!1,n).then(c=>{this._afterConsume(o,s,i,r,c)}).catch(c=>{this._handleError(c,"consume",o,s,e,r,n)})})}penalty(e,r=1,n={}){let o=this.getKey(e);return new Promise((s,i)=>{this._upsert(o,r,this._getKeySecDuration(n)*1e3,!1,n).then(a=>{s(this._getRateLimiterRes(o,r,a))}).catch(a=>{this._handleError(a,"penalty",s,i,e,r,n)})})}reward(e,r=1,n={}){let o=this.getKey(e);return new Promise((s,i)=>{this._upsert(o,-r,this._getKeySecDuration(n)*1e3,!1,n).then(a=>{s(this._getRateLimiterRes(o,-r,a))}).catch(a=>{this._handleError(a,"reward",s,i,e,r,n)})})}get(e,r={}){let n=this.getKey(e);return new Promise((o,s)=>{this._get(n,r).then(i=>{o(i===null||typeof i>"u"?null:this._getRateLimiterRes(n,0,i))}).catch(i=>{this._handleError(i,"get",o,s,e,r)})})}delete(e,r={}){let n=this.getKey(e);return new Promise((o,s)=>{this._delete(n,r).then(i=>{this._inMemoryBlockedKeys.delete(n),o(i)}).catch(i=>{this._handleError(i,"delete",o,s,e,r)})})}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(e,r,n){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(e,r,n,o={}){return new Promise((s,i)=>{this._upsert(e,r,n,!0,o).then(()=>{s(new bO(0,n>0?n:-1,r))}).catch(a=>{this._handleError(a,"block",s,i,this.parseKey(e),n/1e3,o)})})}_get(e,r={}){throw new Error("You have to implement the method '_get'!")}_delete(e,r={}){throw new Error("You have to implement the method '_delete'!")}_upsert(e,r,n,o=!1,s={}){throw new Error("You have to implement the method '_upsert'!")}}});var EO=k((vUe,xO)=>{var Rie=Dl(),Lie=Sn(),sS="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ",iS=class extends Rie{constructor(e){super(e),this.client=e.storeClient,this._rejectIfRedisNotReady=!!e.rejectIfRedisNotReady,this.useRedisPackage=e.useRedisPackage,this.useRedis3AndLowerPackage=e.useRedis3AndLowerPackage,typeof this.client.defineCommand=="function"&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:sS})}_isRedisReady(){return this._rejectIfRedisNotReady?!(this.client.status&&this.client.status!=="ready"||typeof this.client.isReady=="function"&&!this.client.isReady()):!0}_getRateLimiterRes(e,r,n){let[o,s]=n;Array.isArray(o)&&([,o]=o,[,s]=s);let i=new Lie;return i.consumedPoints=parseInt(o),i.isFirstInDuration=i.consumedPoints===r,i.remainingPoints=Math.max(this.points-i.consumedPoints,0),i.msBeforeNext=s,i}async _upsert(e,r,n,o=!1){if(!this._isRedisReady())throw new Error("Redis connection is not ready");let s=Math.floor(n/1e3),i=this.client.multi();return o?(s>0?!this.useRedisPackage&&!this.useRedis3AndLowerPackage?i.set(e,r,"EX",s):i.set(e,r,{EX:s}):i.set(e,r),!this.useRedisPackage&&!this.useRedis3AndLowerPackage?i.pttl(e).exec(!0):i.pTTL(e).exec(!0)):s>0?!this.useRedisPackage&&!this.useRedis3AndLowerPackage?this.client.rlflxIncr([e].concat([String(r),String(s)])):this.useRedis3AndLowerPackage?new Promise((a,c)=>{let u=function(l,h){return l?c(l):a(h)};typeof this.client.rlflxIncr=="function"?this.client.rlflxIncr(e,r,s,u):this.client.eval(sS,1,e,r,s,u)}):this.client.eval(sS,{keys:[e],arguments:[String(r),String(s)]}):!this.useRedisPackage&&!this.useRedis3AndLowerPackage?i.incrby(e,r).pttl(e).exec(!0):i.incrBy(e,r).pTTL(e).exec(!0)}async _get(e){if(!this._isRedisReady())throw new Error("Redis connection is not ready");return!this.useRedisPackage&&!this.useRedis3AndLowerPackage?this.client.multi().get(e).pttl(e).exec().then(r=>{let[[,n]]=r;return n===null?null:r}):this.client.multi().get(e).pTTL(e).exec(!0).then(r=>{let[n]=r;return n===null?null:r})}_delete(e){return this.client.del(e).then(r=>r>0)}};xO.exports=iS});var AO=k((SUe,SO)=>{var Bie=Dl(),Pie=Sn();function vO(t){try{let e=t.client?t.client:t,{version:r}=e.topology.s.options.metadata.driver,n=r.split(".").map(o=>parseInt(o));return{major:n[0],feature:n[1],patch:n[2]}}catch{return{major:0,feature:0,patch:0}}}var qd=class extends Bie{constructor(e){super(e),this.dbName=e.dbName,this.tableName=e.tableName,this.indexKeyPrefix=e.indexKeyPrefix,e.mongo?this.client=e.mongo:this.client=e.storeClient,typeof this.client.then=="function"?this.client.then(r=>{this.client=r,this._initCollection(),this._driverVersion=vO(this.client)}):(this._initCollection(),this._driverVersion=vO(this.client))}get dbName(){return this._dbName}set dbName(e){this._dbName=typeof e>"u"?qd.getDbName():e}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(e){this._tableName=typeof e>"u"?this.keyPrefix:e}get client(){return this._client}set client(e){if(typeof e>"u")throw new Error("mongo is not set");this._client=e}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(e){this._indexKeyPrefix=e||{}}_initCollection(){let r=(typeof this.client.db=="function"?this.client.db(this.dbName):this.client).collection(this.tableName);r.createIndex({expire:-1},{expireAfterSeconds:0}),r.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=r}_getRateLimiterRes(e,r,n){let o=new Pie,s;return typeof n.value>"u"?s=n:s=n.value,o.isFirstInDuration=s.points===r,o.consumedPoints=s.points,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=s.expire!==null?Math.max(new Date(s.expire).getTime()-Date.now(),0):-1,o}_upsert(e,r,n,o=!1,s={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));let i=s.attrs||{},a,c;o?(a={key:e},a=Object.assign(a,i),c={$set:{key:e,points:r,expire:n>0?new Date(Date.now()+n):null}},c.$set=Object.assign(c.$set,i)):(a={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:e},a=Object.assign(a,i),c={$setOnInsert:{key:e,expire:n>0?new Date(Date.now()+n):null},$inc:{points:r}},c.$setOnInsert=Object.assign(c.$setOnInsert,i));let u={upsert:!0};return this._driverVersion.major>=4||this._driverVersion.major===3&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?u.returnDocument="after":u.returnOriginal=!1,new Promise((l,h)=>{this._collection.findOneAndUpdate(a,c,u).then(p=>{l(p)}).catch(p=>{if(p&&p.code===11e3){let m=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:e},i),f={$set:Object.assign({key:e,points:r,expire:n>0?new Date(Date.now()+n):null},i)};this._collection.findOneAndUpdate(m,f,u).then(d=>{l(d)}).catch(d=>{d&&d.code===11e3?this._upsert(e,r,n,o).then(g=>l(g)).catch(g=>h(g)):h(d)})}else h(p)})})}_get(e,r={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));let n=r.attrs||{},o=Object.assign({key:e,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},n);return this._collection.findOne(o)}_delete(e,r={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));let n=r.attrs||{},o=Object.assign({key:e},n);return this._collection.deleteOne(o).then(s=>s.deletedCount>0)}};SO.exports=qd});var TO=k((AUe,CO)=>{var Nie=Dl(),Oie=Sn(),aS=class extends Nie{constructor(e,r=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.dbName=e.dbName,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),typeof r=="function"&&r()):this._createDbAndTable().then(()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),typeof r=="function"&&r()}).catch(n=>{if(typeof r=="function")r(n);else throw n})}clearExpired(e){return new Promise(r=>{this._getConnection().then(n=>{n.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,e],()=>{this._releaseConnection(n),r()})}).catch(()=>{r()})})}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout(()=>{this.clearExpired(Date.now()-36e5).then(()=>{this._clearExpiredHourAgo()})},3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise((e,r)=>{this.client.getConnection((n,o)=>{if(n)return r(n);e(o)})});case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return e.release();case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);default:return!0}}_createDbAndTable(){return new Promise((e,r)=>{this._getConnection().then(n=>{n.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,o=>{if(o)return this._releaseConnection(n),r(o);n.query(this._getCreateTableStmt(),s=>{if(s)return this._releaseConnection(n),r(s);this._releaseConnection(n),e()})})}).catch(n=>{r(n)})})}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(e){if(typeof e>"u")if(this.client.constructor.name==="Connection")e="connection";else if(this.client.constructor.name==="Pool")e="pool";else if(this.client.constructor.name==="Sequelize")e="sequelize";else throw new Error("storeType is not defined");this._clientType=e.toLowerCase()}get dbName(){return this._dbName}set dbName(e){this._dbName=typeof e>"u"?"rtlmtrflx":e}get tableName(){return this._tableName}set tableName(e){this._tableName=typeof e>"u"?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=typeof e>"u"?!1:!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=typeof e>"u"?!0:Boolean(e)}_getRateLimiterRes(e,r,n){let o=new Oie,[s]=n;return o.isFirstInDuration=r===s.points,o.consumedPoints=o.isFirstInDuration?r:s.points,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=s.expire?Math.max(s.expire-Date.now(),0):-1,o}_upsertTransaction(e,r,n,o,s){return new Promise((i,a)=>{e.query("BEGIN",c=>{if(c)return e.rollback(),a(c);let u=Date.now(),l=o>0?u+o:null,h,p;s?(h=`INSERT INTO ??.?? VALUES (?, ?, ?)
          ON DUPLICATE KEY UPDATE 
            points = ?, 
            expire = ?;`,p=[this.dbName,this.tableName,r,n,l,n,l]):(h=`INSERT INTO ??.?? VALUES (?, ?, ?)
          ON DUPLICATE KEY UPDATE 
            points = IF(expire <= ?, ?, points + (?)), 
            expire = IF(expire <= ?, ?, expire);`,p=[this.dbName,this.tableName,r,n,l,u,n,n,u,l]),e.query(h,p,m=>{if(m)return e.rollback(),a(m);e.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,r],(f,d)=>{if(f)return e.rollback(),a(f);e.query("COMMIT",g=>{if(g)return e.rollback(),a(g);i(d)})})})})})}_upsert(e,r,n,o=!1){return this.tableCreated?new Promise((s,i)=>{this._getConnection().then(a=>{this._upsertTransaction(a,e,r,n,o).then(c=>{s(c),this._releaseConnection(a)}).catch(c=>{i(c),this._releaseConnection(a)})}).catch(a=>{i(a)})}):Promise.reject(Error("Table is not created yet"))}_get(e){return this.tableCreated?new Promise((r,n)=>{this._getConnection().then(o=>{o.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,e,Date.now()],(s,i)=>{s?n(s):i.length===0?r(null):r(i),this._releaseConnection(o)})}).catch(o=>{n(o)})}):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?new Promise((r,n)=>{this._getConnection().then(o=>{o.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,e],(s,i)=>{s?n(s):r(i.affectedRows>0),this._releaseConnection(o)})}).catch(o=>{n(o)})}):Promise.reject(Error("Table is not created yet"))}};CO.exports=aS});var IO=k((CUe,_O)=>{var Uie=Dl(),kie=Sn(),cS=class extends Uie{constructor(e,r=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?typeof r=="function"&&r():this._createTable().then(()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),typeof r=="function"&&r()}).catch(n=>{if(typeof r=="function")r(n);else throw n})}clearExpired(e){return new Promise(r=>{let n={name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[e]};this._query(n).then(()=>{r()}).catch(()=>{r()})})}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout(()=>{this.clearExpired(Date.now()-36e5).then(()=>{this._clearExpiredHourAgo()})},3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master);default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return!0;case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);case"typeorm":return!0;default:return!0}}_createTable(){return new Promise((e,r)=>{this._query({text:this._getCreateTableStmt()}).then(()=>{e()}).catch(n=>{n.code==="23505"?e():r(n)})})}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( 
      key varchar(255) PRIMARY KEY,
      points integer NOT NULL DEFAULT 0,
      expire bigint
    );`}get clientType(){return this._clientType}set clientType(e){let r=this.client.constructor.name;if(typeof e>"u")if(r==="Client")e="client";else if(r==="Pool"||r==="BoundPool")e="pool";else if(r==="Sequelize")e="sequelize";else throw new Error("storeType is not defined");this._clientType=e.toLowerCase()}get tableName(){return this._tableName}set tableName(e){this._tableName=typeof e>"u"?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=typeof e>"u"?!1:!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=typeof e>"u"?!0:Boolean(e)}_getRateLimiterRes(e,r,n){let o=new kie,s=n.rows[0];return o.isFirstInDuration=r===s.points,o.consumedPoints=o.isFirstInDuration?r:s.points,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=s.expire?Math.max(s.expire-Date.now(),0):-1,o}_query(e){let n={name:`${this.tableName.toLowerCase()}:${e.name}`,text:e.text,values:e.values};return new Promise((o,s)=>{this._getConnection().then(i=>{i.query(n).then(a=>{o(a),this._releaseConnection(i)}).catch(a=>{s(a),this._releaseConnection(i)})}).catch(i=>{s(i)})})}_upsert(e,r,n,o=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));let s=n>0?Date.now()+n:null,i=o?" $3 ":` CASE
             WHEN ${this.tableName}.expire <= $4 THEN $3
             ELSE ${this.tableName}.expire
            END `;return this._query({name:o?"rlflx-upsert-force":"rlflx-upsert",text:`
            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)
              ON CONFLICT(key) DO UPDATE SET
                points = CASE
                          WHEN (${this.tableName}.expire <= $4 OR 1=${o?1:0}) THEN $2
                          ELSE ${this.tableName}.points + ($2)
                         END,
                expire = ${i}
            RETURNING points, expire;`,values:[e,r,s,Date.now()]})}_get(e){return this.tableCreated?new Promise((r,n)=>{this._query({name:"rlflx-get",text:`
            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[e,Date.now()]}).then(o=>{o.rowCount===0&&(o=null),r(o)}).catch(o=>{n(o)})}):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[e]}).then(r=>r.rowCount>0):Promise.reject(Error("Table is not created yet"))}};_O.exports=cS});var DO=k(()=>{});var LO=k((DUe,RO)=>{RO.exports=class{constructor(e,r,n=null){this.value=e,this.expiresAt=r,this.timeoutId=n}get value(){return this._value}set value(e){this._value=parseInt(e)}get expiresAt(){return this._expiresAt}set expiresAt(e){!(e instanceof Date)&&Number.isInteger(e)&&(e=new Date(e)),this._expiresAt=e}get timeoutId(){return this._timeoutId}set timeoutId(e){this._timeoutId=e}}});var PO=k((LUe,BO)=>{var Mie=LO(),uS=Sn();BO.exports=class{constructor(){this._storage={}}incrby(e,r,n){if(this._storage[e]){let o=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-new Date().getTime():-1;return o!==0?(this._storage[e].value=this._storage[e].value+r,new uS(0,o,this._storage[e].value,!1)):this.set(e,r,n)}return this.set(e,r,n)}set(e,r,n){let o=n*1e3;return this._storage[e]&&this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),this._storage[e]=new Mie(r,o>0?new Date(Date.now()+o):null),o>0&&(this._storage[e].timeoutId=setTimeout(()=>{delete this._storage[e]},o),this._storage[e].timeoutId.unref&&this._storage[e].timeoutId.unref()),new uS(0,o===0?-1:o,this._storage[e].value,!0)}get(e){if(this._storage[e]){let r=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-new Date().getTime():-1;return new uS(0,r,this._storage[e].value,!1)}return null}delete(e){return this._storage[e]?(this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),delete this._storage[e],!0):!1}}});var fS=k((BUe,OO)=>{var Fie=Kd(),Vie=PO(),NO=Sn(),lS=class extends Fie{constructor(e={}){super(e),this._memoryStorage=new Vie}consume(e,r=1,n={}){return new Promise((o,s)=>{let i=this.getKey(e),a=this._getKeySecDuration(n),c=this._memoryStorage.incrby(i,r,a);if(c.remainingPoints=Math.max(this.points-c.consumedPoints,0),c.consumedPoints>this.points)this.blockDuration>0&&c.consumedPoints<=this.points+r&&(c=this._memoryStorage.set(i,c.consumedPoints,this.blockDuration)),s(c);else if(this.execEvenly&&c.msBeforeNext>0&&!c.isFirstInDuration){let u=Math.ceil(c.msBeforeNext/(c.remainingPoints+2));u<this.execEvenlyMinDelayMs&&(u=c.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(o,u,c)}else o(c)})}penalty(e,r=1,n={}){let o=this.getKey(e);return new Promise(s=>{let i=this._getKeySecDuration(n),a=this._memoryStorage.incrby(o,r,i);a.remainingPoints=Math.max(this.points-a.consumedPoints,0),s(a)})}reward(e,r=1,n={}){let o=this.getKey(e);return new Promise(s=>{let i=this._getKeySecDuration(n),a=this._memoryStorage.incrby(o,-r,i);a.remainingPoints=Math.max(this.points-a.consumedPoints,0),s(a)})}block(e,r){let n=r*1e3,o=this.points+1;return this._memoryStorage.set(this.getKey(e),o,r),Promise.resolve(new NO(0,n===0?-1:n,o))}set(e,r,n){let o=(n>=0?n:this.duration)*1e3;return this._memoryStorage.set(this.getKey(e),r,n),Promise.resolve(new NO(0,o===0?-1:o,r))}get(e){let r=this._memoryStorage.get(this.getKey(e));return r!==null&&(r.remainingPoints=Math.max(this.points-r.consumedPoints,0)),Promise.resolve(r)}delete(e){return Promise.resolve(this._memoryStorage.delete(this.getKey(e)))}};OO.exports=lS});var $O=k((PUe,zO)=>{var UO=DO(),zie=ph(),$ie=Kd(),MO=fS(),Kie=Sn(),Hn="rate_limiter_flexible",Bl=null,kO=function(t,e,r,n){let o;n===null||n===!0||n===!1?o=n:o={remainingPoints:n.remainingPoints,msBeforeNext:n.msBeforeNext,consumedPoints:n.consumedPoints,isFirstInDuration:n.isFirstInDuration},t.send({channel:Hn,keyPrefix:e.keyPrefix,promiseId:e.promiseId,type:r,data:o})},FO=function(t){setTimeout(()=>{this._initiated?process.send(t):typeof this._promises[t.promiseId]<"u"&&FO.call(this,t)},30)},Rl=function(t,e,r,n,o){let s={channel:Hn,keyPrefix:this.keyPrefix,func:t,promiseId:e,data:{key:r,arg:n,opts:o}};this._initiated?process.send(s):FO.call(this,s)},VO=function(t,e){if(!e||e.channel!==Hn||typeof this._rateLimiters[e.keyPrefix]>"u")return!1;let r;switch(e.func){case"consume":r=this._rateLimiters[e.keyPrefix].consume(e.data.key,e.data.arg,e.data.opts);break;case"penalty":r=this._rateLimiters[e.keyPrefix].penalty(e.data.key,e.data.arg,e.data.opts);break;case"reward":r=this._rateLimiters[e.keyPrefix].reward(e.data.key,e.data.arg,e.data.opts);break;case"block":r=this._rateLimiters[e.keyPrefix].block(e.data.key,e.data.arg,e.data.opts);break;case"get":r=this._rateLimiters[e.keyPrefix].get(e.data.key,e.data.opts);break;case"delete":r=this._rateLimiters[e.keyPrefix].delete(e.data.key,e.data.opts);break;default:return!1}r&&r.then(n=>{kO(t,e,"resolve",n)}).catch(n=>{kO(t,e,"reject",n)})},qie=function(t){if(!t||t.channel!==Hn||t.keyPrefix!==this.keyPrefix)return!1;if(this._promises[t.promiseId]){clearTimeout(this._promises[t.promiseId].timeoutId);let e;switch(t.data===null||t.data===!0||t.data===!1?e=t.data:e=new Kie(t.data.remainingPoints,t.data.msBeforeNext,t.data.consumedPoints,t.data.isFirstInDuration),t.type){case"resolve":this._promises[t.promiseId].resolve(e);break;case"reject":this._promises[t.promiseId].reject(e);break;default:throw new Error(`RateLimiterCluster: no such message type '${t.type}'`)}delete this._promises[t.promiseId]}},Hie=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},Ll=function(t,e){let r=process.hrtime(),n=r[0].toString()+r[1].toString();return typeof this._promises[n]<"u"&&(n+=zie.randomBytes(12).toString("base64")),this._promises[n]={resolve:t,reject:e,timeoutId:setTimeout(()=>{delete this._promises[n],e(new Error("RateLimiterCluster timeout: no answer from master in time"))},this.timeoutMs)},n},hS=class{constructor(){if(Bl)return Bl;this._rateLimiters={},UO.setMaxListeners(0),UO.on("message",(e,r)=>{r&&r.channel===Hn&&r.type==="init"?(typeof this._rateLimiters[r.opts.keyPrefix]>"u"&&(this._rateLimiters[r.opts.keyPrefix]=new MO(r.opts)),e.send({channel:Hn,type:"init",keyPrefix:r.opts.keyPrefix})):VO.call(this,e,r)}),Bl=this}},dS=class{constructor(e){if(Bl)return Bl;this._rateLimiters={},e.launchBus((r,n)=>{n.on("process:msg",o=>{let s=o.raw;if(s&&s.channel===Hn&&s.type==="init")typeof this._rateLimiters[s.opts.keyPrefix]>"u"&&(this._rateLimiters[s.opts.keyPrefix]=new MO(s.opts)),e.sendDataToProcessId(o.process.pm_id,{data:{},topic:Hn,channel:Hn,type:"init",keyPrefix:s.opts.keyPrefix},(i,a)=>{i&&console.log(i,a)});else{let i={send:a=>{let c=a;c.topic=Hn,typeof c.data>"u"&&(c.data={}),e.sendDataToProcessId(o.process.pm_id,c,(u,l)=>{u&&console.log(u,l)})}};VO.call(this,i,s)}})}),Bl=this}},pS=class extends $ie{get timeoutMs(){return this._timeoutMs}set timeoutMs(e){this._timeoutMs=typeof e>"u"?5e3:Math.abs(parseInt(e))}constructor(e={}){super(e),process.setMaxListeners(0),this.timeoutMs=e.timeoutMs,this._initiated=!1,process.on("message",r=>{r&&r.channel===Hn&&r.type==="init"&&r.keyPrefix===this.keyPrefix?this._initiated=!0:qie.call(this,r)}),process.send({channel:Hn,type:"init",opts:Hie.call(this)}),this._promises={}}consume(e,r=1,n={}){return new Promise((o,s)=>{let i=Ll.call(this,o,s);Rl.call(this,"consume",i,e,r,n)})}penalty(e,r=1,n={}){return new Promise((o,s)=>{let i=Ll.call(this,o,s);Rl.call(this,"penalty",i,e,r,n)})}reward(e,r=1,n={}){return new Promise((o,s)=>{let i=Ll.call(this,o,s);Rl.call(this,"reward",i,e,r,n)})}block(e,r,n={}){return new Promise((o,s)=>{let i=Ll.call(this,o,s);Rl.call(this,"block",i,e,r,n)})}get(e,r={}){return new Promise((n,o)=>{let s=Ll.call(this,n,o);Rl.call(this,"get",s,e,r)})}delete(e,r={}){return new Promise((n,o)=>{let s=Ll.call(this,n,o);Rl.call(this,"delete",s,e,r)})}};zO.exports={RateLimiterClusterMaster:hS,RateLimiterClusterMasterPM2:dS,RateLimiterCluster:pS}});var qO=k((NUe,KO)=>{var Gie=Dl(),Wie=Sn(),mS=class extends Gie{constructor(e){super(e),this.client=e.storeClient}_getRateLimiterRes(e,r,n){let o=new Wie;return o.consumedPoints=parseInt(n.consumedPoints),o.isFirstInDuration=n.consumedPoints===r,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=n.msBeforeNext,o}_upsert(e,r,n,o=!1,s={}){return new Promise((i,a)=>{let c=Date.now(),u=Math.floor(n/1e3);o?this.client.set(e,r,u,l=>{l?a(l):this.client.set(`${e}_expire`,u>0?c+u*1e3:-1,u,()=>{let h={consumedPoints:r,msBeforeNext:u>0?u*1e3:-1};i(h)})}):this.client.incr(e,r,(l,h)=>{l||h===!1?this.client.add(e,r,u,(p,m)=>{if(p||!m)if(typeof s.attemptNumber>"u"||s.attemptNumber<3){let f=Object.assign({},s);f.attemptNumber=f.attemptNumber?f.attemptNumber+1:1,this._upsert(e,r,n,o,f).then(d=>i(d)).catch(d=>a(d))}else a(new Error("Can not add key"));else this.client.add(`${e}_expire`,u>0?c+u*1e3:-1,u,()=>{let f={consumedPoints:r,msBeforeNext:u>0?u*1e3:-1};i(f)})}):this.client.get(`${e}_expire`,(p,m)=>{if(p)a(p);else{let f=m===!1?0:m,d={consumedPoints:h,msBeforeNext:f>=0?Math.max(f-c,0):-1};i(d)}})})})}_get(e){return new Promise((r,n)=>{let o=Date.now();this.client.get(e,(s,i)=>{i?this.client.get(`${e}_expire`,(a,c)=>{if(a)n(a);else{let u=c===!1?0:c,l={consumedPoints:i,msBeforeNext:u>=0?Math.max(u-o,0):-1};r(l)}}):r(null)})})}_delete(e){return new Promise((r,n)=>{this.client.del(e,(o,s)=>{o?n(o):s===!1?r(s):this.client.del(`${e}_expire`,i=>{i?n(i):r(s)})})})}};KO.exports=mS});var WO=k((UUe,GO)=>{var HO=Sn();GO.exports=class{constructor(e={}){this.limiter=e.limiter,this.blackList=e.blackList,this.whiteList=e.whiteList,this.isBlackListed=e.isBlackListed,this.isWhiteListed=e.isWhiteListed,this.runActionAnyway=e.runActionAnyway}get limiter(){return this._limiter}set limiter(e){if(typeof e>"u")throw new Error("limiter is not set");this._limiter=e}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(e){this._runActionAnyway=typeof e>"u"?!1:e}get blackList(){return this._blackList}set blackList(e){this._blackList=Array.isArray(e)?e:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(e){if(typeof e>"u"&&(e=()=>!1),typeof e!="function")throw new Error("isBlackListed must be function");this._isBlackListed=e}get whiteList(){return this._whiteList}set whiteList(e){this._whiteList=Array.isArray(e)?e:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(e){if(typeof e>"u"&&(e=()=>!1),typeof e!="function")throw new Error("isWhiteListed must be function");this._isWhiteListed=e}isBlackListedSomewhere(e){return this.blackList.indexOf(e)>=0||this.isBlackListed(e)}isWhiteListedSomewhere(e){return this.whiteList.indexOf(e)>=0||this.isWhiteListed(e)}getBlackRes(){return new HO(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new HO(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(e,r=1){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.rejectBlack()),typeof n>"u"?this.limiter.consume(e,r):(this.runActionAnyway&&this.limiter.consume(e,r).catch(()=>{}),n)}block(e,r){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),typeof n>"u"?this.limiter.block(e,r):(this.runActionAnyway&&this.limiter.block(e,r).catch(()=>{}),n)}penalty(e,r){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),typeof n>"u"?this.limiter.penalty(e,r):(this.runActionAnyway&&this.limiter.penalty(e,r).catch(()=>{}),n)}reward(e,r){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),typeof n>"u"?this.limiter.reward(e,r):(this.runActionAnyway&&this.limiter.reward(e,r).catch(()=>{}),n)}get(e){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),typeof r>"u"||this.runActionAnyway?this.limiter.get(e):r}delete(e){return this.limiter.delete(e)}}});var YO=k((MUe,jO)=>{var jie=Kd();jO.exports=class{constructor(...e){if(e.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");e.forEach(r=>{if(!(r instanceof jie))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")}),this._limiters=e}consume(e,r=1){return new Promise((n,o)=>{let s=[];this._limiters.forEach(i=>{s.push(i.consume(e,r).catch(a=>({rejected:!0,rej:a})))}),Promise.all(s).then(i=>{let a={},c=!1;i.forEach(u=>{u.rejected===!0&&(c=!0)});for(let u=0;u<i.length;u++)c&&i[u].rejected===!0?a[this._limiters[u].keyPrefix]=i[u].rej:c||(a[this._limiters[u].keyPrefix]=i[u]);c?o(a):n(a)})})}}});var XO=k((VUe,QO)=>{QO.exports=class extends Error{constructor(e,r){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=e,r&&(this.extra=r)}}});var tU=k(($Ue,eU)=>{var JO=XO(),ZO=4294967295,gS="limiter";eU.exports=class{constructor(e,r={maxQueueSize:ZO}){this._queueLimiters={KEY_DEFAULT:new vg(e,r)},this._limiterFlexible=e,this._maxQueueSize=r.maxQueueSize}getTokensRemaining(e=gS){return this._queueLimiters[e]?this._queueLimiters[e].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(e,r=gS){return this._queueLimiters[r]||(this._queueLimiters[r]=new vg(this._limiterFlexible,{key:r,maxQueueSize:this._maxQueueSize})),this._queueLimiters[r].removeTokens(e)}};var vg=class{constructor(e,r={maxQueueSize:ZO,key:gS}){this._key=r.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=e,this._maxQueueSize=r.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then(e=>e!==null?e.remainingPoints:this._limiterFlexible.points)}removeTokens(e){let r=this;return new Promise((n,o)=>{if(e>r._limiterFlexible.points){o(new JO(`Requested tokens ${e} exceeds maximum ${r._limiterFlexible.points} tokens per interval`));return}r._queue.length>0?r._queueRequest.call(r,n,o,e):r._limiterFlexible.consume(r._key,e).then(s=>{n(s.remainingPoints)}).catch(s=>{s instanceof Error?o(s):(r._queueRequest.call(r,n,o,e),r._waitTimeout===null&&(r._waitTimeout=setTimeout(r._processFIFO.bind(r),s.msBeforeNext)))})})}_queueRequest(e,r,n){let o=this;o._queue.length<o._maxQueueSize?o._queue.push({resolve:e,reject:r,tokens:n}):r(new JO(`Number of requests reached it's maximum ${o._maxQueueSize}`))}_processFIFO(){let e=this;if(e._waitTimeout!==null&&(clearTimeout(e._waitTimeout),e._waitTimeout=null),e._queue.length===0)return;let r=e._queue.shift();e._limiterFlexible.consume(e._key,r.tokens).then(n=>{r.resolve(n.remainingPoints),e._processFIFO.call(e)}).catch(n=>{n instanceof Error?(r.reject(n),e._processFIFO.call(e)):(e._queue.unshift(r),e._waitTimeout===null&&(e._waitTimeout=setTimeout(e._processFIFO.bind(e),n.msBeforeNext)))})}}});var nU=k((qUe,rU)=>{var yS=Sn();rU.exports=class{constructor(e,r){this._rateLimiter=e,this._burstLimiter=r}_combineRes(e,r){return e?new yS(e.remainingPoints,Math.min(e.msBeforeNext,r?r.msBeforeNext:0),e.consumedPoints,e.isFirstInDuration):null}consume(e,r=1,n={}){return this._rateLimiter.consume(e,r,n).catch(o=>o instanceof yS?this._burstLimiter.consume(e,r,n).then(s=>Promise.resolve(this._combineRes(o,s))).catch(s=>s instanceof yS?Promise.reject(this._combineRes(o,s)):Promise.reject(s)):Promise.reject(o))}get(e){return Promise.all([this._rateLimiter.get(e),this._burstLimiter.get(e)]).then(([r,n])=>this._combineRes(r,n))}get points(){return this._rateLimiter.points}}});var bS=k((HUe,oU)=>{var Yie=EO(),Qie=AO(),Xie=TO(),Jie=IO(),{RateLimiterClusterMaster:Zie,RateLimiterClusterMasterPM2:eae,RateLimiterCluster:tae}=$O(),rae=fS(),nae=qO(),oae=WO(),sae=YO(),iae=tU(),aae=nU(),cae=Sn();oU.exports={RateLimiterRedis:Yie,RateLimiterMongo:Qie,RateLimiterMySQL:Xie,RateLimiterPostgres:Jie,RateLimiterMemory:rae,RateLimiterMemcache:nae,RateLimiterClusterMaster:Zie,RateLimiterClusterMasterPM2:eae,RateLimiterCluster:tae,RLWrapperBlackAndWhite:oae,RateLimiterUnion:sae,RateLimiterQueue:iae,BurstyRateLimiter:aae,RateLimiterRes:cae}});var fk=k((XFe,lk)=>{function Wn(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}lk.exports=Wn;Wn.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Wn.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Wn.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0};Wn.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Wn.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};Wn.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};Wn.prototype.start=Wn.prototype.try;Wn.prototype.errors=function(){return this._errors};Wn.prototype.attempts=function(){return this._attempts};Wn.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var o=this._errors[n],s=o.message,i=(t[s]||0)+1;t[s]=i,i>=r&&(e=o,r=i)}return e}});var hk=k(lc=>{var Jce=fk();lc.operation=function(t){var e=lc.timeouts(t);return new Jce(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};lc.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],o=0;o<e.retries;o++)n.push(this.createTimeout(o,e));return t&&t.forever&&!n.length&&n.push(this.createTimeout(o,e)),n.sort(function(s,i){return s-i}),n};lc.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,n=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return n=Math.min(n,e.maxTimeout),n};lc.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var n in t)typeof t[n]=="function"&&r.push(n)}for(var o=0;o<r.length;o++){var s=r[o],i=t[s];t[s]=function(c){var u=lc.operation(e),l=Array.prototype.slice.call(arguments,1),h=l.pop();l.push(function(p){u.retry(p)||(p&&(arguments[0]=u.mainError()),h.apply(this,arguments))}),u.attempt(function(){c.apply(t,l)})}.bind(t,i),t[s].options=e}}});var pk=k((ZFe,dk)=>{dk.exports=hk()});var CM=k((PKe,AM)=>{function Xle(){return typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}AM.exports=Xle});var v7=k(xy=>{"use strict";Object.defineProperty(xy,"__esModule",{value:!0});var e4=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let r={value:e,done:!1};if(this.pullQueue.length){let n=this.pullQueue.shift();n&&n.resolve(r)}else this.pushQueue.push(Promise.resolve(r)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let r of this.pullQueue)r.reject(e);this.pullQueue.length=0}else{let r=Promise.reject(e);r.catch(()=>{}),this.pushQueue.push(r)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let r=this.pushQueue.shift();return r?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),r):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((n,o)=>{this.pullQueue.push({resolve:n,reject:o})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},wy=class{constructor(e,{highWaterMark:r=100,lowWaterMark:n=1}={}){let o=new e4;o.highWaterMark=r,o.lowWaterMark=n,o.removeCallback=e({push:s=>o.push(s),stop:()=>o.stop(),fail:s=>o.fail(s),on:(s,i)=>{o.eventHandlers[s]=i}})||(()=>{}),this[Symbol.asyncIterator]=()=>o[Symbol.asyncIterator](),Object.freeze(this)}};xy.EventIterator=wy;xy.default=wy});var S7=k(pp=>{"use strict";Object.defineProperty(pp,"__esModule",{value:!0});var t4=v7();pp.EventIterator=t4.EventIterator;function Rhe(t,e,r){return new t4.EventIterator(({push:n})=>(this.addEventListener(t,n,e),()=>this.removeEventListener(t,n,e)),r)}pp.subscribe=Rhe;pp.default=t4.EventIterator});var C4=k((dWe,e9)=>{"use strict";var Fde=typeof navigator<"u"&&navigator.product==="ReactNative";function Vde(){return Fde?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var wp=self.URL,Z7=Vde(),A4=class{constructor(e="",r=Z7){this.super=new wp(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return wp.createObjectURL(e)}static revokeObjectURL(e){wp.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function zde(t){if(typeof t=="string")return new wp(t).toString();if(!(t instanceof wp)){let e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",o=t.protocol?t.protocol+"//":"",s=t.host||"",i=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",u=t.pathname||"",l=t.path||u+a;return`${o}${e||r}${s||i+n}${l}${c}`}}e9.exports={URLWithLegacySupport:A4,URLSearchParams:self.URLSearchParams,defaultBase:Z7,format:zde}});var n9=k((pWe,r9)=>{"use strict";var{URLWithLegacySupport:t9,format:$de}=C4();r9.exports=(t,e={},r={},n)=>{let o=e.protocol?e.protocol.replace(":",""):"http";o=(r[o]||n||o)+":";let s;try{s=new t9(t)}catch{s={}}let i=Object.assign({},e,{protocol:o||s.protocol,host:e.host||s.host});return new t9(t,$de(i)).toString()}});var s9=k((mWe,o9)=>{"use strict";var{URLWithLegacySupport:Kde,format:qde,URLSearchParams:Hde,defaultBase:Gde}=C4(),Wde=n9();o9.exports={URL:Kde,URLSearchParams:Hde,format:qde,relative:Wde,defaultBase:Gde}});var hV=k((oet,fV)=>{"use strict";function Oge(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),r=0;r<e.length;r++)e[r]=255;for(var n=0;n<t.length;n++){var o=t.charAt(n),s=o.charCodeAt(0);if(e[s]!==255)throw new TypeError(o+" is ambiguous");e[s]=n}var i=t.length,a=t.charAt(0),c=Math.log(i)/Math.log(256),u=Math.log(256)/Math.log(i);function l(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var f=0,d=0,g=0,y=m.length;g!==y&&m[g]===0;)g++,f++;for(var b=(y-g)*u+1>>>0,w=new Uint8Array(b);g!==y;){for(var x=m[g],E=0,S=b-1;(x!==0||E<d)&&S!==-1;S--,E++)x+=256*w[S]>>>0,w[S]=x%i>>>0,x=x/i>>>0;if(x!==0)throw new Error("Non-zero carry");d=E,g++}for(var v=b-d;v!==b&&w[v]===0;)v++;for(var A=a.repeat(f);v<b;++v)A+=t.charAt(w[v]);return A}function h(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var f=0;if(m[f]!==" "){for(var d=0,g=0;m[f]===a;)d++,f++;for(var y=(m.length-f)*c+1>>>0,b=new Uint8Array(y);m[f];){var w=e[m.charCodeAt(f)];if(w===255)return;for(var x=0,E=y-1;(w!==0||x<g)&&E!==-1;E--,x++)w+=i*b[E]>>>0,b[E]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");g=x,f++}if(m[f]!==" "){for(var S=y-g;S!==y&&b[S]===0;)S++;for(var v=new Uint8Array(d+(y-S)),A=d;S!==y;)v[A++]=b[S++];return v}}}function p(m){var f=h(m);if(f)return f;throw new Error("Non-base"+i+" character")}return{encode:l,decodeUnsafe:h,decode:p}}fV.exports=Oge});var Jy=k((set,dV)=>{"use strict";var Uge=new TextDecoder,kge=t=>Uge.decode(t),Mge=new TextEncoder,Fge=t=>Mge.encode(t);function Vge(t,e){let r=new Uint8Array(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return r}dV.exports={decodeText:kge,encodeText:Fge,concat:Vge}});var mV=k((iet,pV)=>{"use strict";var{encodeText:zge}=Jy(),a6=class{constructor(e,r,n,o){this.name=e,this.code=r,this.codeBuf=zge(this.code),this.alphabet=o,this.codec=n(o)}encode(e){return this.codec.encode(e)}decode(e){for(let r of e)if(this.alphabet&&this.alphabet.indexOf(r)<0)throw new Error(`invalid character '${r}' in '${e}'`);return this.codec.decode(e)}};pV.exports=a6});var yV=k((aet,gV)=>{"use strict";var $ge=(t,e,r)=>{let n={};for(let u=0;u<e.length;++u)n[e[u]]=u;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),i=0,a=0,c=0;for(let u=0;u<o;++u){let l=n[t[u]];if(l===void 0)throw new SyntaxError("Invalid character "+t[u]);a=a<<r|l,i+=r,i>=8&&(i-=8,s[c++]=255&a>>i)}if(i>=r||255&a<<8-i)throw new SyntaxError("Unexpected end of data");return s},Kge=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},qge=t=>e=>({encode(r){return Kge(r,e,t)},decode(r){return $ge(r,e,t)}});gV.exports={rfc4648:qge}});var EV=k((cet,xV)=>{"use strict";var $p=hV(),Hge=mV(),{rfc4648:Cr}=yV(),{decodeText:Gge,encodeText:Wge}=Jy(),jge=()=>({encode:Gge,decode:Wge}),bV=[["identity","\0",jge,""],["base2","0",Cr(1),"01"],["base8","7",Cr(3),"01234567"],["base10","9",$p,"0123456789"],["base16","f",Cr(4),"0123456789abcdef"],["base16upper","F",Cr(4),"0123456789ABCDEF"],["base32hex","v",Cr(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",Cr(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",Cr(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",Cr(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",Cr(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",Cr(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",Cr(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",Cr(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",Cr(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",$p,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",$p,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",$p,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",$p,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",Cr(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",Cr(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",Cr(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",Cr(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],wV=bV.reduce((t,e)=>(t[e[0]]=new Hge(e[0],e[1],e[2],e[3]),t),{}),Yge=bV.reduce((t,e)=>(t[e[1]]=wV[e[0]],t),{});xV.exports={names:wV,codes:Yge}});var AV=k((ri,SV)=>{"use strict";var Uf=EV(),{encodeText:Qge,decodeText:Zy,concat:vV}=Jy();function Xge(t,e){if(!e)throw new Error("requires an encoded Uint8Array");let{name:r,codeBuf:n}=Tc(t);return tye(r,e),vV([n,e],n.length+e.length)}function Jge(t,e){let r=Tc(t),n=Qge(r.encode(e));return vV([r.codeBuf,n],r.codeBuf.length+n.length)}function Zge(t){t instanceof Uint8Array&&(t=Zy(t));let e=t[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(e)&&(t=t.toLowerCase()),Tc(t[0]).decode(t.substring(1))}function eye(t){if(t instanceof Uint8Array&&(t=Zy(t)),Object.prototype.toString.call(t)!=="[object String]")return!1;try{return Tc(t[0]).name}catch{return!1}}function tye(t,e){Tc(t).decode(Zy(e))}function Tc(t){if(Object.prototype.hasOwnProperty.call(Uf.names,t))return Uf.names[t];if(Object.prototype.hasOwnProperty.call(Uf.codes,t))return Uf.codes[t];throw new Error(`Unsupported encoding: ${t}`)}function rye(t){return t instanceof Uint8Array&&(t=Zy(t)),Tc(t[0])}ri=SV.exports=Xge;ri.encode=Jge;ri.decode=Zge;ri.isEncoded=eye;ri.encoding=Tc;ri.encodingFromData=rye;var nye=Object.freeze(Uf.names),oye=Object.freeze(Uf.codes);ri.names=nye;ri.codes=oye});var IV=k((uet,_V)=>{_V.exports=TV;var CV=128,sye=127,iye=~sye,aye=Math.pow(2,31);function TV(t,e,r){e=e||[],r=r||0;for(var n=r;t>=aye;)e[r++]=t&255|CV,t/=128;for(;t&iye;)e[r++]=t&255|CV,t>>>=7;return e[r]=t|0,TV.bytes=r-n+1,e}});var LV=k((fet,RV)=>{RV.exports=c6;var cye=128,DV=127;function c6(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw c6.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&DV)<<o:(i&DV)*Math.pow(2,o),o+=7}while(i>=cye);return c6.bytes=s-n,r}});var PV=k((het,BV)=>{var uye=Math.pow(2,7),lye=Math.pow(2,14),fye=Math.pow(2,21),hye=Math.pow(2,28),dye=Math.pow(2,35),pye=Math.pow(2,42),mye=Math.pow(2,49),gye=Math.pow(2,56),yye=Math.pow(2,63);BV.exports=function(t){return t<uye?1:t<lye?2:t<fye?3:t<hye?4:t<dye?5:t<pye?6:t<mye?7:t<gye?8:t<yye?9:10}});var OV=k((det,NV)=>{NV.exports={encode:IV(),decode:LV(),encodingLength:PV()}});var kV=k((pet,UV)=>{"use strict";var bye=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});UV.exports={names:bye}});function wye(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var xye,Eye,MV,FV=Re(()=>{xye=wye,Eye=xye,MV=Eye});var get,VV,ni,zV,$V,pa=Re(()=>{get=new Uint8Array(0),VV=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ni=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},zV=t=>new TextEncoder().encode(t),$V=t=>new TextDecoder().decode(t)});var u6,l6,f6,qV,h6,kf,ma,vye,Sye,Bt,vo=Re(()=>{FV();pa();u6=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},l6=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return qV(this,e)}},f6=class{constructor(e){this.decoders=e}or(e){return qV(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},qV=(t,e)=>new f6({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),h6=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new u6(e,r,n),this.decoder=new l6(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},kf=({name:t,prefix:e,encode:r,decode:n})=>new h6(t,e,r,n),ma=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=MV(r,e);return kf({prefix:t,name:e,encode:n,decode:s=>ni(o(s))})},vye=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},Sye=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Bt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>kf({prefix:e,name:t,encode(o){return Sye(o,n,r)},decode(o){return vye(o,n,r,t)}})});var d6={};T(d6,{identity:()=>Aye});var Aye,HV=Re(()=>{vo();pa();Aye=kf({prefix:"\0",name:"identity",encode:t=>$V(t),decode:t=>zV(t)})});var p6={};T(p6,{base2:()=>Cye});var Cye,GV=Re(()=>{vo();Cye=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var m6={};T(m6,{base8:()=>Tye});var Tye,WV=Re(()=>{vo();Tye=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var g6={};T(g6,{base10:()=>_ye});var _ye,jV=Re(()=>{vo();_ye=ma({prefix:"9",name:"base10",alphabet:"0123456789"})});var y6={};T(y6,{base16:()=>Iye,base16upper:()=>Dye});var Iye,Dye,YV=Re(()=>{vo();Iye=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Dye=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var b6={};T(b6,{base32:()=>Mf,base32hex:()=>Pye,base32hexpad:()=>Oye,base32hexpadupper:()=>Uye,base32hexupper:()=>Nye,base32pad:()=>Lye,base32padupper:()=>Bye,base32upper:()=>Rye,base32z:()=>kye});var Mf,Rye,Lye,Bye,Pye,Nye,Oye,Uye,kye,w6=Re(()=>{vo();Mf=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Rye=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Lye=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bye=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Pye=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Nye=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Oye=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Uye=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),kye=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var x6={};T(x6,{base36:()=>Mye,base36upper:()=>Fye});var Mye,Fye,QV=Re(()=>{vo();Mye=ma({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Fye=ma({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var E6={};T(E6,{base58btc:()=>jo,base58flickr:()=>Vye});var jo,Vye,v6=Re(()=>{vo();jo=ma({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vye=ma({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var S6={};T(S6,{base64:()=>zye,base64pad:()=>$ye,base64url:()=>Kye,base64urlpad:()=>qye});var zye,$ye,Kye,qye,XV=Re(()=>{vo();zye=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$ye=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Kye=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qye=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var A6={};T(A6,{base256emoji:()=>Yye});function Wye(t){return t.reduce((e,r)=>(e+=Hye[r],e),"")}function jye(t){let e=[];for(let r of t){let n=Gye[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var JV,Hye,Gye,Yye,ZV=Re(()=>{vo();JV=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Hye=JV.reduce((t,e,r)=>(t[r]=e,t),[]),Gye=JV.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);Yye=kf({prefix:"\u{1F680}",name:"base256emoji",encode:Wye,decode:jye})});function rz(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Zye;)e[r++]=t&255|ez,t/=128;for(;t&Jye;)e[r++]=t&255|ez,t>>>=7;return e[r]=t|0,rz.bytes=r-n+1,e}function C6(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw C6.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&tz)<<o:(i&tz)*Math.pow(2,o),o+=7}while(i>=tbe);return C6.bytes=s-n,r}var Qye,ez,Xye,Jye,Zye,ebe,tbe,tz,rbe,nbe,obe,sbe,ibe,abe,cbe,ube,lbe,fbe,hbe,dbe,Kp,nz=Re(()=>{Qye=rz,ez=128,Xye=127,Jye=~Xye,Zye=Math.pow(2,31);ebe=C6,tbe=128,tz=127;rbe=Math.pow(2,7),nbe=Math.pow(2,14),obe=Math.pow(2,21),sbe=Math.pow(2,28),ibe=Math.pow(2,35),abe=Math.pow(2,42),cbe=Math.pow(2,49),ube=Math.pow(2,56),lbe=Math.pow(2,63),fbe=function(t){return t<rbe?1:t<nbe?2:t<obe?3:t<sbe?4:t<ibe?5:t<abe?6:t<cbe?7:t<ube?8:t<lbe?9:10},hbe={encode:Qye,decode:ebe,encodingLength:fbe},dbe=hbe,Kp=dbe});var qp,Ff,Vf,tb=Re(()=>{nz();qp=(t,e=0)=>[Kp.decode(t,e),Kp.decode.bytes],Ff=(t,e,r=0)=>(Kp.encode(t,e,r),e),Vf=t=>Kp.encodingLength(t)});var _c,oz,sz,zf,Gp=Re(()=>{pa();tb();_c=(t,e)=>{let r=e.byteLength,n=Vf(t),o=n+Vf(r),s=new Uint8Array(o+r);return Ff(t,s,0),Ff(r,s,n),s.set(e,o),new zf(t,r,e,s)},oz=t=>{let e=ni(t),[r,n]=qp(e),[o,s]=qp(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new zf(r,o,i,e)},sz=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&VV(t.bytes,e.bytes),zf=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}}});var _6,T6,I6=Re(()=>{Gp();_6=({name:t,code:e,encode:r})=>new T6(t,e,r),T6=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?_c(this.code,r):r.then(n=>_c(this.code,n))}else throw Error("Unknown type, must be binary type")}}});var D6={};T(D6,{sha256:()=>pbe,sha512:()=>mbe});var az,pbe,mbe,cz=Re(()=>{I6();az=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),pbe=_6({name:"sha2-256",code:18,encode:az("SHA-256")}),mbe=_6({name:"sha2-512",code:19,encode:az("SHA-512")})});var R6={};T(R6,{identity:()=>bbe});var uz,gbe,lz,ybe,bbe,fz=Re(()=>{pa();Gp();uz=0,gbe="identity",lz=ni,ybe=t=>_c(uz,lz(t)),bbe={code:uz,name:gbe,encode:lz,digest:ybe}});var hz=Re(()=>{pa()});var Met,Fet,dz=Re(()=>{Met=new TextEncoder,Fet=new TextDecoder});var nr,Ebe,vbe,Sbe,Wp,Abe,pz,mz,rb,nb,Cbe,Tbe,_be,gz=Re(()=>{tb();Gp();v6();w6();pa();nr=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this.byteOffset=o.byteOffset,this.byteLength=o.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:nb,byteLength:nb,code:rb,version:rb,multihash:rb,bytes:rb,_baseCache:nb,asCID:nb})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Wp)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Abe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return nr.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=_c(e,r);return nr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&sz(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:o}=this;switch(n){case 0:return vbe(r,o,e||jo.encoder);default:return Sbe(r,o,e||Mf.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Tbe(/^0\.0/,_be),!!(e&&(e[mz]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof nr)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:o,bytes:s}=e;return new nr(r,n,o,s||pz(r,n,o.bytes))}else if(e!=null&&e[mz]===!0){let{version:r,multihash:n,code:o}=e,s=oz(n);return nr.create(r,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Wp)throw new Error(`Version 0 CID must use dag-pb (code: ${Wp}) block encoding`);return new nr(e,r,n,n.bytes)}case 1:{let o=pz(e,r,n.bytes);return new nr(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return nr.create(0,Wp,e)}static createV1(e,r){return nr.create(1,e,r)}static decode(e){let[r,n]=nr.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=nr.inspectBytes(e),n=r.size-r.multihashSize,o=ni(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new zf(r.multihashCode,r.digestSize,s,o);return[r.version===0?nr.createV0(i):nr.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=qp(e.subarray(r));return r+=p,h},o=n(),s=Wp;if(o===18?(o=0,r=0):o===1&&(s=n()),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=Ebe(e,r),s=nr.decode(o);return s._baseCache.set(n,e),s}},Ebe=(t,e)=>{switch(t[0]){case"Q":{let r=e||jo;return[jo.prefix,r.decode(`${jo.prefix}${t}`)]}case jo.prefix:{let r=e||jo;return[jo.prefix,r.decode(t)]}case Mf.prefix:{let r=e||Mf;return[Mf.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},vbe=(t,e,r)=>{let{prefix:n}=r;if(n!==jo.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},Sbe=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},Wp=112,Abe=18,pz=(t,e,r)=>{let n=Vf(t),o=n+Vf(e),s=new Uint8Array(o+r.byteLength);return Ff(t,s,0),Ff(e,s,n),s.set(r,o),s},mz=Symbol.for("@ipld/js-cid/CID"),rb={writable:!1,configurable:!1,enumerable:!0},nb={writable:!1,enumerable:!1,configurable:!1},Cbe="0.0.0-dev",Tbe=(t,e)=>{if(t.test(Cbe))console.warn(e);else throw new Error(e)},_be=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var yz=Re(()=>{gz();tb();pa();I6();Gp()});var L6,Wet,bz=Re(()=>{HV();GV();WV();jV();YV();w6();QV();v6();XV();ZV();cz();fz();hz();dz();yz();L6={...d6,...p6,...m6,...g6,...y6,...b6,...x6,...E6,...S6,...A6},Wet={...D6,...R6}});function Ic(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var jp=Re(()=>{});function Yp(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ic(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}var ob=Re(()=>{jp()});function xz(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var wz,B6,Ibe,sb,P6=Re(()=>{bz();ob();wz=xz("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),B6=xz("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Yp(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ibe={utf8:wz,"utf-8":wz,hex:L6.base16,latin1:B6,ascii:B6,binary:B6,...L6},sb=Ibe});var Ez={};T(Ez,{toString:()=>N6});function N6(t,e="utf8"){let r=sb[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var O6=Re(()=>{P6()});var vz={};T(vz,{fromString:()=>U6});function U6(t,e="utf8"){let r=sb[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ic(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var k6=Re(()=>{P6();jp()});var Az={};T(Az,{concat:()=>Sz});function Sz(t,e){e||(e=t.reduce((o,s)=>o+s.length,0));let r=Yp(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return Ic(r)}var M6=Re(()=>{ob();jp()});var V6=k((itt,Rz)=>{"use strict";var Cz=AV(),$f=OV(),{names:Qp}=kV(),{toString:ib}=(O6(),_b(Ez)),{fromString:Dbe}=(k6(),_b(vz)),{concat:Rbe}=(M6(),_b(Az)),Kf={};for(let t in Qp){let e=t;Kf[Qp[e]]=e}Object.freeze(Kf);function Lbe(t){if(!(t instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return ib(t,"base16")}function Bbe(t){return Dbe(t,"base16")}function Pbe(t){if(!(t instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return ib(Cz.encode("base58btc",t)).slice(1)}function Nbe(t){let e=t instanceof Uint8Array?ib(t):t;return Cz.decode("z"+e)}function Tz(t){if(!(t instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(t.length<2)throw new Error("multihash too short. must be > 2 bytes.");let e=$f.decode(t);if(!Iz(e))throw new Error(`multihash unknown function code: 0x${e.toString(16)}`);t=t.slice($f.decode.bytes);let r=$f.decode(t);if(r<0)throw new Error(`multihash invalid length: ${r}`);if(t=t.slice($f.decode.bytes),t.length!==r)throw new Error(`multihash length inconsistent: 0x${ib(t,"base16")}`);return{code:e,name:Kf[e],length:r,digest:t}}function Obe(t,e,r){if(!t||e===void 0)throw new Error("multihash encode requires at least two args: digest, code");let n=_z(e);if(!(t instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(r==null&&(r=t.length),r&&t.length!==r)throw new Error("digest length should be equal to specified length.");let o=$f.encode(n),s=$f.encode(r);return Rbe([o,s,t],o.length+s.length+t.length)}function _z(t){let e=t;if(typeof t=="string"){if(Qp[t]===void 0)throw new Error(`Unrecognized hash function named: ${t}`);e=Qp[t]}if(typeof e!="number")throw new Error(`Hash function code should be a number. Got: ${e}`);if(Kf[e]===void 0&&!F6(e))throw new Error(`Unrecognized function code: ${e}`);return e}function F6(t){return t>0&&t<16}function Iz(t){return!!(F6(t)||Kf[t])}function Dz(t){Tz(t)}function Ube(t){return Dz(t),t.subarray(0,2)}Rz.exports={names:Qp,codes:Kf,toHexString:Lbe,fromHexString:Bbe,toB58String:Pbe,fromB58String:Nbe,decode:Tz,encode:Obe,coerceCode:_z,isAppCode:F6,validate:Dz,prefix:Ube,isValidCode:Iz}});var aK=k((ast,iK)=>{iK.exports=mT;var sK=128,I1e=127,D1e=~I1e,R1e=Math.pow(2,31);function mT(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw mT.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=R1e;)e[r++]=t&255|sK,t/=128;for(;t&D1e;)e[r++]=t&255|sK,t>>>=7;return e[r]=t|0,mT.bytes=r-n+1,e}});var lK=k((cst,uK)=>{uK.exports=gT;var L1e=128,cK=127;function gT(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a||o>49)throw gT.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&cK)<<o:(i&cK)*Math.pow(2,o),o+=7}while(i>=L1e);return gT.bytes=s-n,r}});var hK=k((ust,fK)=>{var B1e=Math.pow(2,7),P1e=Math.pow(2,14),N1e=Math.pow(2,21),O1e=Math.pow(2,28),U1e=Math.pow(2,35),k1e=Math.pow(2,42),M1e=Math.pow(2,49),F1e=Math.pow(2,56),V1e=Math.pow(2,63);fK.exports=function(t){return t<B1e?1:t<P1e?2:t<N1e?3:t<O1e?4:t<U1e?5:t<k1e?6:t<M1e?7:t<F1e?8:t<V1e?9:10}});var vb=k((lst,dK)=>{dK.exports={encode:aK(),decode:lK(),encodingLength:hK()}});var ek=J(li(),1);var M8e=J(dh(),1),F8e=J(i5(),1);var N0=class extends Error{code;type;constructor(e="The operation was aborted"){super(e),this.code=N0.code,this.type=N0.type}},Zn=N0;ln(Zn,"code","ABORT_ERR"),ln(Zn,"type","aborted");var C=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}},Xb=class extends Error{code;constructor(e="Unexpected Peer"){super(e),this.code=Xb.code}},kc=Xb;ln(kc,"code","ERR_UNEXPECTED_PEER");var Jb=class extends Error{code;constructor(e="Invalid crypto exchange"){super(e),this.code=Jb.code}},mi=Jb;ln(mi,"code","ERR_INVALID_CRYPTO_EXCHANGE");var cm=J(Oe(),1);function Mc(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var nw={};T(nw,{base10:()=>vG});function yG(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var bG=yG,wG=bG,a5=wG;var UEe=new Uint8Array(0);var c5=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ts=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var u5=t=>new TextEncoder().encode(t),l5=t=>new TextDecoder().decode(t);var Zb=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ew=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return h5(this,e)}},tw=class{constructor(e){this.decoders=e}or(e){return h5(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},h5=(t,e)=>new tw({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),rw=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Zb(e,r,n),this.decoder=new ew(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Fc=({name:t,prefix:e,encode:r,decode:n})=>new rw(t,e,r,n),gi=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=a5(r,e);return Fc({prefix:t,name:e,encode:n,decode:s=>ts(o(s))})},xG=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},EG=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},bt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Fc({prefix:e,name:t,encode(o){return EG(o,n,r)},decode(o){return xG(o,n,r,t)}});var vG=gi({prefix:"9",name:"base10",alphabet:"0123456789"});var ow={};T(ow,{base16:()=>SG,base16upper:()=>AG});var SG=bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),AG=bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var sw={};T(sw,{base2:()=>CG});var CG=bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var iw={};T(iw,{base256emoji:()=>RG});var d5=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),TG=d5.reduce((t,e,r)=>(t[r]=e,t),[]),_G=d5.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function IG(t){return t.reduce((e,r)=>(e+=TG[r],e),"")}function DG(t){let e=[];for(let r of t){let n=_G[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var RG=Fc({prefix:"\u{1F680}",name:"base256emoji",encode:IG,decode:DG});var aw={};T(aw,{base32:()=>Vc,base32hex:()=>NG,base32hexpad:()=>UG,base32hexpadupper:()=>kG,base32hexupper:()=>OG,base32pad:()=>BG,base32padupper:()=>PG,base32upper:()=>LG,base32z:()=>MG});var Vc=bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),LG=bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),BG=bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),PG=bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),NG=bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),OG=bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),UG=bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),kG=bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),MG=bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var cw={};T(cw,{base36:()=>FG,base36upper:()=>VG});var FG=gi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),VG=gi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var uw={};T(uw,{base58btc:()=>Fn,base58flickr:()=>zG});var Fn=gi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zG=gi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var lw={};T(lw,{base64:()=>yh,base64pad:()=>$G,base64url:()=>KG,base64urlpad:()=>qG});var yh=bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$G=bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),KG=bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qG=bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var fw={};T(fw,{base8:()=>HG});var HG=bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var hw={};T(hw,{identity:()=>GG});var GG=Fc({prefix:"\0",name:"identity",encode:t=>l5(t),decode:t=>u5(t)});var XEe=new TextEncoder,JEe=new TextDecoder;var mw={};T(mw,{identity:()=>pw});var YG=g5,p5=128,QG=127,XG=~QG,JG=Math.pow(2,31);function g5(t,e,r){e=e||[],r=r||0;for(var n=r;t>=JG;)e[r++]=t&255|p5,t/=128;for(;t&XG;)e[r++]=t&255|p5,t>>>=7;return e[r]=t|0,g5.bytes=r-n+1,e}var ZG=dw,eW=128,m5=127;function dw(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw dw.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&m5)<<o:(i&m5)*Math.pow(2,o),o+=7}while(i>=eW);return dw.bytes=s-n,r}var tW=Math.pow(2,7),rW=Math.pow(2,14),nW=Math.pow(2,21),oW=Math.pow(2,28),sW=Math.pow(2,35),iW=Math.pow(2,42),aW=Math.pow(2,49),cW=Math.pow(2,56),uW=Math.pow(2,63),lW=function(t){return t<tW?1:t<rW?2:t<nW?3:t<oW?4:t<sW?5:t<iW?6:t<aW?7:t<cW?8:t<uW?9:10},fW={encode:YG,decode:ZG,encodingLength:lW},hW=fW,bh=hW;var wh=(t,e=0)=>[bh.decode(t,e),bh.decode.bytes],zc=(t,e,r=0)=>(bh.encode(t,e,r),e),$c=t=>bh.encodingLength(t);var Ta=(t,e)=>{let r=e.byteLength,n=$c(t),o=n+$c(r),s=new Uint8Array(o+r);return zc(t,s,0),zc(r,s,n),s.set(e,o),new Kc(t,r,e,s)},y5=t=>{let e=ts(t),[r,n]=wh(e),[o,s]=wh(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Kc(r,o,i,e)},b5=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&c5(t.bytes,r.bytes)}},Kc=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var w5=0,dW="identity",x5=ts,pW=t=>Ta(w5,x5(t)),pw={code:w5,name:dW,encode:x5,digest:pW};var bw={};T(bw,{sha256:()=>fn,sha512:()=>mW});var yw=({name:t,code:e,encode:r})=>new gw(t,e,r),gw=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Ta(this.code,r):r.then(n=>Ta(this.code,n))}else throw Error("Unknown type, must be binary type")}};var v5=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),fn=yw({name:"sha2-256",code:18,encode:v5("SHA-256")}),mW=yw({name:"sha2-512",code:19,encode:v5("SHA-512")});var S5=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return yW(r,ww(t),e||Fn.encoder);default:return bW(r,ww(t),e||Vc.encoder)}};var A5=new WeakMap,ww=t=>{let e=A5.get(t);if(e==null){let r=new Map;return A5.set(t,r),r}return e},Kt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Eh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==wW)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Kt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Ta(e,r);return Kt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Kt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&b5(e.multihash,n.multihash)}toString(e){return S5(this,e)}toJSON(){return{"/":S5(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof Kt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new Kt(n,o,s,i||C5(n,o,s.bytes))}else if(r[xW]===!0){let{version:n,multihash:o,code:s}=r,i=y5(o);return Kt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Eh)throw new Error(`Version 0 CID must use dag-pb (code: ${Eh}) block encoding`);return new Kt(e,r,n,n.bytes)}case 1:{let o=C5(e,r,n.bytes);return new Kt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return Kt.create(0,Eh,e)}static createV1(e,r){return Kt.create(1,e,r)}static decode(e){let[r,n]=Kt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Kt.inspectBytes(e),n=r.size-r.multihashSize,o=ts(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new Kc(r.multihashCode,r.digestSize,s,o);return[r.version===0?Kt.createV0(i):Kt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=wh(e.subarray(r));return r+=p,h},o=n(),s=Eh;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=gW(e,r),s=Kt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return ww(s).set(n,e),s}},gW=(t,e)=>{switch(t[0]){case"Q":{let r=e||Fn;return[Fn.prefix,r.decode(`${Fn.prefix}${t}`)]}case Fn.prefix:{let r=e||Fn;return[Fn.prefix,r.decode(t)]}case Vc.prefix:{let r=e||Vc;return[Vc.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},yW=(t,e,r)=>{let{prefix:n}=r;if(n!==Fn.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},bW=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},Eh=112,wW=18,C5=(t,e,r)=>{let n=$c(t),o=n+$c(e),s=new Uint8Array(o+r.byteLength);return zc(t,s,0),zc(e,s,n),s.set(r,o),s},xW=Symbol.for("@ipld/js-cid/CID");var xw={...hw,...sw,...fw,...nw,...ow,...aw,...cw,...uw,...lw,...iw},pve={...bw,...mw};function U0(t=0){return globalThis.Buffer?.allocUnsafe!=null?Mc(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function _5(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var T5=_5("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Ew=_5("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=U0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),EW={utf8:T5,"utf-8":T5,hex:xw.base16,latin1:Ew,ascii:Ew,binary:Ew,...xw},k0=EW;function Vr(t,e="utf8"){let r=k0[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Mc(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var nx={};T(nx,{Ed25519PrivateKey:()=>Na,Ed25519PublicKey:()=>Rh,generateKeyPair:()=>kj,generateKeyPairFromSeed:()=>KI,unmarshalEd25519PrivateKey:()=>Oj,unmarshalEd25519PublicKey:()=>Uj});function Do(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function M0(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function vw(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function vh(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");M0(t.outputLen),M0(t.blockLen)}function qc(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function I5(t,e){vw(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var F0=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var D5=t=>t instanceof Uint8Array;var V0=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),eo=(t,e)=>t<<32-e|t>>>e,vW=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!vW)throw new Error("Non little-endian hardware is not supported");function Sw(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function yi(t){if(typeof t=="string"&&(t=Sw(t)),!D5(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function z0(...t){let e=new Uint8Array(t.reduce((n,o)=>n+o.length,0)),r=0;return t.forEach(n=>{if(!D5(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var Hc=class{clone(){return this._cloneInto()}},Ive={}.toString;function $0(t){let e=n=>t().update(yi(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function _a(t=32){if(F0&&typeof F0.getRandomValues=="function")return F0.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function SW(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let o=BigInt(32),s=BigInt(4294967295),i=Number(r>>o&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,i,n),t.setUint32(e+u,a,n)}var Gc=class extends Hc{constructor(e,r,n,o){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=V0(this.buffer)}update(e){qc(this);let{view:r,buffer:n,blockLen:o}=this;e=yi(e);let s=e.length;for(let i=0;i<s;){let a=Math.min(o-this.pos,s-i);if(a===o){let c=V0(e);for(;o<=s-i;i+=o)this.process(c,i);continue}n.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){qc(this),I5(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:s}=this,{pos:i}=this;r[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(n,0),i=0);for(let h=i;h<o;h++)r[h]=0;SW(n,o-8,BigInt(this.length*8),s),this.process(n,0);let a=V0(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,l[h],s)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:s,destroyed:i,pos:a}=this;return e.length=o,e.pos=a,e.finished=s,e.destroyed=i,o%r&&e.buffer.set(n),e}};var K0=BigInt(4294967295),Aw=BigInt(32);function R5(t,e=!1){return e?{h:Number(t&K0),l:Number(t>>Aw&K0)}:{h:Number(t>>Aw&K0)|0,l:Number(t&K0)|0}}function AW(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let o=0;o<t.length;o++){let{h:s,l:i}=R5(t[o],e);[r[o],n[o]]=[s,i]}return[r,n]}var CW=(t,e)=>BigInt(t>>>0)<<Aw|BigInt(e>>>0),TW=(t,e,r)=>t>>>r,_W=(t,e,r)=>t<<32-r|e>>>r,IW=(t,e,r)=>t>>>r|e<<32-r,DW=(t,e,r)=>t<<32-r|e>>>r,RW=(t,e,r)=>t<<64-r|e>>>r-32,LW=(t,e,r)=>t>>>r-32|e<<64-r,BW=(t,e)=>e,PW=(t,e)=>t,NW=(t,e,r)=>t<<r|e>>>32-r,OW=(t,e,r)=>e<<r|t>>>32-r,UW=(t,e,r)=>e<<r-32|t>>>64-r,kW=(t,e,r)=>t<<r-32|e>>>64-r;function MW(t,e,r,n){let o=(e>>>0)+(n>>>0);return{h:t+r+(o/2**32|0)|0,l:o|0}}var FW=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),VW=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,zW=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),$W=(t,e,r,n,o)=>e+r+n+o+(t/2**32|0)|0,KW=(t,e,r,n,o)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(o>>>0),qW=(t,e,r,n,o,s)=>e+r+n+o+s+(t/2**32|0)|0;var HW={fromBig:R5,split:AW,toBig:CW,shrSH:TW,shrSL:_W,rotrSH:IW,rotrSL:DW,rotrBH:RW,rotrBL:LW,rotr32H:BW,rotr32L:PW,rotlSH:NW,rotlSL:OW,rotlBH:UW,rotlBL:kW,add:MW,add3L:FW,add3H:VW,add4L:zW,add4H:$W,add5H:qW,add5L:KW},de=HW;var[GW,WW]=(()=>de.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),bi=new Uint32Array(80),wi=new Uint32Array(80),Cw=class extends Gc{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:o,Ch:s,Cl:i,Dh:a,Dl:c,Eh:u,El:l,Fh:h,Fl:p,Gh:m,Gl:f,Hh:d,Hl:g}=this;return[e,r,n,o,s,i,a,c,u,l,h,p,m,f,d,g]}set(e,r,n,o,s,i,a,c,u,l,h,p,m,f,d,g){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=h|0,this.Fl=p|0,this.Gh=m|0,this.Gl=f|0,this.Hh=d|0,this.Hl=g|0}process(e,r){for(let w=0;w<16;w++,r+=4)bi[w]=e.getUint32(r),wi[w]=e.getUint32(r+=4);for(let w=16;w<80;w++){let x=bi[w-15]|0,E=wi[w-15]|0,S=de.rotrSH(x,E,1)^de.rotrSH(x,E,8)^de.shrSH(x,E,7),v=de.rotrSL(x,E,1)^de.rotrSL(x,E,8)^de.shrSL(x,E,7),A=bi[w-2]|0,_=wi[w-2]|0,z=de.rotrSH(A,_,19)^de.rotrBH(A,_,61)^de.shrSH(A,_,6),V=de.rotrSL(A,_,19)^de.rotrBL(A,_,61)^de.shrSL(A,_,6),K=de.add4L(v,V,wi[w-7],wi[w-16]),G=de.add4H(K,S,z,bi[w-7],bi[w-16]);bi[w]=G|0,wi[w]=K|0}let{Ah:n,Al:o,Bh:s,Bl:i,Ch:a,Cl:c,Dh:u,Dl:l,Eh:h,El:p,Fh:m,Fl:f,Gh:d,Gl:g,Hh:y,Hl:b}=this;for(let w=0;w<80;w++){let x=de.rotrSH(h,p,14)^de.rotrSH(h,p,18)^de.rotrBH(h,p,41),E=de.rotrSL(h,p,14)^de.rotrSL(h,p,18)^de.rotrBL(h,p,41),S=h&m^~h&d,v=p&f^~p&g,A=de.add5L(b,E,v,WW[w],wi[w]),_=de.add5H(A,y,x,S,GW[w],bi[w]),z=A|0,V=de.rotrSH(n,o,28)^de.rotrBH(n,o,34)^de.rotrBH(n,o,39),K=de.rotrSL(n,o,28)^de.rotrBL(n,o,34)^de.rotrBL(n,o,39),G=n&s^n&a^s&a,se=o&i^o&c^i&c;y=d|0,b=g|0,d=m|0,g=f|0,m=h|0,f=p|0,{h,l:p}=de.add(u|0,l|0,_|0,z|0),u=a|0,l=c|0,a=s|0,c=i|0,s=n|0,i=o|0;let L=de.add3L(z,K,se);n=de.add3H(L,_,V,G),o=L|0}({h:n,l:o}=de.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:i}=de.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:a,l:c}=de.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=de.add(this.Dh|0,this.Dl|0,u|0,l|0),{h,l:p}=de.add(this.Eh|0,this.El|0,h|0,p|0),{h:m,l:f}=de.add(this.Fh|0,this.Fl|0,m|0,f|0),{h:d,l:g}=de.add(this.Gh|0,this.Gl|0,d|0,g|0),{h:y,l:b}=de.add(this.Hh|0,this.Hl|0,y|0,b|0),this.set(n,o,s,i,a,c,u,l,h,p,m,f,d,g,y,b)}roundClean(){bi.fill(0),wi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Tw=$0(()=>new Cw);var G0={};T(G0,{bitGet:()=>ej,bitLen:()=>ZW,bitMask:()=>Sh,bitSet:()=>tj,bytesToHex:()=>rs,bytesToNumberBE:()=>ns,bytesToNumberLE:()=>to,concatBytes:()=>ss,createHmacDrbg:()=>Dw,ensureBytes:()=>tt,equalBytes:()=>XW,hexToBytes:()=>Ia,hexToNumber:()=>Iw,numberToBytesBE:()=>xi,numberToBytesLE:()=>os,numberToHexUnpadded:()=>P5,numberToVarBytesBE:()=>QW,utf8ToBytes:()=>JW,validateObject:()=>Vn});var B5=BigInt(0),q0=BigInt(1),jW=BigInt(2),H0=t=>t instanceof Uint8Array,YW=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function rs(t){if(!H0(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=YW[t[r]];return e}function P5(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Iw(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function Ia(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let o=n*2,s=t.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");r[n]=i}return r}function ns(t){return Iw(rs(t))}function to(t){if(!H0(t))throw new Error("Uint8Array expected");return Iw(rs(Uint8Array.from(t).reverse()))}function xi(t,e){return Ia(t.toString(16).padStart(e*2,"0"))}function os(t,e){return xi(t,e).reverse()}function QW(t){return Ia(P5(t))}function tt(t,e,r){let n;if(typeof e=="string")try{n=Ia(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(H0(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(`${t} expected ${r} bytes, got ${o}`);return n}function ss(...t){let e=new Uint8Array(t.reduce((n,o)=>n+o.length,0)),r=0;return t.forEach(n=>{if(!H0(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function XW(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function JW(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function ZW(t){let e;for(e=0;t>B5;t>>=q0,e+=1);return e}function ej(t,e){return t>>BigInt(e)&q0}var tj=(t,e,r)=>t|(r?q0:B5)<<BigInt(e),Sh=t=>(jW<<BigInt(t-1))-q0,_w=t=>new Uint8Array(t),L5=t=>Uint8Array.from(t);function Dw(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=_w(t),o=_w(t),s=0,i=()=>{n.fill(1),o.fill(0),s=0},a=(...h)=>r(o,n,...h),c=(h=_w())=>{o=a(L5([0]),h),n=a(),h.length!==0&&(o=a(L5([1]),h),n=a())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,p=[];for(;h<e;){n=a();let m=n.slice();p.push(m),h+=n.length}return ss(...p)};return(h,p)=>{i(),c(h);let m;for(;!(m=p(u()));)c();return i(),m}}var rj={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Vn(t,e,r={}){let n=(o,s,i)=>{let a=rj[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=t[o];if(!(i&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(o)}=${c} (${typeof c}), expected ${s}`)};for(let[o,s]of Object.entries(e))n(o,s,!1);for(let[o,s]of Object.entries(r))n(o,s,!0);return t}var Jt=BigInt(0),it=BigInt(1),Da=BigInt(2),nj=BigInt(3),Rw=BigInt(4),N5=BigInt(5),O5=BigInt(8),oj=BigInt(9),sj=BigInt(16);function Ie(t,e){let r=t%e;return r>=Jt?r:e+r}function Lw(t,e,r){if(r<=Jt||e<Jt)throw new Error("Expected power/modulo > 0");if(r===it)return Jt;let n=it;for(;e>Jt;)e&it&&(n=n*t%r),t=t*t%r,e>>=it;return n}function rt(t,e,r){let n=t;for(;e-- >Jt;)n*=n,n%=r;return n}function W0(t,e){if(t===Jt||e<=Jt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Ie(t,e),n=e,o=Jt,s=it,i=it,a=Jt;for(;r!==Jt;){let u=n/r,l=n%r,h=o-i*u,p=s-a*u;n=r,r=l,o=i,s=a,i=h,a=p}if(n!==it)throw new Error("invert: does not exist");return Ie(o,e)}function ij(t){let e=(t-it)/Da,r,n,o;for(r=t-it,n=0;r%Da===Jt;r/=Da,n++);for(o=Da;o<t&&Lw(o,e,t)!==t-it;o++);if(n===1){let i=(t+it)/Rw;return function(c,u){let l=c.pow(u,i);if(!c.eql(c.sqr(l),u))throw new Error("Cannot find square root");return l}}let s=(r+it)/Da;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,l=a.pow(a.mul(a.ONE,o),r),h=a.pow(c,s),p=a.pow(c,r);for(;!a.eql(p,a.ONE);){if(a.eql(p,a.ZERO))return a.ZERO;let m=1;for(let d=a.sqr(p);m<u&&!a.eql(d,a.ONE);m++)d=a.sqr(d);let f=a.pow(l,it<<BigInt(u-m-1));l=a.sqr(f),h=a.mul(h,f),p=a.mul(p,l),u=m}return h}}function aj(t){if(t%Rw===nj){let e=(t+it)/Rw;return function(n,o){let s=n.pow(o,e);if(!n.eql(n.sqr(s),o))throw new Error("Cannot find square root");return s}}if(t%O5===N5){let e=(t-N5)/O5;return function(n,o){let s=n.mul(o,Da),i=n.pow(s,e),a=n.mul(o,i),c=n.mul(n.mul(a,Da),i),u=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),o))throw new Error("Cannot find square root");return u}}return t%sj,ij(t)}var U5=(t,e)=>(Ie(t,e)&it)===it,cj=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Bw(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=cj.reduce((n,o)=>(n[o]="function",n),e);return Vn(t,r)}function uj(t,e,r){if(r<Jt)throw new Error("Expected power > 0");if(r===Jt)return t.ONE;if(r===it)return e;let n=t.ONE,o=e;for(;r>Jt;)r&it&&(n=t.mul(n,o)),o=t.sqr(o),r>>=it;return n}function lj(t,e){let r=new Array(e.length),n=e.reduce((s,i,a)=>t.is0(i)?s:(r[a]=s,t.mul(s,i)),t.ONE),o=t.inv(n);return e.reduceRight((s,i,a)=>t.is0(i)?s:(r[a]=t.mul(s,r[a]),t.mul(s,i)),o),r}function Pw(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function j0(t,e,r=!1,n={}){if(t<=Jt)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:o,nByteLength:s}=Pw(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let i=aj(t),a=Object.freeze({ORDER:t,BITS:o,BYTES:s,MASK:Sh(o),ZERO:Jt,ONE:it,create:c=>Ie(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Jt<=c&&c<t},is0:c=>c===Jt,isOdd:c=>(c&it)===it,neg:c=>Ie(-c,t),eql:(c,u)=>c===u,sqr:c=>Ie(c*c,t),add:(c,u)=>Ie(c+u,t),sub:(c,u)=>Ie(c-u,t),mul:(c,u)=>Ie(c*u,t),pow:(c,u)=>uj(a,c,u),div:(c,u)=>Ie(c*W0(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>W0(c,t),sqrt:n.sqrt||(c=>i(a,c)),invertBatch:c=>lj(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>r?os(c,s):xi(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?to(c):ns(c)}});return Object.freeze(a)}function k5(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function M5(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function Nw(t){let e=M5(t);return e+Math.ceil(e/2)}function F5(t,e,r=!1){let n=t.length,o=M5(e),s=Nw(e);if(n<16||n<s||n>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${n}`);let i=r?ns(t):to(t),a=Ie(i,e-it)+it;return r?os(a,o):xi(a,o)}var hj=BigInt(0),Ow=BigInt(1);function Y0(t,e){let r=(o,s)=>{let i=s.negate();return o?i:s},n=o=>{let s=Math.ceil(e/o)+1,i=2**(o-1);return{windows:s,windowSize:i}};return{constTimeNegate:r,unsafeLadder(o,s){let i=t.ZERO,a=o;for(;s>hj;)s&Ow&&(i=i.add(a)),a=a.double(),s>>=Ow;return i},precomputeWindow(o,s){let{windows:i,windowSize:a}=n(s),c=[],u=o,l=u;for(let h=0;h<i;h++){l=u,c.push(l);for(let p=1;p<a;p++)l=l.add(u),c.push(l);u=l.double()}return c},wNAF(o,s,i){let{windows:a,windowSize:c}=n(o),u=t.ZERO,l=t.BASE,h=BigInt(2**o-1),p=2**o,m=BigInt(o);for(let f=0;f<a;f++){let d=f*c,g=Number(i&h);i>>=m,g>c&&(g-=p,i+=Ow);let y=d,b=d+Math.abs(g)-1,w=f%2!==0,x=g<0;g===0?l=l.add(r(w,s[y])):u=u.add(r(x,s[b]))}return{p:u,f:l}},wNAFCached(o,s,i,a){let c=o._WINDOW_SIZE||1,u=s.get(o);return u||(u=this.precomputeWindow(o,c),c!==1&&s.set(o,a(u))),this.wNAF(c,u,i)}}}function Ah(t){return Bw(t.Fp),Vn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Pw(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var ro=BigInt(0),hn=BigInt(1),Q0=BigInt(2),dj=BigInt(8),pj={zip215:!0};function mj(t){let e=Ah(t);return Vn(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function X0(t){let e=mj(t),{Fp:r,n,prehash:o,hash:s,randomBytes:i,nByteLength:a,h:c}=e,u=Q0<<BigInt(a*8)-hn,l=r.create,h=e.uvRatio||((N,D)=>{try{return{isValid:!0,value:r.sqrt(N*r.inv(D))}}catch{return{isValid:!1,value:ro}}}),p=e.adjustScalarBytes||(N=>N),m=e.domain||((N,D,F)=>{if(D.length||F)throw new Error("Contexts/pre-hash are not supported");return N}),f=N=>typeof N=="bigint"&&ro<N,d=(N,D)=>f(N)&&f(D)&&N<D,g=N=>N===ro||d(N,u);function y(N,D){if(d(N,D))return N;throw new Error(`Expected valid scalar < ${D}, got ${typeof N} ${N}`)}function b(N){return N===ro?N:y(N,n)}let w=new Map;function x(N){if(!(N instanceof E))throw new Error("ExtendedPoint expected")}class E{constructor(D,F,q,W){if(this.ex=D,this.ey=F,this.ez=q,this.et=W,!g(D))throw new Error("x required");if(!g(F))throw new Error("y required");if(!g(q))throw new Error("z required");if(!g(W))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(D){if(D instanceof E)throw new Error("extended point not allowed");let{x:F,y:q}=D||{};if(!g(F)||!g(q))throw new Error("invalid affine point");return new E(F,q,hn,l(F*q))}static normalizeZ(D){let F=r.invertBatch(D.map(q=>q.ez));return D.map((q,W)=>q.toAffine(F[W])).map(E.fromAffine)}_setWindowSize(D){this._WINDOW_SIZE=D,w.delete(this)}assertValidity(){let{a:D,d:F}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:q,ey:W,ez:oe,et:ie}=this,pe=l(q*q),ae=l(W*W),le=l(oe*oe),$e=l(le*le),Ne=l(pe*D),dr=l(le*l(Ne+ae)),pr=l($e+l(F*l(pe*ae)));if(dr!==pr)throw new Error("bad point: equation left != right (1)");let Xt=l(q*W),Tr=l(oe*ie);if(Xt!==Tr)throw new Error("bad point: equation left != right (2)")}equals(D){x(D);let{ex:F,ey:q,ez:W}=this,{ex:oe,ey:ie,ez:pe}=D,ae=l(F*pe),le=l(oe*W),$e=l(q*pe),Ne=l(ie*W);return ae===le&&$e===Ne}is0(){return this.equals(E.ZERO)}negate(){return new E(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){let{a:D}=e,{ex:F,ey:q,ez:W}=this,oe=l(F*F),ie=l(q*q),pe=l(Q0*l(W*W)),ae=l(D*oe),le=F+q,$e=l(l(le*le)-oe-ie),Ne=ae+ie,dr=Ne-pe,pr=ae-ie,Xt=l($e*dr),Tr=l(Ne*pr),Xo=l($e*pr),xa=l(dr*Ne);return new E(Xt,Tr,xa,Xo)}add(D){x(D);let{a:F,d:q}=e,{ex:W,ey:oe,ez:ie,et:pe}=this,{ex:ae,ey:le,ez:$e,et:Ne}=D;if(F===BigInt(-1)){let IT=l((oe-W)*(le+ae)),DT=l((oe+W)*(le-ae)),Tb=l(DT-IT);if(Tb===ro)return this.double();let RT=l(ie*Q0*Ne),LT=l(pe*Q0*$e),BT=LT+RT,PT=DT+IT,NT=LT-RT,LK=l(BT*Tb),BK=l(PT*NT),PK=l(BT*NT),NK=l(Tb*PT);return new E(LK,BK,NK,PK)}let dr=l(W*ae),pr=l(oe*le),Xt=l(pe*q*Ne),Tr=l(ie*$e),Xo=l((W+oe)*(ae+le)-dr-pr),xa=Tr-Xt,ch=Tr+Xt,_T=l(pr-F*dr),_K=l(Xo*xa),IK=l(ch*_T),DK=l(Xo*_T),RK=l(xa*ch);return new E(_K,IK,RK,DK)}subtract(D){return this.add(D.negate())}wNAF(D){return A.wNAFCached(this,w,D,E.normalizeZ)}multiply(D){let{p:F,f:q}=this.wNAF(y(D,n));return E.normalizeZ([F,q])[0]}multiplyUnsafe(D){let F=b(D);return F===ro?v:this.equals(v)||F===hn?this:this.equals(S)?this.wNAF(F).p:A.unsafeLadder(this,F)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return A.unsafeLadder(this,n).is0()}toAffine(D){let{ex:F,ey:q,ez:W}=this,oe=this.is0();D==null&&(D=oe?dj:r.inv(W));let ie=l(F*D),pe=l(q*D),ae=l(W*D);if(oe)return{x:ro,y:hn};if(ae!==hn)throw new Error("invZ was invalid");return{x:ie,y:pe}}clearCofactor(){let{h:D}=e;return D===hn?this:this.multiplyUnsafe(D)}static fromHex(D,F=!1){let{d:q,a:W}=e,oe=r.BYTES;D=tt("pointHex",D,oe);let ie=D.slice(),pe=D[oe-1];ie[oe-1]=pe&-129;let ae=to(ie);ae===ro||(F?y(ae,u):y(ae,r.ORDER));let le=l(ae*ae),$e=l(le-hn),Ne=l(q*le-W),{isValid:dr,value:pr}=h($e,Ne);if(!dr)throw new Error("Point.fromHex: invalid y coordinate");let Xt=(pr&hn)===hn,Tr=(pe&128)!==0;if(!F&&pr===ro&&Tr)throw new Error("Point.fromHex: x=0 and x_0=1");return Tr!==Xt&&(pr=l(-pr)),E.fromAffine({x:pr,y:ae})}static fromPrivateKey(D){return V(D).point}toRawBytes(){let{x:D,y:F}=this.toAffine(),q=os(F,r.BYTES);return q[q.length-1]|=D&hn?128:0,q}toHex(){return rs(this.toRawBytes())}}E.BASE=new E(e.Gx,e.Gy,hn,l(e.Gx*e.Gy)),E.ZERO=new E(ro,hn,hn,ro);let{BASE:S,ZERO:v}=E,A=Y0(E,a*8);function _(N){return Ie(N,n)}function z(N){return _(to(N))}function V(N){let D=a;N=tt("private key",N,D);let F=tt("hashed private key",s(N),2*D),q=p(F.slice(0,D)),W=F.slice(D,2*D),oe=z(q),ie=S.multiply(oe),pe=ie.toRawBytes();return{head:q,prefix:W,scalar:oe,point:ie,pointBytes:pe}}function K(N){return V(N).pointBytes}function G(N=new Uint8Array,...D){let F=ss(...D);return z(s(m(F,tt("context",N),!!o)))}function se(N,D,F={}){N=tt("message",N),o&&(N=o(N));let{prefix:q,scalar:W,pointBytes:oe}=V(D),ie=G(F.context,q,N),pe=S.multiply(ie).toRawBytes(),ae=G(F.context,pe,oe,N),le=_(ie+ae*W);b(le);let $e=ss(pe,os(le,r.BYTES));return tt("result",$e,a*2)}let L=pj;function O(N,D,F,q=L){let{context:W,zip215:oe}=q,ie=r.BYTES;N=tt("signature",N,2*ie),D=tt("message",D),o&&(D=o(D));let pe=to(N.slice(ie,2*ie)),ae,le,$e;try{ae=E.fromHex(F,oe),le=E.fromHex(N.slice(0,ie),oe),$e=S.multiplyUnsafe(pe)}catch{return!1}if(!oe&&ae.isSmallOrder())return!1;let Ne=G(W,le.toRawBytes(),ae.toRawBytes(),D);return le.add(ae.multiplyUnsafe(Ne)).subtract($e).clearCofactor().equals(E.ZERO)}return S._setWindowSize(8),{CURVE:e,getPublicKey:K,sign:se,verify:O,ExtendedPoint:E,utils:{getExtendedPublicKey:V,randomPrivateKey:()=>i(r.BYTES),precompute(N=8,D=E.BASE){return D._setWindowSize(N),D.multiply(BigInt(3)),D}}}}var Ch=BigInt(0),Uw=BigInt(1);function gj(t){return Vn(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function V5(t){let e=gj(t),{P:r}=e,n=w=>Ie(w,r),o=e.montgomeryBits,s=Math.ceil(o/8),i=e.nByteLength,a=e.adjustScalarBytes||(w=>w),c=e.powPminus2||(w=>Lw(w,r-BigInt(2),r));function u(w,x,E){let S=n(w*(x-E));return x=n(x-S),E=n(E+S),[x,E]}function l(w){if(typeof w=="bigint"&&Ch<=w&&w<r)return w;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(e.a-BigInt(2))/BigInt(4);function p(w,x){let E=l(w),S=l(x),v=E,A=Uw,_=Ch,z=E,V=Uw,K=Ch,G;for(let L=BigInt(o-1);L>=Ch;L--){let O=S>>L&Uw;K^=O,G=u(K,A,z),A=G[0],z=G[1],G=u(K,_,V),_=G[0],V=G[1],K=O;let P=A+_,N=n(P*P),D=A-_,F=n(D*D),q=N-F,W=z+V,oe=z-V,ie=n(oe*P),pe=n(W*D),ae=ie+pe,le=ie-pe;z=n(ae*ae),V=n(v*n(le*le)),A=n(N*F),_=n(q*(N+n(h*q)))}G=u(K,A,z),A=G[0],z=G[1],G=u(K,_,V),_=G[0],V=G[1];let se=c(_);return n(A*se)}function m(w){return os(n(w),s)}function f(w){let x=tt("u coordinate",w,s);return i===s&&(x[i-1]&=127),to(x)}function d(w){let x=tt("scalar",w);if(x.length!==s&&x.length!==i)throw new Error(`Expected ${s} or ${i} bytes, got ${x.length}`);return to(a(x))}function g(w,x){let E=f(x),S=d(w),v=p(E,S);if(v===Ch)throw new Error("Invalid private or public key received");return m(v)}let y=m(e.Gu);function b(w){return g(w,y)}return{scalarMult:g,scalarMultBase:b,getSharedSecret:(w,x)=>g(w,x),getPublicKey:w=>b(w),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:y}}var Th=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),z5=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),eSe=BigInt(0),yj=BigInt(1),kw=BigInt(2),bj=BigInt(5),$5=BigInt(10),wj=BigInt(20),xj=BigInt(40),K5=BigInt(80);function q5(t){let e=Th,n=t*t%e*t%e,o=rt(n,kw,e)*n%e,s=rt(o,yj,e)*t%e,i=rt(s,bj,e)*s%e,a=rt(i,$5,e)*i%e,c=rt(a,wj,e)*a%e,u=rt(c,xj,e)*c%e,l=rt(u,K5,e)*u%e,h=rt(l,K5,e)*u%e,p=rt(h,$5,e)*i%e;return{pow_p_5_8:rt(p,kw,e)*t%e,b2:n}}function H5(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Ej(t,e){let r=Th,n=Ie(e*e*e,r),o=Ie(n*n*e,r),s=q5(t*o).pow_p_5_8,i=Ie(t*n*s,r),a=Ie(e*i*i,r),c=i,u=Ie(i*z5,r),l=a===t,h=a===Ie(-t,r),p=a===Ie(-t*z5,r);return l&&(i=c),(h||p)&&(i=u),U5(i,r)&&(i=Ie(-i,r)),{isValid:l||h,value:i}}var is=j0(Th,void 0,!0),Mw={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:is,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Tw,randomBytes:_a,adjustScalarBytes:H5,uvRatio:Ej},Wc=X0(Mw);function G5(t,e,r){if(e.length>255)throw new Error("Context is too big");return z0(Sw("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var tSe=X0({...Mw,domain:G5}),rSe=X0({...Mw,domain:G5,prehash:Tw}),_h=(()=>V5({P:Th,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let e=Th,{pow_p_5_8:r,b2:n}=q5(t);return Ie(rt(r,BigInt(3),e)*n,e)},adjustScalarBytes:H5,randomBytes:_a}))();var vj=(is.ORDER+BigInt(3))/BigInt(8),nSe=is.pow(kw,vj),oSe=is.sqrt(is.neg(is.ONE)),sSe=(is.ORDER-BigInt(5))/BigInt(8),iSe=BigInt(486662);var aSe=k5(is,is.neg(BigInt(486664)));var cSe=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),uSe=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),lSe=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),fSe=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var hSe=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var jc=32,as=64,J0=32;async function W5(){let t=Wc.utils.randomPrivateKey(),e=Wc.getPublicKey(t);return{privateKey:X5(t,e),publicKey:e}}async function j5(t){if(t.length!==J0)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=Wc.getPublicKey(e);return{privateKey:X5(e,r),publicKey:r}}async function Y5(t,e){let r=t.subarray(0,J0);return Wc.sign(e,r)}async function Q5(t,e,r){return Wc.verify(e,r,t)}function X5(t,e){let r=new Uint8Array(as);for(let n=0;n<J0;n++)r[n]=t[n],r[J0+n]=e[n];return r}function Ra(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=U0(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return Mc(r)}var Qr={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Fw={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Z0(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,o=t?.digest??"SHA-256",s=t?.saltLength??16,i=t?.iterations??32767,a=Qr.get();r*=8;async function c(h,p){let m=a.getRandomValues(new Uint8Array(s)),f=a.getRandomValues(new Uint8Array(n)),d={name:e,iv:f};typeof p=="string"&&(p=Vr(p));let g;if(p.length===0){g=await a.subtle.importKey("jwk",Fw,{name:"AES-GCM"},!0,["encrypt"]);try{let b={name:"PBKDF2",salt:m,iterations:i,hash:{name:o}},w=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(b,w,{name:e,length:r},!0,["encrypt"])}catch{g=await a.subtle.importKey("jwk",Fw,{name:"AES-GCM"},!0,["encrypt"])}}else{let b={name:"PBKDF2",salt:m,iterations:i,hash:{name:o}},w=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);g=await a.subtle.deriveKey(b,w,{name:e,length:r},!0,["encrypt"])}let y=await a.subtle.encrypt(d,g,h);return Ra([m,d.iv,new Uint8Array(y)])}async function u(h,p){let m=h.subarray(0,s),f=h.subarray(s,s+n),d=h.subarray(s+n),g={name:e,iv:f};typeof p=="string"&&(p=Vr(p));let y;if(p.length===0)try{let w={name:"PBKDF2",salt:m,iterations:i,hash:{name:o}},x=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(w,x,{name:e,length:r},!0,["decrypt"])}catch{y=await a.subtle.importKey("jwk",Fw,{name:"AES-GCM"},!0,["decrypt"])}else{let w={name:"PBKDF2",salt:m,iterations:i,hash:{name:o}},x=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey"]);y=await a.subtle.deriveKey(w,x,{name:e,length:r},!0,["decrypt"])}let b=await a.subtle.decrypt(g,y,d);return new Uint8Array(b)}return{encrypt:c,decrypt:u}}async function Yc(t,e){let n=await Z0().encrypt(t,e);return yh.encode(n)}var Jw=J(qw(),1),FI=J(LI(),1),VI=J(Ba(),1),Zw=J(Xw(),1),zI=J(MI(),1);function Bj(){VI.default._configure(),Jw.default._configure(FI.default),Zw.default._configure(zI.default)}Bj();var $I=["uint64","int64","sint64","fixed64","sfixed64"];function Pj(t){for(let e of $I){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function ex(t){return Pj(new Jw.default(t))}function Nj(t){for(let e of $I){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function tx(){return Nj(Zw.default.create())}function Ae(t,e){let r=ex(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Ce(t,e){let r=tx();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Xc;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Xc||(Xc={}));function om(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function so(t){function e(o){if(t[o.toString()]==null)throw new Error("Invalid enum value");return t[o]}let r=function(s,i){let a=e(s);i.int32(a)},n=function(s){let i=s.int32();return e(i)};return om("enum",Xc.VARINT,r,n)}function Te(t,e){return om("message",Xc.LENGTH_DELIMITED,t,e)}var at;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(at||(at={}));var rx;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(rx||(rx={}));(function(t){t.codec=()=>so(rx)})(at||(at={}));var Bo;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),at.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.Type=at.codec().decode(r);break;case 2:o.Data=r.bytes();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(Bo||(Bo={}));var Po;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),at.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.Type=at.codec().decode(r);break;case 2:o.Data=r.bytes();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(Po||(Po={}));var Rh=class{_key;constructor(e){this._key=Jc(e,jc)}async verify(e,r){return Q5(this._key,r,e)}marshal(){return this._key}get bytes(){return Bo.encode({Type:at.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Do(this.bytes,e.bytes)}async hash(){let{bytes:e}=await fn.digest(this.bytes);return e}},Na=class{_key;_publicKey;constructor(e,r){this._key=Jc(e,as),this._publicKey=Jc(r,jc)}async sign(e){return Y5(this._key,e)}get public(){return new Rh(this._publicKey)}marshal(){return this._key}get bytes(){return Po.encode({Type:at.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Do(this.bytes,e.bytes)}async hash(){let{bytes:e}=await fn.digest(this.bytes);return e}async id(){let e=pw.digest(this.public.bytes);return Fn.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Yc(this.bytes,e);throw new C(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Oj(t){if(t.length>as){t=Jc(t,as+jc);let n=t.subarray(0,as),o=t.subarray(as,t.length);return new Na(n,o)}t=Jc(t,as);let e=t.subarray(0,as),r=t.subarray(jc);return new Na(e,r)}function Uj(t){return t=Jc(t,jc),new Rh(t)}async function kj(){let{privateKey:t,publicKey:e}=await W5();return new Na(t,e)}async function KI(t){let{privateKey:e,publicKey:r}=await j5(t);return new Na(e,r)}function Jc(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new C(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}function Xr(t,e="utf8"){let r=k0[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var aAe=J(Ut(),1),cAe=J(R0(),1),qI=J(Oe(),1);function io(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Ra([new Uint8Array(e-r.length),r])}return Xr(r,"base64url")}function dn(t){let e=HI(t);return new qI.default.jsbn.BigInteger(Xr(e,"base16"),16)}function HI(t,e){let r=Vr(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Ra([new Uint8Array(e-r.length),r])}return r}var Mj={"P-256":256,"P-384":384,"P-521":521},Fj=Object.keys(Mj),wAe=Fj.join(" / ");async function GI(t,e){let r=yh.decode(t);return Z0().decrypt(r,e)}var cx={};T(cx,{MAX_KEY_SIZE:()=>Nh,RsaPrivateKey:()=>Zc,RsaPublicKey:()=>Ph,fromJwk:()=>Yj,generateKeyPair:()=>Qj,unmarshalRsaPrivateKey:()=>Wj,unmarshalRsaPublicKey:()=>jj});var Bh=J(Oe(),1);var n8e=J(JI(),1);function Ua(t){if(isNaN(t)||t<=0)throw new C("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return _a(t)}var FAe=J(P0(),1),ix=J(Oe(),1);function ZI(t,e){return e.map(r=>dn(t[r]))}function eD(t){return ix.default.pki.setRsaPrivateKey(...ZI(t,["n","e","d","p","q","dp","dq","qi"]))}function tD(t){return ix.default.pki.setRsaPublicKey(...ZI(t,["n","e"]))}var ka={};T(ka,{jwkToPkcs1:()=>$j,jwkToPkix:()=>qj,pkcs1ToJwk:()=>zj,pkixToJwk:()=>Kj});var $Ae=J(dh(),1),KAe=J(P0(),1);var cs=J(Oe(),1);function zj(t){let e=cs.default.asn1.fromDer(Xr(t,"ascii")),r=cs.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:io(r.n),e:io(r.e),d:io(r.d),p:io(r.p),q:io(r.q),dp:io(r.dP),dq:io(r.dQ),qi:io(r.qInv),alg:"RS256"}}function $j(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new C("JWK was missing components","ERR_INVALID_PARAMETERS");let e=cs.default.pki.privateKeyToAsn1({n:dn(t.n),e:dn(t.e),d:dn(t.d),p:dn(t.p),q:dn(t.q),dP:dn(t.dp),dQ:dn(t.dq),qInv:dn(t.qi)});return Vr(cs.default.asn1.toDer(e).getBytes(),"ascii")}function Kj(t){let e=cs.default.asn1.fromDer(Xr(t,"ascii")),r=cs.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:io(r.n),e:io(r.e)}}function qj(t){if(t.n==null||t.e==null)throw new C("JWK was missing components","ERR_INVALID_PARAMETERS");let e=cs.default.pki.publicKeyToAsn1({n:dn(t.n),e:dn(t.e)});return Vr(cs.default.asn1.toDer(e).getBytes(),"ascii")}async function rD(t){let e=await Qr.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await sD(e);return{privateKey:r[0],publicKey:r[1]}}async function ax(t){let r=[await Qr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Hj(t)],n=await sD({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function nD(t,e){let r=await Qr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Qr.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function oD(t,e,r){let n=await Qr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Qr.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function sD(t){if(t.privateKey==null||t.publicKey==null)throw new C("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Qr.get().subtle.exportKey("jwk",t.privateKey),Qr.get().subtle.exportKey("jwk",t.publicKey)])}async function Hj(t){return Qr.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function iD(t,e,r,n){let o=e?tD(t):eD(t),s=Xr(Uint8Array.from(r),"ascii"),i=n(s,o);return Vr(i,"ascii")}function aD(t,e){return iD(t,!0,e,(r,n)=>n.encrypt(r))}function cD(t,e){return iD(t,!1,e,(r,n)=>n.decrypt(r))}function im(t){if(t.kty!=="RSA")throw new C("invalid key type","ERR_INVALID_KEY_TYPE");if(t.n==null)throw new C("invalid key modulus","ERR_INVALID_KEY_MODULUS");return Vr(t.n,"base64url").length*8}var Nh=8192,Ph=class{_key;constructor(e){this._key=e}async verify(e,r){return oD(this._key,r,e)}marshal(){return ka.jwkToPkix(this._key)}get bytes(){return Bo.encode({Type:at.RSA,Data:this.marshal()}).subarray()}encrypt(e){return aD(this._key,e)}equals(e){return Do(this.bytes,e.bytes)}async hash(){let{bytes:e}=await fn.digest(this.bytes);return e}},Zc=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Ua(16)}async sign(e){return nD(this._key,e)}get public(){if(this._publicKey==null)throw new C("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Ph(this._publicKey)}decrypt(e){return cD(this._key,e)}marshal(){return ka.jwkToPkcs1(this._key)}get bytes(){return Po.encode({Type:at.RSA,Data:this.marshal()}).subarray()}equals(e){return Do(this.bytes,e.bytes)}async hash(){let{bytes:e}=await fn.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Xr(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Bh.default.util.ByteBuffer(this.marshal()),o=Bh.default.asn1.fromDer(n),s=Bh.default.pki.privateKeyFromAsn1(o),i={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Bh.default.pki.encryptRsaPrivateKey(s,e,i)}else{if(r==="libp2p-key")return Yc(this.bytes,e);throw new C(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function Wj(t){let e=ka.pkcs1ToJwk(t);if(im(e)>Nh)throw new C("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let r=await ax(e);return new Zc(r.privateKey,r.publicKey)}function jj(t){let e=ka.pkixToJwk(t);if(im(e)>Nh)throw new C("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Ph(e)}async function Yj(t){if(im(t)>Nh)throw new C("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await ax(t);return new Zc(e.privateKey,e.publicKey)}async function Qj(t){if(t>Nh)throw new C("key size is too large","ERR_KEY_SIZE_TOO_LARGE");let e=await rD(t);return new Zc(e.privateKey,e.publicKey)}var dx={};T(dx,{Secp256k1PrivateKey:()=>Uh,Secp256k1PublicKey:()=>Oh,generateKeyPair:()=>fY,unmarshalSecp256k1PrivateKey:()=>uY,unmarshalSecp256k1PublicKey:()=>lY});var Xj=(t,e,r)=>t&e^~t&r,Jj=(t,e,r)=>t&e^t&r^e&r,Zj=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Si=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ai=new Uint32Array(64),ux=class extends Gc{constructor(){super(64,32,8,!1),this.A=Si[0]|0,this.B=Si[1]|0,this.C=Si[2]|0,this.D=Si[3]|0,this.E=Si[4]|0,this.F=Si[5]|0,this.G=Si[6]|0,this.H=Si[7]|0}get(){let{A:e,B:r,C:n,D:o,E:s,F:i,G:a,H:c}=this;return[e,r,n,o,s,i,a,c]}set(e,r,n,o,s,i,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=a|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)Ai[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let p=Ai[h-15],m=Ai[h-2],f=eo(p,7)^eo(p,18)^p>>>3,d=eo(m,17)^eo(m,19)^m>>>10;Ai[h]=d+Ai[h-7]+f+Ai[h-16]|0}let{A:n,B:o,C:s,D:i,E:a,F:c,G:u,H:l}=this;for(let h=0;h<64;h++){let p=eo(a,6)^eo(a,11)^eo(a,25),m=l+p+Xj(a,c,u)+Zj[h]+Ai[h]|0,d=(eo(n,2)^eo(n,13)^eo(n,22))+Jj(n,o,s)|0;l=u,u=c,c=a,a=i+m|0,i=s,s=o,o=n,n=m+d|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,o,s,i,a,c,u,l)}roundClean(){Ai.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var eu=$0(()=>new ux);function eY(t){let e=Ah(t);Vn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:o}=e;if(r){if(!n.eql(o,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:tY,hexToBytes:rY}=G0,Ma={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=Ma;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:tY(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=Ma,r=typeof t=="string"?rY(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:o,l:s}=Ma._parseInt(r.subarray(2)),{d:i,l:a}=Ma._parseInt(s);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:o,s:i}},hexFromSig(t){let e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let l=u.toString(16);return l.length&1?`0${l}`:l},n=e(r(t.s)),o=e(r(t.r)),s=n.length/2,i=o.length/2,a=r(s),c=r(i);return`30${r(i+s+4)}02${c}${o}02${a}${n}`}},us=BigInt(0),$n=BigInt(1),h8e=BigInt(2),uD=BigInt(3),d8e=BigInt(4);function nY(t){let e=eY(t),{Fp:r}=e,n=e.toBytes||((f,d,g)=>{let y=d.toAffine();return ss(Uint8Array.from([4]),r.toBytes(y.x),r.toBytes(y.y))}),o=e.fromBytes||(f=>{let d=f.subarray(1),g=r.fromBytes(d.subarray(0,r.BYTES)),y=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:g,y}});function s(f){let{a:d,b:g}=e,y=r.sqr(f),b=r.mul(y,f);return r.add(r.add(b,r.mul(f,d)),g)}if(!r.eql(r.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function i(f){return typeof f=="bigint"&&us<f&&f<e.n}function a(f){if(!i(f))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(f){let{allowedPrivateKeyLengths:d,nByteLength:g,wrapPrivateKey:y,n:b}=e;if(d&&typeof f!="bigint"){if(f instanceof Uint8Array&&(f=rs(f)),typeof f!="string"||!d.includes(f.length))throw new Error("Invalid key");f=f.padStart(g*2,"0")}let w;try{w=typeof f=="bigint"?f:ns(tt("private key",f,g))}catch{throw new Error(`private key must be ${g} bytes, hex or bigint, not ${typeof f}`)}return y&&(w=Ie(w,b)),a(w),w}let u=new Map;function l(f){if(!(f instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(d,g,y){if(this.px=d,this.py=g,this.pz=y,d==null||!r.isValid(d))throw new Error("x required");if(g==null||!r.isValid(g))throw new Error("y required");if(y==null||!r.isValid(y))throw new Error("z required")}static fromAffine(d){let{x:g,y}=d||{};if(!d||!r.isValid(g)||!r.isValid(y))throw new Error("invalid affine point");if(d instanceof h)throw new Error("projective point not allowed");let b=w=>r.eql(w,r.ZERO);return b(g)&&b(y)?h.ZERO:new h(g,y,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let g=r.invertBatch(d.map(y=>y.pz));return d.map((y,b)=>y.toAffine(g[b])).map(h.fromAffine)}static fromHex(d){let g=h.fromAffine(o(tt("pointHex",d)));return g.assertValidity(),g}static fromPrivateKey(d){return h.BASE.multiply(c(d))}_setWindowSize(d){this._WINDOW_SIZE=d,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:d,y:g}=this.toAffine();if(!r.isValid(d)||!r.isValid(g))throw new Error("bad point: x or y not FE");let y=r.sqr(g),b=s(d);if(!r.eql(y,b))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){l(d);let{px:g,py:y,pz:b}=this,{px:w,py:x,pz:E}=d,S=r.eql(r.mul(g,E),r.mul(w,b)),v=r.eql(r.mul(y,E),r.mul(x,b));return S&&v}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){let{a:d,b:g}=e,y=r.mul(g,uD),{px:b,py:w,pz:x}=this,E=r.ZERO,S=r.ZERO,v=r.ZERO,A=r.mul(b,b),_=r.mul(w,w),z=r.mul(x,x),V=r.mul(b,w);return V=r.add(V,V),v=r.mul(b,x),v=r.add(v,v),E=r.mul(d,v),S=r.mul(y,z),S=r.add(E,S),E=r.sub(_,S),S=r.add(_,S),S=r.mul(E,S),E=r.mul(V,E),v=r.mul(y,v),z=r.mul(d,z),V=r.sub(A,z),V=r.mul(d,V),V=r.add(V,v),v=r.add(A,A),A=r.add(v,A),A=r.add(A,z),A=r.mul(A,V),S=r.add(S,A),z=r.mul(w,x),z=r.add(z,z),A=r.mul(z,V),E=r.sub(E,A),v=r.mul(z,_),v=r.add(v,v),v=r.add(v,v),new h(E,S,v)}add(d){l(d);let{px:g,py:y,pz:b}=this,{px:w,py:x,pz:E}=d,S=r.ZERO,v=r.ZERO,A=r.ZERO,_=e.a,z=r.mul(e.b,uD),V=r.mul(g,w),K=r.mul(y,x),G=r.mul(b,E),se=r.add(g,y),L=r.add(w,x);se=r.mul(se,L),L=r.add(V,K),se=r.sub(se,L),L=r.add(g,b);let O=r.add(w,E);return L=r.mul(L,O),O=r.add(V,G),L=r.sub(L,O),O=r.add(y,b),S=r.add(x,E),O=r.mul(O,S),S=r.add(K,G),O=r.sub(O,S),A=r.mul(_,L),S=r.mul(z,G),A=r.add(S,A),S=r.sub(K,A),A=r.add(K,A),v=r.mul(S,A),K=r.add(V,V),K=r.add(K,V),G=r.mul(_,G),L=r.mul(z,L),K=r.add(K,G),G=r.sub(V,G),G=r.mul(_,G),L=r.add(L,G),V=r.mul(K,L),v=r.add(v,V),V=r.mul(O,L),S=r.mul(se,S),S=r.sub(S,V),V=r.mul(se,K),A=r.mul(O,A),A=r.add(A,V),new h(S,v,A)}subtract(d){return this.add(d.negate())}is0(){return this.equals(h.ZERO)}wNAF(d){return m.wNAFCached(this,u,d,g=>{let y=r.invertBatch(g.map(b=>b.pz));return g.map((b,w)=>b.toAffine(y[w])).map(h.fromAffine)})}multiplyUnsafe(d){let g=h.ZERO;if(d===us)return g;if(a(d),d===$n)return this;let{endo:y}=e;if(!y)return m.unsafeLadder(this,d);let{k1neg:b,k1:w,k2neg:x,k2:E}=y.splitScalar(d),S=g,v=g,A=this;for(;w>us||E>us;)w&$n&&(S=S.add(A)),E&$n&&(v=v.add(A)),A=A.double(),w>>=$n,E>>=$n;return b&&(S=S.negate()),x&&(v=v.negate()),v=new h(r.mul(v.px,y.beta),v.py,v.pz),S.add(v)}multiply(d){a(d);let g=d,y,b,{endo:w}=e;if(w){let{k1neg:x,k1:E,k2neg:S,k2:v}=w.splitScalar(g),{p:A,f:_}=this.wNAF(E),{p:z,f:V}=this.wNAF(v);A=m.constTimeNegate(x,A),z=m.constTimeNegate(S,z),z=new h(r.mul(z.px,w.beta),z.py,z.pz),y=A.add(z),b=_.add(V)}else{let{p:x,f:E}=this.wNAF(g);y=x,b=E}return h.normalizeZ([y,b])[0]}multiplyAndAddUnsafe(d,g,y){let b=h.BASE,w=(E,S)=>S===us||S===$n||!E.equals(b)?E.multiplyUnsafe(S):E.multiply(S),x=w(this,g).add(w(d,y));return x.is0()?void 0:x}toAffine(d){let{px:g,py:y,pz:b}=this,w=this.is0();d==null&&(d=w?r.ONE:r.inv(b));let x=r.mul(g,d),E=r.mul(y,d),S=r.mul(b,d);if(w)return{x:r.ZERO,y:r.ZERO};if(!r.eql(S,r.ONE))throw new Error("invZ was invalid");return{x,y:E}}isTorsionFree(){let{h:d,isTorsionFree:g}=e;if(d===$n)return!0;if(g)return g(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:g}=e;return d===$n?this:g?g(h,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),n(h,this,d)}toHex(d=!0){return rs(this.toRawBytes(d))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);let p=e.nBitLength,m=Y0(h,e.endo?Math.ceil(p/2):p);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:i}}function oY(t){let e=Ah(t);return Vn(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function lD(t){let e=oY(t),{Fp:r,n}=e,o=r.BYTES+1,s=2*r.BYTES+1;function i(L){return us<L&&L<r.ORDER}function a(L){return Ie(L,n)}function c(L){return W0(L,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:l,weierstrassEquation:h,isWithinCurveOrder:p}=nY({...e,toBytes(L,O,P){let N=O.toAffine(),D=r.toBytes(N.x),F=ss;return P?F(Uint8Array.from([O.hasEvenY()?2:3]),D):F(Uint8Array.from([4]),D,r.toBytes(N.y))},fromBytes(L){let O=L.length,P=L[0],N=L.subarray(1);if(O===o&&(P===2||P===3)){let D=ns(N);if(!i(D))throw new Error("Point is not on curve");let F=h(D),q=r.sqrt(F),W=(q&$n)===$n;return(P&1)===1!==W&&(q=r.neg(q)),{x:D,y:q}}else if(O===s&&P===4){let D=r.fromBytes(N.subarray(0,r.BYTES)),F=r.fromBytes(N.subarray(r.BYTES,2*r.BYTES));return{x:D,y:F}}else throw new Error(`Point of length ${O} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),m=L=>rs(xi(L,e.nByteLength));function f(L){let O=n>>$n;return L>O}function d(L){return f(L)?a(-L):L}let g=(L,O,P)=>ns(L.slice(O,P));class y{constructor(O,P,N){this.r=O,this.s=P,this.recovery=N,this.assertValidity()}static fromCompact(O){let P=e.nByteLength;return O=tt("compactSignature",O,P*2),new y(g(O,0,P),g(O,P,2*P))}static fromDER(O){let{r:P,s:N}=Ma.toSig(tt("DER",O));return new y(P,N)}assertValidity(){if(!p(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!p(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(O){return new y(this.r,this.s,O)}recoverPublicKey(O){let{r:P,s:N,recovery:D}=this,F=v(tt("msgHash",O));if(D==null||![0,1,2,3].includes(D))throw new Error("recovery id invalid");let q=D===2||D===3?P+e.n:P;if(q>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let W=(D&1)===0?"02":"03",oe=u.fromHex(W+m(q)),ie=c(q),pe=a(-F*ie),ae=a(N*ie),le=u.BASE.multiplyAndAddUnsafe(oe,pe,ae);if(!le)throw new Error("point at infinify");return le.assertValidity(),le}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Ia(this.toDERHex())}toDERHex(){return Ma.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ia(this.toCompactHex())}toCompactHex(){return m(this.r)+m(this.s)}}let b={isValidPrivateKey(L){try{return l(L),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{let L=Nw(e.n);return F5(e.randomBytes(L),e.n)},precompute(L=8,O=u.BASE){return O._setWindowSize(L),O.multiply(BigInt(3)),O}};function w(L,O=!0){return u.fromPrivateKey(L).toRawBytes(O)}function x(L){let O=L instanceof Uint8Array,P=typeof L=="string",N=(O||P)&&L.length;return O?N===o||N===s:P?N===2*o||N===2*s:L instanceof u}function E(L,O,P=!0){if(x(L))throw new Error("first arg must be private key");if(!x(O))throw new Error("second arg must be public key");return u.fromHex(O).multiply(l(L)).toRawBytes(P)}let S=e.bits2int||function(L){let O=ns(L),P=L.length*8-e.nBitLength;return P>0?O>>BigInt(P):O},v=e.bits2int_modN||function(L){return a(S(L))},A=Sh(e.nBitLength);function _(L){if(typeof L!="bigint")throw new Error("bigint expected");if(!(us<=L&&L<A))throw new Error(`bigint expected < 2^${e.nBitLength}`);return xi(L,e.nByteLength)}function z(L,O,P=V){if(["recovered","canonical"].some(Ne=>Ne in P))throw new Error("sign() legacy options not supported");let{hash:N,randomBytes:D}=e,{lowS:F,prehash:q,extraEntropy:W}=P;F==null&&(F=!0),L=tt("msgHash",L),q&&(L=tt("prehashed msgHash",N(L)));let oe=v(L),ie=l(O),pe=[_(ie),_(oe)];if(W!=null){let Ne=W===!0?D(r.BYTES):W;pe.push(tt("extraEntropy",Ne))}let ae=ss(...pe),le=oe;function $e(Ne){let dr=S(Ne);if(!p(dr))return;let pr=c(dr),Xt=u.BASE.multiply(dr).toAffine(),Tr=a(Xt.x);if(Tr===us)return;let Xo=a(pr*a(le+Tr*ie));if(Xo===us)return;let xa=(Xt.x===Tr?0:2)|Number(Xt.y&$n),ch=Xo;return F&&f(Xo)&&(ch=d(Xo),xa^=1),new y(Tr,ch,xa)}return{seed:ae,k2sig:$e}}let V={lowS:e.lowS,prehash:!1},K={lowS:e.lowS,prehash:!1};function G(L,O,P=V){let{seed:N,k2sig:D}=z(L,O,P),F=e;return Dw(F.hash.outputLen,F.nByteLength,F.hmac)(N,D)}u.BASE._setWindowSize(8);function se(L,O,P,N=K){let D=L;if(O=tt("msgHash",O),P=tt("publicKey",P),"strict"in N)throw new Error("options.strict was renamed to lowS");let{lowS:F,prehash:q}=N,W,oe;try{if(typeof D=="string"||D instanceof Uint8Array)try{W=y.fromDER(D)}catch(Xt){if(!(Xt instanceof Ma.Err))throw Xt;W=y.fromCompact(D)}else if(typeof D=="object"&&typeof D.r=="bigint"&&typeof D.s=="bigint"){let{r:Xt,s:Tr}=D;W=new y(Xt,Tr)}else throw new Error("PARSE");oe=u.fromHex(P)}catch(Xt){if(Xt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(F&&W.hasHighS())return!1;q&&(O=e.hash(O));let{r:ie,s:pe}=W,ae=v(O),le=c(pe),$e=a(ae*le),Ne=a(ie*le),dr=u.BASE.multiplyAndAddUnsafe(oe,$e,Ne)?.toAffine();return dr?a(dr.x)===ie:!1}return{CURVE:e,getPublicKey:w,getSharedSecret:E,sign:G,verify:se,ProjectivePoint:u,Signature:y,utils:b}}var am=class extends Hc{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,vh(e);let n=yi(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?e.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=e.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(e){return qc(this),this.iHash.update(e),this}digestInto(e){qc(this),vw(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:a}=this;return e=e,e.finished=o,e.destroyed=s,e.blockLen=i,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},tu=(t,e,r)=>new am(t,e).update(r).digest();tu.create=(t,e)=>new am(t,e);function sY(t){return{hash:t,hmac:(e,...r)=>tu(t,e,z0(...r)),randomBytes:_a}}function fD(t,e){let r=n=>lD({...t,...sY(n)});return Object.freeze({...r(e),create:r})}var pD=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),hD=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),iY=BigInt(1),lx=BigInt(2),dD=(t,e)=>(t+e/lx)/e;function aY(t){let e=pD,r=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,l=u*u*t%e,h=rt(l,r,e)*l%e,p=rt(h,r,e)*l%e,m=rt(p,lx,e)*u%e,f=rt(m,o,e)*m%e,d=rt(f,s,e)*f%e,g=rt(d,a,e)*d%e,y=rt(g,c,e)*g%e,b=rt(y,a,e)*d%e,w=rt(b,r,e)*l%e,x=rt(w,i,e)*f%e,E=rt(x,n,e)*u%e,S=rt(E,lx,e);if(!fx.eql(fx.sqr(S),t))throw new Error("Cannot find square root");return S}var fx=j0(pD,void 0,void 0,{sqrt:aY}),ls=fD({a:BigInt(0),b:BigInt(7),Fp:fx,n:hD,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=hD,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-iY*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,i=BigInt("0x100000000000000000000000000000000"),a=dD(s*t,e),c=dD(-n*t,e),u=Ie(t-a*r-c*o,e),l=Ie(-a*n-c*s,e),h=u>i,p=l>i;if(h&&(u=e-u),p&&(l=e-l),u>i||l>i)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:u,k2neg:p,k2:l}}}},eu),C8e=BigInt(0);var T8e=ls.ProjectivePoint;function mD(){return ls.utils.randomPrivateKey()}async function gD(t,e){let{digest:r}=await fn.digest(e);try{return ls.sign(r,t).toDERRawBytes()}catch(n){throw new C(String(n),"ERR_INVALID_INPUT")}}async function yD(t,e,r){try{let{digest:n}=await fn.digest(r);return ls.verify(e,n,t)}catch(n){throw new C(String(n),"ERR_INVALID_INPUT")}}function bD(t){return ls.ProjectivePoint.fromHex(t).toRawBytes(!0)}function wD(t){try{ls.getPublicKey(t,!0)}catch(e){throw new C(String(e),"ERR_INVALID_PRIVATE_KEY")}}function hx(t){try{ls.ProjectivePoint.fromHex(t)}catch(e){throw new C(String(e),"ERR_INVALID_PUBLIC_KEY")}}function xD(t){try{return ls.getPublicKey(t,!0)}catch(e){throw new C(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Oh=class{_key;constructor(e){hx(e),this._key=e}async verify(e,r){return yD(this._key,r,e)}marshal(){return bD(this._key)}get bytes(){return Bo.encode({Type:at.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Do(this.bytes,e.bytes)}async hash(){let{bytes:e}=await fn.digest(this.bytes);return e}},Uh=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??xD(e),wD(this._key),hx(this._publicKey)}async sign(e){return gD(this._key,e)}get public(){return new Oh(this._publicKey)}marshal(){return this._key}get bytes(){return Po.encode({Type:at.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Do(this.bytes,e.bytes)}async hash(){let{bytes:e}=await fn.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Xr(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Yc(this.bytes,e);throw new C(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function uY(t){return new Uh(t)}function lY(t){return new Oh(t)}async function fY(){let t=mD();return new Uh(t)}var fs={rsa:cx,ed25519:nx,secp256k1:dx};function px(t){let e=Object.keys(fs).join(" / ");return new C(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function mx(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return fs[t];throw px(t)}async function um(t,e){return mx(t).generateKeyPair(e??2048)}function Fa(t){let e=Bo.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case at.RSA:return fs.rsa.unmarshalRsaPublicKey(r);case at.Ed25519:return fs.ed25519.unmarshalEd25519PublicKey(r);case at.Secp256k1:return fs.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw px(e.Type??"unknown")}}function ED(t,e){return e=(e??"rsa").toLowerCase(),mx(e),t.bytes}async function Ci(t){let e=Po.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case at.RSA:return fs.rsa.unmarshalRsaPrivateKey(r);case at.Ed25519:return fs.ed25519.unmarshalEd25519PrivateKey(r);case at.Secp256k1:return fs.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw px(e.Type??"RSA")}}function vD(t,e){return e=(e??"rsa").toLowerCase(),mx(e),t.bytes}async function kh(t,e){try{let o=await GI(t,e);return await Ci(o)}catch{}let r=cm.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new C("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=cm.default.asn1.toDer(cm.default.pki.privateKeyToAsn1(r));return n=Vr(n.getBytes(),"ascii"),fs.rsa.unmarshalRsaPrivateKey(n)}var gx=Symbol.for("@libp2p/content-routing");var mr=class extends EventTarget{#e=new Map;listenerCount(e){let r=this.#e.get(e);return r==null?0:r.length}addEventListener(e,r,n){super.addEventListener(e,r,n);let o=this.#e.get(e);o==null&&(o=[],this.#e.set(e,o)),o.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(e,r,n){super.removeEventListener(e.toString(),r??null,n);let o=this.#e.get(e);o!=null&&(o=o.filter(({callback:s})=>s!==r),this.#e.set(e,o))}dispatchEvent(e){let r=super.dispatchEvent(e),n=this.#e.get(e.type);return n==null||(n=n.filter(({once:o})=>!o),this.#e.set(e.type,n)),r}safeDispatchEvent(e,r){return this.dispatchEvent(new bx(e,r))}},yx=class extends Event{detail;constructor(e,r){super(e,r),this.detail=r?.detail}},bx=globalThis.CustomEvent??yx;var wx=Symbol.for("@libp2p/peer-discovery");var xx=Symbol.for("@libp2p/peer-routing");var X8e=J(v0(),1),dY=J(Oe(),1);var AD=J(zb(),1),CD=J(Ut(),1),SD={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Mh(t,e,r,n,o){if(o!=="sha1"&&o!=="sha2-256"&&o!=="sha2-512"){let a=Object.keys(SD).join(" / ");throw new C(`Hash '${o}' is unknown or not supported. Must be ${a}`,"ERR_UNSUPPORTED_HASH_TYPE")}let s=SD[o],i=(0,AD.default)(t,e,r,n,s);return CD.default.encode64(i,null)}var mn=J(ao(),1);var Cx={};T(Cx,{base32:()=>_i,base32hex:()=>UY,base32hexpad:()=>MY,base32hexpadupper:()=>FY,base32hexupper:()=>kY,base32pad:()=>NY,base32padupper:()=>OY,base32upper:()=>PY,base32z:()=>VY});function IY(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var DY=IY,RY=DY,RD=RY;var h4e=new Uint8Array(0);var LD=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},hs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var BD=t=>new TextEncoder().encode(t),PD=t=>new TextDecoder().decode(t);var Ex=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},vx=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return OD(this,e)}},Sx=class{constructor(e){this.decoders=e}or(e){return OD(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},OD=(t,e)=>new Sx({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Ax=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Ex(e,r,n),this.decoder=new vx(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},su=({name:t,prefix:e,encode:r,decode:n})=>new Ax(t,e,r,n),Ti=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=RD(r,e);return su({prefix:t,name:e,encode:n,decode:s=>hs(o(s))})},LY=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},BY=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},wt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>su({prefix:e,name:t,encode(o){return BY(o,n,r)},decode(o){return LY(o,n,r,t)}});var _i=wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),PY=wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),NY=wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),OY=wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),UY=wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kY=wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),MY=wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),FY=wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),VY=wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Tx={};T(Tx,{base58btc:()=>zr,base58flickr:()=>zY});var zr=Ti({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zY=Ti({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ix={};T(Ix,{base64:()=>_x,base64pad:()=>$Y,base64url:()=>KY,base64urlpad:()=>qY});var _x=wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$Y=wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),KY=wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qY=wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});mn.default.formatters.b=t=>t==null?"undefined":zr.baseEncode(t);mn.default.formatters.t=t=>t==null?"undefined":_i.baseEncode(t);mn.default.formatters.m=t=>t==null?"undefined":_x.baseEncode(t);mn.default.formatters.p=t=>t==null?"undefined":t.toString();mn.default.formatters.c=t=>t==null?"undefined":t.toString();mn.default.formatters.k=t=>t==null?"undefined":t.toString();mn.default.formatters.a=t=>t==null?"undefined":t.toString();function HY(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function UD(t){let e=HY(`${t}:trace`);return mn.default.enabled(`${t}:trace`)&&mn.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,mn.default)(`${t}:trace`)),Object.assign((0,mn.default)(t),{error:(0,mn.default)(`${t}:error`),trace:e})}var gr=Symbol.for("@libp2p/peer-id");function hm(t){return t!=null&&Boolean(t[gr])}var Dx={};T(Dx,{base10:()=>GY});var GY=Ti({prefix:"9",name:"base10",alphabet:"0123456789"});var Rx={};T(Rx,{base16:()=>WY,base16upper:()=>jY});var WY=wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),jY=wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Lx={};T(Lx,{base2:()=>YY});var YY=wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Bx={};T(Bx,{base256emoji:()=>eQ});var kD=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),QY=kD.reduce((t,e,r)=>(t[r]=e,t),[]),XY=kD.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function JY(t){return t.reduce((e,r)=>(e+=QY[r],e),"")}function ZY(t){let e=[];for(let r of t){let n=XY[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var eQ=su({prefix:"\u{1F680}",name:"base256emoji",encode:JY,decode:ZY});var Px={};T(Px,{base36:()=>tQ,base36upper:()=>rQ});var tQ=Ti({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),rQ=Ti({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Nx={};T(Nx,{base8:()=>nQ});var nQ=wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ox={};T(Ox,{identity:()=>oQ});var oQ=su({prefix:"\0",name:"identity",encode:t=>PD(t),decode:t=>BD(t)});var B4e=new TextEncoder,P4e=new TextDecoder;var kx={};T(kx,{identity:()=>lu});var aQ=VD,MD=128,cQ=127,uQ=~cQ,lQ=Math.pow(2,31);function VD(t,e,r){e=e||[],r=r||0;for(var n=r;t>=lQ;)e[r++]=t&255|MD,t/=128;for(;t&uQ;)e[r++]=t&255|MD,t>>>=7;return e[r]=t|0,VD.bytes=r-n+1,e}var fQ=Ux,hQ=128,FD=127;function Ux(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw Ux.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&FD)<<o:(i&FD)*Math.pow(2,o),o+=7}while(i>=hQ);return Ux.bytes=s-n,r}var dQ=Math.pow(2,7),pQ=Math.pow(2,14),mQ=Math.pow(2,21),gQ=Math.pow(2,28),yQ=Math.pow(2,35),bQ=Math.pow(2,42),wQ=Math.pow(2,49),xQ=Math.pow(2,56),EQ=Math.pow(2,63),vQ=function(t){return t<dQ?1:t<pQ?2:t<mQ?3:t<gQ?4:t<yQ?5:t<bQ?6:t<wQ?7:t<xQ?8:t<EQ?9:10},SQ={encode:aQ,decode:fQ,encodingLength:vQ},AQ=SQ,Fh=AQ;var Vh=(t,e=0)=>[Fh.decode(t,e),Fh.decode.bytes],iu=(t,e,r=0)=>(Fh.encode(t,e,r),e),au=t=>Fh.encodingLength(t);var No=(t,e)=>{let r=e.byteLength,n=au(t),o=n+au(r),s=new Uint8Array(o+r);return iu(t,s,0),iu(r,s,n),s.set(e,o),new cu(t,r,e,s)},zh=t=>{let e=hs(t),[r,n]=Vh(e),[o,s]=Vh(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new cu(r,o,i,e)},zD=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&LD(t.bytes,r.bytes)}},cu=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var $D=0,CQ="identity",KD=hs,TQ=t=>No($D,KD(t)),lu={code:$D,name:CQ,encode:KD,digest:TQ};var Vx={};T(Vx,{sha256:()=>$h,sha512:()=>_Q});var Fx=({name:t,code:e,encode:r})=>new Mx(t,e,r),Mx=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?No(this.code,r):r.then(n=>No(this.code,n))}else throw Error("Unknown type, must be binary type")}};var HD=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),$h=Fx({name:"sha2-256",code:18,encode:HD("SHA-256")}),_Q=Fx({name:"sha2-512",code:19,encode:HD("SHA-512")});var GD=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return DQ(r,zx(t),e||zr.encoder);default:return RQ(r,zx(t),e||_i.encoder)}};var WD=new WeakMap,zx=t=>{let e=WD.get(t);if(e==null){let r=new Map;return WD.set(t,r),r}return e},dt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Kh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==LQ)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return dt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=No(e,r);return dt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return dt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&zD(e.multihash,n.multihash)}toString(e){return GD(this,e)}toJSON(){return{"/":GD(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof dt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new dt(n,o,s,i||jD(n,o,s.bytes))}else if(r[BQ]===!0){let{version:n,multihash:o,code:s}=r,i=zh(o);return dt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Kh)throw new Error(`Version 0 CID must use dag-pb (code: ${Kh}) block encoding`);return new dt(e,r,n,n.bytes)}case 1:{let o=jD(e,r,n.bytes);return new dt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return dt.create(0,Kh,e)}static createV1(e,r){return dt.create(1,e,r)}static decode(e){let[r,n]=dt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=dt.inspectBytes(e),n=r.size-r.multihashSize,o=hs(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new cu(r.multihashCode,r.digestSize,s,o);return[r.version===0?dt.createV0(i):dt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Vh(e.subarray(r));return r+=p,h},o=n(),s=Kh;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=IQ(e,r),s=dt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return zx(s).set(n,e),s}},IQ=(t,e)=>{switch(t[0]){case"Q":{let r=e||zr;return[zr.prefix,r.decode(`${zr.prefix}${t}`)]}case zr.prefix:{let r=e||zr;return[zr.prefix,r.decode(t)]}case _i.prefix:{let r=e||_i;return[_i.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},DQ=(t,e,r)=>{let{prefix:n}=r;if(n!==zr.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},RQ=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},Kh=112,LQ=18,jD=(t,e,r)=>{let n=au(t),o=n+au(e),s=new Uint8Array(o+r.byteLength);return iu(t,s,0),iu(e,s,n),s.set(r,o),s},BQ=Symbol.for("@ipld/js-cid/CID");var fu={...Ox,...Lx,...Nx,...Dx,...Rx,...Cx,...Px,...Tx,...Ix,...Bx},Y4e={...Vx,...kx};function $x(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var PQ=Symbol.for("nodejs.util.inspect.custom"),YD=Object.values(fu).map(t=>t.decoder).reduce((t,e)=>t.or(e),fu.identity.decoder),QD=114,Kx=36,qx=37,qh=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[gr]=!0;toString(){return this.string==null&&(this.string=zr.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return dt.createV1(QD,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return $x(this.multihash.bytes,e);if(typeof e=="string")return NQ(e).equals(this);if(e?.multihash?.bytes!=null)return $x(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[PQ](){return`PeerId(${this.toString()})`}},hu=class extends qh{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},du=class extends qh{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},pu=class extends qh{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function NQ(t,e){if(e=e??YD,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=zh(zr.decode(`z${t}`));return t.startsWith("12D")?new du({multihash:r}):t.startsWith("16U")?new pu({multihash:r}):new hu({multihash:r})}return OQ(YD.decode(t))}function OQ(t){try{let e=zh(t);if(e.code===lu.code){if(e.digest.length===Kx)return new du({multihash:e});if(e.digest.length===qx)return new pu({multihash:e})}if(e.code===$h.code)return new hu({multihash:e})}catch{return UQ(dt.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function UQ(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==QD)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===$h.code)return new hu({multihash:t.multihash});if(e.code===lu.code){if(e.digest.length===Kx)return new du({multihash:t.multihash});if(e.digest.length===qx)return new pu({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function XD(t,e){return t.length===Kx?new du({multihash:No(lu.code,t),privateKey:e}):t.length===qx?new pu({multihash:No(lu.code,t),privateKey:e}):new hu({multihash:await $h.digest(t),publicKey:t,privateKey:e})}var Ii=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"");function pm(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function JD(t=0){return globalThis.Buffer?.allocUnsafe!=null?pm(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function eR(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var ZD=eR("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Hx=eR("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=JD(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),kQ={utf8:ZD,"utf-8":ZD,hex:fu.base16,latin1:Hx,ascii:Hx,binary:Hx,...fu},mm=kQ;function Kn(t,e="utf8"){let r=mm[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?pm(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Oo(t,e="utf8"){let r=mm[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var ds="/",tR=new TextEncoder().encode(ds),gm=tR[0],yr=class{_buf;constructor(e,r){if(typeof e=="string")this._buf=Kn(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==gm)throw new Error("Invalid key")}toString(e="utf8"){return Oo(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new yr(e.join(ds))}static random(){return new yr(Ii().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new yr(e):typeof e.uint8Array=="function"?new yr(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=tR),this._buf[0]!==gm){let e=new Uint8Array(this._buf.byteLength+1);e.fill(gm,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===gm;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let o=0;o<r.length;o++){if(n.length<o+1)return!1;let s=r[o],i=n[o];if(s<i)return!0;if(s>i)return!1}return r.length<n.length}reverse(){return yr.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(ds).slice(1)}type(){return MQ(this.baseNamespace())}name(){return FQ(this.baseNamespace())}instance(e){return new yr(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(ds)||(e+=ds),e+=this.type(),new yr(e)}parent(){let e=this.list();return e.length===1?new yr(ds):new yr(e.slice(0,-1).join(ds))}child(e){return this.toString()===ds?e:e.toString()===ds?this:new yr(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return yr.withNamespaces([...this.namespaces(),...VQ(e.map(r=>r.namespaces()))])}};function MQ(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function FQ(t){let e=t.split(":");return e[e.length-1]}function VQ(t){return[].concat(...t)}var lR=J(uR(),1),Di=lR.default;var xR=J(wR(),1);var we;(function(t){t.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",t.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",t.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",t.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",t.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",t.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",t.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",t.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",t.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",t.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",t.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",t.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",t.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",t.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",t.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH"})(we||(we={}));var wm=UD("libp2p:keychain"),oX="/pkcs8/",ER="/info/",za=new WeakMap,$a={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},Wx={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function ps(t){return t==null||typeof t!="string"?!1:t===(0,xR.default)(t.trim())&&t.length>0}async function Ve(){let r=Math.random()*800+200;await new Promise(n=>setTimeout(n,r))}function Uo(t){return new yr(oX+t)}function Ri(t){return new yr(ER+t)}var Ka=class{components;init;constructor(e,r){if(this.components=e,this.init=Di(Wx,r),this.init.pass!=null&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<$a.minKeyLength)throw new Error(`dek.keyLength must be least ${$a.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<$a.minSaltLength)throw new Error(`dek.saltLength must be least ${$a.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<$a.minIterationCount)throw new Error(`dek.iterationCount must be least ${$a.minIterationCount}`);let n=this.init.pass!=null&&this.init.dek?.salt!=null?Mh(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";za.set(this,{dek:n})}static generateOptions(){let e=Object.assign({},Wx),r=Math.ceil($a.minSaltLength/3)*3;return e.dek.salt=Oo(Ua(r),"base64"),e}static get options(){return Wx}async createKey(e,r,n=2048){if(!ps(e)||e==="self")throw await Ve(),new C("Invalid key name",we.ERR_INVALID_KEY_NAME);if(typeof r!="string")throw await Ve(),new C("Invalid key type",we.ERR_INVALID_KEY_TYPE);let o=Uo(e);if(await this.components.datastore.has(o))throw await Ve(),new C("Key name already exists",we.ERR_KEY_ALREADY_EXISTS);switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)throw await Ve(),new C("Invalid RSA key size",we.ERR_INVALID_KEY_SIZE);break;default:break}let i;try{let a=await um(r,n),c=await a.id(),u=za.get(this);if(u==null)throw new C("dek missing",we.ERR_INVALID_PARAMETERS);let l=u.dek,h=await a.export(l);i={name:e,id:c};let p=this.components.datastore.batch();p.put(o,Kn(h)),p.put(Ri(e),Kn(JSON.stringify(i))),await p.commit()}catch(a){throw await Ve(),a}return i}async listKeys(){let e={prefix:ER},r=[];for await(let n of this.components.datastore.query(e))r.push(JSON.parse(Oo(n.value)));return r}async findKeyById(e){try{let n=(await this.listKeys()).find(o=>o.id===e);if(n==null)throw new C(`Key with id '${e}' does not exist.`,we.ERR_KEY_NOT_FOUND);return n}catch(r){throw await Ve(),r}}async findKeyByName(e){if(!ps(e))throw await Ve(),new C(`Invalid key name '${e}'`,we.ERR_INVALID_KEY_NAME);let r=Ri(e);try{let n=await this.components.datastore.get(r);return JSON.parse(Oo(n))}catch(n){throw await Ve(),wm.error(n),new C(`Key '${e}' does not exist.`,we.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!ps(e)||e==="self")throw await Ve(),new C(`Invalid key name '${e}'`,we.ERR_INVALID_KEY_NAME);let r=Uo(e),n=await this.findKeyByName(e),o=this.components.datastore.batch();return o.delete(r),o.delete(Ri(e)),await o.commit(),n}async renameKey(e,r){if(!ps(e)||e==="self")throw await Ve(),new C(`Invalid old key name '${e}'`,we.ERR_OLD_KEY_NAME_INVALID);if(!ps(r)||r==="self")throw await Ve(),new C(`Invalid new key name '${r}'`,we.ERR_NEW_KEY_NAME_INVALID);let n=Uo(e),o=Uo(r),s=Ri(e),i=Ri(r);if(await this.components.datastore.has(o))throw await Ve(),new C(`Key '${r}' already exists`,we.ERR_KEY_ALREADY_EXISTS);try{let c=await this.components.datastore.get(n),u=await this.components.datastore.get(s),l=JSON.parse(Oo(u));l.name=r;let h=this.components.datastore.batch();return h.put(o,c),h.put(i,Kn(JSON.stringify(l))),h.delete(n),h.delete(s),await h.commit(),l}catch(c){throw await Ve(),c}}async exportKey(e,r){if(!ps(e))throw await Ve(),new C(`Invalid key name '${e}'`,we.ERR_INVALID_KEY_NAME);if(r==null)throw await Ve(),new C("Password is required",we.ERR_PASSWORD_REQUIRED);let n=Uo(e);try{let o=await this.components.datastore.get(n),s=Oo(o),i=za.get(this);if(i==null)throw new C("dek missing",we.ERR_INVALID_PARAMETERS);let a=i.dek;return await(await kh(s,a)).export(r)}catch(o){throw await Ve(),o}}async exportPeerId(e){let r="temporary-password",n=await this.exportKey(e,r),o=await kh(n,r);return XD(o.public.bytes,o.bytes)}async importKey(e,r,n){if(!ps(e)||e==="self")throw await Ve(),new C(`Invalid key name '${e}'`,we.ERR_INVALID_KEY_NAME);if(r==null)throw await Ve(),new C("PEM encoded key is required",we.ERR_PEM_REQUIRED);let o=Uo(e);if(await this.components.datastore.has(o))throw await Ve(),new C(`Key '${e}' already exists`,we.ERR_KEY_ALREADY_EXISTS);let i;try{i=await kh(r,n)}catch{throw await Ve(),new C("Cannot read the key, most likely the password is wrong",we.ERR_CANNOT_READ_KEY)}let a;try{a=await i.id();let l=za.get(this);if(l==null)throw new C("dek missing",we.ERR_INVALID_PARAMETERS);let h=l.dek;r=await i.export(h)}catch(l){throw await Ve(),l}let c={name:e,id:a},u=this.components.datastore.batch();return u.put(o,Kn(r)),u.put(Ri(e),Kn(JSON.stringify(c))),await u.commit(),c}async importPeer(e,r){try{if(!ps(e))throw new C(`Invalid key name '${e}'`,we.ERR_INVALID_KEY_NAME);if(r==null)throw new C("PeerId is required",we.ERR_MISSING_PRIVATE_KEY);if(r.privateKey==null)throw new C("PeerId.privKey is required",we.ERR_MISSING_PRIVATE_KEY);let n=await Ci(r.privateKey),o=Uo(e);if(await this.components.datastore.has(o))throw await Ve(),new C(`Key '${e}' already exists`,we.ERR_KEY_ALREADY_EXISTS);let i=za.get(this);if(i==null)throw new C("dek missing",we.ERR_INVALID_PARAMETERS);let a=i.dek,c=await n.export(a),u={name:e,id:r.toString()},l=this.components.datastore.batch();return l.put(o,Kn(c)),l.put(Ri(e),Kn(JSON.stringify(u))),await l.commit(),u}catch(n){throw await Ve(),n}}async getPrivateKey(e){if(!ps(e))throw await Ve(),new C(`Invalid key name '${e}'`,we.ERR_INVALID_KEY_NAME);try{let r=Uo(e),n=await this.components.datastore.get(r);return Oo(n)}catch(r){throw await Ve(),wm.error(r),new C(`Key '${e}' does not exist.`,we.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,r){if(typeof e!="string")throw await Ve(),new C(`Invalid old pass type '${typeof e}'`,we.ERR_INVALID_OLD_PASS_TYPE);if(typeof r!="string")throw await Ve(),new C(`Invalid new pass type '${typeof r}'`,we.ERR_INVALID_NEW_PASS_TYPE);if(r.length<20)throw await Ve(),new C(`Invalid pass length ${r.length}`,we.ERR_INVALID_PASS_LENGTH);wm("recreating keychain");let n=za.get(this);if(n==null)throw new C("dek missing",we.ERR_INVALID_PARAMETERS);let o=n.dek;this.init.pass=r;let s=r!=null&&this.init.dek?.salt!=null?Mh(r,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";za.set(this,{dek:s});let i=await this.listKeys();for(let a of i){let c=await this.components.datastore.get(Uo(a.name)),u=Oo(c),l=await kh(u,o),h=s.toString(),p=await l.export(h),m=this.components.datastore.batch(),f={name:a.name,id:a.id};m.put(Uo(a.name),Kn(p)),m.put(Ri(a.name),Kn(JSON.stringify(f))),await m.commit()}wm("keychain reconstructed")}};var gn=J(ao(),1);var Jx={};T(Jx,{base32:()=>co,base32hex:()=>dX,base32hexpad:()=>mX,base32hexpadupper:()=>gX,base32hexupper:()=>pX,base32pad:()=>fX,base32padupper:()=>hX,base32upper:()=>lX,base32z:()=>yX});function sX(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var iX=sX,aX=iX,vR=aX;var $3e=new Uint8Array(0);var SR=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ms=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var AR=t=>new TextEncoder().encode(t),CR=t=>new TextDecoder().decode(t);var jx=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Yx=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return _R(this,e)}},Qx=class{constructor(e){this.decoders=e}or(e){return _R(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},_R=(t,e)=>new Qx({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Xx=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new jx(e,r,n),this.decoder=new Yx(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},yu=({name:t,prefix:e,encode:r,decode:n})=>new Xx(t,e,r,n),Li=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=vR(r,e);return yu({prefix:t,name:e,encode:n,decode:s=>ms(o(s))})},cX=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},uX=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},xt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>yu({prefix:e,name:t,encode(o){return uX(o,n,r)},decode(o){return cX(o,n,r,t)}});var co=xt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lX=xt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),fX=xt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hX=xt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),dX=xt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),pX=xt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),mX=xt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gX=xt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),yX=xt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Zx={};T(Zx,{base58btc:()=>Zt,base58flickr:()=>bX});var Zt=Li({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),bX=Li({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var t2={};T(t2,{base64:()=>e2,base64pad:()=>wX,base64url:()=>xX,base64urlpad:()=>EX});var e2=xt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),wX=xt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xX=xt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),EX=xt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});gn.default.formatters.b=t=>t==null?"undefined":Zt.baseEncode(t);gn.default.formatters.t=t=>t==null?"undefined":co.baseEncode(t);gn.default.formatters.m=t=>t==null?"undefined":e2.baseEncode(t);gn.default.formatters.p=t=>t==null?"undefined":t.toString();gn.default.formatters.c=t=>t==null?"undefined":t.toString();gn.default.formatters.k=t=>t==null?"undefined":t.toString();gn.default.formatters.a=t=>t==null?"undefined":t.toString();function vX(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function fe(t){let e=vX(`${t}:trace`);return gn.default.enabled(`${t}:trace`)&&gn.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,gn.default)(`${t}:trace`)),Object.assign((0,gn.default)(t),{error:(0,gn.default)(`${t}:error`),trace:e})}var i2={};T(i2,{base58btc:()=>yn,base58flickr:()=>IX});function SX(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var AX=SX,CX=AX,IR=CX;var e6e=new Uint8Array(0);var DR=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},gs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var RR=t=>new TextEncoder().encode(t),LR=t=>new TextDecoder().decode(t);var r2=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},n2=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return PR(this,e)}},o2=class{constructor(e){this.decoders=e}or(e){return PR(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},PR=(t,e)=>new o2({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),s2=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new r2(e,r,n),this.decoder=new n2(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},bu=({name:t,prefix:e,encode:r,decode:n})=>new s2(t,e,r,n),Bi=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=IR(r,e);return bu({prefix:t,name:e,encode:n,decode:s=>gs(o(s))})},TX=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},_X=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Et=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>bu({prefix:e,name:t,encode(o){return _X(o,n,r)},decode(o){return TX(o,n,r,t)}});var yn=Bi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),IX=Bi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var a2={};T(a2,{base10:()=>DX});var DX=Bi({prefix:"9",name:"base10",alphabet:"0123456789"});var c2={};T(c2,{base16:()=>RX,base16upper:()=>LX});var RX=Et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),LX=Et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var u2={};T(u2,{base2:()=>BX});var BX=Et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var l2={};T(l2,{base256emoji:()=>kX});var NR=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),PX=NR.reduce((t,e,r)=>(t[r]=e,t),[]),NX=NR.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function OX(t){return t.reduce((e,r)=>(e+=PX[r],e),"")}function UX(t){let e=[];for(let r of t){let n=NX[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var kX=bu({prefix:"\u{1F680}",name:"base256emoji",encode:OX,decode:UX});var f2={};T(f2,{base32:()=>wu,base32hex:()=>zX,base32hexpad:()=>KX,base32hexpadupper:()=>qX,base32hexupper:()=>$X,base32pad:()=>FX,base32padupper:()=>VX,base32upper:()=>MX,base32z:()=>HX});var wu=Et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),MX=Et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),FX=Et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),VX=Et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zX=Et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$X=Et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),KX=Et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),qX=Et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),HX=Et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var h2={};T(h2,{base36:()=>GX,base36upper:()=>WX});var GX=Bi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),WX=Bi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var d2={};T(d2,{base64:()=>jX,base64pad:()=>YX,base64url:()=>QX,base64urlpad:()=>XX});var jX=Et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),YX=Et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),QX=Et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),XX=Et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var p2={};T(p2,{base8:()=>JX});var JX=Et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var m2={};T(m2,{identity:()=>ZX});var ZX=bu({prefix:"\0",name:"identity",encode:t=>LR(t),decode:t=>RR(t)});var m6e=new TextEncoder,g6e=new TextDecoder;var y2={};T(y2,{identity:()=>Em});var rJ=kR,OR=128,nJ=127,oJ=~nJ,sJ=Math.pow(2,31);function kR(t,e,r){e=e||[],r=r||0;for(var n=r;t>=sJ;)e[r++]=t&255|OR,t/=128;for(;t&oJ;)e[r++]=t&255|OR,t>>>=7;return e[r]=t|0,kR.bytes=r-n+1,e}var iJ=g2,aJ=128,UR=127;function g2(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw g2.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&UR)<<o:(i&UR)*Math.pow(2,o),o+=7}while(i>=aJ);return g2.bytes=s-n,r}var cJ=Math.pow(2,7),uJ=Math.pow(2,14),lJ=Math.pow(2,21),fJ=Math.pow(2,28),hJ=Math.pow(2,35),dJ=Math.pow(2,42),pJ=Math.pow(2,49),mJ=Math.pow(2,56),gJ=Math.pow(2,63),yJ=function(t){return t<cJ?1:t<uJ?2:t<lJ?3:t<fJ?4:t<hJ?5:t<dJ?6:t<pJ?7:t<mJ?8:t<gJ?9:10},bJ={encode:rJ,decode:iJ,encodingLength:yJ},wJ=bJ,Hh=wJ;var Gh=(t,e=0)=>[Hh.decode(t,e),Hh.decode.bytes],xu=(t,e,r=0)=>(Hh.encode(t,e,r),e),Eu=t=>Hh.encodingLength(t);var Pi=(t,e)=>{let r=e.byteLength,n=Eu(t),o=n+Eu(r),s=new Uint8Array(o+r);return xu(t,s,0),xu(r,s,n),s.set(e,o),new vu(t,r,e,s)},Wh=t=>{let e=gs(t),[r,n]=Gh(e),[o,s]=Gh(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new vu(r,o,i,e)},MR=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&DR(t.bytes,r.bytes)}},vu=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var FR=0,xJ="identity",VR=gs,EJ=t=>Pi(FR,VR(t)),Em={code:FR,name:xJ,encode:VR,digest:EJ};var x2={};T(x2,{sha256:()=>vm,sha512:()=>vJ});var w2=({name:t,code:e,encode:r})=>new b2(t,e,r),b2=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Pi(this.code,r):r.then(n=>Pi(this.code,n))}else throw Error("Unknown type, must be binary type")}};var $R=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),vm=w2({name:"sha2-256",code:18,encode:$R("SHA-256")}),vJ=w2({name:"sha2-512",code:19,encode:$R("SHA-512")});var KR=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return AJ(r,E2(t),e||yn.encoder);default:return CJ(r,E2(t),e||wu.encoder)}};var qR=new WeakMap,E2=t=>{let e=qR.get(t);if(e==null){let r=new Map;return qR.set(t,r),r}return e},pt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==jh)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==TJ)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return pt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Pi(e,r);return pt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return pt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&MR(e.multihash,n.multihash)}toString(e){return KR(this,e)}toJSON(){return{"/":KR(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof pt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new pt(n,o,s,i||HR(n,o,s.bytes))}else if(r[_J]===!0){let{version:n,multihash:o,code:s}=r,i=Wh(o);return pt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==jh)throw new Error(`Version 0 CID must use dag-pb (code: ${jh}) block encoding`);return new pt(e,r,n,n.bytes)}case 1:{let o=HR(e,r,n.bytes);return new pt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return pt.create(0,jh,e)}static createV1(e,r){return pt.create(1,e,r)}static decode(e){let[r,n]=pt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=pt.inspectBytes(e),n=r.size-r.multihashSize,o=gs(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new vu(r.multihashCode,r.digestSize,s,o);return[r.version===0?pt.createV0(i):pt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Gh(e.subarray(r));return r+=p,h},o=n(),s=jh;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=SJ(e,r),s=pt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return E2(s).set(n,e),s}},SJ=(t,e)=>{switch(t[0]){case"Q":{let r=e||yn;return[yn.prefix,r.decode(`${yn.prefix}${t}`)]}case yn.prefix:{let r=e||yn;return[yn.prefix,r.decode(t)]}case wu.prefix:{let r=e||wu;return[wu.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},AJ=(t,e,r)=>{let{prefix:n}=r;if(n!==yn.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},CJ=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},jh=112,TJ=18,HR=(t,e,r)=>{let n=Eu(t),o=n+Eu(e),s=new Uint8Array(o+r.byteLength);return xu(t,s,0),xu(e,s,n),s.set(r,o),s},_J=Symbol.for("@ipld/js-cid/CID");var v2={...m2,...u2,...p2,...a2,...c2,...f2,...h2,...i2,...d2,...l2},B6e={...x2,...y2};function S2(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var IJ=Symbol.for("nodejs.util.inspect.custom"),GR=Object.values(v2).map(t=>t.decoder).reduce((t,e)=>t.or(e),v2.identity.decoder),WR=114,jR=36,YR=37,Yh=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[gr]=!0;toString(){return this.string==null&&(this.string=yn.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return pt.createV1(WR,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return S2(this.multihash.bytes,e);if(typeof e=="string")return qt(e).equals(this);if(e?.multihash?.bytes!=null)return S2(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[IJ](){return`PeerId(${this.toString()})`}},Qh=class extends Yh{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Xh=class extends Yh{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},Jh=class extends Yh{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function qt(t,e){if(e=e??GR,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Wh(yn.decode(`z${t}`));return t.startsWith("12D")?new Xh({multihash:r}):t.startsWith("16U")?new Jh({multihash:r}):new Qh({multihash:r})}return DJ(GR.decode(t))}function DJ(t){try{let e=Wh(t);if(e.code===Em.code){if(e.digest.length===jR)return new Xh({multihash:e});if(e.digest.length===YR)return new Jh({multihash:e})}if(e.code===vm.code)return new Qh({multihash:e})}catch{return RJ(pt.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function RJ(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==WR)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===vm.code)return new Qh({multihash:t.multihash});if(e.code===Em.code){if(e.digest.length===jR)return new Xh({multihash:t.multihash});if(e.digest.length===YR)return new Jh({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}function ys(t,e){let r={[Symbol.iterator]:()=>r,next:()=>{let n=t.next(),o=n.value;return n.done===!0||o==null?{done:!0,value:void 0}:{done:!1,value:e(o)}}};return r}var br=class{map;constructor(e){if(this.map=new Map,e!=null)for(let[r,n]of e.entries())this.map.set(r.toString(),n)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return ys(this.map.entries(),e=>[qt(e[0]),e[1]])}forEach(e){this.map.forEach((r,n)=>{e(r,qt(n),this)})}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,r){this.map.set(e.toString(),r)}keys(){return ys(this.map.keys(),e=>qt(e))}values(){return this.map.values()}get size(){return this.map.size}};var uo=class{set;constructor(e){if(this.set=new Set,e!=null)for(let r of e)this.set.add(r.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return ys(this.set.entries(),e=>{let r=qt(e[0]);return[r,r]})}forEach(e){this.set.forEach(r=>{let n=qt(r);e(n,n,this)})}has(e){return this.set.has(e.toString())}values(){return ys(this.set.values(),e=>qt(e))}intersection(e){let r=new uo;for(let n of e)this.has(n)&&r.add(n);return r}difference(e){let r=new uo;for(let n of this)e.has(n)||r.add(n);return r}union(e){let r=new uo;for(let n of e)r.add(n);for(let n of this)r.add(n);return r}};var Au=class{list;constructor(e){if(this.list=[],e!=null)for(let r of e)this.list.push(r.toString())}[Symbol.iterator](){return ys(this.list.entries(),e=>qt(e[1]))}concat(e){let r=new Au(this);for(let n of e)r.push(n);return r}entries(){return ys(this.list.entries(),e=>[e[0],qt(e[1])])}every(e){return this.list.every((r,n)=>e(qt(r),n,this))}filter(e){let r=new Au;return this.list.forEach((n,o)=>{let s=qt(n);e(s,o,this)&&r.push(s)}),r}find(e){let r=this.list.find((n,o)=>e(qt(n),o,this));if(r!=null)return qt(r)}findIndex(e){return this.list.findIndex((r,n)=>e(qt(r),n,this))}forEach(e){this.list.forEach((r,n)=>{e(qt(r),n,this)})}includes(e){return this.list.includes(e.toString())}indexOf(e){return this.list.indexOf(e.toString())}pop(){let e=this.list.pop();if(e!=null)return qt(e)}push(...e){for(let r of e)this.list.push(r.toString())}shift(){let e=this.list.shift();if(e!=null)return qt(e)}unshift(...e){let r=this.list.length;for(let n=e.length-1;n>-1;n--)r=this.list.unshift(e[n].toString());return r}get length(){return this.list.length}};var A2={};T(A2,{base10:()=>LJ});var LJ=Li({prefix:"9",name:"base10",alphabet:"0123456789"});var C2={};T(C2,{base16:()=>BJ,base16upper:()=>PJ});var BJ=xt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),PJ=xt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var T2={};T(T2,{base2:()=>NJ});var NJ=xt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var _2={};T(_2,{base256emoji:()=>FJ});var QR=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),OJ=QR.reduce((t,e,r)=>(t[r]=e,t),[]),UJ=QR.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function kJ(t){return t.reduce((e,r)=>(e+=OJ[r],e),"")}function MJ(t){let e=[];for(let r of t){let n=UJ[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var FJ=yu({prefix:"\u{1F680}",name:"base256emoji",encode:kJ,decode:MJ});var I2={};T(I2,{base36:()=>VJ,base36upper:()=>zJ});var VJ=Li({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),zJ=Li({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var D2={};T(D2,{base8:()=>$J});var $J=xt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var R2={};T(R2,{identity:()=>KJ});var KJ=yu({prefix:"\0",name:"identity",encode:t=>CR(t),decode:t=>AR(t)});var hCe=new TextEncoder,dCe=new TextDecoder;var B2={};T(B2,{identity:()=>Iu});var GJ=ZR,XR=128,WJ=127,jJ=~WJ,YJ=Math.pow(2,31);function ZR(t,e,r){e=e||[],r=r||0;for(var n=r;t>=YJ;)e[r++]=t&255|XR,t/=128;for(;t&jJ;)e[r++]=t&255|XR,t>>>=7;return e[r]=t|0,ZR.bytes=r-n+1,e}var QJ=L2,XJ=128,JR=127;function L2(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw L2.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&JR)<<o:(i&JR)*Math.pow(2,o),o+=7}while(i>=XJ);return L2.bytes=s-n,r}var JJ=Math.pow(2,7),ZJ=Math.pow(2,14),eZ=Math.pow(2,21),tZ=Math.pow(2,28),rZ=Math.pow(2,35),nZ=Math.pow(2,42),oZ=Math.pow(2,49),sZ=Math.pow(2,56),iZ=Math.pow(2,63),aZ=function(t){return t<JJ?1:t<ZJ?2:t<eZ?3:t<tZ?4:t<rZ?5:t<nZ?6:t<oZ?7:t<sZ?8:t<iZ?9:10},cZ={encode:GJ,decode:QJ,encodingLength:aZ},uZ=cZ,Zh=uZ;var ed=(t,e=0)=>[Zh.decode(t,e),Zh.decode.bytes],Cu=(t,e,r=0)=>(Zh.encode(t,e,r),e),Tu=t=>Zh.encodingLength(t);var ko=(t,e)=>{let r=e.byteLength,n=Tu(t),o=n+Tu(r),s=new Uint8Array(o+r);return Cu(t,s,0),Cu(r,s,n),s.set(e,o),new _u(t,r,e,s)},qa=t=>{let e=ms(t),[r,n]=ed(e),[o,s]=ed(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new _u(r,o,i,e)},eL=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&SR(t.bytes,r.bytes)}},_u=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var tL=0,lZ="identity",rL=ms,fZ=t=>ko(tL,rL(t)),Iu={code:tL,name:lZ,encode:rL,digest:fZ};var O2={};T(O2,{sha256:()=>Ga,sha512:()=>hZ});var N2=({name:t,code:e,encode:r})=>new P2(t,e,r),P2=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?ko(this.code,r):r.then(n=>ko(this.code,n))}else throw Error("Unknown type, must be binary type")}};var oL=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Ga=N2({name:"sha2-256",code:18,encode:oL("SHA-256")}),hZ=N2({name:"sha2-512",code:19,encode:oL("SHA-512")});var sL=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return pZ(r,U2(t),e||Zt.encoder);default:return mZ(r,U2(t),e||co.encoder)}};var iL=new WeakMap,U2=t=>{let e=iL.get(t);if(e==null){let r=new Map;return iL.set(t,r),r}return e},Ue=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==td)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==gZ)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ue.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=ko(e,r);return Ue.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ue.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&eL(e.multihash,n.multihash)}toString(e){return sL(this,e)}toJSON(){return{"/":sL(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof Ue)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new Ue(n,o,s,i||aL(n,o,s.bytes))}else if(r[yZ]===!0){let{version:n,multihash:o,code:s}=r,i=qa(o);return Ue.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==td)throw new Error(`Version 0 CID must use dag-pb (code: ${td}) block encoding`);return new Ue(e,r,n,n.bytes)}case 1:{let o=aL(e,r,n.bytes);return new Ue(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return Ue.create(0,td,e)}static createV1(e,r){return Ue.create(1,e,r)}static decode(e){let[r,n]=Ue.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Ue.inspectBytes(e),n=r.size-r.multihashSize,o=ms(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new _u(r.multihashCode,r.digestSize,s,o);return[r.version===0?Ue.createV0(i):Ue.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=ed(e.subarray(r));return r+=p,h},o=n(),s=td;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=dZ(e,r),s=Ue.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return U2(s).set(n,e),s}},dZ=(t,e)=>{switch(t[0]){case"Q":{let r=e||Zt;return[Zt.prefix,r.decode(`${Zt.prefix}${t}`)]}case Zt.prefix:{let r=e||Zt;return[Zt.prefix,r.decode(t)]}case co.prefix:{let r=e||co;return[co.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},pZ=(t,e,r)=>{let{prefix:n}=r;if(n!==Zt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},mZ=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},td=112,gZ=18,aL=(t,e,r)=>{let n=Tu(t),o=n+Tu(e),s=new Uint8Array(o+r.byteLength);return Cu(t,s,0),Cu(e,s,n),s.set(r,o),s},yZ=Symbol.for("@ipld/js-cid/CID");var Ni={...R2,...T2,...D2,...A2,...C2,...Jx,...I2,...Zx,...t2,..._2},DCe={...O2,...B2};function rd(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var bZ=Symbol.for("nodejs.util.inspect.custom"),cL=Object.values(Ni).map(t=>t.decoder).reduce((t,e)=>t.or(e),Ni.identity.decoder),uL=114,k2=36,M2=37,nd=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[gr]=!0;toString(){return this.string==null&&(this.string=Zt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Ue.createV1(uL,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return rd(this.multihash.bytes,e);if(typeof e=="string")return _r(e).equals(this);if(e?.multihash?.bytes!=null)return rd(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[bZ](){return`PeerId(${this.toString()})`}},Du=class extends nd{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Ru=class extends nd{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},Lu=class extends nd{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function _r(t,e){if(e=e??cL,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=qa(Zt.decode(`z${t}`));return t.startsWith("12D")?new Ru({multihash:r}):t.startsWith("16U")?new Lu({multihash:r}):new Du({multihash:r})}return od(cL.decode(t))}function od(t){try{let e=qa(t);if(e.code===Iu.code){if(e.digest.length===k2)return new Ru({multihash:e});if(e.digest.length===M2)return new Lu({multihash:e})}if(e.code===Ga.code)return new Du({multihash:e})}catch{return wZ(Ue.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function wZ(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==uL)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Ga.code)return new Du({multihash:t.multihash});if(e.code===Iu.code){if(e.digest.length===k2)return new Ru({multihash:t.multihash});if(e.digest.length===M2)return new Lu({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function lL(t,e){return t.length===k2?new Ru({multihash:ko(Iu.code,t),privateKey:e}):t.length===M2?new Lu({multihash:ko(Iu.code,t),privateKey:e}):new Du({multihash:await Ga.digest(t),publicKey:t,privateKey:e})}var K2={};T(K2,{base58btc:()=>bn,base58flickr:()=>CZ});function xZ(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var EZ=xZ,vZ=EZ,fL=vZ;var $Ce=new Uint8Array(0);var hL=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},bs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var dL=t=>new TextEncoder().encode(t),pL=t=>new TextDecoder().decode(t);var F2=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},V2=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return gL(this,e)}},z2=class{constructor(e){this.decoders=e}or(e){return gL(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},gL=(t,e)=>new z2({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),$2=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new F2(e,r,n),this.decoder=new V2(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Bu=({name:t,prefix:e,encode:r,decode:n})=>new $2(t,e,r,n),Oi=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=fL(r,e);return Bu({prefix:t,name:e,encode:n,decode:s=>bs(o(s))})},SZ=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},AZ=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},vt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Bu({prefix:e,name:t,encode(o){return AZ(o,n,r)},decode(o){return SZ(o,n,r,t)}});var bn=Oi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),CZ=Oi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var q2={};T(q2,{base10:()=>TZ});var TZ=Oi({prefix:"9",name:"base10",alphabet:"0123456789"});var H2={};T(H2,{base16:()=>_Z,base16upper:()=>IZ});var _Z=vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),IZ=vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var G2={};T(G2,{base2:()=>DZ});var DZ=vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var W2={};T(W2,{base256emoji:()=>NZ});var yL=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),RZ=yL.reduce((t,e,r)=>(t[r]=e,t),[]),LZ=yL.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function BZ(t){return t.reduce((e,r)=>(e+=RZ[r],e),"")}function PZ(t){let e=[];for(let r of t){let n=LZ[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var NZ=Bu({prefix:"\u{1F680}",name:"base256emoji",encode:BZ,decode:PZ});var j2={};T(j2,{base32:()=>Pu,base32hex:()=>MZ,base32hexpad:()=>VZ,base32hexpadupper:()=>zZ,base32hexupper:()=>FZ,base32pad:()=>UZ,base32padupper:()=>kZ,base32upper:()=>OZ,base32z:()=>$Z});var Pu=vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),OZ=vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),UZ=vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),kZ=vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),MZ=vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),FZ=vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),VZ=vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),zZ=vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$Z=vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Y2={};T(Y2,{base36:()=>KZ,base36upper:()=>qZ});var KZ=Oi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),qZ=Oi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Q2={};T(Q2,{base64:()=>HZ,base64pad:()=>GZ,base64url:()=>WZ,base64urlpad:()=>jZ});var HZ=vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),GZ=vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),WZ=vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),jZ=vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var X2={};T(X2,{base8:()=>YZ});var YZ=vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var J2={};T(J2,{identity:()=>QZ});var QZ=Bu({prefix:"\0",name:"identity",encode:t=>pL(t),decode:t=>dL(t)});var nTe=new TextEncoder,oTe=new TextDecoder;var e1={};T(e1,{identity:()=>Mu});var ZZ=xL,bL=128,eee=127,tee=~eee,ree=Math.pow(2,31);function xL(t,e,r){e=e||[],r=r||0;for(var n=r;t>=ree;)e[r++]=t&255|bL,t/=128;for(;t&tee;)e[r++]=t&255|bL,t>>>=7;return e[r]=t|0,xL.bytes=r-n+1,e}var nee=Z2,oee=128,wL=127;function Z2(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw Z2.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&wL)<<o:(i&wL)*Math.pow(2,o),o+=7}while(i>=oee);return Z2.bytes=s-n,r}var see=Math.pow(2,7),iee=Math.pow(2,14),aee=Math.pow(2,21),cee=Math.pow(2,28),uee=Math.pow(2,35),lee=Math.pow(2,42),fee=Math.pow(2,49),hee=Math.pow(2,56),dee=Math.pow(2,63),pee=function(t){return t<see?1:t<iee?2:t<aee?3:t<cee?4:t<uee?5:t<lee?6:t<fee?7:t<hee?8:t<dee?9:10},mee={encode:ZZ,decode:nee,encodingLength:pee},gee=mee,sd=gee;var id=(t,e=0)=>[sd.decode(t,e),sd.decode.bytes],Nu=(t,e,r=0)=>(sd.encode(t,e,r),e),Ou=t=>sd.encodingLength(t);var Mo=(t,e)=>{let r=e.byteLength,n=Ou(t),o=n+Ou(r),s=new Uint8Array(o+r);return Nu(t,s,0),Nu(r,s,n),s.set(e,o),new Uu(t,r,e,s)},ad=t=>{let e=bs(t),[r,n]=id(e),[o,s]=id(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Uu(r,o,i,e)},EL=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&hL(t.bytes,r.bytes)}},Uu=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var vL=0,yee="identity",SL=bs,bee=t=>Mo(vL,SL(t)),Mu={code:vL,name:yee,encode:SL,digest:bee};var n1={};T(n1,{sha256:()=>cd,sha512:()=>wee});var r1=({name:t,code:e,encode:r})=>new t1(t,e,r),t1=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Mo(this.code,r):r.then(n=>Mo(this.code,n))}else throw Error("Unknown type, must be binary type")}};var CL=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),cd=r1({name:"sha2-256",code:18,encode:CL("SHA-256")}),wee=r1({name:"sha2-512",code:19,encode:CL("SHA-512")});var TL=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Eee(r,o1(t),e||bn.encoder);default:return vee(r,o1(t),e||Pu.encoder)}};var _L=new WeakMap,o1=t=>{let e=_L.get(t);if(e==null){let r=new Map;return _L.set(t,r),r}return e},mt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==ud)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==See)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return mt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Mo(e,r);return mt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return mt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&EL(e.multihash,n.multihash)}toString(e){return TL(this,e)}toJSON(){return{"/":TL(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof mt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new mt(n,o,s,i||IL(n,o,s.bytes))}else if(r[Aee]===!0){let{version:n,multihash:o,code:s}=r,i=ad(o);return mt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==ud)throw new Error(`Version 0 CID must use dag-pb (code: ${ud}) block encoding`);return new mt(e,r,n,n.bytes)}case 1:{let o=IL(e,r,n.bytes);return new mt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return mt.create(0,ud,e)}static createV1(e,r){return mt.create(1,e,r)}static decode(e){let[r,n]=mt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=mt.inspectBytes(e),n=r.size-r.multihashSize,o=bs(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new Uu(r.multihashCode,r.digestSize,s,o);return[r.version===0?mt.createV0(i):mt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=id(e.subarray(r));return r+=p,h},o=n(),s=ud;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=xee(e,r),s=mt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return o1(s).set(n,e),s}},xee=(t,e)=>{switch(t[0]){case"Q":{let r=e||bn;return[bn.prefix,r.decode(`${bn.prefix}${t}`)]}case bn.prefix:{let r=e||bn;return[bn.prefix,r.decode(t)]}case Pu.prefix:{let r=e||Pu;return[Pu.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Eee=(t,e,r)=>{let{prefix:n}=r;if(n!==bn.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},vee=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},ud=112,See=18,IL=(t,e,r)=>{let n=Ou(t),o=n+Ou(e),s=new Uint8Array(o+r.byteLength);return Nu(t,s,0),Nu(e,s,n),s.set(r,o),s},Aee=Symbol.for("@ipld/js-cid/CID");var Fu={...J2,...G2,...X2,...q2,...H2,...j2,...Y2,...K2,...Q2,...W2},xTe={...n1,...e1};function s1(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Cee=Symbol.for("nodejs.util.inspect.custom"),DL=Object.values(Fu).map(t=>t.decoder).reduce((t,e)=>t.or(e),Fu.identity.decoder),RL=114,i1=36,a1=37,ld=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[gr]=!0;toString(){return this.string==null&&(this.string=bn.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return mt.createV1(RL,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return s1(this.multihash.bytes,e);if(typeof e=="string")return Tee(e).equals(this);if(e?.multihash?.bytes!=null)return s1(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Cee](){return`PeerId(${this.toString()})`}},Vu=class extends ld{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},zu=class extends ld{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},$u=class extends ld{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function Tee(t,e){if(e=e??DL,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=ad(bn.decode(`z${t}`));return t.startsWith("12D")?new zu({multihash:r}):t.startsWith("16U")?new $u({multihash:r}):new Vu({multihash:r})}return LL(DL.decode(t))}function LL(t){try{let e=ad(t);if(e.code===Mu.code){if(e.digest.length===i1)return new zu({multihash:e});if(e.digest.length===a1)return new $u({multihash:e})}if(e.code===cd.code)return new Vu({multihash:e})}catch{return _ee(mt.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function _ee(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==RL)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===cd.code)return new Vu({multihash:t.multihash});if(e.code===Mu.code){if(e.digest.length===i1)return new zu({multihash:t.multihash});if(e.digest.length===a1)return new $u({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function BL(t,e){return t.length===i1?new zu({multihash:Mo(Mu.code,t),privateKey:e}):t.length===a1?new $u({multihash:Mo(Mu.code,t),privateKey:e}):new Vu({multihash:await cd.digest(t),publicKey:t,privateKey:e})}function c1(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function PL(t=0){return globalThis.Buffer?.allocUnsafe!=null?c1(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function OL(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var NL=OL("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),u1=OL("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=PL(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),kTe={utf8:NL,"utf-8":NL,hex:Fu.base16,latin1:u1,ascii:u1,binary:u1,...Fu};var l1;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.id!=null&&(n.uint32(10),n.bytes(r.id)),r.pubKey!=null&&(n.uint32(18),n.bytes(r.pubKey)),r.privKey!=null&&(n.uint32(26),n.bytes(r.privKey)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.id=r.bytes();break;case 2:o.pubKey=r.bytes();break;case 3:o.privKey=r.bytes();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(l1||(l1={}));var UL=async()=>{let t=await um("Ed25519"),e=await Iee(t);if(e.type==="Ed25519")return e;throw new Error(`Generated unexpected PeerId type "${e.type}"`)};async function Iee(t){return BL(ED(t.public),vD(t))}var xn=J(ao(),1);var m1={};T(m1,{base32:()=>wn,base32hex:()=>kee,base32hexpad:()=>Fee,base32hexpadupper:()=>Vee,base32hexupper:()=>Mee,base32pad:()=>Oee,base32padupper:()=>Uee,base32upper:()=>Nee,base32z:()=>zee});function Dee(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var Ree=Dee,Lee=Ree,kL=Lee;var JTe=new Uint8Array(0);var ML=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ws=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var FL=t=>new TextEncoder().encode(t),VL=t=>new TextDecoder().decode(t);var f1=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},h1=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return $L(this,e)}},d1=class{constructor(e){this.decoders=e}or(e){return $L(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},$L=(t,e)=>new d1({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),p1=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new f1(e,r,n),this.decoder=new h1(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Ku=({name:t,prefix:e,encode:r,decode:n})=>new p1(t,e,r,n),Ui=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=kL(r,e);return Ku({prefix:t,name:e,encode:n,decode:s=>ws(o(s))})},Bee=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},Pee=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},St=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Ku({prefix:e,name:t,encode(o){return Pee(o,n,r)},decode(o){return Bee(o,n,r,t)}});var wn=St({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Nee=St({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Oee=St({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Uee=St({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),kee=St({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Mee=St({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Fee=St({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vee=St({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zee=St({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var g1={};T(g1,{base58btc:()=>er,base58flickr:()=>$ee});var er=Ui({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$ee=Ui({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var b1={};T(b1,{base64:()=>y1,base64pad:()=>Kee,base64url:()=>qee,base64urlpad:()=>Hee});var y1=St({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Kee=St({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qee=St({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Hee=St({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});xn.default.formatters.b=t=>t==null?"undefined":er.baseEncode(t);xn.default.formatters.t=t=>t==null?"undefined":wn.baseEncode(t);xn.default.formatters.m=t=>t==null?"undefined":y1.baseEncode(t);xn.default.formatters.p=t=>t==null?"undefined":t.toString();xn.default.formatters.c=t=>t==null?"undefined":t.toString();xn.default.formatters.k=t=>t==null?"undefined":t.toString();xn.default.formatters.a=t=>t==null?"undefined":t.toString();function Gee(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function KL(t){let e=Gee(`${t}:trace`);return xn.default.enabled(`${t}:trace`)&&xn.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,xn.default)(`${t}:trace`)),Object.assign((0,xn.default)(t),{error:(0,xn.default)(`${t}:error`),trace:e})}var S1={};T(S1,{base58btc:()=>wr,base58flickr:()=>Jee});function Wee(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var jee=Wee,Yee=jee,qL=Yee;var l_e=new Uint8Array(0);var HL=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},xs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var GL=t=>new TextEncoder().encode(t),WL=t=>new TextDecoder().decode(t);var w1=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},x1=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return YL(this,e)}},E1=class{constructor(e){this.decoders=e}or(e){return YL(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},YL=(t,e)=>new E1({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),v1=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new w1(e,r,n),this.decoder=new x1(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},qu=({name:t,prefix:e,encode:r,decode:n})=>new v1(t,e,r,n),ki=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=qL(r,e);return qu({prefix:t,name:e,encode:n,decode:s=>xs(o(s))})},Qee=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},Xee=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},At=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>qu({prefix:e,name:t,encode(o){return Xee(o,n,r)},decode(o){return Qee(o,n,r,t)}});var wr=ki({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Jee=ki({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var A1={};T(A1,{base10:()=>Zee});var Zee=ki({prefix:"9",name:"base10",alphabet:"0123456789"});var C1={};T(C1,{base16:()=>ete,base16upper:()=>tte});var ete=At({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tte=At({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var T1={};T(T1,{base2:()=>rte});var rte=At({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var _1={};T(_1,{base256emoji:()=>ate});var QL=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),nte=QL.reduce((t,e,r)=>(t[r]=e,t),[]),ote=QL.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function ste(t){return t.reduce((e,r)=>(e+=nte[r],e),"")}function ite(t){let e=[];for(let r of t){let n=ote[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var ate=qu({prefix:"\u{1F680}",name:"base256emoji",encode:ste,decode:ite});var I1={};T(I1,{base32:()=>Es,base32hex:()=>fte,base32hexpad:()=>dte,base32hexpadupper:()=>pte,base32hexupper:()=>hte,base32pad:()=>ute,base32padupper:()=>lte,base32upper:()=>cte,base32z:()=>mte});var Es=At({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),cte=At({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ute=At({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),lte=At({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fte=At({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hte=At({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),dte=At({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),pte=At({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mte=At({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var D1={};T(D1,{base36:()=>gte,base36upper:()=>yte});var gte=ki({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),yte=ki({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var R1={};T(R1,{base64:()=>bte,base64pad:()=>wte,base64url:()=>xte,base64urlpad:()=>Ete});var bte=At({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),wte=At({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xte=At({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ete=At({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var L1={};T(L1,{base8:()=>vte});var vte=At({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var B1={};T(B1,{identity:()=>Ste});var Ste=qu({prefix:"\0",name:"identity",encode:t=>WL(t),decode:t=>GL(t)});var C_e=new TextEncoder,T_e=new TextDecoder;var N1={};T(N1,{identity:()=>ju});var Tte=ZL,XL=128,_te=127,Ite=~_te,Dte=Math.pow(2,31);function ZL(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Dte;)e[r++]=t&255|XL,t/=128;for(;t&Ite;)e[r++]=t&255|XL,t>>>=7;return e[r]=t|0,ZL.bytes=r-n+1,e}var Rte=P1,Lte=128,JL=127;function P1(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw P1.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&JL)<<o:(i&JL)*Math.pow(2,o),o+=7}while(i>=Lte);return P1.bytes=s-n,r}var Bte=Math.pow(2,7),Pte=Math.pow(2,14),Nte=Math.pow(2,21),Ote=Math.pow(2,28),Ute=Math.pow(2,35),kte=Math.pow(2,42),Mte=Math.pow(2,49),Fte=Math.pow(2,56),Vte=Math.pow(2,63),zte=function(t){return t<Bte?1:t<Pte?2:t<Nte?3:t<Ote?4:t<Ute?5:t<kte?6:t<Mte?7:t<Fte?8:t<Vte?9:10},$te={encode:Tte,decode:Rte,encodingLength:zte},Kte=$te,fd=Kte;var hd=(t,e=0)=>[fd.decode(t,e),fd.decode.bytes],Hu=(t,e,r=0)=>(fd.encode(t,e,r),e),Gu=t=>fd.encodingLength(t);var Fo=(t,e)=>{let r=e.byteLength,n=Gu(t),o=n+Gu(r),s=new Uint8Array(o+r);return Hu(t,s,0),Hu(r,s,n),s.set(e,o),new Wu(t,r,e,s)},Wa=t=>{let e=xs(t),[r,n]=hd(e),[o,s]=hd(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Wu(r,o,i,e)},eB=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&HL(t.bytes,r.bytes)}},Wu=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var tB=0,qte="identity",rB=xs,Hte=t=>Fo(tB,rB(t)),ju={code:tB,name:qte,encode:rB,digest:Hte};var k1={};T(k1,{sha256:()=>dd,sha512:()=>Gte});var U1=({name:t,code:e,encode:r})=>new O1(t,e,r),O1=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Fo(this.code,r):r.then(n=>Fo(this.code,n))}else throw Error("Unknown type, must be binary type")}};var oB=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),dd=U1({name:"sha2-256",code:18,encode:oB("SHA-256")}),Gte=U1({name:"sha2-512",code:19,encode:oB("SHA-512")});var sB=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return jte(r,M1(t),e||wr.encoder);default:return Yte(r,M1(t),e||Es.encoder)}};var iB=new WeakMap,M1=t=>{let e=iB.get(t);if(e==null){let r=new Map;return iB.set(t,r),r}return e},Ke=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==pd)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Qte)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ke.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Fo(e,r);return Ke.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ke.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&eB(e.multihash,n.multihash)}toString(e){return sB(this,e)}toJSON(){return{"/":sB(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof Ke)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new Ke(n,o,s,i||aB(n,o,s.bytes))}else if(r[Xte]===!0){let{version:n,multihash:o,code:s}=r,i=Wa(o);return Ke.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==pd)throw new Error(`Version 0 CID must use dag-pb (code: ${pd}) block encoding`);return new Ke(e,r,n,n.bytes)}case 1:{let o=aB(e,r,n.bytes);return new Ke(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return Ke.create(0,pd,e)}static createV1(e,r){return Ke.create(1,e,r)}static decode(e){let[r,n]=Ke.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Ke.inspectBytes(e),n=r.size-r.multihashSize,o=xs(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new Wu(r.multihashCode,r.digestSize,s,o);return[r.version===0?Ke.createV0(i):Ke.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=hd(e.subarray(r));return r+=p,h},o=n(),s=pd;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=Wte(e,r),s=Ke.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return M1(s).set(n,e),s}},Wte=(t,e)=>{switch(t[0]){case"Q":{let r=e||wr;return[wr.prefix,r.decode(`${wr.prefix}${t}`)]}case wr.prefix:{let r=e||wr;return[wr.prefix,r.decode(t)]}case Es.prefix:{let r=e||Es;return[Es.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},jte=(t,e,r)=>{let{prefix:n}=r;if(n!==wr.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},Yte=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},pd=112,Qte=18,aB=(t,e,r)=>{let n=Gu(t),o=n+Gu(e),s=new Uint8Array(o+r.byteLength);return Hu(t,s,0),Hu(e,s,n),s.set(r,o),s},Xte=Symbol.for("@ipld/js-cid/CID");var Mi={...B1,...T1,...L1,...A1,...C1,...I1,...D1,...S1,...R1,..._1},$_e={...k1,...N1};function Ya(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Jte=Symbol.for("nodejs.util.inspect.custom"),cB=Object.values(Mi).map(t=>t.decoder).reduce((t,e)=>t.or(e),Mi.identity.decoder),uB=114,F1=36,V1=37,md=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[gr]=!0;toString(){return this.string==null&&(this.string=wr.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Ke.createV1(uB,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Ya(this.multihash.bytes,e);if(typeof e=="string")return Zte(e).equals(this);if(e?.multihash?.bytes!=null)return Ya(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Jte](){return`PeerId(${this.toString()})`}},Yu=class extends md{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Qu=class extends md{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},Xu=class extends md{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function Zte(t,e){if(e=e??cB,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Wa(wr.decode(`z${t}`));return t.startsWith("12D")?new Qu({multihash:r}):t.startsWith("16U")?new Xu({multihash:r}):new Yu({multihash:r})}return z1(cB.decode(t))}function z1(t){try{let e=Wa(t);if(e.code===ju.code){if(e.digest.length===F1)return new Qu({multihash:e});if(e.digest.length===V1)return new Xu({multihash:e})}if(e.code===dd.code)return new Yu({multihash:e})}catch{return ere(Ke.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function ere(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==uB)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===dd.code)return new Yu({multihash:t.multihash});if(e.code===ju.code){if(e.digest.length===F1)return new Qu({multihash:t.multihash});if(e.digest.length===V1)return new Xu({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function lB(t,e){return t.length===F1?new Qu({multihash:Fo(ju.code,t),privateKey:e}):t.length===V1?new Xu({multihash:Fo(ju.code,t),privateKey:e}):new Yu({multihash:await dd.digest(t),publicKey:t,privateKey:e})}function fB(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function hB(t=0){return globalThis.Buffer?.allocUnsafe!=null?fB(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}var tre=Math.pow(2,7),rre=Math.pow(2,14),nre=Math.pow(2,21),$1=Math.pow(2,28),K1=Math.pow(2,35),q1=Math.pow(2,42),H1=Math.pow(2,49),Be=128,Ir=127;function X(t){if(t<tre)return 1;if(t<rre)return 2;if(t<nre)return 3;if(t<$1)return 4;if(t<K1)return 5;if(t<q1)return 6;if(t<H1)return 7;if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function ore(t,e,r=0){switch(X(t)){case 8:e[r++]=t&255|Be,t/=128;case 7:e[r++]=t&255|Be,t/=128;case 6:e[r++]=t&255|Be,t/=128;case 5:e[r++]=t&255|Be,t/=128;case 4:e[r++]=t&255|Be,t>>>=7;case 3:e[r++]=t&255|Be,t>>>=7;case 2:e[r++]=t&255|Be,t>>>=7;case 1:{e[r++]=t&255,t>>>=7;break}default:throw new Error("unreachable")}return e}function sre(t,e,r=0){switch(X(t)){case 8:e.set(r++,t&255|Be),t/=128;case 7:e.set(r++,t&255|Be),t/=128;case 6:e.set(r++,t&255|Be),t/=128;case 5:e.set(r++,t&255|Be),t/=128;case 4:e.set(r++,t&255|Be),t>>>=7;case 3:e.set(r++,t&255|Be),t>>>=7;case 2:e.set(r++,t&255|Be),t>>>=7;case 1:{e.set(r++,t&255),t>>>=7;break}default:throw new Error("unreachable")}return e}function ire(t,e){let r=t[e],n=0;if(n+=r&Ir,r<Be||(r=t[e+1],n+=(r&Ir)<<7,r<Be)||(r=t[e+2],n+=(r&Ir)<<14,r<Be)||(r=t[e+3],n+=(r&Ir)<<21,r<Be)||(r=t[e+4],n+=(r&Ir)*$1,r<Be)||(r=t[e+5],n+=(r&Ir)*K1,r<Be)||(r=t[e+6],n+=(r&Ir)*q1,r<Be)||(r=t[e+7],n+=(r&Ir)*H1,r<Be))return n;throw new RangeError("Could not decode varint")}function are(t,e){let r=t.get(e),n=0;if(n+=r&Ir,r<Be||(r=t.get(e+1),n+=(r&Ir)<<7,r<Be)||(r=t.get(e+2),n+=(r&Ir)<<14,r<Be)||(r=t.get(e+3),n+=(r&Ir)<<21,r<Be)||(r=t.get(e+4),n+=(r&Ir)*$1,r<Be)||(r=t.get(e+5),n+=(r&Ir)*K1,r<Be)||(r=t.get(e+6),n+=(r&Ir)*q1,r<Be)||(r=t.get(e+7),n+=(r&Ir)*H1,r<Be))return n;throw new RangeError("Could not decode varint")}function re(t,e,r=0){return e==null&&(e=hB(X(t))),e instanceof Uint8Array?ore(t,e,r):sre(t,e,r)}function te(t,e=0){return t instanceof Uint8Array?ire(t,e):are(t,e)}function gd(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function vs(t=0){return globalThis.Buffer?.alloc!=null?gd(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function yd(t=0){return globalThis.Buffer?.allocUnsafe!=null?gd(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function G1(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=yd(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return gd(r)}function dB(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var mB=Symbol.for("@achingbrain/uint8arraylist");function pB(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let o=r+n.byteLength;if(e<o)return{buf:n,index:e-r};r=o}throw new RangeError("index is out of bounds")}function Tm(t){return Boolean(t?.[mB])}var ue=class{constructor(...e){Object.defineProperty(this,mB,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(Tm(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(Tm(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=pB(this.bufs,e);return r.buf[r.index]}set(e,r){let n=pB(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(Tm(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,r){let{bufs:n,length:o}=this._subList(e,r);return G1(n,o)}subarray(e,r){let{bufs:n,length:o}=this._subList(e,r);return n.length===1?n[0]:G1(n,o)}sublist(e,r){let{bufs:n,length:o}=this._subList(e,r),s=new ue;return s.length=o,s.bufs=n,s}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],o=0;for(let s=0;s<this.bufs.length;s++){let i=this.bufs[s],a=o,c=a+i.byteLength;if(o=c,e>=c)continue;let u=e>=a&&e<c,l=r>a&&r<=c;if(u&&l){if(e===a&&r===c){n.push(i);break}let h=e-a;n.push(i.subarray(h,h+(r-e)));break}if(u){if(e===0){n.push(i);continue}n.push(i.subarray(e-a));continue}if(l){if(r===c){n.push(i);break}n.push(i.subarray(0,r-a));break}n.push(i)}return{bufs:n,length:r-e}}indexOf(e,r=0){if(!Tm(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),e.length===0)return r>this.length?this.length:r;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let s=256,i=new Int32Array(s);for(let h=0;h<s;h++)i[h]=-1;for(let h=0;h<o;h++)i[n[h]]=h;let a=i,c=this.byteLength-n.byteLength,u=n.byteLength-1,l;for(let h=r;h<=c;h+=l){l=0;for(let p=u;p>=0;p--){let m=this.get(h+p);if(n[p]!==m){l=Math.max(1,p-a[m]);break}}if(l===0)return h}return-1}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=yd(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let o=vs(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,r,n),this.write(o,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let o=vs(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,r,n),this.write(o,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let o=vs(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,r,n),this.write(o,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=yd(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let o=vs(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,r,n),this.write(o,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let o=vs(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,r,n),this.write(o,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let o=vs(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,r,n),this.write(o,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let o=vs(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,r,n),this.write(o,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let o=vs(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,r,n),this.write(o,e)}equals(e){if(e==null||!(e instanceof ue)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!dB(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new ue;return n.bufs=e,r==null&&(r=e.reduce((o,s)=>o+s.byteLength,0)),n.length=r,n}};function Ju(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function _m(t=0){return globalThis.Buffer?.allocUnsafe!=null?Ju(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function yB(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var gB=yB("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),W1=yB("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=_m(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),cre={utf8:gB,"utf-8":gB,hex:Mi.base16,latin1:W1,ascii:W1,binary:W1,...Mi},Im=cre;function bd(t,e="utf8"){let r=Im[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ju(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var bB={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var wd;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.publicKey!=null&&r.publicKey.byteLength>0&&(n.uint32(10),n.bytes(r.publicKey)),r.payloadType!=null&&r.payloadType.byteLength>0&&(n.uint32(18),n.bytes(r.payloadType)),r.payload!=null&&r.payload.byteLength>0&&(n.uint32(26),n.bytes(r.payload)),r.signature!=null&&r.signature.byteLength>0&&(n.uint32(42),n.bytes(r.signature)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.publicKey=r.bytes();break;case 2:o.payloadType=r.bytes();break;case 3:o.payload=r.bytes();break;case 5:o.signature=r.bytes();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(wd||(wd={}));var xd=class{peerId;payloadType;payload;signature;marshaled;constructor(e){let{peerId:r,payloadType:n,payload:o,signature:s}=e;this.peerId=r,this.payloadType=n,this.payload=o,this.signature=s}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=wd.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return Ya(this.marshal(),e.marshal())}async validate(e){let r=wB(e,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return Fa(this.peerId.publicKey).verify(r.subarray(),this.signature)}},Dr=xd;ln(Dr,"createFromProtobuf",async e=>{let r=wd.decode(e),n=await lB(r.publicKey);return new xd({peerId:n,payloadType:r.payloadType,payload:r.payload,signature:r.signature})}),ln(Dr,"seal",async(e,r)=>{if(r.privateKey==null)throw new Error("Missing private key");let n=e.domain,o=e.codec,s=e.marshal(),i=wB(n,o,s),c=await(await Ci(r.privateKey)).sign(i.subarray());return new xd({peerId:r,payloadType:o,payload:s,signature:c})}),ln(Dr,"openAndCertify",async(e,r)=>{let n=await xd.createFromProtobuf(e);if(!await n.validate(r))throw new C("envelope signature is not valid for the given domain",bB.ERR_SIGNATURE_NOT_VALID);return n});var wB=(t,e,r)=>{let n=bd(t),o=re(n.byteLength),s=re(e.length),i=re(r.length);return new ue(o,n,s,e,i,r)};function xB(t,e){let r=(n,o)=>n.toString().localeCompare(o.toString());return t.length!==e.length?!1:(e.sort(r),t.sort(r).every((n,o)=>e[o].equals(n)))}function Jr(t,e="utf8"){let r=Im[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Ss(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=_m(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return Ju(r)}var Dm=class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){let r=this.index,n=e();return n===void 0&&(this.index=r),n}parseWith(e){let r=e();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{let r=this.readChar();if(r===e)return r})}readSeparator(e,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(e)===void 0))return n()})}readNumber(e,r,n,o){return this.readAtomically(()=>{let s=0,i=0,a=this.peekChar();if(a===void 0)return;let c=a==="0",u=2**(8*o)-1;for(;;){let l=this.readAtomically(()=>{let h=this.readChar();if(h===void 0)return;let p=Number.parseInt(h,e);if(!Number.isNaN(p))return p});if(l===void 0)break;if(s*=e,s+=l,s>u||(i+=1,r!==void 0&&i>r))return}if(i!==0)return!n&&c&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let e=new Uint8Array(4);for(let r=0;r<e.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;e[r]=n}return e})}readIPv6Addr(){let e=r=>{for(let n=0;n<r.length/2;n++){let o=n*2;if(n<r.length-3){let i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return r[o]=i[0],r[o+1]=i[1],r[o+2]=i[2],r[o+3]=i[3],[o+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];r[o]=s>>8,r[o+1]=s&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,o]=e(r);if(n===16)return r;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),i=16-(n+2),[a]=e(s.subarray(0,i));return r.set(s.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var EB=45,ure=15,Zu=new Dm;function j1(t){if(!(t.length>ure))return Zu.new(t).parseWith(()=>Zu.readIPv4Addr())}function Y1(t){if(t.includes("%")&&(t=t.split("%")[0]),!(t.length>EB))return Zu.new(t).parseWith(()=>Zu.readIPv6Addr())}function Rm(t){if(t.includes("%")&&(t=t.split("%")[0]),!(t.length>EB))return Zu.new(t).parseWith(()=>Zu.readIPAddr())}var X5e=parseInt("0xFFFF",16),J5e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function cr(t){return Boolean(j1(t))}function ur(t){return Boolean(Y1(t))}function xe(t){return Boolean(Rm(t))}var SB=cr,pre=ur,Q1=function(t){let e=0;if(t=t.toString().trim(),SB(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(pre(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let s=SB(r[n]),i;s&&(i=Q1(r[n]),r[n]=Jr(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,Jr(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let o=new Uint8Array(e+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);o[e++]=s>>8&255,o[e++]=s&255}return o}throw new Error("invalid ip address")},AB=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let o=[];for(let s=0;s<r;s++)o.push(t[e+s]);return o.join(".")}if(r===16){let o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(e+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var el={},X1={},gre=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];gre.forEach(t=>{let e=yre(...t);X1[e.code]=e,el[e.name]=e});function yre(t,e,r,n,o){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(o)}}function je(t){if(typeof t=="number"){if(X1[t]!=null)return X1[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(el[t]!=null)return el[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var OIe=je("ip4"),UIe=je("ip6"),kIe=je("ipcidr");function Z1(t,e){switch(je(t).code){case 4:case 41:return wre(e);case 42:return _B(e);case 6:case 273:case 33:case 132:return DB(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return _B(e);case 421:return Sre(e);case 444:return IB(e);case 445:return IB(e);case 466:return vre(e);default:return Jr(e,"base16")}}function eE(t,e){switch(je(t).code){case 4:return CB(e);case 41:return CB(e);case 42:return TB(e);case 6:case 273:case 33:case 132:return tE(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return TB(e);case 421:return xre(e);case 444:return Are(e);case 445:return Cre(e);case 466:return Ere(e);default:return bd(e,"base16")}}var J1=Object.values(Mi).map(t=>t.decoder),bre=function(){let t=J1[0].or(J1[1]);return J1.slice(2).forEach(e=>t=t.or(e)),t}();function CB(t){if(!xe(t))throw new Error("invalid ip address");return Q1(t)}function wre(t){let e=AB(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!xe(e))throw new Error("invalid ip address");return e}function tE(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function DB(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function TB(t){let e=bd(t),r=Uint8Array.from(re(e.length));return Ss([r,e],r.length+e.length)}function _B(t){let e=te(t);if(t=t.slice(X(e)),t.length!==e)throw new Error("inconsistent lengths");return Jr(t)}function xre(t){let e;t[0]==="Q"||t[0]==="1"?e=Wa(wr.decode(`z${t}`)).bytes:e=Ke.parse(t).multihash.bytes;let r=Uint8Array.from(re(e.length));return Ss([r,e],r.length+e.length)}function Ere(t){let e=bre.decode(t),r=Uint8Array.from(re(e.length));return Ss([r,e],r.length+e.length)}function vre(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+Jr(r,"base64url")}function Sre(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return Jr(r,"base58btc")}function Are(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=Es.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=tE(n);return Ss([r,o],r.length+o.length)}function Cre(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=Es.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=tE(n);return Ss([r,o],r.length+o.length)}function IB(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=Jr(e,"base32"),o=DB(r);return`${n}:${o}`}function RB(t){t=rE(t);let e=[],r=[],n=null,o=t.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=je(i);if(a.size===0){e.push([a.code]),r.push([a.code]);continue}if(s++,s>=o.length)throw BB("invalid address: "+t);if(a.path===!0){n=rE(o.slice(s).join("/")),e.push([a.code,eE(a.code,n)]),r.push([a.code,n]);break}let c=eE(a.code,o[s]);e.push([a.code,c]),r.push([a.code,Z1(a.code,c)])}return{string:LB(r),bytes:oE(e),tuples:e,stringTuples:r,path:n}}function nE(t){let e=[],r=[],n=null,o=0;for(;o<t.length;){let s=te(t,o),i=X(s),a=je(s),c=Tre(a,t.slice(o+i));if(c===0){e.push([s]),r.push([s]),o+=i;continue}let u=t.slice(o+i,o+i+c);if(o+=c+i,o>t.length)throw BB("Invalid address Uint8Array: "+Jr(t,"base16"));e.push([s,u]);let l=Z1(s,u);if(r.push([s,l]),a.path===!0){n=l;break}}return{bytes:Uint8Array.from(t),string:LB(r),tuples:e,stringTuples:r,path:n}}function LB(t){let e=[];return t.map(r=>{let n=je(r[0]);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),rE(e.join("/"))}function oE(t){return Ss(t.map(e=>{let r=je(e[0]),n=Uint8Array.from(re(r.code));return e.length>1&&e[1]!=null&&(n=Ss([n,e[1]])),n}))}function Tre(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{let r=te(e instanceof Uint8Array?e:Uint8Array.from(e));return r+X(r)}}function rE(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function BB(t){return new Error("Error parsing address: "+t)}var _re=Symbol.for("nodejs.util.inspect.custom"),Ire=[je("dns").code,je("dns4").code,je("dns6").code,je("dnsaddr").code],Dre=new Map,PB=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Rre(t){return Boolean(t?.[PB])}var As=class{bytes;#e;#t;#r;#n;[PB]=!0;constructor(e){e==null&&(e="");let r;if(e instanceof Uint8Array)r=nE(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);r=RB(e)}else if(Rre(e))r=nE(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#e=r.string,this.#t=r.tuples,this.#r=r.stringTuples,this.#n=r.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,r,n,o,s="",i=je("tcp"),a=je("udp"),c=je("ip4"),u=je("ip6"),l=je("dns6"),h=je("ip6zone");for(let[m,f]of this.stringTuples())m===h.code&&(s=`%${f??""}`),Ire.includes(m)&&(r=i.name,o=443,n=`${f??""}${s}`,e=m===l.code?6:4),(m===i.code||m===a.code)&&(r=je(m).name,o=parseInt(f??"")),(m===c.code||m===u.code)&&(r=je(m).name,n=`${f??""}${s}`,e=m===u.code?6:4);if(e==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:o}}protos(){return this.#t.map(([e])=>Object.assign({},je(e)))}protoCodes(){return this.#t.map(([e])=>e)}protoNames(){return this.#t.map(([e])=>je(e).name)}tuples(){return this.#t}stringTuples(){return this.#r}encapsulate(e){return e=new As(e),new As(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new As(n.slice(0,o))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new As(oE(r.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach(([n,o])=>{n===el.p2p.code&&e.push([n,o]),n===el["p2p-circuit"].code&&(e=[])});let r=e.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?Jr(wr.decode(`z${n}`),"base58btc"):Jr(Ke.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(e){return Ya(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=Dre.get(r.name);if(n==null)throw new C(`no available resolver for ${r.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new As(s))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[_re](){return`Multiaddr(${this.#e})`}};function sE(t){return new As(t)}var NB="libp2p-peer-record",OB=Uint8Array.from([3,1]);var Ed;(function(t){let e;(function(n){let o;n.codec=()=>(o==null&&(o=Te((s,i,a={})=>{a.lengthDelimited!==!1&&i.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(i.uint32(10),i.bytes(s.multiaddr)),a.lengthDelimited!==!1&&i.ldelim()},(s,i)=>{let a={multiaddr:new Uint8Array(0)},c=i==null?s.len:s.pos+i;for(;s.pos<c;){let u=s.uint32();switch(u>>>3){case 1:a.multiaddr=s.bytes();break;default:s.skipType(u&7);break}}return a})),o),n.encode=s=>Ce(s,n.codec()),n.decode=s=>Ae(s,n.codec())})(e=t.AddressInfo||(t.AddressInfo={}));let r;t.codec=()=>(r==null&&(r=Te((n,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(o.uint32(10),o.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(o.uint32(16),o.uint64(n.seq)),n.addresses!=null)for(let i of n.addresses)o.uint32(26),t.AddressInfo.codec().encode(i,o);s.lengthDelimited!==!1&&o.ldelim()},(n,o)=>{let s={peerId:new Uint8Array(0),seq:0n,addresses:[]},i=o==null?n.len:n.pos+o;for(;n.pos<i;){let a=n.uint32();switch(a>>>3){case 1:s.peerId=n.bytes();break;case 2:s.seq=n.uint64();break;case 3:s.addresses.push(t.AddressInfo.codec().decode(n,n.uint32()));break;default:n.skipType(a&7);break}}return s})),r),t.encode=n=>Ce(n,t.codec()),t.decode=n=>Ae(n,t.codec())})(Ed||(Ed={}));var tl=class{peerId;multiaddrs;seqNumber;domain=tl.DOMAIN;codec=tl.CODEC;marshaled;constructor(e){let{peerId:r,multiaddrs:n,seqNumber:o}=e;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=o??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=Ed.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))})),this.marshaled}equals(e){return!(!(e instanceof tl)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!xB(this.multiaddrs,e.multiaddrs))}},Rr=tl;ln(Rr,"createFromProtobuf",e=>{let r=Ed.decode(e),n=z1(r.peerId),o=(r.addresses??[]).map(i=>sE(i.multiaddr)),s=r.seq;return new tl({peerId:n,multiaddrs:o,seqNumber:s})}),ln(Rr,"DOMAIN",NB),ln(Rr,"CODEC",OB);function Lre(t){return t[Symbol.asyncIterator]!=null}function Bre(t){if(Lre(t))return(async()=>{let r=[];for await(let n of t)r.push(n);return r})();let e=[];for(let r of t)e.push(r);return e}var UB=Bre;var iE={};T(iE,{base10:()=>Pre});var Pre=Ui({prefix:"9",name:"base10",alphabet:"0123456789"});var aE={};T(aE,{base16:()=>Nre,base16upper:()=>Ore});var Nre=St({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ore=St({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var cE={};T(cE,{base2:()=>Ure});var Ure=St({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var uE={};T(uE,{base256emoji:()=>zre});var kB=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),kre=kB.reduce((t,e,r)=>(t[r]=e,t),[]),Mre=kB.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Fre(t){return t.reduce((e,r)=>(e+=kre[r],e),"")}function Vre(t){let e=[];for(let r of t){let n=Mre[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var zre=Ku({prefix:"\u{1F680}",name:"base256emoji",encode:Fre,decode:Vre});var lE={};T(lE,{base36:()=>$re,base36upper:()=>Kre});var $re=Ui({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Kre=Ui({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var fE={};T(fE,{base8:()=>qre});var qre=St({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var hE={};T(hE,{identity:()=>Hre});var Hre=Ku({prefix:"\0",name:"identity",encode:t=>VL(t),decode:t=>FL(t)});var CDe=new TextEncoder,TDe=new TextDecoder;var pE={};T(pE,{identity:()=>Bm});var jre=VB,MB=128,Yre=127,Qre=~Yre,Xre=Math.pow(2,31);function VB(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Xre;)e[r++]=t&255|MB,t/=128;for(;t&Qre;)e[r++]=t&255|MB,t>>>=7;return e[r]=t|0,VB.bytes=r-n+1,e}var Jre=dE,Zre=128,FB=127;function dE(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw dE.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&FB)<<o:(i&FB)*Math.pow(2,o),o+=7}while(i>=Zre);return dE.bytes=s-n,r}var ene=Math.pow(2,7),tne=Math.pow(2,14),rne=Math.pow(2,21),nne=Math.pow(2,28),one=Math.pow(2,35),sne=Math.pow(2,42),ine=Math.pow(2,49),ane=Math.pow(2,56),cne=Math.pow(2,63),une=function(t){return t<ene?1:t<tne?2:t<rne?3:t<nne?4:t<one?5:t<sne?6:t<ine?7:t<ane?8:t<cne?9:10},lne={encode:jre,decode:Jre,encodingLength:une},fne=lne,vd=fne;var Sd=(t,e=0)=>[vd.decode(t,e),vd.decode.bytes],rl=(t,e,r=0)=>(vd.encode(t,e,r),e),nl=t=>vd.encodingLength(t);var Vi=(t,e)=>{let r=e.byteLength,n=nl(t),o=n+nl(r),s=new Uint8Array(o+r);return rl(t,s,0),rl(r,s,n),s.set(e,o),new ol(t,r,e,s)},Qa=t=>{let e=ws(t),[r,n]=Sd(e),[o,s]=Sd(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new ol(r,o,i,e)},zB=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&ML(t.bytes,r.bytes)}},ol=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var $B=0,hne="identity",KB=ws,dne=t=>Vi($B,KB(t)),Bm={code:$B,name:hne,encode:KB,digest:dne};var yE={};T(yE,{sha256:()=>Pm,sha512:()=>pne});var gE=({name:t,code:e,encode:r})=>new mE(t,e,r),mE=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Vi(this.code,r):r.then(n=>Vi(this.code,n))}else throw Error("Unknown type, must be binary type")}};var HB=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Pm=gE({name:"sha2-256",code:18,encode:HB("SHA-256")}),pne=gE({name:"sha2-512",code:19,encode:HB("SHA-512")});var GB=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return gne(r,bE(t),e||er.encoder);default:return yne(r,bE(t),e||wn.encoder)}};var WB=new WeakMap,bE=t=>{let e=WB.get(t);if(e==null){let r=new Map;return WB.set(t,r),r}return e},qe=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Ad)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==bne)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return qe.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Vi(e,r);return qe.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return qe.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&zB(e.multihash,n.multihash)}toString(e){return GB(this,e)}toJSON(){return{"/":GB(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof qe)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new qe(n,o,s,i||jB(n,o,s.bytes))}else if(r[wne]===!0){let{version:n,multihash:o,code:s}=r,i=Qa(o);return qe.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Ad)throw new Error(`Version 0 CID must use dag-pb (code: ${Ad}) block encoding`);return new qe(e,r,n,n.bytes)}case 1:{let o=jB(e,r,n.bytes);return new qe(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return qe.create(0,Ad,e)}static createV1(e,r){return qe.create(1,e,r)}static decode(e){let[r,n]=qe.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=qe.inspectBytes(e),n=r.size-r.multihashSize,o=ws(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new ol(r.multihashCode,r.digestSize,s,o);return[r.version===0?qe.createV0(i):qe.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Sd(e.subarray(r));return r+=p,h},o=n(),s=Ad;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=mne(e,r),s=qe.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return bE(s).set(n,e),s}},mne=(t,e)=>{switch(t[0]){case"Q":{let r=e||er;return[er.prefix,r.decode(`${er.prefix}${t}`)]}case er.prefix:{let r=e||er;return[er.prefix,r.decode(t)]}case wn.prefix:{let r=e||wn;return[wn.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},gne=(t,e,r)=>{let{prefix:n}=r;if(n!==er.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},yne=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},Ad=112,bne=18,jB=(t,e,r)=>{let n=nl(t),o=n+nl(e),s=new Uint8Array(o+r.byteLength);return rl(t,s,0),rl(e,s,n),s.set(r,o),s},wne=Symbol.for("@ipld/js-cid/CID");var zi={...hE,...cE,...fE,...iE,...aE,...m1,...lE,...g1,...b1,...uE},$De={...yE,...pE};function Cs(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var xne=Symbol.for("nodejs.util.inspect.custom"),YB=Object.values(zi).map(t=>t.decoder).reduce((t,e)=>t.or(e),zi.identity.decoder),QB=114,XB=36,JB=37,Cd=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[gr]=!0;toString(){return this.string==null&&(this.string=er.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return qe.createV1(QB,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Cs(this.multihash.bytes,e);if(typeof e=="string")return Ene(e).equals(this);if(e?.multihash?.bytes!=null)return Cs(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[xne](){return`PeerId(${this.toString()})`}},sl=class extends Cd{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},il=class extends Cd{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},al=class extends Cd{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function ZB(t){if(t.type==="RSA")return new sl(t);if(t.type==="Ed25519")return new il(t);if(t.type==="secp256k1")return new al(t);throw new C("Not a PeerId","ERR_INVALID_PARAMETERS")}function Ene(t,e){if(e=e??YB,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Qa(er.decode(`z${t}`));return t.startsWith("12D")?new il({multihash:r}):t.startsWith("16U")?new al({multihash:r}):new sl({multihash:r})}return wE(YB.decode(t))}function wE(t){try{let e=Qa(t);if(e.code===Bm.code){if(e.digest.length===XB)return new il({multihash:e});if(e.digest.length===JB)return new al({multihash:e})}if(e.code===Pm.code)return new sl({multihash:e})}catch{return vne(qe.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function vne(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==QB)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Pm.code)return new sl({multihash:t.multihash});if(e.code===Bm.code){if(e.digest.length===XB)return new il({multihash:t.multihash});if(e.digest.length===JB)return new al({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}var EE=J(tP(),1);var _d=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},vE=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},rP=t=>globalThis.DOMException===void 0?new vE(t):new DOMException(t),nP=t=>{let e=t.reason===void 0?rP("This operation was aborted."):t.reason;return e instanceof Error?e:rP(e)};function SE(t,e,r,n){let o,s=new Promise((i,a)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){i(t);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:c}=n;c.aborted&&a(nP(c)),c.addEventListener("abort",()=>{a(nP(c))})}o=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{i(r())}catch(l){a(l)}return}let c=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,u=r instanceof Error?r:new _d(c);typeof t.cancel=="function"&&t.cancel(),a(u)},e),(async()=>{try{i(await t)}catch(c){a(c)}finally{n.customTimers.clearTimeout.call(void 0,o)}})()});return s.clear=()=>{clearTimeout(o),o=void 0},s}function AE(t,e,r){let n=0,o=t.length;for(;o>0;){let s=Math.trunc(o/2),i=n+s;r(t[i],e)<=0?(n=++i,o-=s+1):o=s}return n}var Ja=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Ts,CE=class{constructor(){Ts.set(this,[])}enqueue(e,r){r={priority:0,...r};let n={priority:r.priority,run:e};if(this.size&&Ja(this,Ts,"f")[this.size-1].priority>=r.priority){Ja(this,Ts,"f").push(n);return}let o=AE(Ja(this,Ts,"f"),n,(s,i)=>i.priority-s.priority);Ja(this,Ts,"f").splice(o,0,n)}dequeue(){let e=Ja(this,Ts,"f").shift();return e?.run}filter(e){return Ja(this,Ts,"f").filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return Ja(this,Ts,"f").length}};Ts=new WeakMap;var oP=CE;var gt=function(t,e,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(t,r):o?o.value=r:e.set(t,r),r},Q=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Mt,Dd,Rd,Ki,Vm,Ld,Om,lo,Id,En,Um,vn,Bd,$i,km,sP,iP,uP,aP,cP,Mm,TE,_E,zm,lP,Fm,$m=class extends Error{},IE=class extends EE.default{constructor(e){var r,n,o,s;if(super(),Mt.add(this),Dd.set(this,void 0),Rd.set(this,void 0),Ki.set(this,0),Vm.set(this,void 0),Ld.set(this,void 0),Om.set(this,0),lo.set(this,void 0),Id.set(this,void 0),En.set(this,void 0),Um.set(this,void 0),vn.set(this,0),Bd.set(this,void 0),$i.set(this,void 0),km.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:oP,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(o=e.interval)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);gt(this,Dd,e.carryoverConcurrencyCount,"f"),gt(this,Rd,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),gt(this,Vm,e.intervalCap,"f"),gt(this,Ld,e.interval,"f"),gt(this,En,new e.queueClass,"f"),gt(this,Um,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,gt(this,km,e.throwOnTimeout===!0,"f"),gt(this,$i,e.autoStart===!1,"f")}get concurrency(){return Q(this,Bd,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);gt(this,Bd,e,"f"),Q(this,Mt,"m",zm).call(this)}async add(e,r={}){return r={timeout:this.timeout,throwOnTimeout:Q(this,km,"f"),...r},new Promise((n,o)=>{Q(this,En,"f").enqueue(async()=>{var s,i,a;gt(this,vn,(i=Q(this,vn,"f"),i++,i),"f"),gt(this,Ki,(a=Q(this,Ki,"f"),a++,a),"f");try{if(!((s=r.signal)===null||s===void 0)&&s.aborted)throw new $m("The task was aborted.");let c=e({signal:r.signal});r.timeout&&(c=SE(Promise.resolve(c),r.timeout)),r.signal&&(c=Promise.race([c,Q(this,Mt,"m",lP).call(this,r.signal)]));let u=await c;n(u),this.emit("completed",u)}catch(c){if(c instanceof _d&&!r.throwOnTimeout){n();return}o(c),this.emit("error",c)}finally{Q(this,Mt,"m",uP).call(this)}},r),this.emit("add"),Q(this,Mt,"m",Mm).call(this)})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return Q(this,$i,"f")?(gt(this,$i,!1,"f"),Q(this,Mt,"m",zm).call(this),this):this}pause(){gt(this,$i,!0,"f")}clear(){gt(this,En,new(Q(this,Um,"f")),"f")}async onEmpty(){Q(this,En,"f").size!==0&&await Q(this,Mt,"m",Fm).call(this,"empty")}async onSizeLessThan(e){Q(this,En,"f").size<e||await Q(this,Mt,"m",Fm).call(this,"next",()=>Q(this,En,"f").size<e)}async onIdle(){Q(this,vn,"f")===0&&Q(this,En,"f").size===0||await Q(this,Mt,"m",Fm).call(this,"idle")}get size(){return Q(this,En,"f").size}sizeBy(e){return Q(this,En,"f").filter(e).length}get pending(){return Q(this,vn,"f")}get isPaused(){return Q(this,$i,"f")}};Dd=new WeakMap,Rd=new WeakMap,Ki=new WeakMap,Vm=new WeakMap,Ld=new WeakMap,Om=new WeakMap,lo=new WeakMap,Id=new WeakMap,En=new WeakMap,Um=new WeakMap,vn=new WeakMap,Bd=new WeakMap,$i=new WeakMap,km=new WeakMap,Mt=new WeakSet,sP=function(){return Q(this,Rd,"f")||Q(this,Ki,"f")<Q(this,Vm,"f")},iP=function(){return Q(this,vn,"f")<Q(this,Bd,"f")},uP=function(){var e;gt(this,vn,(e=Q(this,vn,"f"),e--,e),"f"),Q(this,Mt,"m",Mm).call(this),this.emit("next")},aP=function(){Q(this,Mt,"m",_E).call(this),Q(this,Mt,"m",TE).call(this),gt(this,Id,void 0,"f")},cP=function(){let e=Date.now();if(Q(this,lo,"f")===void 0){let r=Q(this,Om,"f")-e;if(r<0)gt(this,Ki,Q(this,Dd,"f")?Q(this,vn,"f"):0,"f");else return Q(this,Id,"f")===void 0&&gt(this,Id,setTimeout(()=>{Q(this,Mt,"m",aP).call(this)},r),"f"),!0}return!1},Mm=function(){if(Q(this,En,"f").size===0)return Q(this,lo,"f")&&clearInterval(Q(this,lo,"f")),gt(this,lo,void 0,"f"),this.emit("empty"),Q(this,vn,"f")===0&&this.emit("idle"),!1;if(!Q(this,$i,"f")){let e=!Q(this,Mt,"a",cP);if(Q(this,Mt,"a",sP)&&Q(this,Mt,"a",iP)){let r=Q(this,En,"f").dequeue();return r?(this.emit("active"),r(),e&&Q(this,Mt,"m",TE).call(this),!0):!1}}return!1},TE=function(){Q(this,Rd,"f")||Q(this,lo,"f")!==void 0||(gt(this,lo,setInterval(()=>{Q(this,Mt,"m",_E).call(this)},Q(this,Ld,"f")),"f"),gt(this,Om,Date.now()+Q(this,Ld,"f"),"f"))},_E=function(){Q(this,Ki,"f")===0&&Q(this,vn,"f")===0&&Q(this,lo,"f")&&(clearInterval(Q(this,lo,"f")),gt(this,lo,void 0,"f")),gt(this,Ki,Q(this,Dd,"f")?Q(this,vn,"f"):0,"f"),Q(this,Mt,"m",zm).call(this)},zm=function(){for(;Q(this,Mt,"m",Mm).call(this););},lP=async function(e){return new Promise((r,n)=>{e.addEventListener("abort",()=>{n(new $m("The task was aborted."))},{once:!0})})},Fm=async function(e,r){return new Promise(n=>{let o=()=>{r&&!r()||(this.off(e,o),n())};this.on(e,o)})};var qi=IE;var cl=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},DE=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},fP=t=>globalThis.DOMException===void 0?new DE(t):new DOMException(t),hP=t=>{let e=t.reason===void 0?fP("This operation was aborted."):t.reason;return e instanceof Error?e:fP(e)};function _s(t,e){let{milliseconds:r,fallback:n,message:o,customTimers:s={setTimeout,clearTimeout}}=e,i,c=new Promise((u,l)=>{if(typeof r!="number"||Math.sign(r)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(e.signal){let{signal:p}=e;p.aborted&&l(hP(p)),p.addEventListener("abort",()=>{l(hP(p))})}if(r===Number.POSITIVE_INFINITY){t.then(u,l);return}let h=new cl;i=s.setTimeout.call(void 0,()=>{if(n){try{u(n())}catch(p){l(p)}return}typeof t.cancel=="function"&&t.cancel(),o===!1?u():o instanceof Error?l(o):(h.message=o??`Promise timed out after ${r} milliseconds`,l(h))},r),(async()=>{try{u(await t)}catch(p){l(p)}})()}).finally(()=>{c.clear()});return c.clear=()=>{s.clearTimeout.call(void 0,i),i=void 0},c}var RE="lock:worker:request-read",LE="lock:worker:release-read",BE="lock:master:grant-read",PE="lock:worker:request-write",NE="lock:worker:release-write",OE="lock:master:grant-write";var Hi={},ul=t=>{t.addEventListener("message",e=>{ul.dispatchEvent("message",t,e)}),t.port!=null&&t.port.addEventListener("message",e=>{ul.dispatchEvent("message",t,e)})};ul.addEventListener=(t,e)=>{Hi[t]==null&&(Hi[t]=[]),Hi[t].push(e)};ul.removeEventListener=(t,e)=>{Hi[t]!=null&&(Hi[t]=Hi[t].filter(r=>r===e))};ul.dispatchEvent=function(t,e,r){Hi[t]!=null&&Hi[t].forEach(n=>n(e,r))};var UE=ul;var dP=(t,e,r,n,o)=>(s,i)=>{if(i.data.type!==r)return;let a={type:i.data.type,name:i.data.name,identifier:i.data.identifier};t.dispatchEvent(new MessageEvent(e,{data:{name:a.name,handler:async()=>(s.postMessage({type:o,name:a.name,identifier:a.identifier}),await new Promise(c=>{let u=l=>{if(l==null||l.data==null)return;let h={type:l.data.type,name:l.data.name,identifier:l.data.identifier};h.type===n&&h.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)}))}}))},pP=(t,e,r,n)=>async()=>{let o=Ii();return globalThis.postMessage({type:e,identifier:o,name:t}),await new Promise(s=>{let i=a=>{if(a==null||a.data==null)return;let c={type:a.data.type,identifier:a.data.identifier};c.type===r&&c.identifier===o&&(globalThis.removeEventListener("message",i),s(()=>{globalThis.postMessage({type:n,identifier:o,name:t})}))};globalThis.addEventListener("message",i)})},Cne={singleProcess:!1},mP=t=>{if(t=Object.assign({},Cne,t),Boolean(globalThis.document)||t.singleProcess){let r=new EventTarget;return UE.addEventListener("message",dP(r,"requestReadLock",RE,LE,BE)),UE.addEventListener("message",dP(r,"requestWriteLock",PE,NE,OE)),r}return{isWorker:!0,readLock:r=>pP(r,RE,BE,LE),writeLock:r=>pP(r,PE,OE,NE)}};var Za={},Gi;async function kE(t,e){let r,n=new Promise(o=>{r=o});return t.add(async()=>await _s((async()=>await new Promise(o=>{r(()=>{o()})}))(),{milliseconds:e.timeout})),await n}var Tne=(t,e)=>{if(Gi.isWorker===!0)return{readLock:Gi.readLock(t,e),writeLock:Gi.writeLock(t,e)};let r=new qi({concurrency:1}),n;return{async readLock(){if(n!=null)return await kE(n,e);n=new qi({concurrency:e.concurrency,autoStart:!1});let o=n,s=kE(n,e);return r.add(async()=>(o.start(),await o.onIdle().then(()=>{n===o&&(n=null)}))),await s},async writeLock(){return n=null,await kE(r,e)}}},_ne={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function ME(t){let e=Object.assign({},_ne,t);return Gi==null&&(Gi=mP(e),Gi.isWorker!==!0&&(Gi.addEventListener("requestReadLock",r=>{Za[r.data.name]!=null&&Za[r.data.name].readLock().then(async n=>await r.data.handler().finally(()=>n()))}),Gi.addEventListener("requestWriteLock",async r=>{Za[r.data.name]!=null&&Za[r.data.name].writeLock().then(async n=>await r.data.handler().finally(()=>n()))}))),Za[e.name]==null&&(Za[e.name]=Tne(e.name,e)),Za[e.name]}var xr={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS"};var ll;(function(t){let e;(function(o){let s;o.codec=()=>(s==null&&(s=Te((i,a,c={})=>{c.lengthDelimited!==!1&&a.fork(),i.key!=null&&i.key!==""&&(a.uint32(10),a.string(i.key)),i.value!=null&&i.value.byteLength>0&&(a.uint32(18),a.bytes(i.value)),c.lengthDelimited!==!1&&a.ldelim()},(i,a)=>{let c={key:"",value:new Uint8Array(0)},u=a==null?i.len:i.pos+a;for(;i.pos<u;){let l=i.uint32();switch(l>>>3){case 1:c.key=i.string();break;case 2:c.value=i.bytes();break;default:i.skipType(l&7);break}}return c})),s),o.encode=i=>Ce(i,o.codec()),o.decode=i=>Ae(i,o.codec())})(e=t.Peer$metadataEntry||(t.Peer$metadataEntry={}));let r;(function(o){let s;o.codec=()=>(s==null&&(s=Te((i,a,c={})=>{c.lengthDelimited!==!1&&a.fork(),i.key!=null&&i.key!==""&&(a.uint32(10),a.string(i.key)),i.value!=null&&(a.uint32(18),qm.codec().encode(i.value,a)),c.lengthDelimited!==!1&&a.ldelim()},(i,a)=>{let c={key:""},u=a==null?i.len:i.pos+a;for(;i.pos<u;){let l=i.uint32();switch(l>>>3){case 1:c.key=i.string();break;case 2:c.value=qm.codec().decode(i,i.uint32());break;default:i.skipType(l&7);break}}return c})),s),o.encode=i=>Ce(i,o.codec()),o.decode=i=>Ae(i,o.codec())})(r=t.Peer$tagsEntry||(t.Peer$tagsEntry={}));let n;t.codec=()=>(n==null&&(n=Te((o,s,i={})=>{if(i.lengthDelimited!==!1&&s.fork(),o.addresses!=null)for(let a of o.addresses)s.uint32(10),Km.codec().encode(a,s);if(o.protocols!=null)for(let a of o.protocols)s.uint32(18),s.string(a);if(o.publicKey!=null&&(s.uint32(34),s.bytes(o.publicKey)),o.peerRecordEnvelope!=null&&(s.uint32(42),s.bytes(o.peerRecordEnvelope)),o.metadata!=null&&o.metadata.size!==0)for(let[a,c]of o.metadata.entries())s.uint32(50),t.Peer$metadataEntry.codec().encode({key:a,value:c},s);if(o.tags!=null&&o.tags.size!==0)for(let[a,c]of o.tags.entries())s.uint32(58),t.Peer$tagsEntry.codec().encode({key:a,value:c},s);i.lengthDelimited!==!1&&s.ldelim()},(o,s)=>{let i={addresses:[],protocols:[],metadata:new Map,tags:new Map},a=s==null?o.len:o.pos+s;for(;o.pos<a;){let c=o.uint32();switch(c>>>3){case 1:i.addresses.push(Km.codec().decode(o,o.uint32()));break;case 2:i.protocols.push(o.string());break;case 4:i.publicKey=o.bytes();break;case 5:i.peerRecordEnvelope=o.bytes();break;case 6:{let u=t.Peer$metadataEntry.codec().decode(o,o.uint32());i.metadata.set(u.key,u.value);break}case 7:{let u=t.Peer$tagsEntry.codec().decode(o,o.uint32());i.tags.set(u.key,u.value);break}default:o.skipType(c&7);break}}return i})),n),t.encode=o=>Ce(o,t.codec()),t.decode=o=>Ae(o,t.codec())})(ll||(ll={}));var Km;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.multiaddr!=null&&r.multiaddr.byteLength>0&&(n.uint32(10),n.bytes(r.multiaddr)),r.isCertified!=null&&(n.uint32(16),n.bool(r.isCertified)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={multiaddr:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.multiaddr=r.bytes();break;case 2:o.isCertified=r.bool();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(Km||(Km={}));var qm;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.value!=null&&r.value!==0&&(n.uint32(8),n.uint32(r.value)),r.expiry!=null&&(n.uint32(16),n.uint64(r.expiry)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={value:0},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.value=r.uint32();break;case 2:o.expiry=r.uint64();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(qm||(qm={}));function fl(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Hm(t=0){return globalThis.Buffer?.allocUnsafe!=null?fl(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function yP(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var gP=yP("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),FE=yP("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Hm(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ine={utf8:gP,"utf-8":gP,hex:zi.base16,latin1:FE,ascii:FE,binary:FE,...zi},Gm=Ine;function Br(t,e="utf8"){let r=Gm[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Is(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=Hm(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return fl(r)}function Pd(t,e="utf8"){let r=Gm[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?fl(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var bP=cr,Dne=ur,VE=function(t){let e=0;if(t=t.toString().trim(),bP(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(Dne(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let s=bP(r[n]),i;s&&(i=VE(r[n]),r[n]=Br(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,Br(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let o=new Uint8Array(e+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);o[e++]=s>>8&255,o[e++]=s&255}return o}throw new Error("invalid ip address")},wP=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let o=[];for(let s=0;s<r;s++)o.push(t[e+s]);return o.join(".")}if(r===16){let o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(e+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var hl={},zE={},Lne=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Lne.forEach(t=>{let e=Bne(...t);zE[e.code]=e,hl[e.name]=e});function Bne(t,e,r,n,o){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(o)}}function Ye(t){if(typeof t=="number"){if(zE[t]!=null)return zE[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(hl[t]!=null)return hl[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var XRe=Ye("ip4"),JRe=Ye("ip6"),ZRe=Ye("ipcidr");function KE(t,e){switch(Ye(t).code){case 4:case 41:return Nne(e);case 42:return vP(e);case 6:case 273:case 33:case 132:return AP(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return vP(e);case 421:return Mne(e);case 444:return SP(e);case 445:return SP(e);case 466:return kne(e);default:return Br(e,"base16")}}function qE(t,e){switch(Ye(t).code){case 4:return xP(e);case 41:return xP(e);case 42:return EP(e);case 6:case 273:case 33:case 132:return HE(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return EP(e);case 421:return One(e);case 444:return Fne(e);case 445:return Vne(e);case 466:return Une(e);default:return Pd(e,"base16")}}var $E=Object.values(zi).map(t=>t.decoder),Pne=function(){let t=$E[0].or($E[1]);return $E.slice(2).forEach(e=>t=t.or(e)),t}();function xP(t){if(!xe(t))throw new Error("invalid ip address");return VE(t)}function Nne(t){let e=wP(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!xe(e))throw new Error("invalid ip address");return e}function HE(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function AP(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function EP(t){let e=Pd(t),r=Uint8Array.from(re(e.length));return Is([r,e],r.length+e.length)}function vP(t){let e=te(t);if(t=t.slice(X(e)),t.length!==e)throw new Error("inconsistent lengths");return Br(t)}function One(t){let e;t[0]==="Q"||t[0]==="1"?e=Qa(er.decode(`z${t}`)).bytes:e=qe.parse(t).multihash.bytes;let r=Uint8Array.from(re(e.length));return Is([r,e],r.length+e.length)}function Une(t){let e=Pne.decode(t),r=Uint8Array.from(re(e.length));return Is([r,e],r.length+e.length)}function kne(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+Br(r,"base64url")}function Mne(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return Br(r,"base58btc")}function Fne(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=wn.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=HE(n);return Is([r,o],r.length+o.length)}function Vne(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=wn.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=HE(n);return Is([r,o],r.length+o.length)}function SP(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=Br(e,"base32"),o=AP(r);return`${n}:${o}`}function CP(t){t=GE(t);let e=[],r=[],n=null,o=t.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=Ye(i);if(a.size===0){e.push([a.code]),r.push([a.code]);continue}if(s++,s>=o.length)throw _P("invalid address: "+t);if(a.path===!0){n=GE(o.slice(s).join("/")),e.push([a.code,qE(a.code,n)]),r.push([a.code,n]);break}let c=qE(a.code,o[s]);e.push([a.code,c]),r.push([a.code,KE(a.code,c)])}return{string:TP(r),bytes:jE(e),tuples:e,stringTuples:r,path:n}}function WE(t){let e=[],r=[],n=null,o=0;for(;o<t.length;){let s=te(t,o),i=X(s),a=Ye(s),c=zne(a,t.slice(o+i));if(c===0){e.push([s]),r.push([s]),o+=i;continue}let u=t.slice(o+i,o+i+c);if(o+=c+i,o>t.length)throw _P("Invalid address Uint8Array: "+Br(t,"base16"));e.push([s,u]);let l=KE(s,u);if(r.push([s,l]),a.path===!0){n=l;break}}return{bytes:Uint8Array.from(t),string:TP(r),tuples:e,stringTuples:r,path:n}}function TP(t){let e=[];return t.map(r=>{let n=Ye(r[0]);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),GE(e.join("/"))}function jE(t){return Is(t.map(e=>{let r=Ye(e[0]),n=Uint8Array.from(re(r.code));return e.length>1&&e[1]!=null&&(n=Is([n,e[1]])),n}))}function zne(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{let r=te(e instanceof Uint8Array?e:Uint8Array.from(e));return r+X(r)}}function GE(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function _P(t){return new Error("Error parsing address: "+t)}var $ne=Symbol.for("nodejs.util.inspect.custom"),Kne=[Ye("dns").code,Ye("dns4").code,Ye("dns6").code,Ye("dnsaddr").code],qne=new Map,IP=Symbol.for("@multiformats/js-multiaddr/multiaddr");function YE(t){return Boolean(t?.[IP])}var Ds=class{bytes;#e;#t;#r;#n;[IP]=!0;constructor(e){e==null&&(e="");let r;if(e instanceof Uint8Array)r=WE(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);r=CP(e)}else if(YE(e))r=WE(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#e=r.string,this.#t=r.tuples,this.#r=r.stringTuples,this.#n=r.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,r,n,o,s="",i=Ye("tcp"),a=Ye("udp"),c=Ye("ip4"),u=Ye("ip6"),l=Ye("dns6"),h=Ye("ip6zone");for(let[m,f]of this.stringTuples())m===h.code&&(s=`%${f??""}`),Kne.includes(m)&&(r=i.name,o=443,n=`${f??""}${s}`,e=m===l.code?6:4),(m===i.code||m===a.code)&&(r=Ye(m).name,o=parseInt(f??"")),(m===c.code||m===u.code)&&(r=Ye(m).name,n=`${f??""}${s}`,e=m===u.code?6:4);if(e==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:o}}protos(){return this.#t.map(([e])=>Object.assign({},Ye(e)))}protoCodes(){return this.#t.map(([e])=>e)}protoNames(){return this.#t.map(([e])=>Ye(e).name)}tuples(){return this.#t}stringTuples(){return this.#r}encapsulate(e){return e=new Ds(e),new Ds(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Ds(n.slice(0,o))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Ds(jE(r.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach(([n,o])=>{n===hl.p2p.code&&e.push([n,o]),n===hl["p2p-circuit"].code&&(e=[])});let r=e.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?Br(er.decode(`z${n}`),"base58btc"):Br(qe.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(e){return Cs(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=qne.get(r.name);if(n==null)throw new C(`no available resolver for ${r.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new Ds(s))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[$ne](){return`Multiaddr(${this.#e})`}};function Nd(t){return new Ds(t)}function dl(t,e){let r=ll.decode(e);r.publicKey!=null&&t.publicKey==null&&(t=ZB({...t,publicKey:t.publicKey}));let n=new Map,o=BigInt(Date.now());for(let[s,i]of r.tags.entries())i.expiry!=null&&i.expiry<o||n.set(s,i);return{...r,id:t,addresses:r.addresses.map(({multiaddr:s,isCertified:i})=>({multiaddr:Nd(s),isCertified:i??!1})),metadata:r.metadata,peerRecordEnvelope:r.peerRecordEnvelope??void 0,tags:n}}var Rs="/",DP=new TextEncoder().encode(Rs),Wm=DP[0],Pr=class{_buf;constructor(e,r){if(typeof e=="string")this._buf=Pd(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Wm)throw new Error("Invalid key")}toString(e="utf8"){return Br(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Pr(e.join(Rs))}static random(){return new Pr(Ii().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Pr(e):typeof e.uint8Array=="function"?new Pr(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=DP),this._buf[0]!==Wm){let e=new Uint8Array(this._buf.byteLength+1);e.fill(Wm,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Wm;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let o=0;o<r.length;o++){if(n.length<o+1)return!1;let s=r[o],i=n[o];if(s<i)return!0;if(s>i)return!1}return r.length<n.length}reverse(){return Pr.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Rs).slice(1)}type(){return Hne(this.baseNamespace())}name(){return Gne(this.baseNamespace())}instance(e){return new Pr(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Rs)||(e+=Rs),e+=this.type(),new Pr(e)}parent(){let e=this.list();return e.length===1?new Pr(Rs):new Pr(e.slice(0,-1).join(Rs))}child(e){return this.toString()===Rs?e:e.toString()===Rs?this:new Pr(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Pr.withNamespaces([...this.namespaces(),...Wne(e.map(r=>r.namespaces()))])}};function Hne(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Gne(t){let e=t.split(":");return e[e.length-1]}function Wne(t){return[].concat(...t)}var QE="/peers/";function pl(t){if(!hm(t)||t.type==null)throw new C("Invalid PeerId",xr.ERR_INVALID_PARAMETERS);let e=t.toCID().toString();return new Pr(`${QE}${e}`)}async function RP(t,e,r){let n=new Map;for(let o of r){if(o==null)continue;if(o.multiaddr instanceof Uint8Array&&(o.multiaddr=Nd(o.multiaddr)),!YE(o.multiaddr))throw new C("Multiaddr was invalid",xr.ERR_INVALID_PARAMETERS);if(!await e(t,o.multiaddr))continue;let s=o.isCertified??!1,i=o.multiaddr.toString(),a=n.get(i);a!=null?o.isCertified=a.isCertified||s:n.set(i,{multiaddr:o.multiaddr,isCertified:s})}return[...n.values()].sort((o,s)=>o.multiaddr.toString().localeCompare(s.multiaddr.toString())).map(({isCertified:o,multiaddr:s})=>({isCertified:o,multiaddr:s.bytes}))}async function Ym(t,e,r,n){if(e==null)throw new C("Invalid PeerData",xr.ERR_INVALID_PARAMETERS);if(e.publicKey!=null&&t.publicKey!=null&&!Cs(e.publicKey,t.publicKey))throw new C("publicKey bytes do not match peer id publicKey bytes",xr.ERR_INVALID_PARAMETERS);let o=n.existingPeer;if(o!=null&&!t.equals(o.id))throw new C("peer id did not match existing peer id",xr.ERR_INVALID_PARAMETERS);let s=o?.addresses??[],i=new Set(o?.protocols??[]),a=o?.metadata??new Map,c=o?.tags??new Map,u=o?.peerRecordEnvelope;if(r==="patch"){if((e.multiaddrs!=null||e.addresses!=null)&&(s=[],e.multiaddrs!=null&&s.push(...e.multiaddrs.map(h=>({isCertified:!1,multiaddr:h}))),e.addresses!=null&&s.push(...e.addresses)),e.protocols!=null&&(i=new Set(e.protocols)),e.metadata!=null){let h=e.metadata instanceof Map?[...e.metadata.entries()]:Object.entries(e.metadata);a=jm(h,{validate:LP})}if(e.tags!=null){let h=e.tags instanceof Map?[...e.tags.entries()]:Object.entries(e.tags);c=jm(h,{validate:BP,map:PP})}e.peerRecordEnvelope!=null&&(u=e.peerRecordEnvelope)}if(r==="merge"){if(e.multiaddrs!=null&&s.push(...e.multiaddrs.map(h=>({isCertified:!1,multiaddr:h}))),e.addresses!=null&&s.push(...e.addresses),e.protocols!=null&&(i=new Set([...i,...e.protocols])),e.metadata!=null){let h=e.metadata instanceof Map?[...e.metadata.entries()]:Object.entries(e.metadata);for(let[p,m]of h)m==null?a.delete(p):a.set(p,m);a=jm([...a.entries()],{validate:LP})}if(e.tags!=null){let h=e.tags instanceof Map?[...e.tags.entries()]:Object.entries(e.tags),p=new Map(c);for(let[m,f]of h)f==null?p.delete(m):p.set(m,f);c=jm([...p.entries()],{validate:BP,map:PP})}e.peerRecordEnvelope!=null&&(u=e.peerRecordEnvelope)}let l={addresses:await RP(t,n.addressFilter??(async()=>!0),s),protocols:[...i.values()].sort((h,p)=>h.localeCompare(p)),metadata:a,tags:c,publicKey:o?.id.publicKey??e.publicKey??t.publicKey,peerRecordEnvelope:u};return t.type!=="RSA"&&delete l.publicKey,l}function jm(t,e){let r=new Map;for(let[n,o]of t)o!=null&&e.validate(n,o);for(let[n,o]of t.sort(([s],[i])=>s.localeCompare(i)))o!=null&&r.set(n,e.map?.(n,o)??o);return r}function LP(t,e){if(typeof t!="string")throw new C("Metadata key must be a string",xr.ERR_INVALID_PARAMETERS);if(!(e instanceof Uint8Array))throw new C("Metadata value must be a Uint8Array",xr.ERR_INVALID_PARAMETERS)}function BP(t,e){if(typeof t!="string")throw new C("Tag name must be a string",xr.ERR_INVALID_PARAMETERS);if(e.value!=null){if(parseInt(`${e.value}`,10)!==e.value)throw new C("Tag value must be an integer",xr.ERR_INVALID_PARAMETERS);if(e.value<0||e.value>100)throw new C("Tag value must be between 0-100",xr.ERR_INVALID_PARAMETERS)}if(e.ttl!=null){if(parseInt(`${e.ttl}`,10)!==e.ttl)throw new C("Tag ttl must be an integer",xr.ERR_INVALID_PARAMETERS);if(e.ttl<0)throw new C("Tag ttl must be between greater than 0",xr.ERR_INVALID_PARAMETERS)}}function PP(t,e){let r;return e.expiry!=null&&(r=e.expiry),e.ttl!=null&&(r=BigInt(Date.now()+Number(e.ttl))),{value:e.value??0,expiry:r}}function Qm(t,e,r){let n=t.toString().split("/")[2],o=wn.decode(n),s=wE(o),i=r.get(s);if(i!=null)return i;let a=dl(s,e);return r.set(s,a),a}function jne(t,e){return t==null?{}:{prefix:QE,filters:(t.filters??[]).map(r=>({key:n,value:o})=>r(Qm(n,o,e))),orders:(t.orders??[]).map(r=>(n,o)=>r(Qm(n.key,n.value,e),Qm(o.key,o.value,e)))}}var Xm=class{peerId;datastore;lock;addressFilter;constructor(e,r={}){this.peerId=e.peerId,this.datastore=e.datastore,this.addressFilter=r.addressFilter,this.lock=ME({name:"peer-store",singleProcess:!0})}async has(e){return this.datastore.has(pl(e))}async delete(e){if(this.peerId.equals(e))throw new C("Cannot delete self peer",xr.ERR_INVALID_PARAMETERS);await this.datastore.delete(pl(e))}async load(e){let r=await this.datastore.get(pl(e));return dl(e,r)}async save(e,r){let{existingBuf:n,existingPeer:o}=await this.#e(e),s=await Ym(e,r,"patch",{addressFilter:this.addressFilter});return this.#t(e,s,n,o)}async patch(e,r){let{existingBuf:n,existingPeer:o}=await this.#e(e),s=await Ym(e,r,"patch",{addressFilter:this.addressFilter,existingPeer:o});return this.#t(e,s,n,o)}async merge(e,r){let{existingBuf:n,existingPeer:o}=await this.#e(e),s=await Ym(e,r,"merge",{addressFilter:this.addressFilter,existingPeer:o});return this.#t(e,s,n,o)}async*all(e){let r=new br;for await(let{key:n,value:o}of this.datastore.query(jne(e??{},r))){let s=Qm(n,o,r);s.id.equals(this.peerId)||(yield s)}}async#e(e){try{let r=await this.datastore.get(pl(e)),n=dl(e,r);return{existingBuf:r,existingPeer:n}}catch(r){if(r.code!=="ERR_NOT_FOUND")throw r}return{}}async#t(e,r,n,o){let s=ll.encode(r);return n!=null&&Cs(s,n)?{peer:dl(e,s),previous:o,updated:!1}:(await this.datastore.put(pl(e),s),{peer:dl(e,s),previous:o,updated:!0})}};var Qe=KL("libp2p:peer-store"),Jm=class{store;events;peerId;constructor(e,r={}){this.events=e.events,this.peerId=e.peerId,this.store=new Xm(e,r)}async forEach(e,r){Qe.trace("forEach await read lock");let n=await this.store.lock.readLock();Qe.trace("forEach got read lock");try{for await(let o of this.store.all(r))e(o)}finally{Qe.trace("forEach release read lock"),n()}}async all(e){Qe.trace("all await read lock");let r=await this.store.lock.readLock();Qe.trace("all got read lock");try{return await UB(this.store.all(e))}finally{Qe.trace("all release read lock"),r()}}async delete(e){Qe.trace("delete await write lock");let r=await this.store.lock.writeLock();Qe.trace("delete got write lock");try{await this.store.delete(e)}finally{Qe.trace("delete release write lock"),r()}}async has(e){Qe.trace("has await read lock");let r=await this.store.lock.readLock();Qe.trace("has got read lock");try{return await this.store.has(e)}finally{Qe.trace("has release read lock"),r()}}async get(e){Qe.trace("get await read lock");let r=await this.store.lock.readLock();Qe.trace("get got read lock");try{return await this.store.load(e)}finally{Qe.trace("get release read lock"),r()}}async save(e,r){Qe.trace("save await write lock");let n=await this.store.lock.writeLock();Qe.trace("save got write lock");try{let o=await this.store.save(e,r);return this.#e(e,o),o.peer}finally{Qe.trace("save release write lock"),n()}}async patch(e,r){Qe.trace("patch await write lock");let n=await this.store.lock.writeLock();Qe.trace("patch got write lock");try{let o=await this.store.patch(e,r);return this.#e(e,o),o.peer}finally{Qe.trace("patch release write lock"),n()}}async merge(e,r){Qe.trace("merge await write lock");let n=await this.store.lock.writeLock();Qe.trace("merge got write lock");try{let o=await this.store.merge(e,r);return this.#e(e,o),o.peer}finally{Qe.trace("merge release write lock"),n()}}async consumePeerRecord(e,r){let n=await Dr.openAndCertify(e,Rr.DOMAIN);if(r?.equals(n.peerId)===!1)return Qe("envelope peer id was not the expected peer id - expected: %p received: %p",r,n.peerId),!1;let o=Rr.createFromProtobuf(n.payload),s;try{s=await this.get(n.peerId)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i}if(s?.peerRecordEnvelope!=null){let i=await Dr.createFromProtobuf(s.peerRecordEnvelope),a=Rr.createFromProtobuf(i.payload);if(a.seqNumber>=o.seqNumber)return Qe("sequence number was lower or equal to existing sequence number - stored: %d received: %d",a.seqNumber,o.seqNumber),!1}return await this.patch(o.peerId,{peerRecordEnvelope:e,addresses:o.multiaddrs.map(i=>({isCertified:!0,multiaddr:i}))}),!0}#e(e,r){!r.updated||(this.peerId.equals(e)?this.events.safeDispatchEvent("self:peer:update",{detail:r}):this.events.safeDispatchEvent("peer:update",{detail:r}))}};function ml(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Zm(t=0){return globalThis.Buffer?.allocUnsafe!=null?ml(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function OP(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var NP=OP("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),XE=OP("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Zm(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Yne={utf8:NP,"utf-8":NP,hex:Ni.base16,latin1:XE,ascii:XE,binary:XE,...Ni},eg=Yne;function Ft(t,e="utf8"){let r=eg[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function fo(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=Zm(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return ml(r)}function Nr(t,e="utf8"){let r=eg[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ml(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var UP=cr,Qne=ur,JE=function(t){let e=0;if(t=t.toString().trim(),UP(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(Qne(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let s=UP(r[n]),i;s&&(i=JE(r[n]),r[n]=Ft(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,Ft(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let o=new Uint8Array(e+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);o[e++]=s>>8&255,o[e++]=s&255}return o}throw new Error("invalid ip address")},kP=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let o=[];for(let s=0;s<r;s++)o.push(t[e+s]);return o.join(".")}if(r===16){let o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(e+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var gl={},ZE={},Jne=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Jne.forEach(t=>{let e=Zne(...t);ZE[e.code]=e,gl[e.name]=e});function Zne(t,e,r,n,o){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(o)}}function De(t){if(typeof t=="number"){if(ZE[t]!=null)return ZE[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(gl[t]!=null)return gl[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var BBe=De("ip4"),PBe=De("ip6"),NBe=De("ipcidr");function tv(t,e){switch(De(t).code){case 4:case 41:return toe(e);case 42:return VP(e);case 6:case 273:case 33:case 132:return $P(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return VP(e);case 421:return soe(e);case 444:return zP(e);case 445:return zP(e);case 466:return ooe(e);default:return Ft(e,"base16")}}function rv(t,e){switch(De(t).code){case 4:return MP(e);case 41:return MP(e);case 42:return FP(e);case 6:case 273:case 33:case 132:return nv(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return FP(e);case 421:return roe(e);case 444:return ioe(e);case 445:return aoe(e);case 466:return noe(e);default:return Nr(e,"base16")}}var ev=Object.values(Ni).map(t=>t.decoder),eoe=function(){let t=ev[0].or(ev[1]);return ev.slice(2).forEach(e=>t=t.or(e)),t}();function MP(t){if(!xe(t))throw new Error("invalid ip address");return JE(t)}function toe(t){let e=kP(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!xe(e))throw new Error("invalid ip address");return e}function nv(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function $P(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function FP(t){let e=Nr(t),r=Uint8Array.from(re(e.length));return fo([r,e],r.length+e.length)}function VP(t){let e=te(t);if(t=t.slice(X(e)),t.length!==e)throw new Error("inconsistent lengths");return Ft(t)}function roe(t){let e;t[0]==="Q"||t[0]==="1"?e=qa(Zt.decode(`z${t}`)).bytes:e=Ue.parse(t).multihash.bytes;let r=Uint8Array.from(re(e.length));return fo([r,e],r.length+e.length)}function noe(t){let e=eoe.decode(t),r=Uint8Array.from(re(e.length));return fo([r,e],r.length+e.length)}function ooe(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+Ft(r,"base64url")}function soe(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return Ft(r,"base58btc")}function ioe(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=co.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=nv(n);return fo([r,o],r.length+o.length)}function aoe(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=co.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=nv(n);return fo([r,o],r.length+o.length)}function zP(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=Ft(e,"base32"),o=$P(r);return`${n}:${o}`}function KP(t){t=ov(t);let e=[],r=[],n=null,o=t.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=De(i);if(a.size===0){e.push([a.code]),r.push([a.code]);continue}if(s++,s>=o.length)throw HP("invalid address: "+t);if(a.path===!0){n=ov(o.slice(s).join("/")),e.push([a.code,rv(a.code,n)]),r.push([a.code,n]);break}let c=rv(a.code,o[s]);e.push([a.code,c]),r.push([a.code,tv(a.code,c)])}return{string:qP(r),bytes:iv(e),tuples:e,stringTuples:r,path:n}}function sv(t){let e=[],r=[],n=null,o=0;for(;o<t.length;){let s=te(t,o),i=X(s),a=De(s),c=coe(a,t.slice(o+i));if(c===0){e.push([s]),r.push([s]),o+=i;continue}let u=t.slice(o+i,o+i+c);if(o+=c+i,o>t.length)throw HP("Invalid address Uint8Array: "+Ft(t,"base16"));e.push([s,u]);let l=tv(s,u);if(r.push([s,l]),a.path===!0){n=l;break}}return{bytes:Uint8Array.from(t),string:qP(r),tuples:e,stringTuples:r,path:n}}function qP(t){let e=[];return t.map(r=>{let n=De(r[0]);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),ov(e.join("/"))}function iv(t){return fo(t.map(e=>{let r=De(e[0]),n=Uint8Array.from(re(r.code));return e.length>1&&e[1]!=null&&(n=fo([n,e[1]])),n}))}function coe(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{let r=te(e instanceof Uint8Array?e:Uint8Array.from(e));return r+X(r)}}function ov(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function HP(t){return new Error("Error parsing address: "+t)}var uoe=Symbol.for("nodejs.util.inspect.custom"),loe=[De("dns").code,De("dns4").code,De("dns6").code,De("dnsaddr").code],av=new Map,GP=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Od(t){return Boolean(t?.[GP])}var Ls=class{bytes;#e;#t;#r;#n;[GP]=!0;constructor(e){e==null&&(e="");let r;if(e instanceof Uint8Array)r=sv(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);r=KP(e)}else if(Od(e))r=sv(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#e=r.string,this.#t=r.tuples,this.#r=r.stringTuples,this.#n=r.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,r,n,o,s="",i=De("tcp"),a=De("udp"),c=De("ip4"),u=De("ip6"),l=De("dns6"),h=De("ip6zone");for(let[m,f]of this.stringTuples())m===h.code&&(s=`%${f??""}`),loe.includes(m)&&(r=i.name,o=443,n=`${f??""}${s}`,e=m===l.code?6:4),(m===i.code||m===a.code)&&(r=De(m).name,o=parseInt(f??"")),(m===c.code||m===u.code)&&(r=De(m).name,n=`${f??""}${s}`,e=m===u.code?6:4);if(e==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:o}}protos(){return this.#t.map(([e])=>Object.assign({},De(e)))}protoCodes(){return this.#t.map(([e])=>e)}protoNames(){return this.#t.map(([e])=>De(e).name)}tuples(){return this.#t}stringTuples(){return this.#r}encapsulate(e){return e=new Ls(e),new Ls(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Ls(n.slice(0,o))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Ls(iv(r.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach(([n,o])=>{n===gl.p2p.code&&e.push([n,o]),n===gl["p2p-circuit"].code&&(e=[])});let r=e.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?Ft(Zt.decode(`z${n}`),"base58btc"):Ft(Ue.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(e){return rd(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=av.get(r.name);if(n==null)throw new C(`no available resolver for ${r.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new Ls(s))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[uoe](){return`Multiaddr(${this.#e})`}};function Pe(t){return new Ls(t)}var Bs="/",WP=new TextEncoder().encode(Bs),tg=WP[0],Er=class{_buf;constructor(e,r){if(typeof e=="string")this._buf=Nr(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==tg)throw new Error("Invalid key")}toString(e="utf8"){return Ft(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Er(e.join(Bs))}static random(){return new Er(Ii().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Er(e):typeof e.uint8Array=="function"?new Er(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=WP),this._buf[0]!==tg){let e=new Uint8Array(this._buf.byteLength+1);e.fill(tg,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===tg;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let o=0;o<r.length;o++){if(n.length<o+1)return!1;let s=r[o],i=n[o];if(s<i)return!0;if(s>i)return!1}return r.length<n.length}reverse(){return Er.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Bs).slice(1)}type(){return foe(this.baseNamespace())}name(){return hoe(this.baseNamespace())}instance(e){return new Er(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Bs)||(e+=Bs),e+=this.type(),new Er(e)}parent(){let e=this.list();return e.length===1?new Er(Bs):new Er(e.slice(0,-1).join(Bs))}child(e){return this.toString()===Bs?e:e.toString()===Bs?this:new Er(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Er.withNamespaces([...this.namespaces(),...doe(e.map(r=>r.namespaces()))])}};function foe(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function hoe(t){let e=t.split(":");return e[e.length-1]}function doe(t){return[].concat(...t)}function poe(t){return t[Symbol.asyncIterator]!=null}function moe(t){if(poe(t))return(async()=>{for await(let e of t);})();for(let e of t);}var cv=moe;function goe(t){let[e,r]=t[Symbol.asyncIterator]!=null?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:o=>{n.push(o)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[r](){return this}}}var rg=goe;function yoe(t){return t[Symbol.asyncIterator]!=null}function boe(t,e){if(yoe(t))return async function*(){for await(let a of t)await e(a)&&(yield a)}();let r=rg(t),{value:n,done:o}=r.next();if(o===!0)return function*(){}();let s=e(n);if(typeof s.then=="function")return async function*(){await s&&(yield n);for await(let a of r)await e(a)&&(yield a)}();let i=e;return function*(){s===!0&&(yield n);for(let a of r)i(a)&&(yield a)}()}var ho=boe;function woe(t){return t[Symbol.asyncIterator]!=null}function xoe(t){if(woe(t))return(async()=>{let r=[];for await(let n of t)r.push(n);return r})();let e=[];for(let r of t)e.push(r);return e}var uv=xoe;function Eoe(t){return t[Symbol.asyncIterator]!=null}function voe(t,e){return Eoe(t)?async function*(){yield*(await uv(t)).sort(e)}():function*(){yield*uv(t).sort(e)}()}var lv=voe;function Soe(t){return t[Symbol.asyncIterator]!=null}function Aoe(t,e){return Soe(t)?async function*(){let r=0;if(!(e<1)){for await(let n of t)if(yield n,r++,r===e)return}}():function*(){let r=0;if(!(e<1)){for(let n of t)if(yield n,r++,r===e)return}}()}var fv=Aoe;var ng=class{put(e,r,n){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:n,value:o}of e)await this.put(n,o,r),yield n}async*getMany(e,r={}){for await(let n of e)yield{key:n,value:await this.get(n,r)}}async*deleteMany(e,r={}){for await(let n of e)await this.delete(n,r),yield n}batch(){let e=[],r=[];return{put(n,o){e.push({key:n,value:o})},delete(n){r.push(n)},commit:async n=>{await cv(this.putMany(e,n)),e=[],await cv(this.deleteMany(r,n)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let n=this._all(e,r);if(e.prefix!=null){let o=e.prefix;n=ho(n,s=>s.key.toString().startsWith(o))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((o,s)=>ho(o,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((o,s)=>lv(o,s),n)),e.offset!=null){let o=0,s=e.offset;n=ho(n,()=>o++>=s)}return e.limit!=null&&(n=fv(n,e.limit)),n}queryKeys(e,r){let n=this._allKeys(e,r);if(e.prefix!=null){let o=e.prefix;n=ho(n,s=>s.toString().startsWith(o))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((o,s)=>ho(o,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((o,s)=>lv(o,s),n)),e.offset!=null){let o=e.offset,s=0;n=ho(n,()=>s++>=o)}return e.limit!=null&&(n=fv(n,e.limit)),n}};var QP=J(og(),1);function XP(t){return t=t??new Error("Not Found"),(0,QP.default)(t,"ERR_NOT_FOUND")}var sg=class extends ng{data;constructor(){super(),this.data=new Map}put(e,r){return this.data.set(e.toString(),r),e}get(e){let r=this.data.get(e.toString());if(r==null)throw XP();return r}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(let[e,r]of this.data.entries())yield{key:new Er(e),value:r}}*_allKeys(){for(let e of this.data.keys())yield new Er(e)}};function JP(t,e){let r;return function(){let n=function(){r=void 0,t()};clearTimeout(r),r=setTimeout(n,e)}}var _oe=fe("libp2p:address-manager"),Ioe=t=>t;function hv(t,e){let r=t.getPeerId();return r!=null&&_r(r).equals(e)&&(t=t.decapsulate(Pe(`/p2p/${e.toString()}`))),t}var ig=class{components;listen;announce;observed;announceFilter;constructor(e,r={}){let{listen:n=[],announce:o=[]}=r;this.components=e,this.listen=n.map(s=>s.toString()),this.announce=new Set(o.map(s=>s.toString())),this.observed=new Map,this.announceFilter=r.announceFilter??Ioe,this._updatePeerStoreAddresses=JP(this._updatePeerStoreAddresses.bind(this),1e3),e.events.addEventListener("transport:listening",()=>{this._updatePeerStoreAddresses()}),e.events.addEventListener("transport:close",()=>{this._updatePeerStoreAddresses()})}_updatePeerStoreAddresses(){let e=this.getAnnounceAddrs().concat(this.components.transportManager.getAddrs()).concat([...this.observed.entries()].filter(([r,n])=>n.confident).map(([r])=>Pe(r))).map(r=>r.getPeerId()===this.components.peerId.toString()?r.decapsulate(`/p2p/${this.components.peerId.toString()}`):r);this.components.peerStore.patch(this.components.peerId,{multiaddrs:e}).catch(r=>{_oe.error("error updating addresses",r)})}getListenAddrs(){return Array.from(this.listen).map(e=>Pe(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>Pe(e))}getObservedAddrs(){return Array.from(this.observed).map(([e])=>Pe(e))}addObservedAddr(e){e=hv(e,this.components.peerId);let r=e.toString();this.observed.has(r)||this.observed.set(r,{confident:!1})}confirmObservedAddr(e){e=hv(e,this.components.peerId);let r=e.toString(),o=(this.observed.get(r)??{confident:!1}).confident;this.observed.set(r,{confident:!0}),o||this._updatePeerStoreAddresses()}removeObservedAddr(e){e=hv(e,this.components.peerId);let r=e.toString();this.observed.delete(r)}getAddresses(){let e=this.getAnnounceAddrs().map(n=>n.toString());e.length===0&&(e=this.components.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(Array.from(this.observed).filter(([n,o])=>o.confident).map(([n])=>n));let r=new Set(e);return this.announceFilter(Array.from(r).map(n=>Pe(n))).map(n=>n.protos().pop()?.path===!0||n.getPeerId()===this.components.peerId.toString()?n:n.encapsulate(`/p2p/${this.components.peerId.toString()}`))}};function ZP(t){return t!=null&&typeof t.start=="function"&&typeof t.stop=="function"}var dv=class{components={};_started=!1;constructor(e={}){this.components={};for(let[r,n]of Object.entries(e))this.components[r]=n}isStarted(){return this._started}async _invokeStartableMethod(e){await Promise.all(Object.values(this.components).filter(r=>ZP(r)).map(async r=>{await r[e]?.()}))}async beforeStart(){await this._invokeStartableMethod("beforeStart")}async start(){await this._invokeStartableMethod("start"),this._started=!0}async afterStart(){await this._invokeStartableMethod("afterStart")}async beforeStop(){await this._invokeStartableMethod("beforeStop")}async stop(){await this._invokeStartableMethod("stop"),this._started=!1}async afterStop(){await this._invokeStartableMethod("afterStop")}},Doe=["metrics","connectionProtector"],Roe=["components","isStarted","beforeStart","start","afterStart","beforeStop","stop","afterStop","then","_invokeStartableMethod"];function eN(t={}){let e=new dv(t);return new Proxy(e,{get(n,o,s){if(typeof o=="string"&&!Roe.includes(o)){let i=e.components[o];if(i==null&&!Doe.includes(o))throw new C(`${o} not set`,"ERR_SERVICE_MISSING");return i}return Reflect.get(n,o,s)},set(n,o,s){return typeof o=="string"?e.components[o]=s:Reflect.set(n,o,s),!0}})}var aN=J(tN(),1);var rN="[a-fA-F\\d:]",Wi=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${rN})|(?<=${rN})(?=\\s|$))`:"",po="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",Ht="[a-fA-F\\d]{1,4}",ag=`
(?:
(?:${Ht}:){7}(?:${Ht}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${Ht}:){6}(?:${po}|:${Ht}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${Ht}:){5}(?::${po}|(?::${Ht}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${Ht}:){4}(?:(?::${Ht}){0,1}:${po}|(?::${Ht}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${Ht}:){3}(?:(?::${Ht}){0,2}:${po}|(?::${Ht}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${Ht}:){2}(?:(?::${Ht}){0,3}:${po}|(?::${Ht}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${Ht}:){1}(?:(?::${Ht}){0,4}:${po}|(?::${Ht}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${Ht}){0,5}:${po}|(?::${Ht}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),Loe=new RegExp(`(?:^${po}$)|(?:^${ag}$)`),Boe=new RegExp(`^${po}$`),Poe=new RegExp(`^${ag}$`),pv=t=>t&&t.exact?Loe:new RegExp(`(?:${Wi(t)}${po}${Wi(t)})|(?:${Wi(t)}${ag}${Wi(t)})`,"g");pv.v4=t=>t&&t.exact?Boe:new RegExp(`${Wi(t)}${po}${Wi(t)}`,"g");pv.v6=t=>t&&t.exact?Poe:new RegExp(`${Wi(t)}${ag}${Wi(t)}`,"g");var nN=pv;var cN=J(sN(),1),{isValid:Noe,parse:Ooe}=cN.default,Uoe=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],koe=Uoe.map(t=>new aN.Netmask(t));function Moe(t){for(let e of koe)if(e.contains(t))return!0;return!1}function iN(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}var uN=t=>{if(Noe(t)){let e=Ooe(t);if(e.kind()==="ipv4")return Moe(e.toNormalizedString());if(e.kind()==="ipv6")return iN(t)}else if(xe(t)&&nN.v6().test(t))return iN(t)};var ug=uN;function lN(t={}){return{denyDialPeer:async()=>!1,denyDialMultiaddr:async e=>{let r=e.stringTuples();return r[0][0]===4||r[0][0]===41?Boolean(ug(`${r[0][1]}`)):!1},denyInboundConnection:async()=>!1,denyOutboundConnection:async()=>!1,denyInboundEncryptedConnection:async()=>!1,denyOutboundEncryptedConnection:async()=>!1,denyInboundUpgradedConnection:async()=>!1,denyOutboundUpgradedConnection:async()=>!1,filterMultiaddrForPeer:async()=>!0,...t}}var Yi=Symbol.for("@libp2p/transport");var ji;(function(t){t[t.FATAL_ALL=0]="FATAL_ALL",t[t.NO_FATAL=1]="NO_FATAL"})(ji||(ji={}));var wv={};T(wv,{base58btc:()=>Or,base58flickr:()=>qoe});function Foe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var Voe=Foe,zoe=Voe,fN=zoe;var KPe=new Uint8Array(0);var hN=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Ps=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var dN=t=>new TextEncoder().encode(t),pN=t=>new TextDecoder().decode(t);var mv=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},gv=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return gN(this,e)}},yv=class{constructor(e){this.decoders=e}or(e){return gN(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},gN=(t,e)=>new yv({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),bv=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new mv(e,r,n),this.decoder=new gv(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},yl=({name:t,prefix:e,encode:r,decode:n})=>new bv(t,e,r,n),Qi=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=fN(r,e);return yl({prefix:t,name:e,encode:n,decode:s=>Ps(o(s))})},$oe=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},Koe=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Ct=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>yl({prefix:e,name:t,encode(o){return Koe(o,n,r)},decode(o){return $oe(o,n,r,t)}});var Or=Qi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qoe=Qi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var xv={};T(xv,{base32:()=>Ns,base32hex:()=>joe,base32hexpad:()=>Qoe,base32hexpadupper:()=>Xoe,base32hexupper:()=>Yoe,base32pad:()=>Goe,base32padupper:()=>Woe,base32upper:()=>Hoe,base32z:()=>Joe});var Ns=Ct({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hoe=Ct({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Goe=Ct({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Woe=Ct({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),joe=Ct({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Yoe=Ct({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Qoe=Ct({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xoe=Ct({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Joe=Ct({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Zoe=wN,yN=128,ese=127,tse=~ese,rse=Math.pow(2,31);function wN(t,e,r){e=e||[],r=r||0;for(var n=r;t>=rse;)e[r++]=t&255|yN,t/=128;for(;t&tse;)e[r++]=t&255|yN,t>>>=7;return e[r]=t|0,wN.bytes=r-n+1,e}var nse=Ev,ose=128,bN=127;function Ev(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw Ev.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&bN)<<o:(i&bN)*Math.pow(2,o),o+=7}while(i>=ose);return Ev.bytes=s-n,r}var sse=Math.pow(2,7),ise=Math.pow(2,14),ase=Math.pow(2,21),cse=Math.pow(2,28),use=Math.pow(2,35),lse=Math.pow(2,42),fse=Math.pow(2,49),hse=Math.pow(2,56),dse=Math.pow(2,63),pse=function(t){return t<sse?1:t<ise?2:t<ase?3:t<cse?4:t<use?5:t<lse?6:t<fse?7:t<hse?8:t<dse?9:10},mse={encode:Zoe,decode:nse,encodingLength:pse},gse=mse,kd=gse;var Md=(t,e=0)=>[kd.decode(t,e),kd.decode.bytes],bl=(t,e,r=0)=>(kd.encode(t,e,r),e),wl=t=>kd.encodingLength(t);var ec=(t,e)=>{let r=e.byteLength,n=wl(t),o=n+wl(r),s=new Uint8Array(o+r);return bl(t,s,0),bl(r,s,n),s.set(e,o),new xl(t,r,e,s)},fg=t=>{let e=Ps(t),[r,n]=Md(e),[o,s]=Md(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new xl(r,o,i,e)},xN=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&hN(t.bytes,r.bytes)}},xl=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var EN=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return bse(r,vv(t),e||Or.encoder);default:return wse(r,vv(t),e||Ns.encoder)}};var vN=new WeakMap,vv=t=>{let e=vN.get(t);if(e==null){let r=new Map;return vN.set(t,r),r}return e},ct=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Fd)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==xse)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ct.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=ec(e,r);return ct.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ct.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&xN(e.multihash,n.multihash)}toString(e){return EN(this,e)}toJSON(){return{"/":EN(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof ct)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new ct(n,o,s,i||SN(n,o,s.bytes))}else if(r[Ese]===!0){let{version:n,multihash:o,code:s}=r,i=fg(o);return ct.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Fd)throw new Error(`Version 0 CID must use dag-pb (code: ${Fd}) block encoding`);return new ct(e,r,n,n.bytes)}case 1:{let o=SN(e,r,n.bytes);return new ct(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return ct.create(0,Fd,e)}static createV1(e,r){return ct.create(1,e,r)}static decode(e){let[r,n]=ct.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=ct.inspectBytes(e),n=r.size-r.multihashSize,o=Ps(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new xl(r.multihashCode,r.digestSize,s,o);return[r.version===0?ct.createV0(i):ct.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Md(e.subarray(r));return r+=p,h},o=n(),s=Fd;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=yse(e,r),s=ct.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return vv(s).set(n,e),s}},yse=(t,e)=>{switch(t[0]){case"Q":{let r=e||Or;return[Or.prefix,r.decode(`${Or.prefix}${t}`)]}case Or.prefix:{let r=e||Or;return[Or.prefix,r.decode(t)]}case Ns.prefix:{let r=e||Ns;return[Ns.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},bse=(t,e,r)=>{let{prefix:n}=r;if(n!==Or.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},wse=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},Fd=112,xse=18,SN=(t,e,r)=>{let n=wl(t),o=n+wl(e),s=new Uint8Array(o+r.byteLength);return bl(t,s,0),bl(e,s,n),s.set(r,o),s},Ese=Symbol.for("@ipld/js-cid/CID");function AN(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Sv={};T(Sv,{base10:()=>vse});var vse=Qi({prefix:"9",name:"base10",alphabet:"0123456789"});var Av={};T(Av,{base16:()=>Sse,base16upper:()=>Ase});var Sse=Ct({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ase=Ct({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Cv={};T(Cv,{base2:()=>Cse});var Cse=Ct({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Tv={};T(Tv,{base256emoji:()=>Rse});var CN=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Tse=CN.reduce((t,e,r)=>(t[r]=e,t),[]),_se=CN.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Ise(t){return t.reduce((e,r)=>(e+=Tse[r],e),"")}function Dse(t){let e=[];for(let r of t){let n=_se[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Rse=yl({prefix:"\u{1F680}",name:"base256emoji",encode:Ise,decode:Dse});var _v={};T(_v,{base36:()=>Lse,base36upper:()=>Bse});var Lse=Qi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Bse=Qi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Dv={};T(Dv,{base64:()=>Pse,base64pad:()=>Nse,base64url:()=>Iv,base64urlpad:()=>Ose});var Pse=Ct({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Nse=Ct({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Iv=Ct({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ose=Ct({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Rv={};T(Rv,{base8:()=>Use});var Use=Ct({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Lv={};T(Lv,{identity:()=>kse});var kse=yl({prefix:"\0",name:"identity",encode:t=>pN(t),decode:t=>dN(t)});var dNe=new TextEncoder,pNe=new TextDecoder;var Bv={};T(Bv,{identity:()=>$se});var TN=0,Vse="identity",_N=Ps,zse=t=>ec(TN,_N(t)),$se={code:TN,name:Vse,encode:_N,digest:zse};var Ov={};T(Ov,{sha256:()=>Kse,sha512:()=>qse});var Nv=({name:t,code:e,encode:r})=>new Pv(t,e,r),Pv=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?ec(this.code,r):r.then(n=>ec(this.code,n))}else throw Error("Unknown type, must be binary type")}};var DN=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Kse=Nv({name:"sha2-256",code:18,encode:DN("SHA-256")}),qse=Nv({name:"sha2-512",code:19,encode:DN("SHA-512")});var Vd={...Lv,...Cv,...Rv,...Sv,...Av,...xv,..._v,...wv,...Dv,...Tv},vNe={...Ov,...Bv};function vl(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function hg(t=0){return globalThis.Buffer?.allocUnsafe!=null?vl(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function LN(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var RN=LN("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Uv=LN("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=hg(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Hse={utf8:RN,"utf-8":RN,hex:Vd.base16,latin1:Uv,ascii:Uv,binary:Uv,...Vd},dg=Hse;function Zr(t,e="utf8"){let r=dg[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Os(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=hg(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return vl(r)}function kv(t,e="utf8"){let r=dg[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?vl(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var BN=cr,Gse=ur,Mv=function(t){let e=0;if(t=t.toString().trim(),BN(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(Gse(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let s=BN(r[n]),i;s&&(i=Mv(r[n]),r[n]=Zr(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,Zr(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let o=new Uint8Array(e+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);o[e++]=s>>8&255,o[e++]=s&255}return o}throw new Error("invalid ip address")},PN=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let o=[];for(let s=0;s<r;s++)o.push(t[e+s]);return o.join(".")}if(r===16){let o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(e+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Sl={},Fv={},jse=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];jse.forEach(t=>{let e=Yse(...t);Fv[e.code]=e,Sl[e.name]=e});function Yse(t,e,r,n,o){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(o)}}function Xe(t){if(typeof t=="number"){if(Fv[t]!=null)return Fv[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(Sl[t]!=null)return Sl[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var XNe=Xe("ip4"),JNe=Xe("ip6"),ZNe=Xe("ipcidr");function zv(t,e){switch(Xe(t).code){case 4:case 41:return Xse(e);case 42:return UN(e);case 6:case 273:case 33:case 132:return MN(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return UN(e);case 421:return tie(e);case 444:return kN(e);case 445:return kN(e);case 466:return eie(e);default:return Zr(e,"base16")}}function $v(t,e){switch(Xe(t).code){case 4:return NN(e);case 41:return NN(e);case 42:return ON(e);case 6:case 273:case 33:case 132:return Kv(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return ON(e);case 421:return Jse(e);case 444:return rie(e);case 445:return nie(e);case 466:return Zse(e);default:return kv(e,"base16")}}var Vv=Object.values(Vd).map(t=>t.decoder),Qse=function(){let t=Vv[0].or(Vv[1]);return Vv.slice(2).forEach(e=>t=t.or(e)),t}();function NN(t){if(!xe(t))throw new Error("invalid ip address");return Mv(t)}function Xse(t){let e=PN(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!xe(e))throw new Error("invalid ip address");return e}function Kv(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function MN(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function ON(t){let e=kv(t),r=Uint8Array.from(re(e.length));return Os([r,e],r.length+e.length)}function UN(t){let e=te(t);if(t=t.slice(X(e)),t.length!==e)throw new Error("inconsistent lengths");return Zr(t)}function Jse(t){let e;t[0]==="Q"||t[0]==="1"?e=fg(Or.decode(`z${t}`)).bytes:e=ct.parse(t).multihash.bytes;let r=Uint8Array.from(re(e.length));return Os([r,e],r.length+e.length)}function Zse(t){let e=Qse.decode(t),r=Uint8Array.from(re(e.length));return Os([r,e],r.length+e.length)}function eie(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+Zr(r,"base64url")}function tie(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return Zr(r,"base58btc")}function rie(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=Ns.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Kv(n);return Os([r,o],r.length+o.length)}function nie(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=Ns.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Kv(n);return Os([r,o],r.length+o.length)}function kN(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=Zr(e,"base32"),o=MN(r);return`${n}:${o}`}function FN(t){t=qv(t);let e=[],r=[],n=null,o=t.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=Xe(i);if(a.size===0){e.push([a.code]),r.push([a.code]);continue}if(s++,s>=o.length)throw zN("invalid address: "+t);if(a.path===!0){n=qv(o.slice(s).join("/")),e.push([a.code,$v(a.code,n)]),r.push([a.code,n]);break}let c=$v(a.code,o[s]);e.push([a.code,c]),r.push([a.code,zv(a.code,c)])}return{string:VN(r),bytes:Gv(e),tuples:e,stringTuples:r,path:n}}function Hv(t){let e=[],r=[],n=null,o=0;for(;o<t.length;){let s=te(t,o),i=X(s),a=Xe(s),c=oie(a,t.slice(o+i));if(c===0){e.push([s]),r.push([s]),o+=i;continue}let u=t.slice(o+i,o+i+c);if(o+=c+i,o>t.length)throw zN("Invalid address Uint8Array: "+Zr(t,"base16"));e.push([s,u]);let l=zv(s,u);if(r.push([s,l]),a.path===!0){n=l;break}}return{bytes:Uint8Array.from(t),string:VN(r),tuples:e,stringTuples:r,path:n}}function VN(t){let e=[];return t.map(r=>{let n=Xe(r[0]);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),qv(e.join("/"))}function Gv(t){return Os(t.map(e=>{let r=Xe(e[0]),n=Uint8Array.from(re(r.code));return e.length>1&&e[1]!=null&&(n=Os([n,e[1]])),n}))}function oie(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{let r=te(e instanceof Uint8Array?e:Uint8Array.from(e));return r+X(r)}}function qv(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function zN(t){return new Error("Error parsing address: "+t)}var sie=Symbol.for("nodejs.util.inspect.custom"),iie=[Xe("dns").code,Xe("dns4").code,Xe("dns6").code,Xe("dnsaddr").code],aie=new Map,$N=Symbol.for("@multiformats/js-multiaddr/multiaddr");function cie(t){return Boolean(t?.[$N])}var Xi=class{bytes;#e;#t;#r;#n;[$N]=!0;constructor(e){e==null&&(e="");let r;if(e instanceof Uint8Array)r=Hv(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);r=FN(e)}else if(cie(e))r=Hv(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#e=r.string,this.#t=r.tuples,this.#r=r.stringTuples,this.#n=r.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,r,n,o,s="",i=Xe("tcp"),a=Xe("udp"),c=Xe("ip4"),u=Xe("ip6"),l=Xe("dns6"),h=Xe("ip6zone");for(let[m,f]of this.stringTuples())m===h.code&&(s=`%${f??""}`),iie.includes(m)&&(r=i.name,o=443,n=`${f??""}${s}`,e=m===l.code?6:4),(m===i.code||m===a.code)&&(r=Xe(m).name,o=parseInt(f??"")),(m===c.code||m===u.code)&&(r=Xe(m).name,n=`${f??""}${s}`,e=m===u.code?6:4);if(e==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:o}}protos(){return this.#t.map(([e])=>Object.assign({},Xe(e)))}protoCodes(){return this.#t.map(([e])=>e)}protoNames(){return this.#t.map(([e])=>Xe(e).name)}tuples(){return this.#t}stringTuples(){return this.#r}encapsulate(e){return e=new Xi(e),new Xi(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Xi(n.slice(0,o))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Xi(Gv(r.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach(([n,o])=>{n===Sl.p2p.code&&e.push([n,o]),n===Sl["p2p-circuit"].code&&(e=[])});let r=e.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?Zr(Or.decode(`z${n}`),"base58btc"):Zr(ct.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(e){return AN(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=aie.get(r.name);if(n==null)throw new C(`no available resolver for ${r.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new Xi(s))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[sie](){return`Multiaddr(${this.#e})`}};var uie=t=>t.toString().split("/").slice(1),zd=t=>({match:e=>e.length<1?!1:t(e[0])?e.slice(1):!1,pattern:"fn"}),Vt=t=>({match:e=>zd(r=>r===t).match(e),pattern:t}),gg=()=>({match:t=>zd(e=>typeof e=="string").match(t),pattern:"{string}"}),KN=()=>({match:t=>zd(e=>!isNaN(parseInt(e))).match(t),pattern:"{number}"}),qn=()=>({match:t=>{if(t.length<2||t[0]!=="p2p"&&t[0]!=="ipfs")return!1;if(t[1].startsWith("Q")||t[1].startsWith("1"))try{Or.decode(`z${t[1]}`)}catch{return!1}else return!1;return t.slice(2)},pattern:"/p2p/{peerid}"}),pg=()=>({match:t=>{if(t.length<2||t[0]!=="certhash")return!1;try{Iv.decode(t[1])}catch{return!1}return t.slice(2)},pattern:"/certhash/{certhash}"}),Vo=t=>({match:e=>{let r=t.match(e);return r===!1?e:r},pattern:`optional(${t.pattern})`}),zo=(...t)=>({match:e=>{let r;for(let n of t){let o=n.match(e);o!==!1&&(r==null||o.length<r.length)&&(r=o)}return r??!1},pattern:`or(${t.map(e=>e.pattern).join(", ")})`}),zt=(...t)=>({match:e=>{for(let r of t){let n=r.match(e);if(n===!1)return!1;e=n}return e},pattern:`and(${t.map(e=>e.pattern).join(", ")})`});function lr(...t){function e(o){let s=uie(o);for(let i of t){let a=i.match(s);if(a===!1)return!1;s=a}return s}function r(o){return e(o)!==!1}function n(o){let s=e(o);return s===!1?!1:s.length===0}return{matches:r,exactMatch:n}}var jv=zt(Vt("dns4"),gg()),Yv=zt(Vt("dns6"),gg()),Qv=zt(Vt("dnsaddr"),gg()),qN=zt(Vt("dns"),gg()),COe=lr(jv),TOe=lr(Yv),_Oe=lr(Qv),IOe=lr(zo(qN,Qv,jv,Yv)),HN=zt(Vt("ip4"),zd(cr)),GN=zt(Vt("ip6"),zd(ur)),WN=zo(HN,GN),yg=zo(WN,qN,jv,Yv,Qv),DOe=lr(HN),ROe=lr(GN),LOe=lr(WN),bg=zt(yg,Vt("tcp"),KN()),$d=zt(yg,Vt("udp"),KN()),lie=zo(bg,$d),BOe=lr(bg),POe=lr($d),Xv=zt($d,Vt("quic")),wg=zt($d,Vt("quic-v1")),fie=zo(Xv,wg),NOe=lr(Xv),OOe=lr(wg),Wv=zo(yg,bg,$d,Xv,wg),jN=zo(zt(Wv,Vt("ws"),Vo(qn()))),UOe=lr(jN),YN=zo(zt(Wv,Vt("wss"),Vo(qn())),zt(Wv,Vt("tls"),Vt("ws"),Vo(qn()))),kOe=lr(YN),QN=zt(lie,Vt("webrtc-direct"),pg(),Vo(pg()),Vo(qn())),XN=lr(QN),JN=zt(wg,Vt("webtransport"),pg(),pg(),Vo(qn())),MOe=lr(JN),mg=zo(jN,YN,zt(bg,Vo(qn())),zt(fie,Vo(qn())),zt(yg,Vo(qn())),QN,JN,qn()),FOe=lr(mg),hie=zt(mg,Vt("p2p-circuit"),qn()),Jv=lr(hie),die=zo(zt(mg,Vt("p2p-circuit"),Vt("webrtc"),qn()),zt(mg,Vt("webrtc"),Vo(qn())),Vt("webrtc")),ZN=lr(die);function Zv(t){try{let{address:e}=t.nodeAddress();return Boolean(ug(e))}catch{return!0}}function pie(t,e){let r=Zv(t.multiaddr),n=Zv(e.multiaddr);return r&&!n?1:!r&&n?-1:0}function mie(t,e){return t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}function gie(t,e){let r=Jv.exactMatch(t.multiaddr),n=Jv.exactMatch(e.multiaddr);return r&&!n?1:!r&&n?-1:0}function Al(t,e){let r=pie(t,e);if(r!==0)return r;let n=gie(t,e);return n!==0?n:mie(t,e)}var tS=J(ao(),1),rS=J(oO(),1);var sO=globalThis.fetch,iO=globalThis.Headers,jOe=globalThis.Request,YOe=globalThis.Response;function Eg(t,e,r){return`${t}?name=${e}&type=${r}`}async function aO(t,e){return await(await sO(t,{headers:new iO({accept:"application/dns-json"}),signal:e})).json()}function rc(t,e){return`${e}_${t}`}var eS=Object.assign((0,tS.default)("dns-over-http-resolver"),{error:(0,tS.default)("dns-over-http-resolver:error")}),nS=class{constructor(e={}){this._cache=new rS.default({max:e?.maxCache??100}),this._TXTcache=new rS.default({max:e?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=e.request??aO,this._abortControllers=[]}cancel(){this._abortControllers.forEach(e=>e.abort())}getServers(){return this._servers}_getShuffledServers(){let e=[...this._servers];for(let r=e.length-1;r>0;r--){let n=Math.floor(Math.random()*r),o=e[r];e[r]=e[n],e[n]=o}return e}setServers(e){this._servers=e}async resolve(e,r="A"){switch(r){case"A":return await this.resolve4(e);case"AAAA":return await this.resolve6(e);case"TXT":return await this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",n=this._cache.get(rc(e,r));if(n!=null)return n;let o=!1;for(let s of this._getShuffledServers()){let i=new AbortController;this._abortControllers.push(i);try{let a=await this._request(Eg(s,e,r),i.signal),c=a.Answer.map(l=>l.data),u=Math.min(...a.Answer.map(l=>l.TTL));return this._cache.set(rc(e,r),c,{ttl:u}),c}catch{i.signal.aborted&&(o=!0),eS.error(`${s} could not resolve ${e} record ${r}`)}finally{this._abortControllers=this._abortControllers.filter(a=>a!==i)}}throw o?Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",n=this._cache.get(rc(e,r));if(n!=null)return n;let o=!1;for(let s of this._getShuffledServers()){let i=new AbortController;this._abortControllers.push(i);try{let a=await this._request(Eg(s,e,r),i.signal),c=a.Answer.map(l=>l.data),u=Math.min(...a.Answer.map(l=>l.TTL));return this._cache.set(rc(e,r),c,{ttl:u}),c}catch{i.signal.aborted&&(o=!0),eS.error(`${s} could not resolve ${e} record ${r}`)}finally{this._abortControllers=this._abortControllers.filter(a=>a!==i)}}throw o?Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",n=this._TXTcache.get(rc(e,r));if(n!=null)return n;let o=!1;for(let s of this._getShuffledServers()){let i=new AbortController;this._abortControllers.push(i);try{let a=await this._request(Eg(s,e,r),i.signal),c=a.Answer.map(l=>[l.data.replace(/['"]+/g,"")]),u=Math.min(...a.Answer.map(l=>l.TTL));return this._TXTcache.set(rc(e,r),c,{ttl:u}),c}catch{i.signal.aborted&&(o=!0),eS.error(`${s} could not resolve ${e} record ${r}`)}finally{this._abortControllers=this._abortControllers.filter(a=>a!==i)}}throw o?Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"}):new Error(`Could not resolve ${e} record ${r}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}},cO=nS;var uO=cO;var{code:Tie}=De("dnsaddr");async function Il(t,e={}){let r=new uO;e.signal!=null&&e.signal.addEventListener("abort",()=>{r.cancel()});let n=t.getPeerId(),[,o]=t.stringTuples().find(([a])=>a===Tie)??[];if(o==null)throw new Error("No hostname found in multiaddr");let i=(await r.resolveTxt(`_dnsaddr.${o}`)).flat().map(a=>a.split("=")[1]).filter(Boolean);return n!=null&&(i=i.filter(a=>a.includes(n))),i}var $o;(function(t){t.NOT_STARTED_YET="The libp2p node is not started yet",t.DHT_DISABLED="DHT is not available",t.PUBSUB_DISABLED="PubSub is not available",t.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",t.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",t.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",t.NOT_FOUND="Not found"})($o||($o={}));var $;(function(t){t.DHT_DISABLED="ERR_DHT_DISABLED",t.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",t.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",t.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",t.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",t.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",t.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",t.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",t.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",t.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",t.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",t.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",t.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",t.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",t.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",t.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",t.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",t.ERR_DIALED_SELF="ERR_DIALED_SELF",t.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",t.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",t.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",t.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",t.ERR_INVALID_KEY="ERR_INVALID_KEY",t.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",t.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",t.ERR_INVALID_PEER="ERR_INVALID_PEER",t.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",t.ERR_NOT_FOUND="ERR_NOT_FOUND",t.ERR_TIMEOUT="ERR_TIMEOUT",t.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",t.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",t.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",t.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",t.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",t.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",t.ERR_FIND_SELF="ERR_FIND_SELF",t.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",t.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",t.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",t.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",t.ERR_INVALID_CMS="ERR_INVALID_CMS",t.ERR_MISSING_KEYS="ERR_MISSING_KEYS",t.ERR_NO_KEY="ERR_NO_KEY",t.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",t.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",t.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",t.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",t.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",t.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",t.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",t.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",t.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",t.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",t.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",t.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",t.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",t.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",t.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",t.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",t.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",t.ERR_INVALID_RECORD="ERR_INVALID_RECORD",t.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",t.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",t.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",t.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",t.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED",t.ERR_TRANSFER_LIMIT_EXCEEDED="ERR_TRANSFER_LIMIT_EXCEEDED"})($||($={}));var _ie={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{resolvers:{dnsaddr:Il},addressSorter:Al},transportManager:{faultTolerance:ji.FATAL_ALL}};function lO(t){let e=Di(_ie,t);if(e.transports==null||e.transports.length<1)throw new C($o.ERR_TRANSPORTS_REQUIRED,$.ERR_TRANSPORTS_REQUIRED);if(e.connectionProtector===null&&globalThis.process?.env?.LIBP2P_FORCE_PNET!=null)throw new C($o.ERR_PROTECTOR_REQUIRED,$.ERR_PROTECTOR_REQUIRED);return e}var fO="keep-alive";var uU=J(bS(),1);var uae=fe("libp2p:get-peer");function Sg(t){if(hm(t))return{peerId:t,multiaddrs:[]};Array.isArray(t)||(t=[t]);let e;if(t.length>0){let r=t[0].getPeerId();e=r==null?void 0:_r(r),t.forEach(n=>{if(!Od(n))throw uae.error("multiaddr %s was invalid",n),new C("Invalid Multiaddr",$.ERR_INVALID_MULTIADDR);let o=n.getPeerId();if(o==null){if(e!=null)throw new C("Multiaddrs must all have the same peer id or have no peer id",$.ERR_INVALID_PARAMETERS)}else{let s=_r(o);if(e==null||!e.equals(s))throw new C("Multiaddrs must all have the same peer id or have no peer id",$.ERR_INVALID_PARAMETERS)}})}return{peerId:e,multiaddrs:t}}function lae(t,e,r){let n=0,o=t.length;for(;o>0;){let s=Math.trunc(o/2),i=n+s;r(t[i],e)<=0?(n=++i,o-=s+1):o=s}return n}var wS=class{#e=[];enqueue(e,r){let n=r?.peerId,o=r?.priority??0;if(n==null)throw new C("missing peer id",$.ERR_INVALID_PARAMETERS);let s={priority:o,peerId:n,run:e};if(this.size>0&&this.#e[this.size-1].priority>=o){this.#e.push(s);return}let i=lae(this.#e,s,(a,c)=>c.priority-a.priority);this.#e.splice(i,0,s)}dequeue(){return this.#e.shift()?.run}filter(e){if(e.peerId!=null){let r=e.peerId;return this.#e.filter(n=>r.equals(n.peerId)).map(n=>n.run)}return this.#e.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this.#e.length}},Pl=class extends qi{constructor(e={}){super({...e,queueClass:wS})}hasJob(e){return this.sizeBy({peerId:e})>0}};var Ag="last-dial-failure";var Cg=5,Us=100,Tg=50,sU=1e3*60*7;var fr=fe("libp2p:connection-manager:auto-dial"),nc={minConnections:Cg,maxQueueLength:100,autoDialConcurrency:25,autoDialPriority:0,autoDialInterval:5e3,autoDialPeerRetryThreshold:sU,autoDialDiscoveredPeersDebounce:10},_g=class{connectionManager;peerStore;queue;minConnections;autoDialPriority;autoDialIntervalMs;autoDialMaxQueueLength;autoDialPeerRetryThresholdMs;autoDialDiscoveredPeersDebounce;autoDialInterval;started;running;constructor(e,r){this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.minConnections=r.minConnections??nc.minConnections,this.autoDialPriority=r.autoDialPriority??nc.autoDialPriority,this.autoDialIntervalMs=r.autoDialInterval??nc.autoDialInterval,this.autoDialMaxQueueLength=r.maxQueueLength??nc.maxQueueLength,this.autoDialPeerRetryThresholdMs=r.autoDialPeerRetryThreshold??nc.autoDialPeerRetryThreshold,this.autoDialDiscoveredPeersDebounce=r.autoDialDiscoveredPeersDebounce??nc.autoDialDiscoveredPeersDebounce,this.started=!1,this.running=!1,this.queue=new Pl({concurrency:r.autoDialConcurrency??nc.autoDialConcurrency}),this.queue.addListener("error",o=>{fr.error("error during auto-dial",o)}),e.events.addEventListener("connection:close",()=>{this.autoDial().catch(o=>{fr.error(o)})});let n;e.events.addEventListener("peer:discovery",()=>{clearTimeout(n),n=setTimeout(()=>{this.autoDial().catch(o=>{fr.error(o)})},this.autoDialDiscoveredPeersDebounce)})}isStarted(){return this.started}start(){this.autoDialInterval=setTimeout(()=>{this.autoDial().catch(e=>{fr.error("error while autodialing",e)})},this.autoDialIntervalMs),this.started=!0}afterStart(){this.autoDial().catch(e=>{fr.error("error while autodialing",e)})}stop(){this.queue.clear(),clearTimeout(this.autoDialInterval),this.started=!1,this.running=!1}async autoDial(){if(!this.started)return;let e=this.connectionManager.getConnectionsMap(),r=e.size;if(r>=this.minConnections){this.minConnections>0&&fr.trace("have enough connections %d/%d",r,this.minConnections);return}if(this.queue.size>this.autoDialMaxQueueLength){fr("not enough connections %d/%d but auto dial queue is full",r,this.minConnections);return}if(this.running){fr("not enough connections %d/%d - but skipping autodial as it is already running",r,this.minConnections);return}this.running=!0,fr("not enough connections %d/%d - will dial peers to increase the number of connections",r,this.minConnections);let n=new uo(this.connectionManager.getDialQueue().map(u=>u.peerId).filter(Boolean)),o=await this.peerStore.all({filters:[u=>u.addresses.length===0?(fr.trace("not autodialing %p because they have no addresses",u.id),!1):e.has(u.id)?(fr.trace("not autodialing %p because they are already connected",u.id),!1):n.has(u.id)?(fr.trace("not autodialing %p because they are already being dialed",u.id),!1):this.queue.hasJob(u.id)?(fr.trace("not autodialing %p because they are already being autodialed",u.id),!1):!0]}),s=o.sort(()=>Math.random()>.5?1:-1),i=new br;for(let u of s)i.has(u.id)||i.set(u.id,[...u.tags.values()].reduce((l,h)=>l+h.value,0));let c=s.sort((u,l)=>{let h=i.get(u.id)??0,p=i.get(l.id)??0;return h>p?-1:h<p?1:0}).filter(u=>{let l=u.metadata.get(Ag);if(l==null)return!0;let h=parseInt(Ft(l));return isNaN(h)?!0:Date.now()-h>this.autoDialPeerRetryThresholdMs});fr("selected %d/%d peers to dial",c.length,o.length);for(let u of c)this.queue.add(async()=>{let l=this.connectionManager.getConnectionsMap().size;if(l>=this.minConnections){fr("got enough connections now %d/%d",l,this.minConnections),this.queue.clear();return}fr("connecting to a peerStore stored peer %p",u.id),await this.connectionManager.openConnection(u.id,{priority:this.autoDialPriority})},{peerId:u.id}).catch(l=>{fr.error("could not connect to peerStore stored peer",l)});this.running=!1,this.started&&(this.autoDialInterval=setTimeout(()=>{this.autoDial().catch(u=>{fr.error("error while autodialing",u)})},this.autoDialIntervalMs))}};var Nl=fe("libp2p:connection-manager:connection-pruner"),iU={maxConnections:Us,allow:[]},Ig=class{maxConnections;connectionManager;peerStore;allow;events;constructor(e,r={}){this.maxConnections=r.maxConnections??iU.maxConnections,this.allow=r.allow??iU.allow,this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.events=e.events,e.events.addEventListener("connection:open",()=>{this.maybePruneConnections().catch(n=>{Nl.error(n)})})}async maybePruneConnections(){let e=this.connectionManager.getConnections(),r=e.length,n=Math.max(r-this.maxConnections,0);if(Nl("checking max connections limit %d/%d",r,this.maxConnections),r<=this.maxConnections)return;Nl("max connections limit exceeded %d/%d, pruning %d connection(s)",r,this.maxConnections,n);let o=new br;for(let a of e){let c=a.remotePeer;if(!o.has(c)){o.set(c,0);try{let u=await this.peerStore.get(c);o.set(c,[...u.tags.values()].reduce((l,h)=>l+h.value,0))}catch(u){u.code!=="ERR_NOT_FOUND"&&Nl.error("error loading peer tags",u)}}}let s=e.sort((a,c)=>{let u=o.get(a.remotePeer)??0,l=o.get(c.remotePeer)??0;if(u>l)return 1;if(u<l)return-1;let h=a.timeline.open,p=c.timeline.open;return h<p?1:h>p?-1:0}),i=[];for(let a of s)if(Nl("too many connections open - closing a connection to %p",a.remotePeer),this.allow.some(u=>a.remoteAddr.toString().startsWith(u.toString()))||i.push(a),i.length===n)break;await Promise.all(i.map(async a=>{try{await a.close()}catch(c){Nl.error(c)}})),this.events.safeDispatchEvent("connection:prune",{detail:i})}};var CS=J(li(),1);function Zi(t){let e=new globalThis.AbortController;function r(){e.abort();for(let s of t)s?.removeEventListener!=null&&s.removeEventListener("abort",r)}for(let s of t){if(s?.aborted===!0){r();break}s?.addEventListener!=null&&s.addEventListener("abort",r)}function n(){for(let s of t)s?.removeEventListener!=null&&s.removeEventListener("abort",r)}let o=e.signal;return o.clear=n,o}function ze(){let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}var SS=J(li(),1);var aU=fe("libp2p:connection-manager:utils");async function AS(t,e){if(!t.protoNames().includes("dnsaddr"))return[t];let n=await dae(t,e),i=(await Promise.all(n.map(async a=>AS(a,e)))).flat().reduce((a,c)=>(a.find(u=>u.equals(c))==null&&a.push(c),a),[]);return aU("resolved %s to",t,i.map(a=>a.toString())),i}async function dae(t,e){try{return t=Pe(t.toString()),await t.resolve(e)}catch(r){return aU.error(`multiaddr ${t.toString()} could not be resolved`,r),[]}}function cU(...t){let e=[];for(let n of t)if(n!=null){try{(0,SS.setMaxListeners)?.(1/0,n)}catch{}e.push(n)}let r=Zi(e);try{(0,SS.setMaxListeners)?.(1/0,r)}catch{}return r}var vr=fe("libp2p:connection-manager:dial-queue"),Hd={addressSorter:Al,maxParallelDials:Tg,maxPeerAddrsToDial:25,maxParallelDialsPerPeer:1,dialTimeout:3e4,resolvers:{dnsaddr:Il}},Dg=class{pendingDials;queue;peerId;peerStore;connectionGater;transportManager;addressSorter;maxPeerAddrsToDial;maxParallelDialsPerPeer;dialTimeout;inProgressDialCount;pendingDialCount;shutDownController;constructor(e,r={}){this.addressSorter=r.addressSorter??Hd.addressSorter,this.maxPeerAddrsToDial=r.maxPeerAddrsToDial??Hd.maxPeerAddrsToDial,this.maxParallelDialsPerPeer=r.maxParallelDialsPerPeer??Hd.maxParallelDialsPerPeer,this.dialTimeout=r.dialTimeout??Hd.dialTimeout,this.peerId=e.peerId,this.peerStore=e.peerStore,this.connectionGater=e.connectionGater,this.transportManager=e.transportManager,this.shutDownController=new AbortController;try{(0,CS.setMaxListeners)?.(1/0,this.shutDownController.signal)}catch{}this.pendingDialCount=e.metrics?.registerMetric("libp2p_dialler_pending_dials"),this.inProgressDialCount=e.metrics?.registerMetric("libp2p_dialler_in_progress_dials"),this.pendingDials=[];for(let[n,o]of Object.entries(r.resolvers??{}))av.set(n,o);this.queue=new qi({concurrency:r.maxParallelDials??Hd.maxParallelDials}),this.queue.on("add",()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)}),this.queue.on("active",()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)}),this.queue.on("completed",()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)}),this.queue.on("error",n=>{vr.error("error in dial queue",n),this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)}),this.queue.on("empty",()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)}),this.queue.on("idle",()=>{this.pendingDialCount?.update(this.queue.size),this.inProgressDialCount?.update(this.queue.pending)})}stop(){this.shutDownController.abort()}async dial(e,r={}){let{peerId:n,multiaddrs:o}=Sg(e),s=o.map(l=>({multiaddr:l,isCertified:!1})),i=this.createDialAbortControllers(r.signal),a;try{a=await this.calculateMultiaddrs(n,s,{...r,signal:i})}catch(l){throw i.clear(),l}let c=this.pendingDials.find(l=>!!(l.peerId!=null&&n!=null&&l.peerId.equals(n)||a.map(({multiaddr:h})=>h.toString()).join()===l.multiaddrs.map(h=>h.toString()).join()));if(c!=null)return vr("joining existing dial target for %p",n),i.clear(),c.promise;vr("creating dial target for",a.map(({multiaddr:l})=>l.toString()));let u={id:pae(),status:"queued",peerId:n,multiaddrs:a.map(({multiaddr:l})=>l)};return u.promise=this.performDial(u,{...r,signal:i}).finally(()=>{this.pendingDials=this.pendingDials.filter(l=>l.id!==u.id),i.clear()}).catch(async l=>{if(vr.error("dial failed to %s",u.multiaddrs.map(h=>h.toString()).join(", "),l),n!=null)try{await this.peerStore.patch(n,{metadata:{[Ag]:Nr(Date.now().toString())}})}catch(h){vr.error("could not update last dial failure key for %p",n,h)}throw i.aborted?new C(l.message,$.ERR_TIMEOUT):l}),this.pendingDials.push(u),u.promise}createDialAbortControllers(e){let r=Zi([AbortSignal.timeout(this.dialTimeout),this.shutDownController.signal,e]);try{(0,CS.setMaxListeners)?.(1/0,r)}catch{}return r}async calculateMultiaddrs(e,r=[],n={}){if(e!=null){if(this.peerId.equals(e))throw new C("Tried to dial self",$.ERR_DIALED_SELF);if(await this.connectionGater.denyDialPeer?.(e)===!0)throw new C("The dial request is blocked by gater.allowDialPeer",$.ERR_PEER_DIAL_INTERCEPTED);if(r.length===0){vr("loading multiaddrs for %p",e);try{let l=await this.peerStore.get(e);r.push(...l.addresses),vr("loaded multiaddrs for %p",e,r.map(({multiaddr:h})=>h.toString()))}catch(l){if(l.code!==$.ERR_NOT_FOUND)throw l}}}let o=(await Promise.all(r.map(async l=>{let h=await AS(l.multiaddr,n);return h.length===1&&h[0].equals(l.multiaddr)?l:h.map(p=>({multiaddr:p,isCertified:!1}))}))).flat(),s=o.filter(l=>{if(this.transportManager.transportForMultiaddr(l.multiaddr)==null)return!1;let h=l.multiaddr.getPeerId();return e!=null&&h!=null?e.equals(h):!0}),i=new Map;for(let l of s){let h=l.multiaddr.toString(),p=i.get(h);if(p!=null){p.isCertified=p.isCertified||l.isCertified||!1;continue}i.set(h,l)}let a=[...i.values()];if((a.length===0||a.length>this.maxPeerAddrsToDial)&&(vr("addresses for %p before filtering",e??"unknown peer",o.map(({multiaddr:l})=>l.toString())),vr("addresses for %p after filtering",e??"unknown peer",a.map(({multiaddr:l})=>l.toString()))),a.length===0)throw new C("The dial request has no valid addresses",$.ERR_NO_VALID_ADDRESSES);if(a.length>this.maxPeerAddrsToDial)throw new C("dial with more addresses than allowed",$.ERR_TOO_MANY_ADDRESSES);if(e!=null){let l=`/p2p/${e.toString()}`;a=a.map(h=>{let p=h.multiaddr.getPeerId();return h.multiaddr.protos().pop()?.path===!0?h:p!==e.toString()?{multiaddr:h.multiaddr.encapsulate(l),isCertified:h.isCertified}:h})}let c=[];for(let l of a)this.connectionGater.denyDialMultiaddr!=null&&await this.connectionGater.denyDialMultiaddr(l.multiaddr)||c.push(l);let u=c.sort(this.addressSorter);if(u.length===0)throw new C("The connection gater denied all addresses in the dial request",$.ERR_NO_VALID_ADDRESSES);return u}async performDial(e,r={}){let n=e.multiaddrs.map(()=>new AbortController);try{let o=new qi({concurrency:this.maxParallelDialsPerPeer});o.on("error",i=>{vr.error("error dialling",i)});let s=await Promise.any(e.multiaddrs.map(async(i,a)=>{let c=n[a];if(c==null)throw new C("dialAction did not come with an AbortController",$.ERR_INVALID_PARAMETERS);let u=cU(c.signal,r.signal);u.addEventListener("abort",()=>{vr("dial to %a aborted",i)});let l=ze();return await o.add(async()=>{if(u.aborted){vr("dial to %a was aborted before reaching the head of the peer dial queue",i),l.reject(new Zn);return}await this.queue.add(async()=>{try{if(u.aborted){vr("dial to %a was aborted before reaching the head of the dial queue",i),l.reject(new Zn);return}e.status="active";let h=await this.transportManager.dial(i,{...r,signal:u});if(c.signal.aborted){vr("multiple dials succeeded, closing superfluous connection"),h.close().catch(p=>{vr.error("error closing superfluous connection",p)}),l.reject(new Zn);return}n[a]=void 0,n.forEach(p=>{p!==void 0&&p.abort()}),vr("dial to %a succeeded",i),l.resolve(h)}catch(h){vr.error("error during dial of %a",i,h),l.reject(h)}},{...r,signal:u}).catch(h=>{l.reject(h)})},{signal:u}).catch(h=>{l.reject(h)}).finally(()=>{u.clear()}),l.promise}));if(s==null)throw new C("successful dial led to empty object returned from peer dial queue",$.ERR_TRANSPORT_DIAL_FAILED);return e.status="success",s}catch(o){throw e.status="error",e.multiaddrs.length===1&&o.name==="AggregateError"?o.errors[0]:o}}};function pae(){return`${parseInt(String(Math.random()*1e9),10).toString()}${Date.now()}`}var An=fe("libp2p:connection-manager"),yae=50,oc={minConnections:Cg,maxConnections:Us,inboundConnectionThreshold:5,maxIncomingPendingConnections:10,autoDialConcurrency:25,autoDialPriority:0,autoDialMaxQueueLength:100},Rg=class{started;connections;allow;deny;maxIncomingPendingConnections;incomingPendingConnections;maxConnections;dialQueue;autoDial;connectionPruner;inboundConnectionRateLimiter;peerStore;metrics;events;constructor(e,r={}){this.maxConnections=r.maxConnections??oc.maxConnections;let n=r.minConnections??oc.minConnections;if(this.maxConnections<n)throw new C("Connection Manager maxConnections must be greater than minConnections",$.ERR_INVALID_PARAMETERS);this.connections=new br,this.started=!1,this.peerStore=e.peerStore,this.metrics=e.metrics,this.events=e.events,this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.events.addEventListener("connection:open",this.onConnect),this.events.addEventListener("connection:close",this.onDisconnect),this.allow=(r.allow??[]).map(o=>Pe(o)),this.deny=(r.deny??[]).map(o=>Pe(o)),this.incomingPendingConnections=0,this.maxIncomingPendingConnections=r.maxIncomingPendingConnections??oc.maxIncomingPendingConnections,this.inboundConnectionRateLimiter=new uU.RateLimiterMemory({points:r.inboundConnectionThreshold??oc.inboundConnectionThreshold,duration:1}),this.autoDial=new _g({connectionManager:this,peerStore:e.peerStore,events:e.events},{minConnections:n,autoDialConcurrency:r.autoDialConcurrency??oc.autoDialConcurrency,autoDialPriority:r.autoDialPriority??oc.autoDialPriority,maxQueueLength:r.autoDialMaxQueueLength??oc.autoDialMaxQueueLength}),this.connectionPruner=new Ig({connectionManager:this,peerStore:e.peerStore,events:e.events},{maxConnections:this.maxConnections,allow:this.allow}),this.dialQueue=new Dg({peerId:e.peerId,metrics:e.metrics,peerStore:e.peerStore,transportManager:e.transportManager,connectionGater:e.connectionGater},{addressSorter:r.addressSorter??Al,maxParallelDials:r.maxParallelDials??Tg,maxPeerAddrsToDial:r.maxPeerAddrsToDial??25,maxParallelDialsPerPeer:r.maxParallelDialsPerPeer??1,dialTimeout:r.dialTimeout??3e4,resolvers:r.resolvers??{dnsaddr:Il}})}isStarted(){return this.started}async start(){this.metrics?.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{let e={inbound:0,outbound:0};for(let r of this.connections.values())for(let n of r)n.direction==="inbound"?e.inbound++:e.outbound++;return e}}),this.metrics?.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{let e={};for(let r of this.connections.values())for(let n of r)for(let o of n.streams){let s=`${o.direction} ${o.protocol??"unnegotiated"}`;e[s]=(e[s]??0)+1}return e}}),this.metrics?.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{let e={};for(let n of this.connections.values())for(let o of n){let s={};for(let i of o.streams){let a=`${i.direction} ${i.protocol??"unnegotiated"}`;s[a]=(s[a]??0)+1}for(let[i,a]of Object.entries(s))e[i]=e[i]??[],e[i].push(a)}let r={};for(let[n,o]of Object.entries(e)){o=o.sort((i,a)=>i-a);let s=Math.floor(o.length*.9);r[n]=o[s]}return r}}),this.autoDial.start(),this.started=!0,An("started")}async afterStart(){Promise.resolve().then(async()=>{let e=await this.peerStore.all({filters:[r=>r.tags.has(fO)]});await Promise.all(e.map(async r=>{await this.openConnection(r.id).catch(n=>{An.error(n)})}))}).catch(e=>{An.error(e)}),this.autoDial.afterStart()}async stop(){this.dialQueue.stop(),this.autoDial.stop();let e=[];for(let r of this.connections.values())for(let n of r)e.push((async()=>{try{await n.close()}catch(o){An.error(o)}})());An("closing %d connections",e.length),await Promise.all(e),this.connections.clear(),An("stopped")}onConnect(e){this._onConnect(e).catch(r=>{An.error(r)})}async _onConnect(e){let{detail:r}=e;if(!this.started){await r.close();return}let n=r.remotePeer,o=this.connections.get(n),s=!1;o!=null?o.push(r):(s=!0,this.connections.set(n,[r])),n.publicKey!=null&&n.type==="RSA"&&await this.peerStore.patch(n,{publicKey:n.publicKey}),s&&this.events.safeDispatchEvent("peer:connect",{detail:r.remotePeer})}onDisconnect(e){let{detail:r}=e;if(!this.started)return;let n=r.remotePeer,o=this.connections.get(n);o!=null&&o.length>1?(o=o.filter(s=>s.id!==r.id),this.connections.set(n,o)):o!=null&&(this.connections.delete(n),this.events.safeDispatchEvent("peer:disconnect",{detail:r.remotePeer}))}getConnections(e){if(e!=null)return this.connections.get(e)??[];let r=[];for(let n of this.connections.values())r=r.concat(n);return r}getConnectionsMap(){return this.connections}async openConnection(e,r={}){if(!this.isStarted())throw new C("Not started",$.ERR_NODE_NOT_STARTED);r.signal?.throwIfAborted();let{peerId:n}=Sg(e);if(n!=null&&r.force!==!0){An("dial %p",n);let a=this.getConnections(n);if(a.length>0)return An("had an existing connection to %p",n),a[0]}let o=await this.dialQueue.dial(e,{...r,priority:r.priority??yae}),s=this.connections.get(o.remotePeer);s==null&&(s=[],this.connections.set(o.remotePeer,s));let i=!1;for(let a of s)a.id===o.id&&(i=!0);return i||s.push(o),o}async closeConnections(e,r={}){let n=this.connections.get(e)??[];await Promise.all(n.map(async o=>{try{await o.close(r)}catch(s){o.abort(s)}}))}async acceptIncomingConnection(e){if(this.deny.some(o=>e.remoteAddr.toString().startsWith(o.toString())))return An("connection from %a refused - connection remote address was in deny list",e.remoteAddr),!1;if(this.allow.some(o=>e.remoteAddr.toString().startsWith(o.toString())))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.maxIncomingPendingConnections)return An("connection from %a refused - incomingPendingConnections exceeded by host",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){let o=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(o,1)}catch{return An("connection from %a refused - inboundConnectionThreshold exceeded by host %s",e.remoteAddr,o),!1}}return this.getConnections().length<this.maxConnections?(this.incomingPendingConnections++,!0):(An("connection from %a refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}getDialQueue(){return this.dialQueue.pendingDials}};var Lg=class{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},Ol=class{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Lg(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let r=this.head;this.head=r.next=new Lg(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};var DS=class extends Error{type;code;constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function Je(t={}){return fU(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function lU(t={}){return fU(r=>{let n,o=[];for(;!r.isEmpty()&&(n=r.shift(),n!=null);){if(n.error!=null)throw n.error;n.done===!1&&o.push(n.value)}return n==null?{done:!0}:{done:n.done===!0,value:o}},t)}function fU(t,e){e=e??{};let r=e.onEnd,n=new Ol,o,s,i,a=ze(),c=async()=>{try{return n.isEmpty()?i?{done:!0}:await new Promise((g,y)=>{s=b=>{s=null,n.push(b);try{g(t(n))}catch(w){y(w)}return o}}):t(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=ze()})}},u=g=>s!=null?s(g):(n.push(g),o),l=g=>(n=new Ol,s!=null?s({error:g}):(n.push({error:g}),o)),h=g=>{if(i)return o;if(e?.objectMode!==!0&&g?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:g})},p=g=>i?o:(i=!0,g!=null?l(g):u({done:!0})),m=()=>(n=new Ol,p(),{done:!0}),f=g=>(p(g),{done:!0});if(o={[Symbol.asyncIterator](){return this},next:c,return:m,throw:f,push:h,end:p,get readableLength(){return n.size},onEmpty:async g=>{let y=g?.signal;if(y?.throwIfAborted(),n.isEmpty())return;let b,w;y!=null&&(b=new Promise((x,E)=>{w=()=>{E(new DS)},y.addEventListener("abort",w)}));try{await Promise.race([a.promise,b])}finally{w!=null&&y!=null&&y?.removeEventListener("abort",w)}}},r==null)return o;let d=o;return o={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(g){return d.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return d.return(),r!=null&&(r(),r=void 0),{done:!0}},push:h,end(g){return d.end(g),r!=null&&(r(g),r=void 0),o},get readableLength(){return d.readableLength}},o}function bae(t){return t[Symbol.asyncIterator]!=null}function wae(...t){let e=[];for(let r of t)bae(r)||e.push(r);return e.length===t.length?function*(){for(let r of e)yield*r}():async function*(){let r=Je({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async n=>{for await(let o of n)r.push(o)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var sc=wae;function Gd(t,...e){if(t==null)throw new Error("Empty pipeline");if(RS(t)){let n=t;t=()=>n.source}else if(dU(t)||hU(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&RS(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)RS(r[n])&&(r[n]=Eae(r[n]));return xae(...r)}var xae=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},hU=t=>t?.[Symbol.asyncIterator]!=null,dU=t=>t?.[Symbol.iterator]!=null,RS=t=>t==null?!1:t.sink!=null&&t.source!=null,Eae=t=>e=>{let r=t.sink(e);if(r?.then!=null){let n=Je({objectMode:!0});r.then(()=>{n.end()},i=>{n.end(i)});let o,s=t.source;if(hU(s))o=async function*(){yield*s,n.end()};else if(dU(s))o=function*(){yield*s,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return sc(n,o())}return t.source};function vae(t){return t[Symbol.asyncIterator]!=null}function Sae(t,e){if(vae(t))return async function*(){for await(let a of t)yield e(a)}();let r=rg(t),{value:n,done:o}=r.next();if(o===!0)return function*(){}();let s=e(n);if(typeof s.then=="function")return async function*(){yield await s;for await(let a of r)yield e(a)}();let i=e;return function*(){yield s;for(let a of r)yield i(a)}()}var pU=Sae;async function*Wd(t,e){yield*pU(t,async r=>(await e.merge(r.id,{multiaddrs:r.multiaddrs}),r))}function Bg(t){let e=new Set;return ho(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*Pg(t,e=1){let r=0;for await(let n of t)r++,yield n;if(r<e)throw new C(`more peers required, seen: ${r}  min: ${e}`,"NOT_FOUND")}var Ng=class{routers;started;components;constructor(e,r){this.routers=r.routers??[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(e,r={}){if(this.routers.length===0)throw new C("No content routers available",$.ERR_NO_ROUTERS_AVAILABLE);yield*Gd(sc(...this.routers.map(n=>n.findProviders(e,r))),n=>Wd(n,this.components.peerStore),n=>Bg(n),n=>Pg(n))}async provide(e,r={}){if(this.routers.length===0)throw new C("No content routers available",$.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(async n=>{await n.provide(e,r)}))}async put(e,r,n){if(!this.isStarted())throw new C($o.NOT_STARTED_YET,$.DHT_NOT_STARTED);await Promise.all(this.routers.map(async o=>{await o.put(e,r,n)}))}async get(e,r){if(!this.isStarted())throw new C($o.NOT_STARTED_YET,$.DHT_NOT_STARTED);return Promise.any(this.routers.map(async n=>n.get(e,r)))}};function Aae(t){return t[Symbol.asyncIterator]!=null}function Cae(t){if(Aae(t))return(async()=>{for await(let e of t)return e})();for(let e of t)return e}var mU=Cae;var Tae=fe("libp2p:peer-routing"),Og=class{components;routers;constructor(e,r){this.components=e,this.routers=r.routers??[]}async findPeer(e,r){if(this.routers.length===0)throw new C("No peer routers available",$.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.components.peerId.toString())throw new C("Should not try to find self",$.ERR_FIND_SELF);let n=await Gd(sc(...this.routers.map(o=>async function*(){try{yield await o.findPeer(e,r)}catch(s){Tae.error(s)}}())),o=>ho(o,Boolean),o=>Wd(o,this.components.peerStore),async o=>mU(o));if(n!=null)return n;throw new C($o.NOT_FOUND,$.ERR_NOT_FOUND)}async*getClosestPeers(e,r){if(this.routers.length===0)throw new C("No peer routers available",$.ERR_NO_ROUTERS_AVAILABLE);yield*Gd(sc(...this.routers.map(n=>n.getClosestPeers(e,r))),n=>Wd(n,this.components.peerStore),n=>Bg(n),n=>Pg(n))}};var LS=fe("libp2p:registrar"),BS=32,PS=64,Ug=class{topologies;handlers;components;constructor(e){this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onPeerUpdate=this._onPeerUpdate.bind(this),this._onConnect=this._onConnect.bind(this),this.components.events.addEventListener("peer:disconnect",this._onDisconnect),this.components.events.addEventListener("peer:connect",this._onConnect),this.components.events.addEventListener("peer:update",this._onPeerUpdate)}getProtocols(){return Array.from(new Set([...this.handlers.keys()])).sort()}getHandler(e){let r=this.handlers.get(e);if(r==null)throw new C(`No handler registered for protocol ${e}`,$.ERR_NO_HANDLER_FOR_PROTOCOL);return r}getTopologies(e){let r=this.topologies.get(e);return r==null?[]:[...r.values()]}async handle(e,r,n){if(this.handlers.has(e))throw new C(`Handler already registered for protocol ${e}`,$.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);let o=Di.bind({ignoreUndefined:!0})({maxInboundStreams:BS,maxOutboundStreams:PS},n);this.handlers.set(e,{handler:r,options:o}),await this.components.peerStore.merge(this.components.peerId,{protocols:[e]})}async unhandle(e){(Array.isArray(e)?e:[e]).forEach(n=>{this.handlers.delete(n)}),await this.components.peerStore.patch(this.components.peerId,{protocols:this.getProtocols()})}async register(e,r){if(r==null)throw new C("invalid topology",$.ERR_INVALID_PARAMETERS);let n=`${(Math.random()*1e9).toString(36)}${Date.now()}`,o=this.topologies.get(e);return o==null&&(o=new Map,this.topologies.set(e,o)),o.set(n,r),n}unregister(e){for(let[r,n]of this.topologies.entries())n.has(e)&&(n.delete(e),n.size===0&&this.topologies.delete(r))}_onDisconnect(e){let r=e.detail;this.components.peerStore.get(r).then(n=>{for(let o of n.protocols){let s=this.topologies.get(o);if(s!=null)for(let i of s.values())i.onDisconnect?.(r)}}).catch(n=>{n.code!==$.ERR_NOT_FOUND&&LS.error("could not inform topologies of disconnecting peer %p",r,n)})}_onConnect(e){let r=e.detail;this.components.peerStore.get(r).then(n=>{let o=this.components.connectionManager.getConnections(n.id)[0];if(o==null){LS("peer %p connected but the connection manager did not have a connection",n);return}for(let s of n.protocols){let i=this.topologies.get(s);if(i!=null)for(let a of i.values())a.onConnect?.(r,o)}}).catch(n=>{n.code!==$.ERR_NOT_FOUND&&LS.error("could not inform topologies of connecting peer %p",r,n)})}_onPeerUpdate(e){let{peer:r,previous:n}=e.detail,o=(n?.protocols??[]).filter(i=>!r.protocols.includes(i)),s=r.protocols.filter(i=>!(n?.protocols??[]).includes(i));for(let i of o){let a=this.topologies.get(i);if(a!=null)for(let c of a.values())c.onDisconnect?.(r.id)}for(let i of s){let a=this.topologies.get(i);if(a!=null)for(let c of a.values()){let u=this.components.connectionManager.getConnections(r.id)[0];u!=null&&c.onConnect?.(r.id,u)}}}};var NS=class extends Map{metric;constructor(e){super();let{name:r,metrics:n}=e;this.metric=n.registerMetric(r),this.updateComponentMetric()}set(e,r){return super.set(e,r),this.updateComponentMetric(),this}delete(e){let r=super.delete(e);return this.updateComponentMetric(),r}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}};function gU(t){let{name:e,metrics:r}=t,n;return r!=null?n=new NS({name:e,metrics:r}):n=new Map,n}var ea=fe("libp2p:transports"),kg=class{components;transports;listeners;faultTolerance;started;constructor(e,r={}){this.components=e,this.started=!1,this.transports=new Map,this.listeners=gU({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=r.faultTolerance??ji.FATAL_ALL}add(e){let r=e[Symbol.toStringTag];if(r==null)throw new C("Transport must have a valid tag",$.ERR_INVALID_KEY);if(this.transports.has(r))throw new C(`There is already a transport with the tag ${r}`,$.ERR_DUPLICATE_TRANSPORT);ea("adding transport %s",r),this.transports.set(r,e),this.listeners.has(r)||this.listeners.set(r,[])}isStarted(){return this.started}start(){this.started=!0}async afterStart(){let e=this.components.addressManager.getListenAddrs();await this.listen(e)}async stop(){let e=[];for(let[r,n]of this.listeners)for(ea("closing listeners for %s",r);n.length>0;){let o=n.pop();o!=null&&e.push(o.close())}await Promise.all(e),ea("all listeners closed");for(let r of this.listeners.keys())this.listeners.set(r,[]);this.started=!1}async dial(e,r){let n=this.transportForMultiaddr(e);if(n==null)throw new C(`No transport available for address ${String(e)}`,$.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,{...r,upgrader:this.components.upgrader})}catch(o){throw o.code==null&&(o.code=$.ERR_TRANSPORT_DIAL_FAILED),o}}getAddrs(){let e=[];for(let r of this.listeners.values())for(let n of r)e=[...e,...n.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}getListeners(){return Array.of(...this.listeners.values()).flat()}transportForMultiaddr(e){for(let r of this.transports.values())if(r.filter([e]).length>0)return r}async listen(e){if(!this.isStarted())throw new C("Not started",$.ERR_NODE_NOT_STARTED);if(e==null||e.length===0){ea("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[n,o]of this.transports.entries()){let s=o.filter(e),i=[];for(let u of s){ea("creating listener for %s on %a",n,u);let l=o.createListener({upgrader:this.components.upgrader}),h=this.listeners.get(n)??[];h==null&&(h=[],this.listeners.set(n,h)),h.push(l),l.addEventListener("listening",()=>{this.components.events.safeDispatchEvent("transport:listening",{detail:l})}),l.addEventListener("close",()=>{let p=h.findIndex(m=>m===l);h.splice(p,1),this.components.events.safeDispatchEvent("transport:close",{detail:l})}),i.push(l.listen(u))}if(i.length===0){r.push(n);continue}if((await Promise.allSettled(i)).find(u=>u.status==="fulfilled")==null&&this.faultTolerance!==ji.NO_FATAL)throw new C(`Transport (${n}) could not listen on any available address`,$.ERR_NO_VALID_ADDRESSES)}if(r.length===this.transports.size){let n=`no valid addresses were provided for transports [${r.join(", ")}]`;if(this.faultTolerance===ji.FATAL_ALL)throw new C(n,$.ERR_NO_VALID_ADDRESSES);ea(`libp2p in dial mode only: ${n}`)}}async remove(e){let r=this.listeners.get(e)??[];ea.trace("removing transport %s",e);let n=[];for(ea.trace("closing listeners for %s",e);r.length>0;){let o=r.pop();o!=null&&n.push(o.close())}await Promise.all(n),this.transports.delete(e),this.listeners.delete(e)}async removeAll(){let e=[];for(let r of this.transports.keys())e.push(this.remove(r));await Promise.all(e)}};var uA=J(li(),1);var ks="/multistream/1.0.0";var Cn=J(ao(),1);var FS={};T(FS,{base32:()=>ra,base32hex:()=>Oae,base32hexpad:()=>kae,base32hexpadupper:()=>Mae,base32hexupper:()=>Uae,base32pad:()=>Pae,base32padupper:()=>Nae,base32upper:()=>Bae,base32z:()=>Fae});function _ae(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var Iae=_ae,Dae=Iae,yU=Dae;var zMe=new Uint8Array(0);var bU=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Ms=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var wU=t=>new TextEncoder().encode(t),xU=t=>new TextDecoder().decode(t);var OS=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},US=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return vU(this,e)}},kS=class{constructor(e){this.decoders=e}or(e){return vU(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},vU=(t,e)=>new kS({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),MS=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new OS(e,r,n),this.decoder=new US(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Ul=({name:t,prefix:e,encode:r,decode:n})=>new MS(t,e,r,n),ta=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=yU(r,e);return Ul({prefix:t,name:e,encode:n,decode:s=>Ms(o(s))})},Rae=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},Lae=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Tt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Ul({prefix:e,name:t,encode(o){return Lae(o,n,r)},decode(o){return Rae(o,n,r,t)}});var ra=Tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Bae=Tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Pae=Tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Nae=Tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Oae=Tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Uae=Tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),kae=Tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mae=Tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Fae=Tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var VS={};T(VS,{base58btc:()=>Gn,base58flickr:()=>Vae});var Gn=ta({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vae=ta({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var $S={};T($S,{base64:()=>zS,base64pad:()=>zae,base64url:()=>$ae,base64urlpad:()=>Kae});var zS=Tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zae=Tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$ae=Tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Kae=Tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});Cn.default.formatters.b=t=>t==null?"undefined":Gn.baseEncode(t);Cn.default.formatters.t=t=>t==null?"undefined":ra.baseEncode(t);Cn.default.formatters.m=t=>t==null?"undefined":zS.baseEncode(t);Cn.default.formatters.p=t=>t==null?"undefined":t.toString();Cn.default.formatters.c=t=>t==null?"undefined":t.toString();Cn.default.formatters.k=t=>t==null?"undefined":t.toString();Cn.default.formatters.a=t=>t==null?"undefined":t.toString();function qae(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function kl(t){let e=qae(`${t}:trace`);return Cn.default.enabled(`${t}:trace`)&&Cn.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,Cn.default)(`${t}:trace`)),Object.assign((0,Cn.default)(t),{error:(0,Cn.default)(`${t}:error`),trace:e})}function KS(t){let e=async function*(){let r=yield,n=new ue;for await(let o of t){if(r==null){n.append(o),r=yield n,n=new ue;continue}for(n.append(o);n.length>=r;){let s=n.sublist(0,r);if(n.consume(r),r=yield s,r==null){n.length>0&&(r=yield n,n=new ue);break}}}if(r!=null)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return e.next(),e}function Mg(t){let e=Je(),r=KS(t.source),n=ze(),o,s=t.sink(async function*(){yield*e,yield*await n.promise}());return s.catch(a=>{o=a}),{reader:r,writer:e,stream:{sink:async a=>{if(o!=null){await Promise.reject(o);return}n.resolve(a),await s},source:r},rest:()=>e.end(),write:e.push,read:async()=>{let a=await r.next();if(a.value!=null)return a.value}}}function Hae(t){return t[Symbol.asyncIterator]!=null}function Gae(...t){let e=[];for(let r of t)Hae(r)||e.push(r);return e.length===t.length?function*(){for(let r of e)yield*r}():async function*(){let r=Je({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async n=>{for await(let o of n)r.push(o)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var qS=Gae;function Fg(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var HS={};T(HS,{base10:()=>Wae});var Wae=ta({prefix:"9",name:"base10",alphabet:"0123456789"});var GS={};T(GS,{base16:()=>jae,base16upper:()=>Yae});var jae=Tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Yae=Tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var WS={};T(WS,{base2:()=>Qae});var Qae=Tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var jS={};T(jS,{base256emoji:()=>tce});var SU=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Xae=SU.reduce((t,e,r)=>(t[r]=e,t),[]),Jae=SU.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Zae(t){return t.reduce((e,r)=>(e+=Xae[r],e),"")}function ece(t){let e=[];for(let r of t){let n=Jae[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var tce=Ul({prefix:"\u{1F680}",name:"base256emoji",encode:Zae,decode:ece});var YS={};T(YS,{base36:()=>rce,base36upper:()=>nce});var rce=ta({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),nce=ta({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var QS={};T(QS,{base8:()=>oce});var oce=Tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var XS={};T(XS,{identity:()=>sce});var sce=Ul({prefix:"\0",name:"identity",encode:t=>xU(t),decode:t=>wU(t)});var m7e=new TextEncoder,g7e=new TextDecoder;var ZS={};T(ZS,{identity:()=>Ice});var cce=TU,AU=128,uce=127,lce=~uce,fce=Math.pow(2,31);function TU(t,e,r){e=e||[],r=r||0;for(var n=r;t>=fce;)e[r++]=t&255|AU,t/=128;for(;t&lce;)e[r++]=t&255|AU,t>>>=7;return e[r]=t|0,TU.bytes=r-n+1,e}var hce=JS,dce=128,CU=127;function JS(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw JS.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&CU)<<o:(i&CU)*Math.pow(2,o),o+=7}while(i>=dce);return JS.bytes=s-n,r}var pce=Math.pow(2,7),mce=Math.pow(2,14),gce=Math.pow(2,21),yce=Math.pow(2,28),bce=Math.pow(2,35),wce=Math.pow(2,42),xce=Math.pow(2,49),Ece=Math.pow(2,56),vce=Math.pow(2,63),Sce=function(t){return t<pce?1:t<mce?2:t<gce?3:t<yce?4:t<bce?5:t<wce?6:t<xce?7:t<Ece?8:t<vce?9:10},Ace={encode:cce,decode:hce,encodingLength:Sce},Cce=Ace,jd=Cce;var Yd=(t,e=0)=>[jd.decode(t,e),jd.decode.bytes],Ml=(t,e,r=0)=>(jd.encode(t,e,r),e),Fl=t=>jd.encodingLength(t);var ic=(t,e)=>{let r=e.byteLength,n=Fl(t),o=n+Fl(r),s=new Uint8Array(o+r);return Ml(t,s,0),Ml(r,s,n),s.set(e,o),new Vl(t,r,e,s)},_U=t=>{let e=Ms(t),[r,n]=Yd(e),[o,s]=Yd(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Vl(r,o,i,e)},IU=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&bU(t.bytes,r.bytes)}},Vl=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var DU=0,Tce="identity",RU=Ms,_ce=t=>ic(DU,RU(t)),Ice={code:DU,name:Tce,encode:RU,digest:_ce};var rA={};T(rA,{sha256:()=>Dce,sha512:()=>Rce});var tA=({name:t,code:e,encode:r})=>new eA(t,e,r),eA=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?ic(this.code,r):r.then(n=>ic(this.code,n))}else throw Error("Unknown type, must be binary type")}};var BU=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Dce=tA({name:"sha2-256",code:18,encode:BU("SHA-256")}),Rce=tA({name:"sha2-512",code:19,encode:BU("SHA-512")});var PU=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Bce(r,nA(t),e||Gn.encoder);default:return Pce(r,nA(t),e||ra.encoder)}};var NU=new WeakMap,nA=t=>{let e=NU.get(t);if(e==null){let r=new Map;return NU.set(t,r),r}return e},Gt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Xd)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Nce)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Gt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=ic(e,r);return Gt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Gt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&IU(e.multihash,n.multihash)}toString(e){return PU(this,e)}toJSON(){return{"/":PU(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof Gt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new Gt(n,o,s,i||OU(n,o,s.bytes))}else if(r[Oce]===!0){let{version:n,multihash:o,code:s}=r,i=_U(o);return Gt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Xd)throw new Error(`Version 0 CID must use dag-pb (code: ${Xd}) block encoding`);return new Gt(e,r,n,n.bytes)}case 1:{let o=OU(e,r,n.bytes);return new Gt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return Gt.create(0,Xd,e)}static createV1(e,r){return Gt.create(1,e,r)}static decode(e){let[r,n]=Gt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Gt.inspectBytes(e),n=r.size-r.multihashSize,o=Ms(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new Vl(r.multihashCode,r.digestSize,s,o);return[r.version===0?Gt.createV0(i):Gt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Yd(e.subarray(r));return r+=p,h},o=n(),s=Xd;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=Lce(e,r),s=Gt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return nA(s).set(n,e),s}},Lce=(t,e)=>{switch(t[0]){case"Q":{let r=e||Gn;return[Gn.prefix,r.decode(`${Gn.prefix}${t}`)]}case Gn.prefix:{let r=e||Gn;return[Gn.prefix,r.decode(t)]}case ra.prefix:{let r=e||ra;return[ra.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Bce=(t,e,r)=>{let{prefix:n}=r;if(n!==Gn.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},Pce=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},Xd=112,Nce=18,OU=(t,e,r)=>{let n=Fl(t),o=n+Fl(e),s=new Uint8Array(o+r.byteLength);return Ml(t,s,0),Ml(e,s,n),s.set(r,o),s},Oce=Symbol.for("@ipld/js-cid/CID");var oA={...XS,...WS,...QS,...HS,...GS,...FS,...YS,...VS,...$S,...jS},B7e={...rA,...ZS};function UU(t=0){return globalThis.Buffer?.allocUnsafe!=null?Fg(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function MU(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var kU=MU("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),sA=MU("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=UU(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Uce={utf8:kU,"utf-8":kU,hex:oA.base16,latin1:sA,ascii:sA,binary:sA,...oA},zg=Uce;function mo(t,e="utf8"){let r=zg[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Fg(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var Jd=class extends Error{constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function FU(t){if(t!=null){if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t.next=="function")return t}throw new Error("argument is not an iterator or iterable")}function go(t,e,r){let n=r??{},o=FU(t);async function*s(){let i,a=()=>{i?.()};for(e.addEventListener("abort",a);;){let c;try{if(e.aborted){let{abortMessage:l,abortCode:h}=n;throw new Jd(l,h)}let u=new Promise((l,h)=>{i=()=>{let{abortMessage:p,abortCode:m}=n;h(new Jd(p,m))}});c=await Promise.race([u,o.next()]),i=null}catch(u){e.removeEventListener("abort",a);let l=u.type==="aborted"&&e.aborted;if(l&&n.onAbort!=null&&n.onAbort(t),typeof o.return=="function")try{let h=o.return();h instanceof Promise&&h.catch(p=>{n.onReturnError!=null&&n.onReturnError(p)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(l&&n.returnOnAbort===!0)return;throw u}if(c.done===!0)break;yield c.value}e.removeEventListener("abort",a)}return s()}function kce(t){return t[Symbol.asyncIterator]!=null}function Mce(t){if(kce(t))return(async()=>{for await(let e of t)return e})();for(let e of t)return e}var VU=Mce;function zU(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function $U(t=0){return globalThis.Buffer?.allocUnsafe!=null?zU(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function $g(t){return t[Symbol.asyncIterator]!=null}var Kg=t=>{let e=X(t),r=$U(e);return re(t,r),Kg.bytes=e,r};Kg.bytes=0;function Fs(t,e){e=e??{};let r=e.lengthEncoder??Kg;function*n(o){let s=r(o.byteLength);s instanceof Uint8Array?yield s:yield*s,o instanceof Uint8Array?yield o:yield*o}return $g(t)?async function*(){for await(let o of t)yield*n(o)}():function*(){for(let o of t)yield*n(o)}()}Fs.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??Kg;return new ue(r(t.byteLength),t)};var zl=J(og(),1);var Fce=8,Vce=1024*1024*4,ac;(function(t){t[t.LENGTH=0]="LENGTH",t[t.DATA=1]="DATA"})(ac||(ac={}));var iA=t=>{let e=te(t);return iA.bytes=X(e),e};iA.bytes=0;function yo(t,e){let r=new ue,n=ac.LENGTH,o=-1,s=e?.lengthDecoder??iA,i=e?.maxLengthLength??Fce,a=e?.maxDataLength??Vce;function*c(){for(;r.byteLength>0;){if(n===ac.LENGTH)try{if(o=s(r),o<0)throw(0,zl.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(o>a)throw(0,zl.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=s.bytes;r.consume(u),e?.onLength!=null&&e.onLength(o),n=ac.DATA}catch(u){if(u instanceof RangeError){if(r.byteLength>i)throw(0,zl.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(n===ac.DATA){if(r.byteLength<o)break;let u=r.sublist(0,o);r.consume(o),e?.onData!=null&&e.onData(u),yield u,n=ac.LENGTH}}}return $g(t)?async function*(){for await(let u of t)r.append(u),yield*c();if(r.byteLength>0)throw(0,zl.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(let u of t)r.append(u),yield*c();if(r.byteLength>0)throw(0,zl.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}yo.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:i}=await t.next(r);if(s===!0)return;i!=null&&(yield i)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return yo(n,{...e??{},onLength:s=>{r=s}})};function KU(t,...e){if(t==null)throw new Error("Empty pipeline");if(aA(t)){let n=t;t=()=>n.source}else if(HU(t)||qU(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&aA(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)aA(r[n])&&(r[n]=$ce(r[n]));return zce(...r)}var zce=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},qU=t=>t?.[Symbol.asyncIterator]!=null,HU=t=>t?.[Symbol.iterator]!=null,aA=t=>t==null?!1:t.sink!=null&&t.source!=null,$ce=t=>e=>{let r=t.sink(e);if(r?.then!=null){let n=Je({objectMode:!0});r.then(()=>{n.end()},i=>{n.end(i)});let o,s=t.source;if(qU(s))o=async function*(){yield*s,n.end()};else if(HU(s))o=function*(){yield*s,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return qS(n,o())}return t.source};function GU(t,e="utf8"){let r=zg[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var qce=kl("libp2p:mss"),WU=mo(`
`);function Zd(t){let e=new ue(t,WU);return Fs.single(e)}function cc(t,e,r={}){let n=Zd(e);r.writeBytes===!0?t.push(n.subarray()):t.push(n)}function jU(t,e,r={}){let n=new ue;for(let o of e)n.append(Zd(o));r.writeBytes===!0?t.push(n.subarray()):t.push(n)}async function Hce(t,e){let r=1,n={[Symbol.asyncIterator]:()=>n,next:async()=>t.next(r)},o=n;e?.signal!=null&&(o=go(n,e.signal));let s=a=>{r=a},i=await KU(o,a=>yo(a,{onLength:s,maxDataLength:1024}),async a=>VU(a));if(i==null||i.length===0)throw new C("no buffer returned","ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(i.get(i.byteLength-1)!==WU[0])throw qce.error("Invalid mss message - missing newline - %s",i.subarray()),new C("missing newline","ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return i.sublist(0,-1)}async function $l(t,e){let r=await Hce(t,e);return GU(r.subarray())}var ep=kl("libp2p:mss:select");async function tp(t,e,r={}){e=Array.isArray(e)?[...e]:[e];let{reader:n,writer:o,rest:s,stream:i}=Mg(t),a=e.shift();if(a==null)throw new Error("At least one protocol must be specified");ep.trace('select: write ["%s", "%s"]',ks,a);let c=mo(ks),u=mo(a);jU(o,[c,u],r);let l=await $l(n,r);if(ep.trace('select: read "%s"',l),l===ks&&(l=await $l(n,r),ep.trace('select: read "%s"',l)),l===a)return s(),{stream:i,protocol:a};for(let h of e){ep.trace('select: write "%s"',h),cc(o,mo(h),r);let p=await $l(n,r);if(ep.trace('select: read "%s" for "%s"',p,h),p===h)return s(),{stream:i,protocol:h}}throw s(),new C("protocol selection failed","ERR_UNSUPPORTED_PROTOCOL")}var rp=kl("libp2p:mss:handle");async function np(t,e,r){e=Array.isArray(e)?e:[e];let{writer:n,reader:o,rest:s,stream:i}=Mg(t);for(;;){let a=await $l(o,r);if(rp.trace('read "%s"',a),a===ks){rp.trace('respond with "%s" for "%s"',ks,a),cc(n,mo(ks),r);continue}if(e.includes(a))return cc(n,mo(a),r),rp.trace('respond with "%s" for "%s"',a,a),s(),{stream:i,protocol:a};if(a==="ls"){cc(n,new ue(...e.map(c=>Zd(mo(c)))),r),rp.trace('respond with "%s" for %s',e,a);continue}cc(n,mo("na"),r),rp('respond with "na" for "%s"',a)}}var XU=J(li(),1);var QU=Symbol.for("@libp2p/connection");var uc=fe("libp2p:connection"),Wce=500,cA=class{id;remoteAddr;remotePeer;direction;timeline;multiplexer;encryption;status;transient;tags;_newStream;_close;_abort;_getStreams;constructor(e){let{remoteAddr:r,remotePeer:n,newStream:o,close:s,abort:i,getStreams:a}=e;this.id=`${parseInt(String(Math.random()*1e9)).toString(36)}${Date.now()}`,this.remoteAddr=r,this.remotePeer=n,this.direction=e.direction,this.status="open",this.timeline=e.timeline,this.multiplexer=e.multiplexer,this.encryption=e.encryption,this.transient=e.transient??!1,this._newStream=o,this._close=s,this._abort=i,this._getStreams=a,this.tags=[]}[Symbol.toStringTag]="Connection";[QU]=!0;get streams(){return this._getStreams()}async newStream(e,r){if(this.status==="closing")throw new C("the connection is being closed","ERR_CONNECTION_BEING_CLOSED");if(this.status==="closed")throw new C("the connection is closed","ERR_CONNECTION_CLOSED");if(Array.isArray(e)||(e=[e]),this.transient&&r?.runOnTransientConnection!==!0)throw new C("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");let n=await this._newStream(e,r);return n.direction="outbound",n}async close(e={}){if(!(this.status==="closed"||this.status==="closing")){uc("closing connection to %a",this.remoteAddr),this.status="closing",e.signal=e?.signal??AbortSignal.timeout(Wce);try{(0,XU.setMaxListeners)?.(1/0,e.signal)}catch{}try{uc.trace("closing all streams"),await Promise.all(this.streams.map(async r=>r.close(e))),uc.trace("closing underlying transport"),await this._close(e),uc.trace("updating timeline with close time"),this.status="closed",this.timeline.close=Date.now()}catch(r){uc.error("error encountered during graceful close of connection to %a",this.remoteAddr,r),this.abort(r)}}}abort(e){uc.error("aborting connection to %a due to error",this.remoteAddr,e),this.status="closing",this.streams.forEach(r=>{r.abort(e)}),uc.error("all streams aborted",this.streams.length),this._abort(e),this.timeline.close=Date.now(),this.status="closed"}};function JU(t){return new cA(t)}var He=fe("libp2p:upgrader");function Yce(t,e){try{let{options:r}=e.getHandler(t);return r.maxInboundStreams}catch(r){if(r.code!==$.ERR_NO_HANDLER_FOR_PROTOCOL)throw r}return BS}function Qce(t,e,r={}){try{let{options:n}=e.getHandler(t);if(n.maxOutboundStreams!=null)return n.maxOutboundStreams}catch(n){if(n.code!==$.ERR_NO_HANDLER_FOR_PROTOCOL)throw n}return r.maxOutboundStreams??PS}function ZU(t,e,r){let n=0;return r.streams.forEach(o=>{o.direction===e&&o.protocol===t&&n++}),n}var Hg=class{components;connectionEncryption;muxers;inboundUpgradeTimeout;events;constructor(e,r){this.components=e,this.connectionEncryption=new Map,r.connectionEncryption.forEach(n=>{this.connectionEncryption.set(n.protocol,n)}),this.muxers=new Map,r.muxers.forEach(n=>{this.muxers.set(n.protocol,n)}),this.inboundUpgradeTimeout=r.inboundUpgradeTimeout??3e4,this.events=e.events}async shouldBlockConnection(e,r,n){let o=this.components.connectionGater[n];if(o!==void 0&&await o(e,r))throw new C(`The multiaddr connection is blocked by gater.${n}`,$.ERR_CONNECTION_INTERCEPTED)}async upgradeInbound(e,r){if(!await this.components.connectionManager.acceptIncomingConnection(e))throw new C("connection denied",$.ERR_CONNECTION_DENIED);let o,s,i,a,c,u=AbortSignal.timeout(this.inboundUpgradeTimeout),l=()=>{e.abort(new C("inbound upgrade timeout",$.ERR_TIMEOUT))};u.addEventListener("abort",l,{once:!0});try{(0,uA.setMaxListeners)?.(1/0,u)}catch{}try{if(await this.components.connectionGater.denyInboundConnection?.(e)===!0)throw new C("The multiaddr connection is blocked by gater.acceptConnection",$.ERR_CONNECTION_INTERCEPTED);this.components.metrics?.trackMultiaddrConnection(e),He("starting the inbound connection upgrade");let h=e;if(r?.skipProtection!==!0){let p=this.components.connectionProtector;p!=null&&(He("protecting the inbound connection"),h=await p.protect(e))}try{if(o=h,r?.skipEncryption!==!0){({conn:o,remotePeer:s,protocol:c}=await this._encryptInbound(h));let p={...h,...o};await this.shouldBlockConnection(s,p,"denyInboundEncryptedConnection")}else{let p=e.remoteAddr.getPeerId();if(p==null)throw new C("inbound connection that skipped encryption must have a peer id",$.ERR_INVALID_MULTIADDR);let m=_r(p);c="native",s=m}if(i=o,r?.muxerFactory!=null)a=r.muxerFactory;else if(this.muxers.size>0){let p=await this._multiplexInbound({...h,...o},this.muxers);a=p.muxerFactory,i=p.stream}}catch(p){throw He.error("Failed to upgrade inbound connection",p),p}return await this.shouldBlockConnection(s,e,"denyInboundUpgradedConnection"),He("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:c,direction:"inbound",maConn:e,upgradedConn:i,muxerFactory:a,remotePeer:s,transient:r?.transient})}finally{u.removeEventListener("abort",l),this.components.connectionManager.afterUpgradeInbound()}}async upgradeOutbound(e,r){let n=e.remoteAddr.getPeerId(),o;n!=null&&(o=_r(n),await this.shouldBlockConnection(o,e,"denyOutboundConnection"));let s,i,a,c,u;this.components.metrics?.trackMultiaddrConnection(e),He("Starting the outbound connection upgrade");let l=e;if(r?.skipProtection!==!0){let h=this.components.connectionProtector;h!=null&&(l=await h.protect(e))}try{if(s=l,r?.skipEncryption!==!0){({conn:s,remotePeer:i,protocol:c}=await this._encryptOutbound(l,o));let h={...l,...s};await this.shouldBlockConnection(i,h,"denyOutboundEncryptedConnection")}else{if(o==null)throw new C("Encryption was skipped but no peer id was passed",$.ERR_INVALID_PEER);c="native",i=o}if(a=s,r?.muxerFactory!=null)u=r.muxerFactory;else if(this.muxers.size>0){let h=await this._multiplexOutbound({...l,...s},this.muxers);u=h.muxerFactory,a=h.stream}}catch(h){throw He.error("Failed to upgrade outbound connection",h),await e.close(h),h}return await this.shouldBlockConnection(i,e,"denyOutboundUpgradedConnection"),He("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:c,direction:"outbound",maConn:e,upgradedConn:a,muxerFactory:u,remotePeer:i,transient:r?.transient})}_createConnection(e){let{cryptoProtocol:r,direction:n,maConn:o,upgradedConn:s,remotePeer:i,muxerFactory:a,transient:c}=e,u,l,h;a!=null&&(u=a.createStreamMuxer({direction:n,onIncomingStream:f=>{h!=null&&Promise.resolve().then(async()=>{let d=this.components.registrar.getProtocols(),{stream:g,protocol:y}=await np(f,d);if(He("%s: incoming stream opened on %s",n,y),h==null)return;let b=Yce(y,this.components.registrar);if(ZU(y,"inbound",h)===b){let x=new C(`Too many inbound protocol streams for protocol "${y}" - limit ${b}`,$.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS);throw f.abort(x),x}f.source=g.source,f.sink=g.sink,f.protocol=y,await this.components.peerStore.merge(i,{protocols:[y]}),this.components.metrics?.trackProtocolStream(f,h),this._onStream({connection:h,stream:f,protocol:y})}).catch(async d=>{He.error(d),f.timeline.close==null&&await f.close()})}}),l=async(f,d={})=>{if(u==null)throw new C("Stream is not multiplexed",$.ERR_MUXER_UNAVAILABLE);He("%s: starting new stream on %s",n,f);let g=await u.newStream();try{if(d.signal==null){He("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",f),d.signal=AbortSignal.timeout(3e4);try{(0,uA.setMaxListeners)?.(1/0,d.signal)}catch{}}let{stream:y,protocol:b}=await tp(g,f,d),w=Qce(b,this.components.registrar,d);if(ZU(b,"outbound",h)>=w){let E=new C(`Too many outbound protocol streams for protocol "${b}" - limit ${w}`,$.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw g.abort(E),E}return await this.components.peerStore.merge(i,{protocols:[b]}),g.source=y.source,g.sink=y.sink,g.protocol=b,this.components.metrics?.trackProtocolStream(g,h),g}catch(y){throw He.error("could not create new stream for protocols %s on connection with address %a",f,h.remoteAddr,y),g.timeline.close==null&&g.abort(y),y.code!=null?y:new C(String(y),$.ERR_UNSUPPORTED_PROTOCOL)}},Promise.all([u.sink(s.source),s.sink(u.source)]).catch(f=>{He.error(f)}));let p=o.timeline;o.timeline=new Proxy(p,{set:(...f)=>(h!=null&&f[1]==="close"&&f[2]!=null&&p.close==null&&(async()=>{try{h.status==="open"&&await h.close()}catch(d){He.error(d)}finally{this.events.safeDispatchEvent("connection:close",{detail:h})}})().catch(d=>{He.error(d)}),Reflect.set(...f))}),o.timeline.upgraded=Date.now();let m=()=>{throw new C("connection is not multiplexed",$.ERR_CONNECTION_NOT_MULTIPLEXED)};return h=JU({remoteAddr:o.remoteAddr,remotePeer:i,status:"open",direction:n,timeline:o.timeline,multiplexer:u?.protocol,encryption:r,transient:c,newStream:l??m,getStreams:()=>u!=null?u.streams:[],close:async f=>{u!=null&&(He.trace("close muxer"),await u.close(f)),He.trace("close maconn"),await o.close(f),He.trace("closed maconn")},abort:f=>{o.abort(f),u?.abort(f)}}),this.events.safeDispatchEvent("connection:open",{detail:h}),h}_onStream(e){let{connection:r,stream:n,protocol:o}=e,{handler:s,options:i}=this.components.registrar.getHandler(o);if(r.transient&&i.runOnTransientConnection!==!0)throw new C("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");s({connection:r,stream:n})}async _encryptInbound(e){let r=Array.from(this.connectionEncryption.keys());He("handling inbound crypto protocol selection",r);try{let{stream:n,protocol:o}=await np(e,r,{writeBytes:!0}),s=this.connectionEncryption.get(o);if(s==null)throw new Error(`no crypto module found for ${o}`);return He("encrypting inbound connection..."),{...await s.secureInbound(this.components.peerId,n),protocol:o}}catch(n){throw new C(String(n),$.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r){let n=Array.from(this.connectionEncryption.keys());He("selecting outbound crypto protocol",n);try{let{stream:o,protocol:s}=await tp(e,n,{writeBytes:!0}),i=this.connectionEncryption.get(s);if(i==null)throw new Error(`no crypto module found for ${s}`);return He("encrypting outbound connection to %p",r),{...await i.secureOutbound(this.components.peerId,o,r),protocol:s}}catch(o){throw new C(String(o),$.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let n=Array.from(r.keys());He("outbound selecting muxer %s",n);try{let{stream:o,protocol:s}=await tp(e,n,{writeBytes:!0});He("%s selected as muxer protocol",s);let i=r.get(s);return{stream:o,muxerFactory:i}}catch(o){throw He.error("error multiplexing outbound stream",o),new C(String(o),$.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let n=Array.from(r.keys());He("inbound handling muxers %s",n);try{let{stream:o,protocol:s}=await np(e,n,{writeBytes:!0}),i=r.get(s);return{stream:o,muxerFactory:i}}catch(o){throw He.error("error multiplexing inbound stream",o),new C(String(o),$.ERR_MUXER_UNAVAILABLE)}}};var en=fe("libp2p"),lA=class extends mr{peerId;peerStore;contentRouting;peerRouting;keychain;metrics;services;components;#e;constructor(e){super();let r=new mr,n=r.dispatchEvent.bind(r);r.dispatchEvent=c=>{let u=n(c),l=this.dispatchEvent(new bx(c.type,{detail:c.detail}));return u||l};try{(0,ek.setMaxListeners)?.(1/0,r)}catch{}this.#e=!1,this.peerId=e.peerId,this.services={};let o=this.components=eN({peerId:e.peerId,events:r,datastore:e.datastore??new sg,connectionGater:lN(e.connectionGater)});this.peerStore=this.configureComponent("peerStore",new Jm(o,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore})),e.metrics!=null&&(this.metrics=this.configureComponent("metrics",e.metrics(this.components))),o.events.addEventListener("peer:update",c=>{if(c.detail.previous==null){let u={id:c.detail.peer.id,multiaddrs:c.detail.peer.addresses.map(l=>l.multiaddr),protocols:c.detail.peer.protocols};o.events.safeDispatchEvent("peer:discovery",{detail:u})}}),e.connectionProtector!=null&&this.configureComponent("connectionProtector",e.connectionProtector(o)),this.components.upgrader=new Hg(this.components,{connectionEncryption:(e.connectionEncryption??[]).map((c,u)=>this.configureComponent(`connection-encryption-${u}`,c(this.components))),muxers:(e.streamMuxers??[]).map((c,u)=>this.configureComponent(`stream-muxers-${u}`,c(this.components))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),this.configureComponent("transportManager",new kg(this.components,e.transportManager)),this.configureComponent("connectionManager",new Rg(this.components,e.connectionManager)),this.configureComponent("registrar",new Ug(this.components)),this.configureComponent("addressManager",new ig(this.components,e.addresses));let s=Ka.generateOptions();this.keychain=this.configureComponent("keyChain",new Ka(this.components,{...s,...e.keychain}));let i=(e.peerRouters??[]).map((c,u)=>this.configureComponent(`peer-router-${u}`,c(this.components)));this.peerRouting=this.components.peerRouting=this.configureComponent("peerRouting",new Og(this.components,{routers:i}));let a=(e.contentRouters??[]).map((c,u)=>this.configureComponent(`content-router-${u}`,c(this.components)));if(this.contentRouting=this.components.contentRouting=this.configureComponent("contentRouting",new Ng(this.components,{routers:a})),(e.peerDiscovery??[]).forEach((c,u)=>{this.configureComponent(`peer-discovery-${u}`,c(this.components)).addEventListener("peer",h=>{this.#t(h)})}),e.transports.forEach((c,u)=>{this.components.transportManager.add(this.configureComponent(`transport-${u}`,c(this.components)))}),e.services!=null)for(let c of Object.keys(e.services)){let u=e.services[c],l=u(this.components);if(l==null){en.error("service factory %s returned null or undefined instance",c);continue}this.services[c]=l,this.configureComponent(c,l),l[gx]!=null&&(en("registering service %s for content routing",c),a.push(l[gx])),l[xx]!=null&&(en("registering service %s for peer routing",c),i.push(l[xx])),l[wx]!=null&&(en("registering service %s for peer discovery",c),l[wx].addEventListener("peer",h=>{this.#t(h)}))}}configureComponent(e,r){return r==null&&en.error("component %s was null or undefined",e),this.components[e]=r,r}async start(){if(this.#e)return;this.#e=!0,en("libp2p is starting"),(await this.keychain.listKeys()).find(r=>r.name==="self")==null&&(en("importing self key into keychain"),await this.keychain.importPeer("self",this.components.peerId));try{await this.components.beforeStart?.(),await this.components.start(),await this.components.afterStart?.(),this.safeDispatchEvent("start",{detail:this}),en("libp2p has started")}catch(r){throw en.error("An error occurred starting libp2p",r),await this.stop(),r}}async stop(){!this.#e||(en("libp2p is stopping"),this.#e=!1,await this.components.beforeStop?.(),await this.components.stop(),await this.components.afterStop?.(),this.safeDispatchEvent("stop",{detail:this}),en("libp2p has stopped"))}isStarted(){return this.#e}getConnections(e){return this.components.connectionManager.getConnections(e)}getDialQueue(){return this.components.connectionManager.getDialQueue()}getPeers(){let e=new uo;for(let r of this.components.connectionManager.getConnections())e.add(r.remotePeer);return Array.from(e)}async dial(e,r={}){return this.components.connectionManager.openConnection(e,r)}async dialProtocol(e,r,n={}){if(r==null)throw new C("no protocols were provided to open a stream",$.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(r=Array.isArray(r)?r:[r],r.length===0)throw new C("no protocols were provided to open a stream",$.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this.dial(e,n)).newStream(r,n)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(e,r={}){Od(e)&&(e=_r(e.getPeerId()??"")),await this.components.connectionManager.closeConnections(e,r)}async getPublicKey(e,r={}){if(en("getPublicKey %p",e),e.publicKey!=null)return e.publicKey;let n=await this.peerStore.get(e);if(n.id.publicKey!=null)return n.id.publicKey;let o=fo([Nr("/pk/"),e.multihash.digest]),s=await this.contentRouting.get(o,r);return Fa(s),await this.peerStore.patch(e,{publicKey:s}),s}async handle(e,r,n){Array.isArray(e)||(e=[e]),await Promise.all(e.map(async o=>{await this.components.registrar.handle(o,r,n)}))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map(async r=>{await this.components.registrar.unhandle(r)}))}async register(e,r){return this.components.registrar.register(e,r)}unregister(e){this.components.registrar.unregister(e)}#t(e){let{detail:r}=e;if(r.id.toString()===this.peerId.toString()){en.error(new Error($.ERR_DISCOVERED_SELF));return}this.components.peerStore.merge(r.id,{multiaddrs:r.multiaddrs,protocols:r.protocols}).catch(n=>{en.error(n)})}};async function tk(t){if(t.peerId==null){let e=t.datastore;if(e!=null)try{let r=new Ka({datastore:e},Di(Ka.generateOptions(),t.keychain));t.peerId=await r.exportPeerId("self")}catch(r){if(r.code!=="ERR_NOT_FOUND")throw r}}return t.peerId==null&&(t.peerId=await UL()),new lA(lO(t))}async function RFe(t){let e=await tk(t);return t.start!==!1&&await e.start(),e}var bk=J(li(),1);var Gg=class extends Error{code;constructor(e,r){super(e),this.code=r}},fA=class extends Gg{type;constructor(e){super(e,"ABORT_ERR"),this.type="aborted"}};function rk(t){let e=Je();t.sink(e).catch(s=>{e.end(s)}),t.sink=async s=>{for await(let i of s)e.push(i);e.end()};let r=t.source;t.source[Symbol.iterator]!=null?r=t.source[Symbol.iterator]():t.source[Symbol.asyncIterator]!=null&&(r=t.source[Symbol.asyncIterator]());let n=new ue;return{read:async(s,i)=>{i?.signal?.throwIfAborted();let a,c=new Promise((u,l)=>{a=()=>{l(new fA("Read aborted"))},i?.signal?.addEventListener("abort",a)});try{if(s==null){let{done:l,value:h}=await Promise.race([r.next(),c]);return l===!0?new ue:h}for(;n.byteLength<s;){let{value:l,done:h}=await Promise.race([r.next(),c]);if(h===!0)throw new Gg("unexpected end of input","ERR_UNEXPECTED_EOF");n.append(l)}let u=n.sublist(0,s);return n.consume(s),u}finally{a!=null&&i?.signal?.removeEventListener("abort",a)}},write:async(s,i)=>{i?.signal?.throwIfAborted(),s instanceof Uint8Array?e.push(s):e.push(s.subarray()),await e.onEmpty(i)},unwrap:()=>{let s=t.source;return t.source=async function*(){yield*n,yield*s}(),t}}}var Wg=class extends Error{code;constructor(e,r){super(e),this.code=r}},nk=t=>te(t);nk.bytes=0;function op(t,e){let r=rk(t);return{read:async o=>{let s=-1,i=new ue,a=e?.lengthDecoder??nk;for(;;){i.append(await r.read(1,o));try{s=a(i)}catch(c){if(c instanceof RangeError)continue;throw c}if(s>-1)break;if(e?.maxLengthLength!=null&&i.byteLength>e.maxLengthLength)throw new Wg("message length length too long","ERR_MSG_LENGTH_TOO_LONG")}if(e?.maxDataLength!=null&&s>e.maxDataLength)throw new Wg("message length too long","ERR_MSG_DATA_TOO_LONG");return r.read(s,o)},write:async(o,s)=>{await r.write(Fs.single(o,e),s)},unwrap:()=>r.unwrap()}}function Sr(t,e){let r=op(t,e),n={read:async(o,s)=>{let i=await r.read(s);return o.decode(i)},write:async(o,s,i)=>{await r.write(s.encode(o),i)},pb:o=>({read:async s=>n.read(o,s),write:async(s,i)=>n.write(s,o,i),unwrap:()=>n}),unwrap:()=>r.unwrap()};return n}var jg="/libp2p/relay";var ok="circuit-relay-source",sk="circuit-relay-relay";var Yg=BigInt(131072),Ko="/libp2p/circuit/relay/0.2.0/hop",sp="/libp2p/circuit/relay/0.2.0/stop",ik=30*1e3,ak=30*1e3;var ke;(function(t){let e;(function(o){o.RESERVE="RESERVE",o.CONNECT="CONNECT",o.STATUS="STATUS"})(e=t.Type||(t.Type={}));let r;(function(o){o[o.RESERVE=0]="RESERVE",o[o.CONNECT=1]="CONNECT",o[o.STATUS=2]="STATUS"})(r||(r={})),function(o){o.codec=()=>so(r)}(e=t.Type||(t.Type={}));let n;t.codec=()=>(n==null&&(n=Te((o,s,i={})=>{i.lengthDelimited!==!1&&s.fork(),o.type!=null&&(s.uint32(8),t.Type.codec().encode(o.type,s)),o.peer!=null&&(s.uint32(18),Kl.codec().encode(o.peer,s)),o.reservation!=null&&(s.uint32(26),Qg.codec().encode(o.reservation,s)),o.limit!=null&&(s.uint32(34),ql.codec().encode(o.limit,s)),o.status!=null&&(s.uint32(40),ge.codec().encode(o.status,s)),i.lengthDelimited!==!1&&s.ldelim()},(o,s)=>{let i={},a=s==null?o.len:o.pos+s;for(;o.pos<a;){let c=o.uint32();switch(c>>>3){case 1:i.type=t.Type.codec().decode(o);break;case 2:i.peer=Kl.codec().decode(o,o.uint32());break;case 3:i.reservation=Qg.codec().decode(o,o.uint32());break;case 4:i.limit=ql.codec().decode(o,o.uint32());break;case 5:i.status=ge.codec().decode(o);break;default:o.skipType(c&7);break}}return i})),n),t.encode=o=>Ce(o,t.codec()),t.decode=o=>Ae(o,t.codec())})(ke||(ke={}));var Tn;(function(t){let e;(function(o){o.CONNECT="CONNECT",o.STATUS="STATUS"})(e=t.Type||(t.Type={}));let r;(function(o){o[o.CONNECT=0]="CONNECT",o[o.STATUS=1]="STATUS"})(r||(r={})),function(o){o.codec=()=>so(r)}(e=t.Type||(t.Type={}));let n;t.codec=()=>(n==null&&(n=Te((o,s,i={})=>{i.lengthDelimited!==!1&&s.fork(),o.type!=null&&(s.uint32(8),t.Type.codec().encode(o.type,s)),o.peer!=null&&(s.uint32(18),Kl.codec().encode(o.peer,s)),o.limit!=null&&(s.uint32(26),ql.codec().encode(o.limit,s)),o.status!=null&&(s.uint32(32),ge.codec().encode(o.status,s)),i.lengthDelimited!==!1&&s.ldelim()},(o,s)=>{let i={},a=s==null?o.len:o.pos+s;for(;o.pos<a;){let c=o.uint32();switch(c>>>3){case 1:i.type=t.Type.codec().decode(o);break;case 2:i.peer=Kl.codec().decode(o,o.uint32());break;case 3:i.limit=ql.codec().decode(o,o.uint32());break;case 4:i.status=ge.codec().decode(o);break;default:o.skipType(c&7);break}}return i})),n),t.encode=o=>Ce(o,t.codec()),t.decode=o=>Ae(o,t.codec())})(Tn||(Tn={}));var Kl;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{if(o.lengthDelimited!==!1&&n.fork(),r.id!=null&&r.id.byteLength>0&&(n.uint32(10),n.bytes(r.id)),r.addrs!=null)for(let s of r.addrs)n.uint32(18),n.bytes(s);o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={id:new Uint8Array(0),addrs:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.id=r.bytes();break;case 2:o.addrs.push(r.bytes());break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(Kl||(Kl={}));var Qg;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{if(o.lengthDelimited!==!1&&n.fork(),r.expire!=null&&r.expire!==0n&&(n.uint32(8),n.uint64(r.expire)),r.addrs!=null)for(let s of r.addrs)n.uint32(18),n.bytes(s);r.voucher!=null&&(n.uint32(26),n.bytes(r.voucher)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={expire:0n,addrs:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.expire=r.uint64();break;case 2:o.addrs.push(r.bytes());break;case 3:o.voucher=r.bytes();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(Qg||(Qg={}));var ql;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.duration!=null&&(n.uint32(8),n.uint32(r.duration)),r.data!=null&&(n.uint32(16),n.uint64(r.data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.duration=r.uint32();break;case 2:o.data=r.uint64();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(ql||(ql={}));var ge;(function(t){t.UNUSED="UNUSED",t.OK="OK",t.RESERVATION_REFUSED="RESERVATION_REFUSED",t.RESOURCE_LIMIT_EXCEEDED="RESOURCE_LIMIT_EXCEEDED",t.PERMISSION_DENIED="PERMISSION_DENIED",t.CONNECTION_FAILED="CONNECTION_FAILED",t.NO_RESERVATION="NO_RESERVATION",t.MALFORMED_MESSAGE="MALFORMED_MESSAGE",t.UNEXPECTED_MESSAGE="UNEXPECTED_MESSAGE"})(ge||(ge={}));var hA;(function(t){t[t.UNUSED=0]="UNUSED",t[t.OK=100]="OK",t[t.RESERVATION_REFUSED=200]="RESERVATION_REFUSED",t[t.RESOURCE_LIMIT_EXCEEDED=201]="RESOURCE_LIMIT_EXCEEDED",t[t.PERMISSION_DENIED=202]="PERMISSION_DENIED",t[t.CONNECTION_FAILED=203]="CONNECTION_FAILED",t[t.NO_RESERVATION=204]="NO_RESERVATION",t[t.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE",t[t.UNEXPECTED_MESSAGE=401]="UNEXPECTED_MESSAGE"})(hA||(hA={}));(function(t){t.codec=()=>so(hA)})(ge||(ge={}));var Xg;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.relay!=null&&r.relay.byteLength>0&&(n.uint32(10),n.bytes(r.relay)),r.peer!=null&&r.peer.byteLength>0&&(n.uint32(18),n.bytes(r.peer)),r.expiration!=null&&r.expiration!==0n&&(n.uint32(24),n.uint64(r.expiration)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={relay:new Uint8Array(0),peer:new Uint8Array(0),expiration:0n},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.relay=r.bytes();break;case 2:o.peer=r.bytes();break;case 3:o.expiration=r.uint64();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(Xg||(Xg={}));var dA=fe("libp2p:circuit-relay:utils");async function*ck(t,e){for await(let r of t){let n=BigInt(r.byteLength);if(e.remaining-n<0){let o=Number(e.remaining);e.remaining=0n;try{o!==0&&(yield r.subarray(0,o))}catch(s){dA.error(s)}throw new Error("data limit exceeded")}e.remaining-=n,yield r}}var Xce=(t,e,r,n)=>{function o(h){t.abort(h),e.abort(h),clearTimeout(a)}let s=new AbortController,i=Zi([r,s.signal]),a=setTimeout(()=>{s.abort()},n.duration),c=!1,u=!1,l={remaining:n.data};queueMicrotask(()=>{let h=()=>{e.abort(new C("duration limit exceeded",$.ERR_TIMEOUT))};i.addEventListener("abort",h,{once:!0}),e.sink(ck(t.source,l)).catch(p=>{dA.error("error while relaying streams src -> dst",p),o(p)}).finally(()=>{c=!0,u&&(i.removeEventListener("abort",h),i.clear(),clearTimeout(a))})}),queueMicrotask(()=>{let h=()=>{t.abort(new C("duration limit exceeded",$.ERR_TIMEOUT))};i.addEventListener("abort",h,{once:!0}),t.sink(ck(e.source,l)).catch(p=>{dA.error("error while relaying streams dst -> src",p),o(p)}).finally(()=>{u=!0,c&&(i.removeEventListener("abort",h),i.clear(),clearTimeout(a))})})};function uk(t,e,r,n){let o=n?.data??BigInt(Yg),s=n?.duration??12e4;Xce(t,e,r,{data:o,duration:s})}async function Jg(t){let e=new TextEncoder().encode(t),r=await Ga.digest(e);return Ue.createV0(r)}function mA(t){let e=t*BigInt(1e3),r=new Date().getTime();return Number(e-BigInt(r))}var gk=J(pk(),1);var Zce=Object.prototype.toString,eue=t=>Zce.call(t)==="[object Error]",tue=new Set(["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed"]);function gA(t){return t&&eue(t)&&t.name==="TypeError"&&typeof t.message=="string"?t.message==="Load failed"?t.stack===void 0:tue.has(t.message):!1}var yA=class extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},mk=(t,e,r)=>{let n=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=n,t};async function bA(t,e){return new Promise((r,n)=>{e={onFailedAttempt(){},retries:10,...e};let o=gk.default.operation(e),s=()=>{o.stop(),n(e.signal?.reason)};e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",s,{once:!0});let i=()=>{e.signal?.removeEventListener("abort",s),o.stop()};o.attempt(async a=>{try{let c=await t(a);i(),r(c)}catch(c){try{if(!(c instanceof Error))throw new TypeError(`Non-error was thrown: "${c}". You should only throw errors.`);if(c instanceof yA)throw c.originalError;if(c instanceof TypeError&&!gA(c))throw c;if(await e.onFailedAttempt(mk(c,a,e)),!o.retry(c))throw o.mainError()}catch(u){mk(u,a,e),i(),n(u)}}})})}var wA=fe("libp2p:circuit-relay:advert-service"),Zg=class extends mr{contentRouting;timeout;started;bootDelay;constructor(e,r){super(),this.contentRouting=e.contentRouting,this.bootDelay=r?.bootDelay??ak,this.started=!1}isStarted(){return this.started}start(){this.started||(this.timeout=setTimeout(()=>{this._advertiseService().catch(e=>{wA.error("could not advertise service",e)})},this.bootDelay),this.started=!0)}stop(){try{clearTimeout(this.timeout)}catch{}this.started=!1}async _advertiseService(){await bA(async()=>{try{let e=await Jg(jg);await this.contentRouting.provide(e),this.safeDispatchEvent("advert:success",{detail:void 0})}catch(e){if(this.safeDispatchEvent("advert:error",{detail:e}),e.code===$.ERR_NO_ROUTERS_AVAILABLE){wA.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop();return}throw wA.error("could not advertise service",e),e}})}};var ey=class{reservations=new br;_started=!1;interval;maxReservations;reservationClearInterval;applyDefaultLimit;reservationTtl;defaultDurationLimit;defaultDataLimit;constructor(e={}){this.maxReservations=e.maxReservations??15,this.reservationClearInterval=e.reservationClearInterval??3e5,this.applyDefaultLimit=e.applyDefaultLimit!==!1,this.reservationTtl=e.reservationTtl??72e5,this.defaultDurationLimit=e.defaultDurationLimit??12e4,this.defaultDataLimit=e.defaultDataLimit??Yg}isStarted(){return this._started}start(){this._started||(this._started=!0,this.interval=setInterval(()=>{let e=new Date().getTime();this.reservations.forEach((r,n)=>{r.expire.getTime()<e&&this.reservations.delete(n)})},this.reservationClearInterval))}stop(){clearInterval(this.interval)}reserve(e,r,n){if(this.reservations.size>=this.maxReservations&&!this.reservations.has(e))return{status:ge.RESERVATION_REFUSED};let o=new Date(Date.now()+this.reservationTtl),s;return this.applyDefaultLimit&&(s=n??{data:this.defaultDataLimit,duration:this.defaultDurationLimit}),this.reservations.set(e,{addr:r,expire:o,limit:s}),{status:ge.OK,expire:Math.round(o.getTime()/1e3)}}removeReservation(e){this.reservations.delete(e)}hasReservation(e){return this.reservations.has(e)}get(e){return this.reservations.get(e)}};var Hl=class{domain="libp2p-relay-rsvp";codec=new Uint8Array([3,2]);relay;peer;expiration;constructor({relay:e,peer:r,expiration:n}){this.relay=e,this.peer=r,this.expiration=n}marshal(){return Xg.encode({relay:this.relay.toBytes(),peer:this.peer.toBytes(),expiration:BigInt(this.expiration)})}equals(e){return!(!(e instanceof Hl)||!this.peer.equals(e.peer)||!this.relay.equals(e.relay)||this.expiration!==e.expiration)}};var ot=fe("libp2p:circuit-relay:server"),yk=t=>t.protoCodes().includes(290),sue={maxOutboundStopStreams:Us},xA=class extends mr{registrar;peerStore;addressManager;peerId;connectionManager;connectionGater;reservationStore;advertService;started;hopTimeout;shutdownController;maxInboundHopStreams;maxOutboundHopStreams;maxOutboundStopStreams;constructor(e,r={}){super(),this.registrar=e.registrar,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.peerId=e.peerId,this.connectionManager=e.connectionManager,this.connectionGater=e.connectionGater,this.started=!1,this.hopTimeout=r?.hopTimeout??ik,this.shutdownController=new AbortController,this.maxInboundHopStreams=r.maxInboundHopStreams,this.maxOutboundHopStreams=r.maxOutboundHopStreams,this.maxOutboundStopStreams=r.maxOutboundStopStreams??sue.maxOutboundStopStreams;try{(0,bk.setMaxListeners)?.(1/0,this.shutdownController.signal)}catch{}r.advertise!=null&&r.advertise!==!1&&(this.advertService=new Zg(e,r.advertise===!0?void 0:r.advertise),this.advertService.addEventListener("advert:success",()=>{this.safeDispatchEvent("relay:advert:success",{})}),this.advertService.addEventListener("advert:error",n=>{this.safeDispatchEvent("relay:advert:error",{detail:n.detail})})),this.reservationStore=new ey(r.reservations)}isStarted(){return this.started}async start(){this.started||(this.advertService?.start(),await this.registrar.handle(Ko,e=>{this.onHop(e).catch(r=>{ot.error(r)})},{maxInboundStreams:this.maxInboundHopStreams,maxOutboundStreams:this.maxOutboundHopStreams,runOnTransientConnection:!0}),this.reservationStore.start(),this.started=!0)}async stop(){this.advertService?.stop(),this.reservationStore.stop(),this.shutdownController.abort(),await this.registrar.unhandle(Ko),this.started=!1}async onHop({connection:e,stream:r}){ot("received circuit v2 hop protocol stream from %p",e.remotePeer);let n=ze(),o=setTimeout(()=>{n.reject("timed out")},this.hopTimeout),s=Sr(r);try{let i=await Promise.race([s.pb(ke).read(),n.promise]);if(i?.type==null)throw new Error("request was invalid, could not read from stream");ot("received",i.type),await Promise.race([this.handleHopProtocol({connection:e,stream:s,request:i}),n.promise])}catch(i){ot.error("error while handling hop",i),await s.pb(ke).write({type:ke.Type.STATUS,status:ge.MALFORMED_MESSAGE}),r.abort(i)}finally{clearTimeout(o)}}async handleHopProtocol({stream:e,request:r,connection:n}){switch(ot("received hop message"),r.type){case ke.Type.RESERVE:await this.handleReserve({stream:e,request:r,connection:n});break;case ke.Type.CONNECT:await this.handleConnect({stream:e,request:r,connection:n});break;default:ot.error("invalid hop request type %s via peer %p",r.type,n.remotePeer),await e.pb(ke).write({type:ke.Type.STATUS,status:ge.UNEXPECTED_MESSAGE})}}async handleReserve({stream:e,request:r,connection:n}){let o=e.pb(ke);if(ot("hop reserve request from %p",n.remotePeer),yk(n.remoteAddr)){ot.error("relay reservation over circuit connection denied for peer: %p",n.remotePeer),await o.write({type:ke.Type.STATUS,status:ge.PERMISSION_DENIED});return}if(await this.connectionGater.denyInboundRelayReservation?.(n.remotePeer)===!0){ot.error("reservation for %p denied by connection gater",n.remotePeer),await o.write({type:ke.Type.STATUS,status:ge.PERMISSION_DENIED});return}let s=this.reservationStore.reserve(n.remotePeer,n.remoteAddr);if(s.status!==ge.OK){await o.write({type:ke.Type.STATUS,status:s.status});return}try{if(s.expire!=null){let i=s.expire*1e3-Date.now();await this.peerStore.merge(n.remotePeer,{tags:{[ok]:{value:1,ttl:i}}})}await o.write({type:ke.Type.STATUS,status:ge.OK,reservation:await this.makeReservation(n.remotePeer,BigInt(s.expire??0)),limit:this.reservationStore.get(n.remotePeer)?.limit}),ot("sent confirmation response to %s",n.remotePeer)}catch(i){ot.error("failed to send confirmation response to %p",n.remotePeer,i),this.reservationStore.removeReservation(n.remotePeer)}}async makeReservation(e,r){let n=[];for(let s of this.addressManager.getAddresses())s.toString().includes("/p2p-circuit")||n.push(s.bytes);let o=await Dr.seal(new Hl({peer:e,relay:this.peerId,expiration:Number(r)}),this.peerId);return{addrs:n,expire:r,voucher:o.marshal()}}async handleConnect({stream:e,request:r,connection:n}){let o=e.pb(ke);if(yk(n.remoteAddr)){ot.error("relay reservation over circuit connection denied for peer: %p",n.remotePeer),await o.write({type:ke.Type.STATUS,status:ge.PERMISSION_DENIED});return}ot("hop connect request from %p",n.remotePeer);let s;try{if(r.peer==null)throw ot.error("no peer info in hop connect request"),new Error("no peer info in request");r.peer.addrs.forEach(Pe),s=od(r.peer.id)}catch(h){ot.error("invalid hop connect request via peer %p %s",n.remotePeer,h),await o.write({type:ke.Type.STATUS,status:ge.MALFORMED_MESSAGE});return}if(!this.reservationStore.hasReservation(s)){ot.error("hop connect denied for destination peer %p not having a reservation for %p with status %s",s,n.remotePeer,ge.NO_RESERVATION),await o.write({type:ke.Type.STATUS,status:ge.NO_RESERVATION});return}if(await this.connectionGater.denyOutboundRelayedConnection?.(n.remotePeer,s)===!0){ot.error("hop connect for %p to %p denied by connection gater",n.remotePeer,s),await o.write({type:ke.Type.STATUS,status:ge.PERMISSION_DENIED});return}let i=this.connectionManager.getConnections(s);if(i.length===0){ot("hop connect denied for destination peer %p not having a connection for %p as there is no destination connection",s,n.remotePeer),await o.write({type:ke.Type.STATUS,status:ge.NO_RESERVATION});return}let a=i[0],c=await this.stopHop({connection:a,request:{type:Tn.Type.CONNECT,peer:{id:n.remotePeer.toBytes(),addrs:[]}}});if(c==null){ot.error("failed to open stream to destination peer %p",a?.remotePeer),await o.write({type:ke.Type.STATUS,status:ge.CONNECTION_FAILED});return}await o.write({type:ke.Type.STATUS,status:ge.OK});let u=e.unwrap();ot("connection from %p to %p established - merging streams",n.remotePeer,s);let l=this.reservationStore.get(s)?.limit;uk(u,c,this.shutdownController.signal,l)}async stopHop({connection:e,request:r}){ot("starting circuit relay v2 stop request to %s",e.remotePeer);let n=await e.newStream([sp],{maxOutboundStreams:this.maxOutboundStopStreams,runOnTransientConnection:!0}),o=Sr(n),s=o.pb(Tn);await s.write(r);let i;try{i=await s.read()}catch{ot.error("error parsing stop message response from %p",e.remotePeer)}if(i==null){ot.error("could not read response from %p",e.remotePeer),await n.close();return}if(i.status===ge.OK)return ot("stop request to %p was successful",e.remotePeer),o.unwrap();ot("stop request failed with code %d",i.status),await n.close()}get reservations(){return this.reservationStore.reservations}};function iue(t={}){return e=>new xA(e,t)}var _n=J(ao(),1);function aue(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var cue=aue,uue=cue,wk=uue;var BVe=new Uint8Array(0);var xk=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var vA=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},SA=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ek(this,e)}},AA=class{constructor(e){this.decoders=e}or(e){return Ek(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ek=(t,e)=>new AA({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),CA=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new vA(e,r,n),this.decoder=new SA(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},vk=({name:t,prefix:e,encode:r,decode:n})=>new CA(t,e,r,n),TA=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=wk(r,e);return vk({prefix:t,name:e,encode:n,decode:s=>xk(o(s))})},lue=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},fue=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Kr=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>vk({prefix:e,name:t,encode(o){return fue(o,n,r)},decode(o){return lue(o,n,r,t)}});var Sk=Kr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),MVe=Kr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),FVe=Kr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),VVe=Kr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zVe=Kr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$Ve=Kr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),KVe=Kr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),qVe=Kr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),HVe=Kr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ak=TA({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jVe=TA({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ck=Kr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),XVe=Kr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),JVe=Kr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ZVe=Kr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});_n.default.formatters.b=t=>t==null?"undefined":Ak.baseEncode(t);_n.default.formatters.t=t=>t==null?"undefined":Sk.baseEncode(t);_n.default.formatters.m=t=>t==null?"undefined":Ck.baseEncode(t);_n.default.formatters.p=t=>t==null?"undefined":t.toString();_n.default.formatters.c=t=>t==null?"undefined":t.toString();_n.default.formatters.k=t=>t==null?"undefined":t.toString();_n.default.formatters.a=t=>t==null?"undefined":t.toString();function hue(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function Tk(t){let e=hue(`${t}:trace`);return _n.default.enabled(`${t}:trace`)&&_n.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,_n.default)(`${t}:trace`)),Object.assign((0,_n.default)(t),{error:(0,_n.default)(`${t}:error`),trace:e})}var due=Tk("libp2p:stream:converter");function _A(t){let{stream:e,remoteAddr:r}=t,{sink:n,source:o}=e,s=async function*(){for await(let c of o)c instanceof Uint8Array?yield c:yield*c}(),i={async sink(c){try{await n(c),a()}catch(u){u.type!=="aborted"&&due(u)}},source:s,remoteAddr:r,timeline:{open:Date.now(),close:void 0},async close(c){a(),await e.close(c)},abort(c){a(),e.abort(c)}};function a(){i.timeline.close==null&&(i.timeline.close=Date.now())}return i}var BA={};T(BA,{base58btc:()=>tn,base58flickr:()=>wue});function pue(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var mue=pue,gue=mue,_k=gue;var cze=new Uint8Array(0);var Ik=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Vs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Dk=t=>new TextEncoder().encode(t),Rk=t=>new TextDecoder().decode(t);var IA=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},DA=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Bk(this,e)}},RA=class{constructor(e){this.decoders=e}or(e){return Bk(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Bk=(t,e)=>new RA({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),LA=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new IA(e,r,n),this.decoder=new DA(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Gl=({name:t,prefix:e,encode:r,decode:n})=>new LA(t,e,r,n),na=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=_k(r,e);return Gl({prefix:t,name:e,encode:n,decode:s=>Vs(o(s))})},yue=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},bue=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},_t=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Gl({prefix:e,name:t,encode(o){return bue(o,n,r)},decode(o){return yue(o,n,r,t)}});var tn=na({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),wue=na({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var PA={};T(PA,{base32:()=>zs,base32hex:()=>Sue,base32hexpad:()=>Cue,base32hexpadupper:()=>Tue,base32hexupper:()=>Aue,base32pad:()=>Eue,base32padupper:()=>vue,base32upper:()=>xue,base32z:()=>_ue});var zs=_t({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xue=_t({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Eue=_t({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),vue=_t({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Sue=_t({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Aue=_t({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Cue=_t({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Tue=_t({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_ue=_t({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Iue=Ok,Pk=128,Due=127,Rue=~Due,Lue=Math.pow(2,31);function Ok(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Lue;)e[r++]=t&255|Pk,t/=128;for(;t&Rue;)e[r++]=t&255|Pk,t>>>=7;return e[r]=t|0,Ok.bytes=r-n+1,e}var Bue=NA,Pue=128,Nk=127;function NA(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw NA.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&Nk)<<o:(i&Nk)*Math.pow(2,o),o+=7}while(i>=Pue);return NA.bytes=s-n,r}var Nue=Math.pow(2,7),Oue=Math.pow(2,14),Uue=Math.pow(2,21),kue=Math.pow(2,28),Mue=Math.pow(2,35),Fue=Math.pow(2,42),Vue=Math.pow(2,49),zue=Math.pow(2,56),$ue=Math.pow(2,63),Kue=function(t){return t<Nue?1:t<Oue?2:t<Uue?3:t<kue?4:t<Mue?5:t<Fue?6:t<Vue?7:t<zue?8:t<$ue?9:10},que={encode:Iue,decode:Bue,encodingLength:Kue},Hue=que,ip=Hue;var ap=(t,e=0)=>[ip.decode(t,e),ip.decode.bytes],Wl=(t,e,r=0)=>(ip.encode(t,e,r),e),jl=t=>ip.encodingLength(t);var fc=(t,e)=>{let r=e.byteLength,n=jl(t),o=n+jl(r),s=new Uint8Array(o+r);return Wl(t,s,0),Wl(r,s,n),s.set(e,o),new Yl(t,r,e,s)},ry=t=>{let e=Vs(t),[r,n]=ap(e),[o,s]=ap(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Yl(r,o,i,e)},Uk=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Ik(t.bytes,r.bytes)}},Yl=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var kk=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Wue(r,OA(t),e||tn.encoder);default:return jue(r,OA(t),e||zs.encoder)}};var Mk=new WeakMap,OA=t=>{let e=Mk.get(t);if(e==null){let r=new Map;return Mk.set(t,r),r}return e},ut=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==cp)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Yue)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ut.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=fc(e,r);return ut.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ut.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Uk(e.multihash,n.multihash)}toString(e){return kk(this,e)}toJSON(){return{"/":kk(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof ut)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new ut(n,o,s,i||Fk(n,o,s.bytes))}else if(r[Que]===!0){let{version:n,multihash:o,code:s}=r,i=ry(o);return ut.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==cp)throw new Error(`Version 0 CID must use dag-pb (code: ${cp}) block encoding`);return new ut(e,r,n,n.bytes)}case 1:{let o=Fk(e,r,n.bytes);return new ut(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return ut.create(0,cp,e)}static createV1(e,r){return ut.create(1,e,r)}static decode(e){let[r,n]=ut.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=ut.inspectBytes(e),n=r.size-r.multihashSize,o=Vs(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new Yl(r.multihashCode,r.digestSize,s,o);return[r.version===0?ut.createV0(i):ut.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=ap(e.subarray(r));return r+=p,h},o=n(),s=cp;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=Gue(e,r),s=ut.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return OA(s).set(n,e),s}},Gue=(t,e)=>{switch(t[0]){case"Q":{let r=e||tn;return[tn.prefix,r.decode(`${tn.prefix}${t}`)]}case tn.prefix:{let r=e||tn;return[tn.prefix,r.decode(t)]}case zs.prefix:{let r=e||zs;return[zs.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Wue=(t,e,r)=>{let{prefix:n}=r;if(n!==tn.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},jue=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},cp=112,Yue=18,Fk=(t,e,r)=>{let n=jl(t),o=n+jl(e),s=new Uint8Array(o+r.byteLength);return Wl(t,s,0),Wl(e,s,n),s.set(r,o),s},Que=Symbol.for("@ipld/js-cid/CID");function Vk(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var UA={};T(UA,{base10:()=>Xue});var Xue=na({prefix:"9",name:"base10",alphabet:"0123456789"});var kA={};T(kA,{base16:()=>Jue,base16upper:()=>Zue});var Jue=_t({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Zue=_t({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var MA={};T(MA,{base2:()=>ele});var ele=_t({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var FA={};T(FA,{base256emoji:()=>sle});var zk=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),tle=zk.reduce((t,e,r)=>(t[r]=e,t),[]),rle=zk.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function nle(t){return t.reduce((e,r)=>(e+=tle[r],e),"")}function ole(t){let e=[];for(let r of t){let n=rle[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var sle=Gl({prefix:"\u{1F680}",name:"base256emoji",encode:nle,decode:ole});var VA={};T(VA,{base36:()=>ile,base36upper:()=>ale});var ile=na({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ale=na({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var zA={};T(zA,{base64:()=>cle,base64pad:()=>ule,base64url:()=>lle,base64urlpad:()=>fle});var cle=_t({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ule=_t({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),lle=_t({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),fle=_t({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $A={};T($A,{base8:()=>hle});var hle=_t({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var KA={};T(KA,{identity:()=>dle});var dle=Gl({prefix:"\0",name:"identity",encode:t=>Rk(t),decode:t=>Dk(t)});var Bze=new TextEncoder,Pze=new TextDecoder;var qA={};T(qA,{identity:()=>ble});var $k=0,gle="identity",Kk=Vs,yle=t=>fc($k,Kk(t)),ble={code:$k,name:gle,encode:Kk,digest:yle};var WA={};T(WA,{sha256:()=>wle,sha512:()=>xle});var GA=({name:t,code:e,encode:r})=>new HA(t,e,r),HA=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?fc(this.code,r):r.then(n=>fc(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Hk=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),wle=GA({name:"sha2-256",code:18,encode:Hk("SHA-256")}),xle=GA({name:"sha2-512",code:19,encode:Hk("SHA-512")});var up={...KA,...MA,...$A,...UA,...kA,...PA,...VA,...BA,...zA,...FA},zze={...WA,...qA};function Xl(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function ny(t=0){return globalThis.Buffer?.allocUnsafe!=null?Xl(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Wk(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Gk=Wk("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),jA=Wk("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=ny(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ele={utf8:Gk,"utf-8":Gk,hex:up.base16,latin1:jA,ascii:jA,binary:jA,...up},oy=Ele;function rn(t,e="utf8"){let r=oy[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function $s(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=ny(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return Xl(r)}function YA(t,e="utf8"){let r=oy[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Xl(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var jk=cr,vle=ur,QA=function(t){let e=0;if(t=t.toString().trim(),jk(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(vle(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let s=jk(r[n]),i;s&&(i=QA(r[n]),r[n]=rn(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,rn(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let o=new Uint8Array(e+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);o[e++]=s>>8&255,o[e++]=s&255}return o}throw new Error("invalid ip address")},Yk=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let o=[];for(let s=0;s<r;s++)o.push(t[e+s]);return o.join(".")}if(r===16){let o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(e+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Jl={},XA={},Ale=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Ale.forEach(t=>{let e=Cle(...t);XA[e.code]=e,Jl[e.name]=e});function Cle(t,e,r,n,o){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(o)}}function Ze(t){if(typeof t=="number"){if(XA[t]!=null)return XA[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(Jl[t]!=null)return Jl[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var g$e=Ze("ip4"),y$e=Ze("ip6"),b$e=Ze("ipcidr");function ZA(t,e){switch(Ze(t).code){case 4:case 41:return _le(e);case 42:return Jk(e);case 6:case 273:case 33:case 132:return eM(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Jk(e);case 421:return Lle(e);case 444:return Zk(e);case 445:return Zk(e);case 466:return Rle(e);default:return rn(e,"base16")}}function e8(t,e){switch(Ze(t).code){case 4:return Qk(e);case 41:return Qk(e);case 42:return Xk(e);case 6:case 273:case 33:case 132:return t8(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Xk(e);case 421:return Ile(e);case 444:return Ble(e);case 445:return Ple(e);case 466:return Dle(e);default:return YA(e,"base16")}}var JA=Object.values(up).map(t=>t.decoder),Tle=function(){let t=JA[0].or(JA[1]);return JA.slice(2).forEach(e=>t=t.or(e)),t}();function Qk(t){if(!xe(t))throw new Error("invalid ip address");return QA(t)}function _le(t){let e=Yk(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!xe(e))throw new Error("invalid ip address");return e}function t8(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function eM(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function Xk(t){let e=YA(t),r=Uint8Array.from(re(e.length));return $s([r,e],r.length+e.length)}function Jk(t){let e=te(t);if(t=t.slice(X(e)),t.length!==e)throw new Error("inconsistent lengths");return rn(t)}function Ile(t){let e;t[0]==="Q"||t[0]==="1"?e=ry(tn.decode(`z${t}`)).bytes:e=ut.parse(t).multihash.bytes;let r=Uint8Array.from(re(e.length));return $s([r,e],r.length+e.length)}function Dle(t){let e=Tle.decode(t),r=Uint8Array.from(re(e.length));return $s([r,e],r.length+e.length)}function Rle(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+rn(r,"base64url")}function Lle(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return rn(r,"base58btc")}function Ble(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=zs.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=t8(n);return $s([r,o],r.length+o.length)}function Ple(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=zs.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=t8(n);return $s([r,o],r.length+o.length)}function Zk(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=rn(e,"base32"),o=eM(r);return`${n}:${o}`}function tM(t){t=r8(t);let e=[],r=[],n=null,o=t.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=Ze(i);if(a.size===0){e.push([a.code]),r.push([a.code]);continue}if(s++,s>=o.length)throw nM("invalid address: "+t);if(a.path===!0){n=r8(o.slice(s).join("/")),e.push([a.code,e8(a.code,n)]),r.push([a.code,n]);break}let c=e8(a.code,o[s]);e.push([a.code,c]),r.push([a.code,ZA(a.code,c)])}return{string:rM(r),bytes:o8(e),tuples:e,stringTuples:r,path:n}}function n8(t){let e=[],r=[],n=null,o=0;for(;o<t.length;){let s=te(t,o),i=X(s),a=Ze(s),c=Nle(a,t.slice(o+i));if(c===0){e.push([s]),r.push([s]),o+=i;continue}let u=t.slice(o+i,o+i+c);if(o+=c+i,o>t.length)throw nM("Invalid address Uint8Array: "+rn(t,"base16"));e.push([s,u]);let l=ZA(s,u);if(r.push([s,l]),a.path===!0){n=l;break}}return{bytes:Uint8Array.from(t),string:rM(r),tuples:e,stringTuples:r,path:n}}function rM(t){let e=[];return t.map(r=>{let n=Ze(r[0]);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),r8(e.join("/"))}function o8(t){return $s(t.map(e=>{let r=Ze(e[0]),n=Uint8Array.from(re(r.code));return e.length>1&&e[1]!=null&&(n=$s([n,e[1]])),n}))}function Nle(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{let r=te(e instanceof Uint8Array?e:Uint8Array.from(e));return r+X(r)}}function r8(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function nM(t){return new Error("Error parsing address: "+t)}var Ole=Symbol.for("nodejs.util.inspect.custom"),Ule=[Ze("dns").code,Ze("dns4").code,Ze("dns6").code,Ze("dnsaddr").code],kle=new Map,oM=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Mle(t){return Boolean(t?.[oM])}var Ks=class{bytes;#e;#t;#r;#n;[oM]=!0;constructor(e){e==null&&(e="");let r;if(e instanceof Uint8Array)r=n8(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);r=tM(e)}else if(Mle(e))r=n8(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#e=r.string,this.#t=r.tuples,this.#r=r.stringTuples,this.#n=r.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,r,n,o,s="",i=Ze("tcp"),a=Ze("udp"),c=Ze("ip4"),u=Ze("ip6"),l=Ze("dns6"),h=Ze("ip6zone");for(let[m,f]of this.stringTuples())m===h.code&&(s=`%${f??""}`),Ule.includes(m)&&(r=i.name,o=443,n=`${f??""}${s}`,e=m===l.code?6:4),(m===i.code||m===a.code)&&(r=Ze(m).name,o=parseInt(f??"")),(m===c.code||m===u.code)&&(r=Ze(m).name,n=`${f??""}${s}`,e=m===u.code?6:4);if(e==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:o}}protos(){return this.#t.map(([e])=>Object.assign({},Ze(e)))}protoCodes(){return this.#t.map(([e])=>e)}protoNames(){return this.#t.map(([e])=>Ze(e).name)}tuples(){return this.#t}stringTuples(){return this.#r}encapsulate(e){return e=new Ks(e),new Ks(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Ks(n.slice(0,o))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Ks(o8(r.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach(([n,o])=>{n===Jl.p2p.code&&e.push([n,o]),n===Jl["p2p-circuit"].code&&(e=[])});let r=e.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?rn(tn.decode(`z${n}`),"base58btc"):rn(ut.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(e){return Vk(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=kle.get(r.name);if(n==null)throw new C(`no available resolver for ${r.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new Ks(s))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[Ole](){return`Multiaddr(${this.#e})`}};function sy(t){return new Ks(t)}var Fle=j("dns4"),Vle=j("dns6"),zle=j("dnsaddr"),wo=$t(j("dns"),zle,Fle,Vle),iy=$t(j("ip4"),j("ip6")),Zl=$t(ne(iy,j("tcp")),ne(wo,j("tcp"))),ay=ne(iy,j("udp")),$le=ne(ay,j("utp")),Kle=ne(ay,j("quic")),qle=ne(ay,j("quic-v1")),s8=$t(ne(Zl,j("ws")),ne(wo,j("ws"))),hc=$t(ne(s8,j("p2p")),s8),i8=$t(ne(Zl,j("wss")),ne(wo,j("wss")),ne(Zl,j("tls"),j("ws")),ne(wo,j("tls"),j("ws"))),qs=$t(ne(i8,j("p2p")),i8),a8=$t(ne(Zl,j("http")),ne(iy,j("http")),ne(wo,j("http"))),c8=$t(ne(Zl,j("https")),ne(iy,j("https")),ne(wo,j("https"))),sM=ne(ay,j("webrtc-direct"),j("certhash")),cM=$t(ne(sM,j("p2p")),sM),iM=ne(qle,j("webtransport"),j("certhash"),j("certhash")),uM=$t(ne(iM,j("p2p")),iM),lM=$t(ne(hc,j("p2p-webrtc-star"),j("p2p")),ne(qs,j("p2p-webrtc-star"),j("p2p")),ne(hc,j("p2p-webrtc-star")),ne(qs,j("p2p-webrtc-star"))),V$e=$t(ne(hc,j("p2p-websocket-star"),j("p2p")),ne(qs,j("p2p-websocket-star"),j("p2p")),ne(hc,j("p2p-websocket-star")),ne(qs,j("p2p-websocket-star"))),fM=$t(ne(a8,j("p2p-webrtc-direct"),j("p2p")),ne(c8,j("p2p-webrtc-direct"),j("p2p")),ne(a8,j("p2p-webrtc-direct")),ne(c8,j("p2p-webrtc-direct"))),dc=$t(s8,i8,a8,c8,lM,fM,Zl,$le,Kle,wo,cM,uM),z$e=$t(ne(dc,j("p2p-stardust"),j("p2p")),ne(dc,j("p2p-stardust"))),oa=$t(ne(dc,j("p2p")),lM,fM,cM,uM,j("p2p")),aM=$t(ne(oa,j("p2p-circuit"),oa),ne(oa,j("p2p-circuit")),ne(j("p2p-circuit"),oa),ne(dc,j("p2p-circuit")),ne(j("p2p-circuit"),dc),j("p2p-circuit")),hM=()=>$t(ne(aM,hM),aM),bo=hM(),$$e=$t(ne(bo,oa,bo),ne(oa,bo),ne(bo,oa),bo,oa);var K$e=$t(ne(bo,j("webrtc"),j("p2p")),ne(bo,j("webrtc")),ne(dc,j("webrtc"),j("p2p")),ne(dc,j("webrtc")),j("webrtc"));function dM(t){function e(r){let n;try{n=sy(r)}catch{return!1}let o=t(n.protoNames());return o===null?!1:o===!0||o===!1?o:o.length===0}return e}function ne(...t){function e(r){if(r.length<t.length)return null;let n=r;return t.some(o=>(n=typeof o=="function"?o().partialMatch(r):o.partialMatch(r),Array.isArray(n)&&(r=n),n===null)),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:dM(e),partialMatch:e}}function $t(...t){function e(n){let o=null;return t.some(s=>{let i=typeof s=="function"?s().partialMatch(n):s.partialMatch(n);return i!=null?(o=i,!0):!1}),o}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:dM(e),partialMatch:e}}function j(t){let e=t;function r(o){let s;try{s=sy(o)}catch{return!1}let i=s.protoNames();return i.length===1&&i[0]===e}function n(o){return o.length===0?null:o[0]===e?o.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:n}}var sa=fe("libp2p:circuit-relay:discover-relays"),cy=class extends mr{peerId;peerStore;contentRouting;registrar;started;topologyId;constructor(e){super(),this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.contentRouting=e.contentRouting,this.registrar=e.registrar}isStarted(){return this.started}async start(){this.topologyId=await this.registrar.register(Ko,{onConnect:e=>{this.safeDispatchEvent("relay:discover",{detail:e})}}),this.discover().catch(e=>{sa.error("error listening on relays",e)}),this.started=!0}stop(){this.topologyId!=null&&this.registrar.unregister(this.topologyId),this.started=!1}async discover(){sa("searching peer store for relays");let e=await this.peerStore.all({filters:[r=>r.protocols.includes(Ko)],orders:[()=>Math.random()<.5?1:-1]});for(let r of e)sa("found relay peer %p in content peer store",r.id),this.safeDispatchEvent("relay:discover",{detail:r.id});sa("found %d relay peers in peer store",e.length);try{sa("searching content routing for relays");let r=await Jg(jg),n=0;for await(let o of this.contentRouting.findProviders(r))if(o.multiaddrs.length>0&&!o.id.equals(this.peerId)){let s=o.id;n++,await this.peerStore.merge(s,{multiaddrs:o.multiaddrs}),sa("found relay peer %p in content routing",s),this.safeDispatchEvent("relay:discover",{detail:s})}sa("found %d relay peers in content routing",n)}catch(r){sa.error("failed when finding relays on the network",r)}}};var u8=fe("libp2p:circuit-relay:transport:listener"),l8=class extends mr{connectionManager;relayStore;listeningAddrs;constructor(e){super(),this.connectionManager=e.connectionManager,this.relayStore=e.relayStore,this.listeningAddrs=new br,this.relayStore.addEventListener("relay:removed",r=>{this.#e(r.detail)})}async listen(e){u8("listen on %a",e);let r=e.getPeerId(),n;if(r!=null){let s=_r(r),i=this.connectionManager.getConnectionsMap().get(s)??[];i.length>0&&(n=i[0])}if(n==null){let s=e.toString().split("/p2p-circuit").find(a=>a!==""),i=Pe(s);n=await this.connectionManager.openConnection(i)}if(!this.relayStore.hasReservation(n.remotePeer)){await this.relayStore.addRelay(n.remotePeer,"configured");return}let o=this.relayStore.getReservation(n.remotePeer);if(o==null)throw new C("Did not have reservation after making reservation","ERR_NO_RESERVATION");if(this.listeningAddrs.has(n.remotePeer)){u8("already listening on relay %p",n.remotePeer);return}this.listeningAddrs.set(n.remotePeer,o.addrs.map(s=>Pe(s).encapsulate("/p2p-circuit"))),this.safeDispatchEvent("listening",{})}getAddrs(){return[...this.listeningAddrs.values()].flat()}async close(){}#e(e){let r=this.listeningAddrs.has(e);u8("relay peer removed %p - had reservation",e,r),this.listeningAddrs.delete(e),r&&this.safeDispatchEvent("close",{})}};function mM(t){return new l8(t)}var qr=fe("libp2p:circuit-relay:transport:reservation-store"),Gle=60*1e3*10,Wle=60*1e3*5,jle=30*1e3,uy=class extends mr{peerId;connectionManager;transportManager;peerStore;events;reserveQueue;reservations;maxDiscoveredRelays;maxReservationQueueLength;reservationCompletionTimeout;started;constructor(e,r){super(),this.peerId=e.peerId,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.peerStore=e.peerStore,this.events=e.events,this.reservations=new br,this.maxDiscoveredRelays=r?.discoverRelays??0,this.maxReservationQueueLength=r?.maxReservationQueueLength??100,this.reservationCompletionTimeout=r?.reservationCompletionTimeout??1e4,this.started=!1,this.reserveQueue=new Pl({concurrency:r?.reservationConcurrency??1}),this.events.addEventListener("peer:disconnect",n=>{this.#t(n.detail)})}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.reserveQueue.clear(),this.reservations.forEach(({timeout:e})=>{clearTimeout(e)}),this.reservations.clear(),this.started=!1}async addRelay(e,r){if(this.peerId.equals(e)){qr("not trying to use self as relay");return}if(this.reserveQueue.size>this.maxReservationQueueLength){qr("not adding relay as the queue is full");return}if(this.reserveQueue.hasJob(e)){qr("relay peer is already in the reservation queue");return}qr("add relay %p",e),await this.reserveQueue.add(async()=>{try{let n=this.reservations.get(e);if(n!=null){if(mA(n.reservation.expire)>Gle){qr("already have reservation on relay peer %p and it expires in more than 10 minutes",e);return}clearTimeout(n.timeout),this.reservations.delete(e)}if(r==="discovered"&&[...this.reservations.values()].reduce((l,h)=>(h.type==="discovered"&&l++,l),0)>=this.maxDiscoveredRelays){qr("already have enough discovered relays");return}let o=AbortSignal.timeout(this.reservationCompletionTimeout),s=await this.connectionManager.openConnection(e,{signal:o});if(s.remoteAddr.protoNames().includes("p2p-circuit")){qr("not creating reservation over relayed connection");return}let i=await this.#e(s,{signal:o});qr("created reservation on relay peer %p",e);let a=mA(i.expire),c=Math.min(Math.max(a-Wle,jle),Math.pow(2,31)-1),u=setTimeout(()=>{this.addRelay(e,r).catch(l=>{qr.error("could not refresh reservation to relay %p",e,l)})},c);this.reservations.set(e,{timeout:u,reservation:i,type:r}),await this.peerStore.merge(e,{tags:{[sk]:{value:1,ttl:a}}}),await this.transportManager.listen([Pe(`/p2p/${e.toString()}/p2p-circuit`)])}catch(n){qr.error("could not reserve slot on %p",e,n);let o=this.reservations.get(e);o!=null&&clearTimeout(o.timeout),this.reservations.delete(e)}},{peerId:e})}hasReservation(e){return this.reservations.has(e)}getReservation(e){return this.reservations.get(e)?.reservation}async#e(e,r){r.signal?.throwIfAborted(),qr("requesting reservation from %p",e.remotePeer);let n=await e.newStream(Ko,r),s=Sr(n).pb(ke);await s.write({type:ke.Type.RESERVE},r);let i;try{i=await s.read(r)}catch(c){throw qr.error("error parsing reserve message response from %p because",e.remotePeer,c),c}finally{await n.close()}if(i.status===ge.OK&&i.reservation!=null)return i.reservation;let a=`reservation failed with status ${i.status??"undefined"}`;throw qr.error(a),new Error(a)}#t(e){let r=this.reservations.get(e);r!=null&&(qr("connection to relay %p closed, removing reservation from local store",e),clearTimeout(r.timeout),this.reservations.delete(e),this.safeDispatchEvent("relay:removed",{detail:e}),this.reservations.size<this.maxDiscoveredRelays&&(qr("not enough relays %d/%d",this.reservations.size,this.maxDiscoveredRelays),this.safeDispatchEvent("relay:not-enough-relays",{})))}};var Ur=fe("libp2p:circuit-relay:transport"),Yle=t=>{if(t.peer==null)return!1;try{t.peer.addrs.forEach(Pe)}catch{return!1}return!0},f8={maxInboundStopStreams:Us,maxOutboundStopStreams:Us,stopTimeout:3e4},h8=class{discovery;registrar;peerStore;connectionManager;peerId;upgrader;addressManager;connectionGater;reservationStore;maxInboundStopStreams;maxOutboundStopStreams;stopTimeout;started;constructor(e,r){this.registrar=e.registrar,this.peerStore=e.peerStore,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.upgrader=e.upgrader,this.addressManager=e.addressManager,this.connectionGater=e.connectionGater,this.maxInboundStopStreams=r.maxInboundStopStreams??f8.maxInboundStopStreams,this.maxOutboundStopStreams=r.maxOutboundStopStreams??f8.maxOutboundStopStreams,this.stopTimeout=r.stopTimeout??f8.stopTimeout,r.discoverRelays!=null&&r.discoverRelays>0&&(this.discovery=new cy(e),this.discovery.addEventListener("relay:discover",n=>{this.reservationStore.addRelay(n.detail,"discovered").catch(o=>{Ur.error("could not add discovered relay %p",n.detail,o)})})),this.reservationStore=new uy(e,r),this.reservationStore.addEventListener("relay:not-enough-relays",()=>{this.discovery?.discover().catch(n=>{Ur.error("could not discover relays",n)})}),this.started=!1}isStarted(){return this.started}async start(){await this.reservationStore.start(),await this.discovery?.start(),await this.registrar.handle(sp,e=>{this.onStop(e).catch(r=>{Ur.error("error while handling STOP protocol",r),e.stream.abort(r)})},{maxInboundStreams:this.maxInboundStopStreams,maxOutboundStreams:this.maxOutboundStopStreams,runOnTransientConnection:!0}),this.started=!0}async stop(){this.discovery?.stop(),await this.reservationStore.stop(),await this.registrar.unhandle(sp),this.started=!1}[Yi]=!0;[Symbol.toStringTag]="libp2p/circuit-relay-v2";async dial(e,r={}){if(e.protoCodes().filter(f=>f===290).length!==1){let f="Invalid circuit relay address";throw Ur.error(f,e),new C(f,$.ERR_RELAYED_DIAL)}let n=e.toString().split("/p2p-circuit"),o=Pe(n[0]),s=Pe(n[n.length-1]),i=o.getPeerId(),a=s.getPeerId();if(i==null||a==null){let f=`Circuit relay dial to ${e.toString()} failed as address did not have peer ids`;throw Ur.error(f),new C(f,$.ERR_RELAYED_DIAL)}let c=_r(i),u=_r(a),l=!1,p=this.connectionManager.getConnections(c)[0];p==null&&(await this.peerStore.merge(c,{multiaddrs:[o]}),p=await this.connectionManager.openConnection(c,r),l=!0);let m;try{return m=await p.newStream([Ko]),await this.connectV2({stream:m,connection:p,destinationPeer:u,destinationAddr:s,relayAddr:o,ma:e,disconnectOnFailure:l})}catch(f){throw Ur.error("circuit relay dial to destination %p via relay %p failed",u,c,f),m?.abort(f),l&&await p.close(),f}}async connectV2({stream:e,connection:r,destinationPeer:n,destinationAddr:o,relayAddr:s,ma:i,disconnectOnFailure:a}){try{let c=Sr(e),u=c.pb(ke);await u.write({type:ke.Type.CONNECT,peer:{id:n.toBytes(),addrs:[Pe(o).bytes]}});let l=await u.read();if(l.status!==ge.OK)throw new C(`failed to connect via relay with status ${l?.status?.toString()??"undefined"}`,$.ERR_HOP_REQUEST_FAILED);let h=_A({stream:c.unwrap(),remoteAddr:i,localAddr:s.encapsulate(`/p2p-circuit/p2p/${this.peerId.toString()}`)});return Ur("new outbound transient connection %a",h.remoteAddr),await this.upgrader.upgradeOutbound(h,{transient:!0})}catch(c){throw Ur.error(`Circuit relay dial to destination ${n.toString()} via relay ${r.remotePeer.toString()} failed`,c),a&&await r.close(),c}}createListener(e){return mM({connectionManager:this.connectionManager,relayStore:this.reservationStore})}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>bo.matches(r))}async onStop({connection:e,stream:r}){let n=AbortSignal.timeout(this.stopTimeout),o=Sr(r).pb(Tn),s=await o.read({signal:n});if(Ur("new circuit relay v2 stop stream from %p with type %s",e.remotePeer,s.type),s?.type===void 0){Ur.error("type was missing from circuit v2 stop protocol request from %s",e.remotePeer),await o.write({type:Tn.Type.STATUS,status:ge.MALFORMED_MESSAGE},{signal:n}),await r.close();return}if(s.type!==Tn.Type.CONNECT){Ur.error("invalid stop connect request via peer %p",e.remotePeer),await o.write({type:Tn.Type.STATUS,status:ge.UNEXPECTED_MESSAGE},{signal:n}),await r.close();return}if(!Yle(s)){Ur.error("invalid stop connect request via peer %p",e.remotePeer),await o.write({type:Tn.Type.STATUS,status:ge.MALFORMED_MESSAGE},{signal:n}),await r.close();return}let i=od(s.peer.id);if(await this.connectionGater.denyInboundRelayedConnection?.(e.remotePeer,i)===!0){Ur.error("connection gater denied inbound relayed connection from %p",e.remotePeer),await o.write({type:Tn.Type.STATUS,status:ge.PERMISSION_DENIED},{signal:n}),await r.close();return}Ur.trace("sending success response to %p",e.remotePeer),await o.write({type:Tn.Type.STATUS,status:ge.OK},{signal:n});let a=e.remoteAddr.encapsulate(`/p2p-circuit/p2p/${i.toString()}`),c=this.addressManager.getAddresses()[0],u=_A({stream:o.unwrap().unwrap(),remoteAddr:a,localAddr:c});Ur("new inbound transient connection %a",u.remoteAddr),await this.upgrader.upgradeInbound(u,{transient:!0}),Ur("%s connection %a upgraded","inbound",u.remoteAddr)}};function Qle(t={}){return e=>new h8(e,t)}var gM="0.46.13";var d8=`js-libp2p/${gM}`,yM="/ipfs/id/1.0.0",bM="/ipfs/id/push/1.0.0",wM="0.1.0",xM="id",EM="id/push",vM="1.0.0",SM="1.0.0";var g8=J(li(),1);var TM=J(CM(),1),p8=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,ly=(0,TM.default)(),fy=p8&&!ly,_M=ly&&!p8,IM=ly&&p8,DM=typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!ly,hy=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,NKe=typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"]==="test",RM=typeof navigator<"u"&&navigator.product==="ReactNative";var Hs;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{if(o.lengthDelimited!==!1&&n.fork(),r.protocolVersion!=null&&(n.uint32(42),n.string(r.protocolVersion)),r.agentVersion!=null&&(n.uint32(50),n.string(r.agentVersion)),r.publicKey!=null&&(n.uint32(10),n.bytes(r.publicKey)),r.listenAddrs!=null)for(let s of r.listenAddrs)n.uint32(18),n.bytes(s);if(r.observedAddr!=null&&(n.uint32(34),n.bytes(r.observedAddr)),r.protocols!=null)for(let s of r.protocols)n.uint32(26),n.string(s);r.signedPeerRecord!=null&&(n.uint32(66),n.bytes(r.signedPeerRecord)),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={listenAddrs:[],protocols:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 5:o.protocolVersion=r.string();break;case 6:o.agentVersion=r.string();break;case 1:o.publicKey=r.bytes();break;case 2:o.listenAddrs.push(r.bytes());break;case 4:o.observedAddr=r.bytes();break;case 3:o.protocols.push(r.string());break;case 8:o.signedPeerRecord=r.bytes();break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(Hs||(Hs={}));var kr=fe("libp2p:identify"),m8=1024*8,In={protocolPrefix:"ipfs",agentVersion:d8,timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1,maxObservedAddresses:10,maxIdentifyMessageSize:8192,runOnConnectionOpen:!0,runOnTransientConnection:!0},dy=class{identifyProtocolStr;identifyPushProtocolStr;host;started;timeout;peerId;peerStore;registrar;connectionManager;addressManager;maxInboundStreams;maxOutboundStreams;maxPushIncomingStreams;maxPushOutgoingStreams;maxIdentifyMessageSize;maxObservedAddresses;events;runOnTransientConnection;constructor(e,r){this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.registrar=e.registrar,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.events=e.events,this.identifyProtocolStr=`/${r.protocolPrefix??In.protocolPrefix}/${xM}/${vM}`,this.identifyPushProtocolStr=`/${r.protocolPrefix??In.protocolPrefix}/${EM}/${SM}`,this.timeout=r.timeout??In.timeout,this.maxInboundStreams=r.maxInboundStreams??In.maxInboundStreams,this.maxOutboundStreams=r.maxOutboundStreams??In.maxOutboundStreams,this.maxPushIncomingStreams=r.maxPushIncomingStreams??In.maxPushIncomingStreams,this.maxPushOutgoingStreams=r.maxPushOutgoingStreams??In.maxPushOutgoingStreams,this.maxIdentifyMessageSize=r.maxIdentifyMessageSize??In.maxIdentifyMessageSize,this.maxObservedAddresses=r.maxObservedAddresses??In.maxObservedAddresses,this.runOnTransientConnection=r.runOnTransientConnection??In.runOnTransientConnection,this.host={protocolVersion:`${r.protocolPrefix??In.protocolPrefix}/${wM}`,agentVersion:r.agentVersion??In.agentVersion},(r.runOnConnectionOpen??In.runOnConnectionOpen)&&e.events.addEventListener("connection:open",n=>{let o=n.detail;this.identify(o).catch(s=>{kr.error("error during identify trigged by connection:open",s)})}),e.events.addEventListener("self:peer:update",n=>{this.push().catch(o=>{kr.error(o)})}),this.host.agentVersion===d8&&(DM||_M?this.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(fy||hy||IM||RM)&&(this.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`))}isStarted(){return this.started}async start(){this.started||(await this.peerStore.merge(this.peerId,{metadata:{AgentVersion:Nr(this.host.agentVersion),ProtocolVersion:Nr(this.host.protocolVersion)}}),await this.registrar.handle(this.identifyProtocolStr,e=>{this._handleIdentify(e).catch(r=>{kr.error(r)})},{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),await this.registrar.handle(this.identifyPushProtocolStr,e=>{this._handlePush(e).catch(r=>{kr.error(r)})},{maxInboundStreams:this.maxPushIncomingStreams,maxOutboundStreams:this.maxPushOutgoingStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0)}async stop(){await this.registrar.unhandle(this.identifyProtocolStr),await this.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async pushToConnections(e){let r=this.addressManager.getAddresses().map(l=>l.decapsulateCode(De("p2p").code)),n=new Rr({peerId:this.peerId,multiaddrs:r}),o=await Dr.seal(n,this.peerId),s=this.registrar.getProtocols(),i=await this.peerStore.get(this.peerId),a=Ft(i.metadata.get("AgentVersion")??Nr(this.host.agentVersion)),c=Ft(i.metadata.get("ProtocolVersion")??Nr(this.host.protocolVersion)),u=e.map(async l=>{let h,p=AbortSignal.timeout(this.timeout);try{(0,g8.setMaxListeners)?.(1/0,p)}catch{}try{h=await l.newStream([this.identifyPushProtocolStr],{signal:p,runOnTransientConnection:this.runOnTransientConnection}),await Sr(h,{maxDataLength:this.maxIdentifyMessageSize??m8}).pb(Hs).write({listenAddrs:r.map(f=>f.bytes),signedPeerRecord:o.marshal(),protocols:s,agentVersion:a,protocolVersion:c},{signal:p}),await h.close({signal:p})}catch(m){kr.error("could not push identify update to peer",m),h?.abort(m)}});await Promise.all(u)}async push(){if(!this.isStarted())return;let e=[];await Promise.all(this.connectionManager.getConnections().map(async r=>{try{if(!(await this.peerStore.get(r.remotePeer)).protocols.includes(this.identifyPushProtocolStr))return;e.push(r)}catch(n){if(n.code!==$.ERR_NOT_FOUND)throw n}})),await this.pushToConnections(e)}async _identify(e,r={}){let n;r.signal=r.signal??AbortSignal.timeout(this.timeout);try{n=await e.newStream([this.identifyProtocolStr],{...r,runOnTransientConnection:this.runOnTransientConnection});let s=await Sr(n,{maxDataLength:this.maxIdentifyMessageSize??m8}).pb(Hs).read(r);return await n.close(r),s}catch(o){throw kr.error("error while reading identify message",o),n?.abort(o),o}}async identify(e,r={}){let n=await this._identify(e,r),{publicKey:o,protocols:s,observedAddr:i}=n;if(o==null)throw new C("public key was missing from identify message",$.ERR_MISSING_PUBLIC_KEY);let a=await lL(o);if(!e.remotePeer.equals(a))throw new C("identified peer does not match the expected peer",$.ERR_INVALID_PEER);if(this.peerId.equals(a))throw new C("identified peer is our own peer id?",$.ERR_INVALID_PEER);let c=Jle(i);kr("identify completed for peer %p and protocols %o",a,s),kr("our observed address is %a",c),c!=null&&this.addressManager.getObservedAddrs().length<(this.maxObservedAddresses??1/0)&&(kr("storing our observed address %a",c),this.addressManager.addObservedAddr(c));let u=await this.#e(e.remotePeer,n),l={peerId:a,protocolVersion:n.protocolVersion,agentVersion:n.agentVersion,publicKey:n.publicKey,listenAddrs:n.listenAddrs.map(h=>Pe(h)),observedAddr:n.observedAddr==null?void 0:Pe(n.observedAddr),protocols:n.protocols,signedPeerRecord:u};return this.events.safeDispatchEvent("peer:identify",{detail:l}),l}async _handleIdentify(e){let{connection:r,stream:n}=e,o=AbortSignal.timeout(this.timeout);try{(0,g8.setMaxListeners)?.(1/0,o)}catch{}try{let s=this.peerId.publicKey??new Uint8Array(0),i=await this.peerStore.get(this.peerId),a=this.addressManager.getAddresses().map(l=>l.decapsulateCode(De("p2p").code)),c=i.peerRecordEnvelope;if(a.length>0&&c==null){let l=new Rr({peerId:this.peerId,multiaddrs:a});c=(await Dr.seal(l,this.peerId)).marshal().subarray()}await Sr(n).pb(Hs).write({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:s,listenAddrs:a.map(l=>l.bytes),signedPeerRecord:c,observedAddr:r.remoteAddr.bytes,protocols:i.protocols},{signal:o}),await n.close({signal:o})}catch(s){kr.error("could not respond to identify request",s),n.abort(s)}}async _handlePush(e){let{connection:r,stream:n}=e;try{if(this.peerId.equals(r.remotePeer))throw new Error("received push from ourselves?");let o={signal:AbortSignal.timeout(this.timeout)},i=await Sr(n,{maxDataLength:this.maxIdentifyMessageSize??m8}).pb(Hs).read(o);await n.close(o),await this.#e(r.remotePeer,i)}catch(o){kr.error("received invalid message",o),n.abort(o);return}kr("handled push from %p",r.remotePeer)}async#e(e,r){if(kr("received identify from %p",e),r==null)throw new Error("Message was null or undefined");let n={addresses:r.listenAddrs.map(s=>({isCertified:!1,multiaddr:Pe(s)})),protocols:r.protocols,metadata:new Map,peerRecordEnvelope:r.signedPeerRecord},o;if(r.signedPeerRecord!=null){kr("received signedPeerRecord in push from %p",e);let s=r.signedPeerRecord,i=await Dr.openAndCertify(s,Rr.DOMAIN),a=Rr.createFromProtobuf(i.payload);if(!a.peerId.equals(i.peerId))throw new Error("signing key does not match PeerId in the PeerRecord");if(!e.equals(a.peerId))throw new Error("signing key does not match remote PeerId");let c;try{c=await this.peerStore.get(a.peerId)}catch(u){if(u.code!=="ERR_NOT_FOUND")throw u}if(c!=null&&(n.metadata=c.metadata,c.peerRecordEnvelope!=null)){let u=await Dr.createFromProtobuf(c.peerRecordEnvelope),l=Rr.createFromProtobuf(u.payload);l.seqNumber>=a.seqNumber&&(kr("sequence number was lower or equal to existing sequence number - stored: %d received: %d",l.seqNumber,a.seqNumber),a=l,s=c.peerRecordEnvelope)}n.peerRecordEnvelope=s,n.addresses=a.multiaddrs.map(u=>({isCertified:!0,multiaddr:u})),o={seq:a.seqNumber,addresses:a.multiaddrs}}else kr("%p did not send a signed peer record",e);return r.agentVersion!=null&&n.metadata.set("AgentVersion",Nr(r.agentVersion)),r.protocolVersion!=null&&n.metadata.set("ProtocolVersion",Nr(r.protocolVersion)),await this.peerStore.patch(e,n),o}};function Jle(t){if(t!=null&&t.length>0)try{return Pe(t)}catch{}}var eqe={IDENTIFY:yM,IDENTIFY_PUSH:bM},tqe={Identify:Hs};function rqe(t={}){return e=>new dy(e,t)}var Dn=J(ao(),1);function Zle(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var efe=Zle,tfe=efe,LM=tfe;var sqe=new Uint8Array(0);var BM=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var y8=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},b8=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return PM(this,e)}},w8=class{constructor(e){this.decoders=e}or(e){return PM(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},PM=(t,e)=>new w8({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),x8=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new y8(e,r,n),this.decoder=new b8(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},NM=({name:t,prefix:e,encode:r,decode:n})=>new x8(t,e,r,n),E8=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=LM(r,e);return NM({prefix:t,name:e,encode:n,decode:s=>BM(o(s))})},rfe=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},nfe=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Hr=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>NM({prefix:e,name:t,encode(o){return nfe(o,n,r)},decode(o){return rfe(o,n,r,t)}});var OM=Hr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),fqe=Hr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),hqe=Hr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dqe=Hr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),pqe=Hr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mqe=Hr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),gqe=Hr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),yqe=Hr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),bqe=Hr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var UM=E8({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Eqe=E8({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var kM=Hr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Aqe=Hr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Cqe=Hr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Tqe=Hr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});Dn.default.formatters.b=t=>t==null?"undefined":UM.baseEncode(t);Dn.default.formatters.t=t=>t==null?"undefined":OM.baseEncode(t);Dn.default.formatters.m=t=>t==null?"undefined":kM.baseEncode(t);Dn.default.formatters.p=t=>t==null?"undefined":t.toString();Dn.default.formatters.c=t=>t==null?"undefined":t.toString();Dn.default.formatters.k=t=>t==null?"undefined":t.toString();Dn.default.formatters.a=t=>t==null?"undefined":t.toString();function ofe(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function py(t){let e=ofe(`${t}:trace`);return Dn.default.enabled(`${t}:trace`)&&Dn.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,Dn.default)(`${t}:trace`)),Object.assign((0,Dn.default)(t),{error:(0,Dn.default)(`${t}:error`),trace:e})}var T8={};T(T8,{base58btc:()=>nn,base58flickr:()=>lfe});function sfe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var ife=sfe,afe=ife,MM=afe;var Pqe=new Uint8Array(0);var FM=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Gs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var VM=t=>new TextEncoder().encode(t),zM=t=>new TextDecoder().decode(t);var v8=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},S8=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return KM(this,e)}},A8=class{constructor(e){this.decoders=e}or(e){return KM(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},KM=(t,e)=>new A8({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),C8=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new v8(e,r,n),this.decoder=new S8(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},ef=({name:t,prefix:e,encode:r,decode:n})=>new C8(t,e,r,n),ia=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=MM(r,e);return ef({prefix:t,name:e,encode:n,decode:s=>Gs(o(s))})},cfe=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},ufe=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},It=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ef({prefix:e,name:t,encode(o){return ufe(o,n,r)},decode(o){return cfe(o,n,r,t)}});var nn=ia({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),lfe=ia({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var _8={};T(_8,{base32:()=>Ws,base32hex:()=>pfe,base32hexpad:()=>gfe,base32hexpadupper:()=>yfe,base32hexupper:()=>mfe,base32pad:()=>hfe,base32padupper:()=>dfe,base32upper:()=>ffe,base32z:()=>bfe});var Ws=It({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ffe=It({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),hfe=It({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dfe=It({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),pfe=It({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mfe=It({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),gfe=It({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),yfe=It({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),bfe=It({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var wfe=GM,qM=128,xfe=127,Efe=~xfe,vfe=Math.pow(2,31);function GM(t,e,r){e=e||[],r=r||0;for(var n=r;t>=vfe;)e[r++]=t&255|qM,t/=128;for(;t&Efe;)e[r++]=t&255|qM,t>>>=7;return e[r]=t|0,GM.bytes=r-n+1,e}var Sfe=I8,Afe=128,HM=127;function I8(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw I8.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&HM)<<o:(i&HM)*Math.pow(2,o),o+=7}while(i>=Afe);return I8.bytes=s-n,r}var Cfe=Math.pow(2,7),Tfe=Math.pow(2,14),_fe=Math.pow(2,21),Ife=Math.pow(2,28),Dfe=Math.pow(2,35),Rfe=Math.pow(2,42),Lfe=Math.pow(2,49),Bfe=Math.pow(2,56),Pfe=Math.pow(2,63),Nfe=function(t){return t<Cfe?1:t<Tfe?2:t<_fe?3:t<Ife?4:t<Dfe?5:t<Rfe?6:t<Lfe?7:t<Bfe?8:t<Pfe?9:10},Ofe={encode:wfe,decode:Sfe,encodingLength:Nfe},Ufe=Ofe,lp=Ufe;var fp=(t,e=0)=>[lp.decode(t,e),lp.decode.bytes],tf=(t,e,r=0)=>(lp.encode(t,e,r),e),rf=t=>lp.encodingLength(t);var pc=(t,e)=>{let r=e.byteLength,n=rf(t),o=n+rf(r),s=new Uint8Array(o+r);return tf(t,s,0),tf(r,s,n),s.set(e,o),new nf(t,r,e,s)},gy=t=>{let e=Gs(t),[r,n]=fp(e),[o,s]=fp(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new nf(r,o,i,e)},WM=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&FM(t.bytes,r.bytes)}},nf=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var jM=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Mfe(r,D8(t),e||nn.encoder);default:return Ffe(r,D8(t),e||Ws.encoder)}};var YM=new WeakMap,D8=t=>{let e=YM.get(t);if(e==null){let r=new Map;return YM.set(t,r),r}return e},lt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==hp)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Vfe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return lt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=pc(e,r);return lt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return lt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&WM(e.multihash,n.multihash)}toString(e){return jM(this,e)}toJSON(){return{"/":jM(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof lt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new lt(n,o,s,i||QM(n,o,s.bytes))}else if(r[zfe]===!0){let{version:n,multihash:o,code:s}=r,i=gy(o);return lt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==hp)throw new Error(`Version 0 CID must use dag-pb (code: ${hp}) block encoding`);return new lt(e,r,n,n.bytes)}case 1:{let o=QM(e,r,n.bytes);return new lt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return lt.create(0,hp,e)}static createV1(e,r){return lt.create(1,e,r)}static decode(e){let[r,n]=lt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=lt.inspectBytes(e),n=r.size-r.multihashSize,o=Gs(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new nf(r.multihashCode,r.digestSize,s,o);return[r.version===0?lt.createV0(i):lt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=fp(e.subarray(r));return r+=p,h},o=n(),s=hp;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=kfe(e,r),s=lt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return D8(s).set(n,e),s}},kfe=(t,e)=>{switch(t[0]){case"Q":{let r=e||nn;return[nn.prefix,r.decode(`${nn.prefix}${t}`)]}case nn.prefix:{let r=e||nn;return[nn.prefix,r.decode(t)]}case Ws.prefix:{let r=e||Ws;return[Ws.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Mfe=(t,e,r)=>{let{prefix:n}=r;if(n!==nn.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},Ffe=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},hp=112,Vfe=18,QM=(t,e,r)=>{let n=rf(t),o=n+rf(e),s=new Uint8Array(o+r.byteLength);return tf(t,s,0),tf(e,s,n),s.set(r,o),s},zfe=Symbol.for("@ipld/js-cid/CID");function XM(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var R8={};T(R8,{base10:()=>$fe});var $fe=ia({prefix:"9",name:"base10",alphabet:"0123456789"});var L8={};T(L8,{base16:()=>Kfe,base16upper:()=>qfe});var Kfe=It({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),qfe=It({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var B8={};T(B8,{base2:()=>Hfe});var Hfe=It({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var P8={};T(P8,{base256emoji:()=>Qfe});var JM=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Gfe=JM.reduce((t,e,r)=>(t[r]=e,t),[]),Wfe=JM.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function jfe(t){return t.reduce((e,r)=>(e+=Gfe[r],e),"")}function Yfe(t){let e=[];for(let r of t){let n=Wfe[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Qfe=ef({prefix:"\u{1F680}",name:"base256emoji",encode:jfe,decode:Yfe});var N8={};T(N8,{base36:()=>Xfe,base36upper:()=>Jfe});var Xfe=ia({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Jfe=ia({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var O8={};T(O8,{base64:()=>Zfe,base64pad:()=>ehe,base64url:()=>the,base64urlpad:()=>rhe});var Zfe=It({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ehe=It({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),the=It({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),rhe=It({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var U8={};T(U8,{base8:()=>nhe});var nhe=It({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var k8={};T(k8,{identity:()=>ohe});var ohe=ef({prefix:"\0",name:"identity",encode:t=>zM(t),decode:t=>VM(t)});var nHe=new TextEncoder,oHe=new TextDecoder;var M8={};T(M8,{identity:()=>uhe});var ZM=0,ahe="identity",e7=Gs,che=t=>pc(ZM,e7(t)),uhe={code:ZM,name:ahe,encode:e7,digest:che};var z8={};T(z8,{sha256:()=>lhe,sha512:()=>fhe});var V8=({name:t,code:e,encode:r})=>new F8(t,e,r),F8=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?pc(this.code,r):r.then(n=>pc(this.code,n))}else throw Error("Unknown type, must be binary type")}};var r7=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),lhe=V8({name:"sha2-256",code:18,encode:r7("SHA-256")}),fhe=V8({name:"sha2-512",code:19,encode:r7("SHA-512")});var dp={...k8,...B8,...U8,...R8,...L8,..._8,...N8,...T8,...O8,...P8},hHe={...z8,...M8};function sf(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function yy(t=0){return globalThis.Buffer?.allocUnsafe!=null?sf(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function o7(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var n7=o7("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),$8=o7("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=yy(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),hhe={utf8:n7,"utf-8":n7,hex:dp.base16,latin1:$8,ascii:$8,binary:$8,...dp},by=hhe;function on(t,e="utf8"){let r=by[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function js(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=yy(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return sf(r)}function K8(t,e="utf8"){let r=by[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?sf(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var s7=cr,dhe=ur,q8=function(t){let e=0;if(t=t.toString().trim(),s7(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(dhe(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let s=s7(r[n]),i;s&&(i=q8(r[n]),r[n]=on(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,on(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let o=new Uint8Array(e+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);o[e++]=s>>8&255,o[e++]=s&255}return o}throw new Error("invalid ip address")},i7=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let o=[];for(let s=0;s<r;s++)o.push(t[e+s]);return o.join(".")}if(r===16){let o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(e+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var af={},H8={},mhe=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];mhe.forEach(t=>{let e=ghe(...t);H8[e.code]=e,af[e.name]=e});function ghe(t,e,r,n,o){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(o)}}function Ee(t){if(typeof t=="number"){if(H8[t]!=null)return H8[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(af[t]!=null)return af[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var zHe=Ee("ip4"),$He=Ee("ip6"),KHe=Ee("ipcidr");function W8(t,e){switch(Ee(t).code){case 4:case 41:return bhe(e);case 42:return u7(e);case 6:case 273:case 33:case 132:return f7(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return u7(e);case 421:return vhe(e);case 444:return l7(e);case 445:return l7(e);case 466:return Ehe(e);default:return on(e,"base16")}}function j8(t,e){switch(Ee(t).code){case 4:return a7(e);case 41:return a7(e);case 42:return c7(e);case 6:case 273:case 33:case 132:return Y8(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return c7(e);case 421:return whe(e);case 444:return She(e);case 445:return Ahe(e);case 466:return xhe(e);default:return K8(e,"base16")}}var G8=Object.values(dp).map(t=>t.decoder),yhe=function(){let t=G8[0].or(G8[1]);return G8.slice(2).forEach(e=>t=t.or(e)),t}();function a7(t){if(!xe(t))throw new Error("invalid ip address");return q8(t)}function bhe(t){let e=i7(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!xe(e))throw new Error("invalid ip address");return e}function Y8(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function f7(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function c7(t){let e=K8(t),r=Uint8Array.from(re(e.length));return js([r,e],r.length+e.length)}function u7(t){let e=te(t);if(t=t.slice(X(e)),t.length!==e)throw new Error("inconsistent lengths");return on(t)}function whe(t){let e;t[0]==="Q"||t[0]==="1"?e=gy(nn.decode(`z${t}`)).bytes:e=lt.parse(t).multihash.bytes;let r=Uint8Array.from(re(e.length));return js([r,e],r.length+e.length)}function xhe(t){let e=yhe.decode(t),r=Uint8Array.from(re(e.length));return js([r,e],r.length+e.length)}function Ehe(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+on(r,"base64url")}function vhe(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return on(r,"base58btc")}function She(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=Ws.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Y8(n);return js([r,o],r.length+o.length)}function Ahe(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=Ws.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Y8(n);return js([r,o],r.length+o.length)}function l7(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=on(e,"base32"),o=f7(r);return`${n}:${o}`}function h7(t){t=Q8(t);let e=[],r=[],n=null,o=t.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=Ee(i);if(a.size===0){e.push([a.code]),r.push([a.code]);continue}if(s++,s>=o.length)throw p7("invalid address: "+t);if(a.path===!0){n=Q8(o.slice(s).join("/")),e.push([a.code,j8(a.code,n)]),r.push([a.code,n]);break}let c=j8(a.code,o[s]);e.push([a.code,c]),r.push([a.code,W8(a.code,c)])}return{string:d7(r),bytes:J8(e),tuples:e,stringTuples:r,path:n}}function X8(t){let e=[],r=[],n=null,o=0;for(;o<t.length;){let s=te(t,o),i=X(s),a=Ee(s),c=Che(a,t.slice(o+i));if(c===0){e.push([s]),r.push([s]),o+=i;continue}let u=t.slice(o+i,o+i+c);if(o+=c+i,o>t.length)throw p7("Invalid address Uint8Array: "+on(t,"base16"));e.push([s,u]);let l=W8(s,u);if(r.push([s,l]),a.path===!0){n=l;break}}return{bytes:Uint8Array.from(t),string:d7(r),tuples:e,stringTuples:r,path:n}}function d7(t){let e=[];return t.map(r=>{let n=Ee(r[0]);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),Q8(e.join("/"))}function J8(t){return js(t.map(e=>{let r=Ee(e[0]),n=Uint8Array.from(re(r.code));return e.length>1&&e[1]!=null&&(n=js([n,e[1]])),n}))}function Che(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{let r=te(e instanceof Uint8Array?e:Uint8Array.from(e));return r+X(r)}}function Q8(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function p7(t){return new Error("Error parsing address: "+t)}var The=Symbol.for("nodejs.util.inspect.custom"),_he=[Ee("dns").code,Ee("dns4").code,Ee("dns6").code,Ee("dnsaddr").code],Ihe=new Map,m7=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Dhe(t){return Boolean(t?.[m7])}var Ys=class{bytes;#e;#t;#r;#n;[m7]=!0;constructor(e){e==null&&(e="");let r;if(e instanceof Uint8Array)r=X8(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);r=h7(e)}else if(Dhe(e))r=X8(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#e=r.string,this.#t=r.tuples,this.#r=r.stringTuples,this.#n=r.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,r,n,o,s="",i=Ee("tcp"),a=Ee("udp"),c=Ee("ip4"),u=Ee("ip6"),l=Ee("dns6"),h=Ee("ip6zone");for(let[m,f]of this.stringTuples())m===h.code&&(s=`%${f??""}`),_he.includes(m)&&(r=i.name,o=443,n=`${f??""}${s}`,e=m===l.code?6:4),(m===i.code||m===a.code)&&(r=Ee(m).name,o=parseInt(f??"")),(m===c.code||m===u.code)&&(r=Ee(m).name,n=`${f??""}${s}`,e=m===u.code?6:4);if(e==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:o}}protos(){return this.#t.map(([e])=>Object.assign({},Ee(e)))}protoCodes(){return this.#t.map(([e])=>e)}protoNames(){return this.#t.map(([e])=>Ee(e).name)}tuples(){return this.#t}stringTuples(){return this.#r}encapsulate(e){return e=new Ys(e),new Ys(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Ys(n.slice(0,o))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Ys(J8(r.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach(([n,o])=>{n===af.p2p.code&&e.push([n,o]),n===af["p2p-circuit"].code&&(e=[])});let r=e.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?on(nn.decode(`z${n}`),"base58btc"):on(lt.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(e){return XM(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=Ihe.get(r.name);if(n==null)throw new C(`no available resolver for ${r.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new Ys(s))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[The](){return`Multiaddr(${this.#e})`}};function Z8(t){return new Ys(t)}function g7(t){let e;try{e=Ee("sni").code}catch{return null}for(let[r,n]of t)if(r===e&&n!==void 0)return n;return null}function y7(t){return t.some(([e,r])=>e===Ee("tls").code)}function Rn(t,e,r){let n=b7[Ee(t).name];if(n===void 0)throw new Error(`Can't interpret protocol ${Ee(t).name}`);let o=n(e,r);return t===Ee("ip6").code?`[${o}]`:o}var b7={ip4:(t,e)=>t,ip6:(t,e)=>e.length===0?t:`[${t}]`,tcp:(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`tcp://${Rn(r[0],r[1]??"",e)}:${t}`},udp:(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`udp://${Rn(r[0],r[1]??"",e)}:${t}`},dnsaddr:(t,e)=>t,dns4:(t,e)=>t,dns6:(t,e)=>t,dns:(t,e)=>t,ipfs:(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${Rn(r[0],r[1]??"",e)}/ipfs/${t}`},p2p:(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${Rn(r[0],r[1]??"",e)}/p2p/${t}`},http:(t,e)=>{let r=y7(e),n=g7(e);if(r&&n!==null)return`https://${n}`;let o=r?"https://":"http://",s=e.pop();if(s===void 0)throw new Error("Unexpected end of multiaddr");let i=Rn(s[0],s[1]??"",e);return i=i.replace("tcp://",""),`${o}${i}`},tls:(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return Rn(r[0],r[1]??"",e)},sni:(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return Rn(r[0],r[1]??"",e)},https:(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");let n=Rn(r[0],r[1]??"",e);return n=n.replace("tcp://",""),`https://${n}`},ws:(t,e)=>{let r=y7(e),n=g7(e);if(r&&n!==null)return`wss://${n}`;let o=r?"wss://":"ws://",s=e.pop();if(s===void 0)throw new Error("Unexpected end of multiaddr");let i=Rn(s[0],s[1]??"",e);return i=i.replace("tcp://",""),`${o}${i}`},wss:(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");let n=Rn(r[0],r[1]??"",e);return n=n.replace("tcp://",""),`wss://${n}`},"p2p-websocket-star":(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${Rn(r[0],r[1]??"",e)}/p2p-websocket-star`},"p2p-webrtc-star":(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${Rn(r[0],r[1]??"",e)}/p2p-webrtc-star`},"p2p-webrtc-direct":(t,e)=>{let r=e.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${Rn(r[0],r[1]??"",e)}/p2p-webrtc-direct`}};function w7(t,e){let n=Z8(t).stringTuples(),o=n.pop();if(o===void 0)throw new Error("Unexpected end of multiaddr");let s=Ee(o[0]),i=b7[s.name];if(i==null)throw new Error(`No interpreter found for ${s.name}`);let a=i(o[1]??"",n);return e?.assumeHttp!==!1&&o[0]===Ee("tcp").code&&(a=a.replace("tcp://","http://"),(o[1]==="443"||o[1]==="80")&&(o[1]==="443"&&(a=a.replace("http://","https://")),a=a.substring(0,a.lastIndexOf(":")))),a}var x7=async t=>{if(t.readyState>=2)throw new Error("socket closed");t.readyState!==1&&await new Promise((e,r)=>{function n(){t.removeEventListener("open",o),t.removeEventListener("error",s)}function o(){n(),e()}function s(i){n(),r(i.error??new Error(`connect ECONNREFUSED ${t.url}`))}t.addEventListener("open",o),t.addEventListener("error",s)})};var E7=(t,e)=>(e=e??{},e.closeOnEnd=e.closeOnEnd!==!1,async n=>{for await(let o of n){try{await x7(t)}catch(s){if(s.message==="socket closed")break;throw s}if(t.readyState===t.CLOSING||t.readyState===t.CLOSED)break;t.send(o)}e.closeOnEnd!=null&&t.readyState<=1&&await new Promise((o,s)=>{t.addEventListener("close",i=>{if(i.wasClean||i.code===1006)o();else{let a=Object.assign(new Error("ws error"),{event:i});s(a)}}),setTimeout(()=>{t.close()})})});var Y7=J(S7(),1);function Ey(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var i4={};T(i4,{base10:()=>Uhe});function Lhe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var Bhe=Lhe,Phe=Bhe,A7=Phe;var wGe=new Uint8Array(0);var C7=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Qs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var T7=t=>new TextEncoder().encode(t),_7=t=>new TextDecoder().decode(t);var r4=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},n4=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return D7(this,e)}},o4=class{constructor(e){this.decoders=e}or(e){return D7(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},D7=(t,e)=>new o4({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),s4=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new r4(e,r,n),this.decoder=new n4(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},cf=({name:t,prefix:e,encode:r,decode:n})=>new s4(t,e,r,n),aa=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=A7(r,e);return cf({prefix:t,name:e,encode:n,decode:s=>Qs(o(s))})},Nhe=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},Ohe=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Dt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>cf({prefix:e,name:t,encode(o){return Ohe(o,n,r)},decode(o){return Nhe(o,n,r,t)}});var Uhe=aa({prefix:"9",name:"base10",alphabet:"0123456789"});var a4={};T(a4,{base16:()=>khe,base16upper:()=>Mhe});var khe=Dt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mhe=Dt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var c4={};T(c4,{base2:()=>Fhe});var Fhe=Dt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var u4={};T(u4,{base256emoji:()=>qhe});var R7=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Vhe=R7.reduce((t,e,r)=>(t[r]=e,t),[]),zhe=R7.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function $he(t){return t.reduce((e,r)=>(e+=Vhe[r],e),"")}function Khe(t){let e=[];for(let r of t){let n=zhe[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var qhe=cf({prefix:"\u{1F680}",name:"base256emoji",encode:$he,decode:Khe});var l4={};T(l4,{base32:()=>uf,base32hex:()=>jhe,base32hexpad:()=>Qhe,base32hexpadupper:()=>Xhe,base32hexupper:()=>Yhe,base32pad:()=>Ghe,base32padupper:()=>Whe,base32upper:()=>Hhe,base32z:()=>Jhe});var uf=Dt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hhe=Dt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ghe=Dt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Whe=Dt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),jhe=Dt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Yhe=Dt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Qhe=Dt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xhe=Dt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Jhe=Dt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var f4={};T(f4,{base36:()=>Zhe,base36upper:()=>ede});var Zhe=aa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ede=aa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var h4={};T(h4,{base58btc:()=>qo,base58flickr:()=>tde});var qo=aa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tde=aa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var d4={};T(d4,{base64:()=>rde,base64pad:()=>nde,base64url:()=>ode,base64urlpad:()=>sde});var rde=Dt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),nde=Dt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ode=Dt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),sde=Dt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var p4={};T(p4,{base8:()=>ide});var ide=Dt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var m4={};T(m4,{identity:()=>ade});var ade=cf({prefix:"\0",name:"identity",encode:t=>_7(t),decode:t=>T7(t)});var NGe=new TextEncoder,OGe=new TextDecoder;var y4={};T(y4,{identity:()=>Rde});var lde=P7,L7=128,fde=127,hde=~fde,dde=Math.pow(2,31);function P7(t,e,r){e=e||[],r=r||0;for(var n=r;t>=dde;)e[r++]=t&255|L7,t/=128;for(;t&hde;)e[r++]=t&255|L7,t>>>=7;return e[r]=t|0,P7.bytes=r-n+1,e}var pde=g4,mde=128,B7=127;function g4(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw g4.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&B7)<<o:(i&B7)*Math.pow(2,o),o+=7}while(i>=mde);return g4.bytes=s-n,r}var gde=Math.pow(2,7),yde=Math.pow(2,14),bde=Math.pow(2,21),wde=Math.pow(2,28),xde=Math.pow(2,35),Ede=Math.pow(2,42),vde=Math.pow(2,49),Sde=Math.pow(2,56),Ade=Math.pow(2,63),Cde=function(t){return t<gde?1:t<yde?2:t<bde?3:t<wde?4:t<xde?5:t<Ede?6:t<vde?7:t<Sde?8:t<Ade?9:10},Tde={encode:lde,decode:pde,encodingLength:Cde},_de=Tde,mp=_de;var gp=(t,e=0)=>[mp.decode(t,e),mp.decode.bytes],lf=(t,e,r=0)=>(mp.encode(t,e,r),e),ff=t=>mp.encodingLength(t);var mc=(t,e)=>{let r=e.byteLength,n=ff(t),o=n+ff(r),s=new Uint8Array(o+r);return lf(t,s,0),lf(r,s,n),s.set(e,o),new hf(t,r,e,s)},N7=t=>{let e=Qs(t),[r,n]=gp(e),[o,s]=gp(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new hf(r,o,i,e)},O7=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&C7(t.bytes,r.bytes)}},hf=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var U7=0,Ide="identity",k7=Qs,Dde=t=>mc(U7,k7(t)),Rde={code:U7,name:Ide,encode:k7,digest:Dde};var x4={};T(x4,{sha256:()=>Lde,sha512:()=>Bde});var w4=({name:t,code:e,encode:r})=>new b4(t,e,r),b4=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?mc(this.code,r):r.then(n=>mc(this.code,n))}else throw Error("Unknown type, must be binary type")}};var F7=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Lde=w4({name:"sha2-256",code:18,encode:F7("SHA-256")}),Bde=w4({name:"sha2-512",code:19,encode:F7("SHA-512")});var V7=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Nde(r,E4(t),e||qo.encoder);default:return Ode(r,E4(t),e||uf.encoder)}};var z7=new WeakMap,E4=t=>{let e=z7.get(t);if(e==null){let r=new Map;return z7.set(t,r),r}return e},Wt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==bp)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Ude)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Wt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=mc(e,r);return Wt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Wt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&O7(e.multihash,n.multihash)}toString(e){return V7(this,e)}toJSON(){return{"/":V7(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof Wt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new Wt(n,o,s,i||$7(n,o,s.bytes))}else if(r[kde]===!0){let{version:n,multihash:o,code:s}=r,i=N7(o);return Wt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==bp)throw new Error(`Version 0 CID must use dag-pb (code: ${bp}) block encoding`);return new Wt(e,r,n,n.bytes)}case 1:{let o=$7(e,r,n.bytes);return new Wt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return Wt.create(0,bp,e)}static createV1(e,r){return Wt.create(1,e,r)}static decode(e){let[r,n]=Wt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Wt.inspectBytes(e),n=r.size-r.multihashSize,o=Qs(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new hf(r.multihashCode,r.digestSize,s,o);return[r.version===0?Wt.createV0(i):Wt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=gp(e.subarray(r));return r+=p,h},o=n(),s=bp;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=Pde(e,r),s=Wt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return E4(s).set(n,e),s}},Pde=(t,e)=>{switch(t[0]){case"Q":{let r=e||qo;return[qo.prefix,r.decode(`${qo.prefix}${t}`)]}case qo.prefix:{let r=e||qo;return[qo.prefix,r.decode(t)]}case uf.prefix:{let r=e||uf;return[uf.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Nde=(t,e,r)=>{let{prefix:n}=r;if(n!==qo.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},Ode=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},bp=112,Ude=18,$7=(t,e,r)=>{let n=ff(t),o=n+ff(e),s=new Uint8Array(o+r.byteLength);return lf(t,s,0),lf(e,s,n),s.set(r,o),s},kde=Symbol.for("@ipld/js-cid/CID");var v4={...m4,...c4,...p4,...i4,...a4,...l4,...f4,...h4,...d4,...u4},XGe={...x4,...y4};function K7(t=0){return globalThis.Buffer?.allocUnsafe!=null?Ey(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function H7(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var q7=H7("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),S4=H7("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=K7(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Mde={utf8:q7,"utf-8":q7,hex:v4.base16,latin1:S4,ascii:S4,binary:S4,...v4},G7=Mde;function W7(t,e="utf8"){let r=G7[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ey(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function j7(t){return t instanceof ArrayBuffer||t?.constructor?.name==="ArrayBuffer"&&typeof t?.byteLength=="number"}var Q7=t=>{t.binaryType="arraybuffer";let e=async()=>{await new Promise((s,i)=>{if(n){s();return}if(o!=null){i(o);return}let a=l=>{t.removeEventListener("open",c),t.removeEventListener("error",u),l()},c=()=>{a(s)},u=l=>{a(()=>{i(l.error??new Error(`connect ECONNREFUSED ${t.url}`))})};t.addEventListener("open",c),t.addEventListener("error",u)})},r=async function*(){let s=new Y7.EventIterator(({push:i,stop:a,fail:c})=>{let u=h=>{let p=null;typeof h.data=="string"&&(p=W7(h.data)),j7(h.data)&&(p=new Uint8Array(h.data)),h.data instanceof Uint8Array&&(p=h.data),p!=null&&i(p)},l=h=>{c(h.error??new Error("Socket error"))};return t.addEventListener("message",u),t.addEventListener("error",l),t.addEventListener("close",a),()=>{t.removeEventListener("message",u),t.removeEventListener("error",l),t.removeEventListener("close",a)}},{highWaterMark:1/0});await e();for await(let i of s)yield j7(i)?new Uint8Array(i):i}(),n=t.readyState===1,o;return t.addEventListener("open",()=>{n=!0,o=null}),t.addEventListener("close",()=>{n=!1,o=null}),t.addEventListener("error",s=>{n||(o=s.error??new Error(`connect ECONNREFUSED ${t.url}`))}),Object.assign(r,{connected:e})};var X7=(t,e)=>{e=e??{};let r=Q7(t),n=e.remoteAddress,o=e.remotePort;if(t.url!=null)try{let i=new URL(t.url);n=i.hostname,o=parseInt(i.port,10)}catch{}if(n==null||o==null)throw new Error("Remote connection did not have address and/or port");return{sink:E7(t,e),source:r,connected:async()=>{await r.connected()},close:async()=>{(t.readyState===t.CONNECTING||t.readyState===t.OPEN)&&await new Promise(i=>{t.addEventListener("close",()=>{i()}),t.close()})},destroy:()=>{t.terminate!=null?t.terminate():t.close()},remoteAddress:n,remotePort:o,socket:t}};var J7=WebSocket;var i9=J(s9(),1),jde={http:"ws",https:"wss"},Yde="ws",a9=(t,e)=>(0,i9.relative)(t,e,jde,Yde);function c9(t,e){let r=typeof window>"u"?"":window.location;e=e??{};let n=a9(t,r.toString()),o=new J7(n,e.websocket);return X7(o,e)}var D4={};T(D4,{all:()=>_4,dnsWsOrWss:()=>Jde,dnsWss:()=>Xde,wss:()=>I4});function _4(t){return t.filter(e=>{if(e.protoCodes().includes(290))return!1;let r=e.decapsulateCode(421);return hc.matches(r)||qs.matches(r)})}function I4(t){return t.filter(e=>{if(e.protoCodes().includes(290))return!1;let r=e.decapsulateCode(421);return qs.matches(r)})}function Xde(t){return t.filter(e=>{if(e.protoCodes().includes(290))return!1;let r=e.decapsulateCode(421);return qs.matches(r)&&wo.matches(r.decapsulateCode(6).decapsulateCode(478))})}function Jde(t){return t.filter(e=>{if(e.protoCodes().includes(290))return!1;let r=e.decapsulateCode(421);return hc.matches(r)?wo.matches(r.decapsulateCode(6).decapsulateCode(477)):qs.matches(r)&&wo.matches(r.decapsulateCode(6).decapsulateCode(478))})}function l9(){throw new Error("WebSocket Servers can not be created in the browser!")}var Cy=py("libp2p:websockets:socket");function f9(t,e,r){r=r??{};let n={async sink(o){r?.signal!=null&&(o=go(o,r.signal));try{await t.sink(o)}catch(s){s.type!=="aborted"&&Cy.error(s)}},source:r.signal!=null?go(t.source,r.signal):t.source,remoteAddr:e,timeline:{open:Date.now()},async close(o={}){let s=Date.now();o.signal=o.signal??AbortSignal.timeout(500);let i=()=>{let{host:a,port:c}=n.remoteAddr.toOptions();Cy("timeout closing stream to %s:%s after %dms, destroying it manually",a,c,Date.now()-s),this.abort(new C("Socket close timeout","ERR_SOCKET_CLOSE_TIMEOUT"))};o.signal.addEventListener("abort",i);try{await t.close()}catch(a){Cy.error("error closing WebSocket gracefully",a),this.abort(a)}finally{o.signal.removeEventListener("abort",i),n.timeline.close=Date.now()}},abort(o){let{host:s,port:i}=n.remoteAddr.toOptions();Cy("timeout closing stream to %s:%s due to error",s,i,o),t.destroy(),n.timeline.close=Date.now()}};return t.socket.addEventListener("close",()=>{n.timeline.close==null&&(n.timeline.close=Date.now())},{once:!0}),n}var ca=py("libp2p:websockets"),R4=class{init;constructor(e){this.init=e}[Symbol.toStringTag]="@libp2p/websockets";[Yi]=!0;async dial(e,r){ca("dialing %s",e),r=r??{};let n=await this._connect(e,r),o=f9(n,e);ca("new outbound connection %s",o.remoteAddr);let s=await r.upgrader.upgradeOutbound(o);return ca("outbound connection %s upgraded",o.remoteAddr),s}async _connect(e,r){if(r?.signal?.aborted===!0)throw new Zn;let n=e.toOptions();ca("dialing %s:%s",n.host,n.port);let o=ze(),s=c9(w7(e),this.init);if(s.socket.addEventListener("error",()=>{let c=new C(`Could not connect to ${e.toString()}`,"ERR_CONNECTION_FAILED");ca.error("connection error:",c),o.reject(c)}),r.signal==null)return await Promise.race([s.connected(),o.promise]),ca("connected %s",e),s;let i,a=new Promise((c,u)=>{if(i=()=>{u(new Zn),s.close().catch(l=>{ca.error("error closing raw socket",l)})},r?.signal?.aborted===!0){i();return}r?.signal?.addEventListener("abort",i)});try{await Promise.race([a,o.promise,s.connected()])}finally{i!=null&&r?.signal?.removeEventListener("abort",i)}return ca("connected %s",e),s}createListener(e){return l9({...this.init,...e})}filter(e){return e=Array.isArray(e)?e:[e],this.init?.filter!=null?this.init?.filter(e):fy||hy?I4(e):_4(e)}};function MWe(t={}){return()=>new R4(t)}var Ln=J(ao(),1);var O4={};T(O4,{base32:()=>xo,base32hex:()=>cpe,base32hexpad:()=>lpe,base32hexpadupper:()=>fpe,base32hexupper:()=>upe,base32pad:()=>ipe,base32padupper:()=>ape,base32upper:()=>spe,base32z:()=>hpe});function epe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var tpe=epe,rpe=tpe,h9=rpe;var zWe=new Uint8Array(0);var d9=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Xs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var p9=t=>new TextEncoder().encode(t),m9=t=>new TextDecoder().decode(t);var L4=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},B4=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return y9(this,e)}},P4=class{constructor(e){this.decoders=e}or(e){return y9(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},y9=(t,e)=>new P4({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),N4=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new L4(e,r,n),this.decoder=new B4(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},df=({name:t,prefix:e,encode:r,decode:n})=>new N4(t,e,r,n),ua=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=h9(r,e);return df({prefix:t,name:e,encode:n,decode:s=>Xs(o(s))})},npe=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},ope=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Rt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>df({prefix:e,name:t,encode(o){return ope(o,n,r)},decode(o){return npe(o,n,r,t)}});var xo=Rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),spe=Rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ipe=Rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ape=Rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),cpe=Rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),upe=Rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),lpe=Rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fpe=Rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hpe=Rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var U4={};T(U4,{base58btc:()=>rr,base58flickr:()=>dpe});var rr=ua({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),dpe=ua({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var M4={};T(M4,{base64:()=>k4,base64pad:()=>ppe,base64url:()=>mpe,base64urlpad:()=>gpe});var k4=Rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ppe=Rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),mpe=Rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),gpe=Rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});Ln.default.formatters.b=t=>t==null?"undefined":rr.baseEncode(t);Ln.default.formatters.t=t=>t==null?"undefined":xo.baseEncode(t);Ln.default.formatters.m=t=>t==null?"undefined":k4.baseEncode(t);Ln.default.formatters.p=t=>t==null?"undefined":t.toString();Ln.default.formatters.c=t=>t==null?"undefined":t.toString();Ln.default.formatters.k=t=>t==null?"undefined":t.toString();Ln.default.formatters.a=t=>t==null?"undefined":t.toString();function ype(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function jt(t){let e=ype(`${t}:trace`);return Ln.default.enabled(`${t}:trace`)&&Ln.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,Ln.default)(`${t}:trace`)),Object.assign((0,Ln.default)(t),{error:(0,Ln.default)(`${t}:error`),trace:e})}var F4={};T(F4,{base10:()=>bpe});var bpe=ua({prefix:"9",name:"base10",alphabet:"0123456789"});var V4={};T(V4,{base16:()=>wpe,base16upper:()=>xpe});var wpe=Rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xpe=Rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var z4={};T(z4,{base2:()=>Epe});var Epe=Rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var $4={};T($4,{base256emoji:()=>Tpe});var b9=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),vpe=b9.reduce((t,e,r)=>(t[r]=e,t),[]),Spe=b9.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Ape(t){return t.reduce((e,r)=>(e+=vpe[r],e),"")}function Cpe(t){let e=[];for(let r of t){let n=Spe[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Tpe=df({prefix:"\u{1F680}",name:"base256emoji",encode:Ape,decode:Cpe});var K4={};T(K4,{base36:()=>_pe,base36upper:()=>Ipe});var _pe=ua({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ipe=ua({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var q4={};T(q4,{base8:()=>Dpe});var Dpe=Rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var H4={};T(H4,{identity:()=>Rpe});var Rpe=df({prefix:"\0",name:"identity",encode:t=>m9(t),decode:t=>p9(t)});var ije=new TextEncoder,aje=new TextDecoder;var W4={};T(W4,{identity:()=>_y});var Ppe=E9,w9=128,Npe=127,Ope=~Npe,Upe=Math.pow(2,31);function E9(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Upe;)e[r++]=t&255|w9,t/=128;for(;t&Ope;)e[r++]=t&255|w9,t>>>=7;return e[r]=t|0,E9.bytes=r-n+1,e}var kpe=G4,Mpe=128,x9=127;function G4(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw G4.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&x9)<<o:(i&x9)*Math.pow(2,o),o+=7}while(i>=Mpe);return G4.bytes=s-n,r}var Fpe=Math.pow(2,7),Vpe=Math.pow(2,14),zpe=Math.pow(2,21),$pe=Math.pow(2,28),Kpe=Math.pow(2,35),qpe=Math.pow(2,42),Hpe=Math.pow(2,49),Gpe=Math.pow(2,56),Wpe=Math.pow(2,63),jpe=function(t){return t<Fpe?1:t<Vpe?2:t<zpe?3:t<$pe?4:t<Kpe?5:t<qpe?6:t<Hpe?7:t<Gpe?8:t<Wpe?9:10},Ype={encode:Ppe,decode:kpe,encodingLength:jpe},Qpe=Ype,xp=Qpe;var Ep=(t,e=0)=>[xp.decode(t,e),xp.decode.bytes],pf=(t,e,r=0)=>(xp.encode(t,e,r),e),mf=t=>xp.encodingLength(t);var la=(t,e)=>{let r=e.byteLength,n=mf(t),o=n+mf(r),s=new Uint8Array(o+r);return pf(t,s,0),pf(r,s,n),s.set(e,o),new gf(t,r,e,s)},gc=t=>{let e=Xs(t),[r,n]=Ep(e),[o,s]=Ep(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new gf(r,o,i,e)},v9=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&d9(t.bytes,r.bytes)}},gf=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var S9=0,Xpe="identity",A9=Xs,Jpe=t=>la(S9,A9(t)),_y={code:S9,name:Xpe,encode:A9,digest:Jpe};var Q4={};T(Q4,{sha256:()=>Iy,sha512:()=>Zpe});var Y4=({name:t,code:e,encode:r})=>new j4(t,e,r),j4=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?la(this.code,r):r.then(n=>la(this.code,n))}else throw Error("Unknown type, must be binary type")}};var T9=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Iy=Y4({name:"sha2-256",code:18,encode:T9("SHA-256")}),Zpe=Y4({name:"sha2-512",code:19,encode:T9("SHA-512")});var _9=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return t0e(r,X4(t),e||rr.encoder);default:return r0e(r,X4(t),e||xo.encoder)}};var I9=new WeakMap,X4=t=>{let e=I9.get(t);if(e==null){let r=new Map;return I9.set(t,r),r}return e},Ge=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==vp)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==n0e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ge.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=la(e,r);return Ge.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ge.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&v9(e.multihash,n.multihash)}toString(e){return _9(this,e)}toJSON(){return{"/":_9(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof Ge)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new Ge(n,o,s,i||D9(n,o,s.bytes))}else if(r[o0e]===!0){let{version:n,multihash:o,code:s}=r,i=gc(o);return Ge.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==vp)throw new Error(`Version 0 CID must use dag-pb (code: ${vp}) block encoding`);return new Ge(e,r,n,n.bytes)}case 1:{let o=D9(e,r,n.bytes);return new Ge(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return Ge.create(0,vp,e)}static createV1(e,r){return Ge.create(1,e,r)}static decode(e){let[r,n]=Ge.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Ge.inspectBytes(e),n=r.size-r.multihashSize,o=Xs(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new gf(r.multihashCode,r.digestSize,s,o);return[r.version===0?Ge.createV0(i):Ge.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Ep(e.subarray(r));return r+=p,h},o=n(),s=vp;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=e0e(e,r),s=Ge.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return X4(s).set(n,e),s}},e0e=(t,e)=>{switch(t[0]){case"Q":{let r=e||rr;return[rr.prefix,r.decode(`${rr.prefix}${t}`)]}case rr.prefix:{let r=e||rr;return[rr.prefix,r.decode(t)]}case xo.prefix:{let r=e||xo;return[xo.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},t0e=(t,e,r)=>{let{prefix:n}=r;if(n!==rr.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},r0e=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},vp=112,n0e=18,D9=(t,e,r)=>{let n=mf(t),o=n+mf(e),s=new Uint8Array(o+r.byteLength);return pf(t,s,0),pf(e,s,n),s.set(r,o),s},o0e=Symbol.for("@ipld/js-cid/CID");var Ho={...H4,...z4,...q4,...F4,...V4,...O4,...K4,...U4,...M4,...$4},Sje={...Q4,...W4};function Sp(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var s0e=Symbol.for("nodejs.util.inspect.custom"),R9=Object.values(Ho).map(t=>t.decoder).reduce((t,e)=>t.or(e),Ho.identity.decoder),L9=114,B9=36,P9=37,Ap=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[gr]=!0;toString(){return this.string==null&&(this.string=rr.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Ge.createV1(L9,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Sp(this.multihash.bytes,e);if(typeof e=="string")return bc(e).equals(this);if(e?.multihash?.bytes!=null)return Sp(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[s0e](){return`PeerId(${this.toString()})`}},Cp=class extends Ap{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Tp=class extends Ap{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},_p=class extends Ap{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function bc(t,e){if(e=e??R9,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=gc(rr.decode(`z${t}`));return t.startsWith("12D")?new Tp({multihash:r}):t.startsWith("16U")?new _p({multihash:r}):new Cp({multihash:r})}return i0e(R9.decode(t))}function i0e(t){try{let e=gc(t);if(e.code===_y.code){if(e.digest.length===B9)return new Tp({multihash:e});if(e.digest.length===P9)return new _p({multihash:e})}if(e.code===Iy.code)return new Cp({multihash:e})}catch{return a0e(Ge.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function a0e(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==L9)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Iy.code)return new Cp({multihash:t.multihash});if(e.code===_y.code){if(e.digest.length===B9)return new Tp({multihash:t.multihash});if(e.digest.length===P9)return new _p({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}function yf(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Dy(t=0){return globalThis.Buffer?.allocUnsafe!=null?yf(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function O9(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var N9=O9("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),J4=O9("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Dy(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),u0e={utf8:N9,"utf-8":N9,hex:Ho.base16,latin1:J4,ascii:J4,binary:J4,...Ho},Ry=u0e;function sn(t,e="utf8"){let r=Ry[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Eo(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=Dy(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return yf(r)}function bf(t,e="utf8"){let r=Ry[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?yf(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var U9=cr,l0e=ur,Z4=function(t){let e=0;if(t=t.toString().trim(),U9(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(l0e(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let s=U9(r[n]),i;s&&(i=Z4(r[n]),r[n]=sn(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,sn(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let o=new Uint8Array(e+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);o[e++]=s>>8&255,o[e++]=s&255}return o}throw new Error("invalid ip address")},k9=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let o=[];for(let s=0;s<r;s++)o.push(t[e+s]);return o.join(".")}if(r===16){let o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(e+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var wf={},e3={},h0e=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];h0e.forEach(t=>{let e=d0e(...t);e3[e.code]=e,wf[e.name]=e});function d0e(t,e,r,n,o){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(o)}}function Me(t){if(typeof t=="number"){if(e3[t]!=null)return e3[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(wf[t]!=null)return wf[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var aYe=Me("ip4"),cYe=Me("ip6"),uYe=Me("ipcidr");function r3(t,e){switch(Me(t).code){case 4:case 41:return m0e(e);case 42:return V9(e);case 6:case 273:case 33:case 132:return $9(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return V9(e);case 421:return w0e(e);case 444:return z9(e);case 445:return z9(e);case 466:return b0e(e);default:return sn(e,"base16")}}function n3(t,e){switch(Me(t).code){case 4:return M9(e);case 41:return M9(e);case 42:return F9(e);case 6:case 273:case 33:case 132:return o3(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return F9(e);case 421:return g0e(e);case 444:return x0e(e);case 445:return E0e(e);case 466:return y0e(e);default:return bf(e,"base16")}}var t3=Object.values(Ho).map(t=>t.decoder),p0e=function(){let t=t3[0].or(t3[1]);return t3.slice(2).forEach(e=>t=t.or(e)),t}();function M9(t){if(!xe(t))throw new Error("invalid ip address");return Z4(t)}function m0e(t){let e=k9(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!xe(e))throw new Error("invalid ip address");return e}function o3(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function $9(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function F9(t){let e=bf(t),r=Uint8Array.from(re(e.length));return Eo([r,e],r.length+e.length)}function V9(t){let e=te(t);if(t=t.slice(X(e)),t.length!==e)throw new Error("inconsistent lengths");return sn(t)}function g0e(t){let e;t[0]==="Q"||t[0]==="1"?e=gc(rr.decode(`z${t}`)).bytes:e=Ge.parse(t).multihash.bytes;let r=Uint8Array.from(re(e.length));return Eo([r,e],r.length+e.length)}function y0e(t){let e=p0e.decode(t),r=Uint8Array.from(re(e.length));return Eo([r,e],r.length+e.length)}function b0e(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+sn(r,"base64url")}function w0e(t){let e=te(t),r=t.slice(X(e));if(r.length!==e)throw new Error("inconsistent lengths");return sn(r,"base58btc")}function x0e(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=xo.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=o3(n);return Eo([r,o],r.length+o.length)}function E0e(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=xo.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=o3(n);return Eo([r,o],r.length+o.length)}function z9(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=sn(e,"base32"),o=$9(r);return`${n}:${o}`}function K9(t){t=s3(t);let e=[],r=[],n=null,o=t.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=Me(i);if(a.size===0){e.push([a.code]),r.push([a.code]);continue}if(s++,s>=o.length)throw H9("invalid address: "+t);if(a.path===!0){n=s3(o.slice(s).join("/")),e.push([a.code,n3(a.code,n)]),r.push([a.code,n]);break}let c=n3(a.code,o[s]);e.push([a.code,c]),r.push([a.code,r3(a.code,c)])}return{string:q9(r),bytes:a3(e),tuples:e,stringTuples:r,path:n}}function i3(t){let e=[],r=[],n=null,o=0;for(;o<t.length;){let s=te(t,o),i=X(s),a=Me(s),c=v0e(a,t.slice(o+i));if(c===0){e.push([s]),r.push([s]),o+=i;continue}let u=t.slice(o+i,o+i+c);if(o+=c+i,o>t.length)throw H9("Invalid address Uint8Array: "+sn(t,"base16"));e.push([s,u]);let l=r3(s,u);if(r.push([s,l]),a.path===!0){n=l;break}}return{bytes:Uint8Array.from(t),string:q9(r),tuples:e,stringTuples:r,path:n}}function q9(t){let e=[];return t.map(r=>{let n=Me(r[0]);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),s3(e.join("/"))}function a3(t){return Eo(t.map(e=>{let r=Me(e[0]),n=Uint8Array.from(re(r.code));return e.length>1&&e[1]!=null&&(n=Eo([n,e[1]])),n}))}function v0e(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{let r=te(e instanceof Uint8Array?e:Uint8Array.from(e));return r+X(r)}}function s3(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function H9(t){return new Error("Error parsing address: "+t)}var S0e=Symbol.for("nodejs.util.inspect.custom"),A0e=[Me("dns").code,Me("dns4").code,Me("dns6").code,Me("dnsaddr").code],C0e=new Map,G9=Symbol.for("@multiformats/js-multiaddr/multiaddr");function T0e(t){return Boolean(t?.[G9])}var Js=class{bytes;#e;#t;#r;#n;[G9]=!0;constructor(e){e==null&&(e="");let r;if(e instanceof Uint8Array)r=i3(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);r=K9(e)}else if(T0e(e))r=i3(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,this.#e=r.string,this.#t=r.tuples,this.#r=r.stringTuples,this.#n=r.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let e,r,n,o,s="",i=Me("tcp"),a=Me("udp"),c=Me("ip4"),u=Me("ip6"),l=Me("dns6"),h=Me("ip6zone");for(let[m,f]of this.stringTuples())m===h.code&&(s=`%${f??""}`),A0e.includes(m)&&(r=i.name,o=443,n=`${f??""}${s}`,e=m===l.code?6:4),(m===i.code||m===a.code)&&(r=Me(m).name,o=parseInt(f??"")),(m===c.code||m===u.code)&&(r=Me(m).name,n=`${f??""}${s}`,e=m===u.code?6:4);if(e==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:o}}protos(){return this.#t.map(([e])=>Object.assign({},Me(e)))}protoCodes(){return this.#t.map(([e])=>e)}protoNames(){return this.#t.map(([e])=>Me(e).name)}tuples(){return this.#t}stringTuples(){return this.#r}encapsulate(e){return e=new Js(e),new Js(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Js(n.slice(0,o))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Js(a3(r.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach(([n,o])=>{n===wf.p2p.code&&e.push([n,o]),n===wf["p2p-circuit"].code&&(e=[])});let r=e.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?sn(rr.decode(`z${n}`),"base58btc"):sn(Ge.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(e){return Sp(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=C0e.get(r.name);if(n==null)throw new C(`no available resolver for ${r.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new Js(s))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[S0e](){return`Multiaddr(${this.#e})`}};function wc(t){return new Js(t)}var Bn;(function(t){t.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",t.ERR_DATA_CHANNEL="ERR_DATA_CHANNEL",t.ERR_CONNECTION_CLOSED="ERR_CONNECTION_CLOSED",t.ERR_HASH_NOT_SUPPORTED="ERR_HASH_NOT_SUPPORTED",t.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",t.ERR_INVALID_FINGERPRINT="ERR_INVALID_FINGERPRINT",t.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",t.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",t.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",t.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS"})(Bn||(Bn={}));var fa=class extends C{constructor(e,r){super(`WebRTC transport error: ${e}`,r??""),this.name="WebRTCTransportError"}};var c3=class extends fa{constructor(e,r){super(`[stream: ${e}] data channel error: ${r}`,Bn.ERR_DATA_CHANNEL),this.name="WebRTC/DataChannelError"}};function p3(t,e){return new c3(t,e)}var u3=class extends fa{constructor(e){super(`There was a problem with the Multiaddr which was passed in: ${e}`,Bn.ERR_INVALID_MULTIADDR),this.name="WebRTC/InappropriateMultiaddrError"}};function Ly(t){return new u3(t)}var l3=class extends fa{constructor(e){super(`There was a problem with a provided argument: ${e}`,Bn.ERR_INVALID_PARAMETERS),this.name="WebRTC/InvalidArgumentError"}};function Ip(t){return new l3(t)}var f3=class extends fa{constructor(e,r){super(`Invalid fingerprint "${e}" within ${r}`,Bn.ERR_INVALID_FINGERPRINT),this.name="WebRTC/InvalidFingerprintError"}};function m3(t,e){return new f3(t,e)}var h3=class extends fa{constructor(e){super(`A method (${e}) was called though it has been intentionally left unimplemented.`,Bn.ERR_NOT_IMPLEMENTED),this.name="WebRTC/UnimplementedError"}};function W9(t){return new h3(t)}var d3=class extends fa{constructor(e){super(`unsupported hash algorithm: ${e}`,Bn.ERR_HASH_NOT_SUPPORTED),this.name="WebRTC/UnsupportedHashAlgorithmError"}};function j9(t){return new d3(t)}var Y9=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},_0e=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}();var I0e=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}();var D0e=function(){function t(e,r,n,o){this.name=e,this.version=r,this.os=n,this.bot=o,this.type="bot-device"}return t}();var R0e=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}();var L0e=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}();var B0e=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,P0e=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Q9=3,N0e=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",B0e]],X9=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Z9(t){return t?J9(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new L0e:typeof navigator<"u"?J9(navigator.userAgent):k0e()}function O0e(t){return t!==""&&N0e.reduce(function(e,r){var n=r[0],o=r[1];if(e)return e;var s=o.exec(t);return!!s&&[n,s]},!1)}function J9(t){var e=O0e(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new R0e;var o=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);o?o.length<Q9&&(o=Y9(Y9([],o,!0),M0e(Q9-o.length),!0)):o=[];var s=o.join("."),i=U0e(t),a=P0e.exec(t);return a&&a[1]?new D0e(r,s,i,a[1]):new _0e(r,s,i)}function U0e(t){for(var e=0,r=X9.length;e<r;e++){var n=X9[e],o=n[0],s=n[1],i=s.exec(t);if(i)return o}return null}function k0e(){var t=typeof process<"u"&&process.version;return t?new I0e(process.version.slice(1)):null}function M0e(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var g3=jt("libp2p:webrtc:utils"),eF=Z9(),Dp=eF!=null&&eF.name==="firefox",By=async function*(){},Py=async t=>{},F0e=30*1e3;function y3(t,e,r=F0e){t.readyState==="open"&&Promise.resolve().then(async()=>{if(t.bufferedAmount>0){g3("%s drain channel with %d buffered bytes",e,t.bufferedAmount);let n=ze(),o=!1;t.bufferedAmountLowThreshold=0;let s=()=>{o||(g3("%s drain channel closed before drain",e),n.resolve())};t.addEventListener("close",s,{once:!0}),t.addEventListener("bufferedamountlow",()=>{o=!0,t.removeEventListener("close",s),n.resolve()}),await _s(n.promise,{milliseconds:r})}}).then(async()=>{t.readyState==="open"&&t.close()}).catch(n=>{g3.error("error closing outbound stream",n)})}var b3=jt("libp2p:webrtc:maconn"),xc=class{peerConnection;remoteAddr;timeline;metrics;source=By();sink=Py;constructor(e){this.remoteAddr=e.remoteAddr,this.timeline=e.timeline,this.peerConnection=e.peerConnection;let r=this.peerConnection.connectionState;this.peerConnection.onconnectionstatechange=()=>{b3.trace("peer connection state change",this.peerConnection.connectionState,"initial state",r),(this.peerConnection.connectionState==="disconnected"||this.peerConnection.connectionState==="failed"||this.peerConnection.connectionState==="closed")&&(this.timeline.close=Date.now())}}async close(e){b3.trace("closing connection"),this.peerConnection.close(),this.timeline.close=Date.now(),this.metrics?.increment({close:!0})}abort(e){b3.error("closing connection due to error",e),this.peerConnection.close(),this.timeline.close=Date.now(),this.metrics?.increment({abort:!0})}};var xf=class extends Error{type;code;constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};async function Ec(t,e,r){if(e==null)return t;if(e.aborted)return Promise.reject(new xf(r?.errorMessage,r?.errorCode));let n,o=new xf(r?.errorMessage,r?.errorCode);try{return await Promise.race([t,new Promise((s,i)=>{n=()=>{i(o)},e.addEventListener("abort",n)})])}finally{n!=null&&e.removeEventListener("abort",n)}}var V0e="ERR_STREAM_RESET",z0e="ERR_SINK_INVALID_STATE",$0e=5e3;function w3(t){return t!=null&&typeof t.then=="function"}var Ef=class{id;direction;timeline;protocol;metadata;source;status;readStatus;writeStatus;sinkController;sinkEnd;endErr;streamSource;onEnd;onCloseRead;onCloseWrite;onReset;onAbort;sendCloseWriteTimeout;log;constructor(e){this.sinkController=new AbortController,this.sinkEnd=ze(),this.log=e.log,this.status="open",this.readStatus="ready",this.writeStatus="ready",this.id=e.id,this.metadata=e.metadata??{},this.direction=e.direction,this.timeline={open:Date.now()},this.sendCloseWriteTimeout=e.sendCloseWriteTimeout??$0e,this.onEnd=e.onEnd,this.onCloseRead=e?.onCloseRead,this.onCloseWrite=e?.onCloseWrite,this.onReset=e?.onReset,this.onAbort=e?.onAbort,this.source=this.streamSource=Je({onEnd:r=>{r!=null?this.log.trace("source ended with error",r):this.log.trace("source ended"),this.onSourceEnd(r)}}),this.sink=this.sink.bind(this)}async sink(e){if(this.writeStatus!=="ready")throw new C(`writable end state is "${this.writeStatus}" not "ready"`,z0e);try{this.writeStatus="writing";let r={signal:this.sinkController.signal};if(this.direction==="outbound"){let n=this.sendNewStream(r);w3(n)&&await n}e=go(e,this.sinkController.signal,{returnOnAbort:!0}),this.log.trace("sink reading from source");for await(let n of e){n=n instanceof Uint8Array?new ue(n):n;let o=this.sendData(n,r);w3(o)&&await o}this.log.trace('sink finished reading from source, write status is "%s"',this.writeStatus),this.writeStatus==="writing"&&(this.writeStatus="closing",this.log.trace("send close write to remote"),await this.sendCloseWrite({signal:AbortSignal.timeout(this.sendCloseWriteTimeout)}),this.writeStatus="closed"),this.onSinkEnd()}catch(r){throw this.log.trace("sink ended with error, calling abort with error",r),this.abort(r),r}finally{this.log.trace("resolve sink end"),this.sinkEnd.resolve()}}onSourceEnd(e){this.timeline.closeRead==null&&(this.timeline.closeRead=Date.now(),this.readStatus="closed",e!=null&&this.endErr==null&&(this.endErr=e),this.onCloseRead?.(),this.timeline.closeWrite!=null?(this.log.trace("source and sink ended"),this.timeline.close=Date.now(),this.status!=="aborted"&&this.status!=="reset"&&(this.status="closed"),this.onEnd!=null&&this.onEnd(this.endErr)):this.log.trace("source ended, waiting for sink to end"))}onSinkEnd(e){this.timeline.closeWrite==null&&(this.timeline.closeWrite=Date.now(),this.writeStatus="closed",e!=null&&this.endErr==null&&(this.endErr=e),this.onCloseWrite?.(),this.timeline.closeRead!=null?(this.log.trace("sink and source ended"),this.timeline.close=Date.now(),this.status!=="aborted"&&this.status!=="reset"&&(this.status="closed"),this.onEnd!=null&&this.onEnd(this.endErr)):this.log.trace("sink ended, waiting for source to end"))}async close(e){this.log.trace("closing gracefully"),this.status="closing",await Promise.all([this.closeRead(e),this.closeWrite(e)]),this.status="closed",this.log.trace("closed gracefully")}async closeRead(e={}){if(this.readStatus==="closing"||this.readStatus==="closed")return;this.log.trace('closing readable end of stream with starting read status "%s"',this.readStatus);let r=this.readStatus;this.readStatus="closing",this.status!=="reset"&&this.status!=="aborted"&&this.timeline.closeRead==null&&(this.log.trace("send close read to remote"),await this.sendCloseRead(e)),r==="ready"&&(this.log.trace("ending internal source queue"),this.streamSource.end()),this.log.trace("closed readable end of stream")}async closeWrite(e={}){this.writeStatus==="closing"||this.writeStatus==="closed"||(this.log.trace('closing writable end of stream with starting write status "%s"',this.writeStatus),this.writeStatus==="ready"&&(this.log.trace("sink was never sunk, sink an empty array"),await Ec(this.sink([]),e.signal)),this.writeStatus==="writing"&&await new Promise((r,n)=>{queueMicrotask(()=>{this.log.trace("aborting source passed to .sink"),this.sinkController.abort(),Ec(this.sinkEnd.promise,e.signal).then(r,n)})}),this.writeStatus="closed",this.log.trace("closed writable end of stream"))}abort(e){if(this.status==="closed"||this.status==="aborted"||this.status==="reset")return;this.log("abort with error",e),this.log("try to send reset to remote");let r=this.sendReset();w3(r)&&r.catch(n=>{this.log.error("error sending reset message",n)}),this.status="aborted",this.timeline.abort=Date.now(),this._closeSinkAndSource(e),this.onAbort?.(e)}reset(){if(this.status==="closed"||this.status==="aborted"||this.status==="reset")return;let e=new C("stream reset",V0e);this.status="reset",this.timeline.reset=Date.now(),this._closeSinkAndSource(e),this.onReset?.()}_closeSinkAndSource(e){this._closeSink(e),this._closeSource(e)}_closeSink(e){this.writeStatus==="writing"&&(this.log.trace("end sink source"),this.sinkController.abort()),this.onSinkEnd(e)}_closeSource(e){this.readStatus!=="closing"&&this.readStatus!=="closed"&&(this.log.trace("ending source with %d bytes to be read by consumer",this.streamSource.readableLength),this.readStatus="closing",this.streamSource.end(e))}remoteCloseWrite(){if(this.readStatus==="closing"||this.readStatus==="closed"){this.log("received remote close write but local source is already closed");return}this.log.trace("remote close write"),this._closeSource()}remoteCloseRead(){if(this.writeStatus==="closing"||this.writeStatus==="closed"){this.log("received remote close read but local sink is already closed");return}this.log.trace("remote close read"),this._closeSink()}destroy(){if(this.status==="closed"||this.status==="aborted"||this.status==="reset"){this.log("received destroy but we are already closed");return}this.log.trace("stream destroyed"),this._closeSinkAndSource()}sourcePush(e){this.streamSource.push(e)}sourceReadableLength(){return this.streamSource.readableLength}};var K0e=t=>{let e=t.on||t.addListener||t.addEventListener,r=t.off||t.removeListener||t.removeEventListener;if(!e||!r)throw new TypeError("Emitter is not compatible");return{addListener:e.bind(t),removeListener:r.bind(t)}};function q0e(t,e,r){let n,o=new Promise((s,i)=>{if(r={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...r},!(r.count>=0&&(r.count===Number.POSITIVE_INFINITY||Number.isInteger(r.count))))throw new TypeError("The `count` option should be at least 0 or more");r.signal?.throwIfAborted();let a=[e].flat(),c=[],{addListener:u,removeListener:l}=K0e(t),h=(...m)=>{let f=r.multiArgs?m:m[0];r.filter&&!r.filter(f)||(c.push(f),r.count===c.length&&(n(),s(c)))},p=m=>{n(),i(m)};n=()=>{for(let m of a)l(m,h);for(let m of r.rejectionEvents)l(m,p)};for(let m of a)u(m,h);for(let m of r.rejectionEvents)u(m,p);r.signal&&r.signal.addEventListener("abort",()=>{p(r.signal.reason)},{once:!0}),r.resolveImmediately&&s(c)});if(o.cancel=n,typeof r.timeout=="number"){let s=_s(o,{milliseconds:r.timeout});return s.cancel=n,s}return o}function tF(t,e,r){typeof r=="function"&&(r={filter:r}),r={...r,count:1,resolveImmediately:!1};let n=q0e(t,e,r),o=n.then(s=>s[0]);return o.cancel=n.cancel,o}var an;(function(t){let e;(function(o){o.FIN="FIN",o.STOP_SENDING="STOP_SENDING",o.RESET="RESET",o.FIN_ACK="FIN_ACK"})(e=t.Flag||(t.Flag={}));let r;(function(o){o[o.FIN=0]="FIN",o[o.STOP_SENDING=1]="STOP_SENDING",o[o.RESET=2]="RESET",o[o.FIN_ACK=3]="FIN_ACK"})(r||(r={})),function(o){o.codec=()=>so(r)}(e=t.Flag||(t.Flag={}));let n;t.codec=()=>(n==null&&(n=Te((o,s,i={})=>{i.lengthDelimited!==!1&&s.fork(),o.flag!=null&&(s.uint32(8),t.Flag.codec().encode(o.flag,s)),o.message!=null&&(s.uint32(18),s.bytes(o.message)),i.lengthDelimited!==!1&&s.ldelim()},(o,s)=>{let i={},a=s==null?o.len:o.pos+s;for(;o.pos<a;){let c=o.uint32();switch(c>>>3){case 1:i.flag=t.Flag.codec().decode(o);break;case 2:i.message=o.bytes();break;default:o.skipType(c&7);break}}return i})),n),t.encode=o=>Ce(o,t.codec()),t.decode=o=>Ae(o,t.codec())})(an||(an={}));var H0e=16*1024*1024,G0e=30*1e3,W0e=5,j0e=2,Y0e=16*1024,Q0e=5e3,x3=class extends Ef{channel;incomingData;messageQueue;maxBufferedAmount;bufferedAmountLowEventTimeout;maxMessageSize;receiveFinAck;finAckTimeout;constructor(e){let r=e.onEnd;switch(e.onEnd=o=>{this.log.trace("readable and writeable ends closed",this.status),Promise.resolve(async()=>{if(!(this.timeline.abort!=null||this.timeline.reset!==null))try{await _s(this.receiveFinAck.promise,{milliseconds:this.finAckTimeout})}catch(s){this.log.error("error receiving FIN_ACK",s)}}).then(()=>{this.incomingData.end(),r?.(o)}).catch(s=>{this.log.error("error ending stream",s)})},super(e),this.channel=e.channel,this.channel.binaryType="arraybuffer",this.incomingData=Je(),this.messageQueue=new ue,this.bufferedAmountLowEventTimeout=e.bufferedAmountLowEventTimeout??G0e,this.maxBufferedAmount=e.maxBufferedAmount??H0e,this.maxMessageSize=(e.maxMessageSize??Y0e)-W0e-j0e,this.receiveFinAck=ze(),this.finAckTimeout=e.closeTimeout??Q0e,this.channel.readyState){case"open":break;case"closed":case"closing":(this.timeline.close===void 0||this.timeline.close===0)&&(this.timeline.close=Date.now());break;case"connecting":break;default:throw this.log.error("unknown datachannel state %s",this.channel.readyState),new C("Unknown datachannel state","ERR_INVALID_STATE")}this.channel.onopen=o=>{this.timeline.open=new Date().getTime(),this.messageQueue!=null&&this.messageQueue.byteLength>0&&(this.log.trace("dataChannel opened, sending queued messages",this.messageQueue.byteLength,this.channel.readyState),this._sendMessage(this.messageQueue).catch(s=>{this.log.error("error sending queued messages",s),this.abort(s)})),this.messageQueue=void 0},this.channel.onclose=o=>{this.receiveFinAck.resolve(),this.close().catch(s=>{this.log.error("error closing stream after channel closed",s)})},this.channel.onerror=o=>{let s=o.error;this.abort(s)},this.channel.onmessage=async o=>{let{data:s}=o;s===null||s.byteLength===0||this.incomingData.push(new Uint8Array(s,0,s.byteLength))};let n=this;Promise.resolve().then(async()=>{for await(let o of yo(this.incomingData)){let s=n.processIncomingProtobuf(o);s!=null&&n.sourcePush(new ue(s))}}).catch(o=>{this.log.error("error processing incoming data channel messages",o)})}sendNewStream(){}async _sendMessage(e,r=!0){if(r&&this.channel.bufferedAmount>this.maxBufferedAmount)try{await tF(this.channel,"bufferedamountlow",{timeout:this.bufferedAmountLowEventTimeout})}catch(n){throw n instanceof cl?new C(`Timed out waiting for DataChannel buffer to clear after ${this.bufferedAmountLowEventTimeout}ms`,"ERR_BUFFER_CLEAR_TIMEOUT"):n}if(this.channel.readyState==="closed"||this.channel.readyState==="closing")throw new C(`Invalid datachannel state - ${this.channel.readyState}`,"ERR_INVALID_STATE");if(this.channel.readyState==="open")for(let n of e)this.channel.send(n);else if(this.channel.readyState==="connecting")this.messageQueue==null&&(this.messageQueue=new ue),this.messageQueue.append(e);else throw this.log.error("unknown datachannel state %s",this.channel.readyState),new C("Unknown datachannel state","ERR_INVALID_STATE")}async sendData(e){for(e=e.sublist();e.byteLength>0;){let r=Math.min(e.byteLength,this.maxMessageSize),n=e.subarray(0,r),o=an.encode({message:n}),s=Fs.single(o);await this._sendMessage(s),e.consume(r)}}async sendReset(){await this._sendFlag(an.Flag.RESET)}async sendCloseWrite(e){if(await this._sendFlag(an.Flag.FIN)){this.log.trace("awaiting FIN_ACK");try{await Ec(this.receiveFinAck.promise,e?.signal,{errorMessage:"sending close-write was aborted before FIN_ACK was received",errorCode:"ERR_FIN_ACK_NOT_RECEIVED"})}catch(n){this.log.error("failed to await FIN_ACK",n)}}else this.log.trace("sending FIN failed, not awaiting FIN_ACK");this.receiveFinAck.resolve()}async sendCloseRead(){await this._sendFlag(an.Flag.STOP_SENDING)}processIncomingProtobuf(e){let r=an.decode(e);if(r.flag!==void 0&&(this.log.trace('incoming flag %s, write status "%s", read status "%s"',r.flag,this.writeStatus,this.readStatus),r.flag===an.Flag.FIN&&(this.remoteCloseWrite(),this.log.trace("sending FIN_ACK"),this._sendFlag(an.Flag.FIN_ACK).catch(n=>{this.log.error("error sending FIN_ACK immediately",n)})),r.flag===an.Flag.RESET&&this.reset(),r.flag===an.Flag.STOP_SENDING&&this.remoteCloseRead(),r.flag===an.Flag.FIN_ACK&&(this.log.trace("received FIN_ACK"),this.receiveFinAck.resolve())),this.readStatus==="ready")return r.message}async _sendFlag(e){if(this.channel.readyState!=="open")return this.log.trace("not sending flag %s because channel is not open",e.toString()),!1;this.log.trace("sending flag %s",e.toString());let r=an.encode({flag:e}),n=Fs.single(r);try{return await this._sendMessage(n,!1),!0}catch(o){this.log.error("could not send flag %s",e.toString(),o)}return!1}};function vf(t){let{channel:e,direction:r}=t;return new x3({id:r==="inbound"?`i${e.id}`:`r${e.id}`,log:jt(`libp2p:webrtc:stream:${r}:${e.id}`),...t})}var rF=jt("libp2p:webrtc:muxer"),nF="/webrtc",vc=class{protocol;peerConnection;streamBuffer=[];metrics;dataChannelOptions;constructor(e){this.peerConnection=e.peerConnection,this.metrics=e.metrics,this.protocol=e.protocol??nF,this.dataChannelOptions=e.dataChannelOptions??{},this.peerConnection.ondatachannel=({channel:r})=>{let n=vf({channel:r,direction:"inbound",onEnd:()=>{this.streamBuffer=this.streamBuffer.filter(o=>o.id!==n.id)},...this.dataChannelOptions});this.streamBuffer.push(n)}}createStreamMuxer(e){return new E3({...e,peerConnection:this.peerConnection,dataChannelOptions:this.dataChannelOptions,metrics:this.metrics,streams:this.streamBuffer,protocol:this.protocol})}},E3=class{init;streams;protocol;peerConnection;dataChannelOptions;metrics;constructor(e){this.init=e,this.streams=e.streams,this.peerConnection=e.peerConnection,this.protocol=e.protocol??nF,this.metrics=e.metrics,this.dataChannelOptions=e.dataChannelOptions??{},this.peerConnection.ondatachannel=({channel:n})=>{let o=vf({channel:n,direction:"inbound",onEnd:()=>{rF.trace("stream %s %s %s onEnd",o.direction,o.id,o.protocol),y3(n,`inbound ${o.id} ${o.protocol}`,this.dataChannelOptions.drainTimeout),this.streams=this.streams.filter(s=>s.id!==o.id),this.metrics?.increment({stream_end:!0}),e?.onStreamEnd?.(o)},...this.dataChannelOptions});this.streams.push(o),this.metrics?.increment({incoming_stream:!0}),e?.onIncomingStream?.(o)};let r=e?.onIncomingStream;r!=null&&this.streams.forEach(n=>{r(n)})}async close(e){try{await Promise.all(this.streams.map(async r=>r.close(e)))}catch(r){this.abort(r)}}abort(e){for(let r of this.streams)r.abort(e)}source=By();sink=Py;newStream(){let e=this.peerConnection.createDataChannel(""),r=vf({channel:e,direction:"outbound",onEnd:()=>{rF.trace("stream %s %s %s onEnd",r.direction,r.id,r.protocol),y3(e,`outbound ${r.id} ${r.protocol}`,this.dataChannelOptions.drainTimeout),this.streams=this.streams.filter(n=>n.id!==r.id),this.metrics?.increment({stream_end:!0}),this.init?.onStreamEnd?.(r)},...this.dataChannelOptions});return this.streams.push(r),this.metrics?.increment({outgoing_stream:!0}),r}};var Sf=globalThis.RTCPeerConnection,Ny=globalThis.RTCSessionDescription,oF=globalThis.RTCIceCandidate;var Gr;(function(t){let e;(function(o){o.SDP_OFFER="SDP_OFFER",o.SDP_ANSWER="SDP_ANSWER",o.ICE_CANDIDATE="ICE_CANDIDATE"})(e=t.Type||(t.Type={}));let r;(function(o){o[o.SDP_OFFER=0]="SDP_OFFER",o[o.SDP_ANSWER=1]="SDP_ANSWER",o[o.ICE_CANDIDATE=2]="ICE_CANDIDATE"})(r||(r={})),function(o){o.codec=()=>so(r)}(e=t.Type||(t.Type={}));let n;t.codec=()=>(n==null&&(n=Te((o,s,i={})=>{i.lengthDelimited!==!1&&s.fork(),o.type!=null&&(s.uint32(8),t.Type.codec().encode(o.type,s)),o.data!=null&&(s.uint32(18),s.string(o.data)),i.lengthDelimited!==!1&&s.ldelim()},(o,s)=>{let i={},a=s==null?o.len:o.pos+s;for(;o.pos<a;){let c=o.uint32();switch(c>>>3){case 1:i.type=t.Type.codec().decode(o);break;case 2:i.data=o.string();break;default:o.skipType(c&7);break}}return i})),n),t.encode=o=>Ce(o,t.codec()),t.decode=o=>Ae(o,t.codec())})(Gr||(Gr={}));var Sc=jt("libp2p:webrtc:peer:util"),Oy=async(t,e,r,n)=>{let o=new AbortController;t.promise.then(()=>{o.abort()},()=>{o.abort()});let s=Zi([o.signal,n.signal]),i=go(r.unwrap().unwrap().source,s,{returnOnAbort:!0});try{for await(let a of yo(i)){let c=Gr.decode(a);if(c.type!==Gr.Type.ICE_CANDIDATE)throw new C("ICE candidate message expected","ERR_NOT_ICE_CANDIDATE");let u=JSON.parse(c.data??"null");u===""&&(Sc.trace("end-of-candidates for this generation received"),u={candidate:"",sdpMid:"0",sdpMLineIndex:0}),u===null&&(Sc.trace("end-of-candidates received"),u={candidate:null,sdpMid:"0",sdpMLineIndex:0});let l=new oF(u);Sc.trace("%s received new ICE candidate",n.direction,l);try{await e.addIceCandidate(l)}catch(h){Sc.error("%s bad candidate received",n.direction,h)}}}catch(a){Sc.error("%s error parsing ICE candidate",n.direction,a)}finally{s.clear()}if(n.signal?.aborted===!0)throw new xf("Aborted while reading ICE candidates","ERR_ICE_CANDIDATES_READ_ABORTED");await Ec(t.promise,n.signal,{errorMessage:"Aborted before connected",errorCode:"ERR_ABORTED_BEFORE_CONNECTED"})};function Uy(t,e){t[Dp?"oniceconnectionstatechange":"onconnectionstatechange"]=r=>{switch(Sc.trace("receiver peerConnectionState state change: %s",t.connectionState),Dp?t.iceConnectionState:t.connectionState){case"connected":e.resolve();break;case"failed":case"disconnected":case"closed":e.reject(new C("RTCPeerConnection was closed","ERR_CONNECTION_CLOSED_BEFORE_CONNECTED"));break;default:break}}}function ky(t){let e=t.split(`\r
`).filter(n=>n.startsWith("a=candidate")).pop(),r=e?.split(" ");return e==null||r==null||r.length<5?(Sc("could not parse remote address from",e),"/webrtc"):`/dnsaddr/${r[4]}/${r[2].toLowerCase()}/${r[5]}/webrtc`}var jn=jt("libp2p:webrtc:initiate-connection");async function sF({peerConnection:t,signal:e,metrics:r,multiaddr:n,connectionManager:o,transportManager:s}){let{baseAddr:i,peerId:a}=iF(n);r?.dialerEvents.increment({open:!0}),jn.trace("dialing base address: %a",i);let c=i.getPeerId();if(c==null)throw new C("Relay peer was missing","ERR_INVALID_ADDRESS");let u=o.getConnections(bc(c)),l,h=!1;u.length===0?(l=await s.dial(i,{signal:e}),h=!0):l=u[0];try{let p=await l.newStream(My,{signal:e,runOnTransientConnection:!0}),m=Sr(p).pb(Gr),f=ze(),d=()=>{f.reject(new C("SDP handshake aborted","ERR_SDP_HANDSHAKE_ABORTED"))};try{Uy(t,f),e?.addEventListener("abort",d);let g=t.createDataChannel("init");t.onicecandidate=({candidate:E})=>{let S=JSON.stringify(E?.toJSON()??null);jn.trace("initiator sending ICE candidate %s",S),m.write({type:Gr.Type.ICE_CANDIDATE,data:S},{signal:e}).catch(v=>{jn.error("error sending ICE candidate",v)})},t.onicecandidateerror=E=>{jn("initiator ICE candidate error",E)};let y=await t.createOffer();jn.trace("initiator send SDP offer %s",y.sdp),await m.write({type:Gr.Type.SDP_OFFER,data:y.sdp},{signal:e}),await t.setLocalDescription(y).catch(E=>{throw jn.error("could not execute setLocalDescription",E),new C("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")});let b=await m.read({signal:e});if(b.type!==Gr.Type.SDP_ANSWER)throw new C("remote should send an SDP answer","ERR_SDP_HANDSHAKE_FAILED");jn.trace("initiator receive SDP answer %s",b.data);let w=new Ny({type:"answer",sdp:b.data});await t.setRemoteDescription(w).catch(E=>{throw jn.error("could not execute setRemoteDescription",E),new C("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")}),jn.trace("initiator read candidates until connected"),await Oy(f,t,m,{direction:"initiator",signal:e}),jn.trace("initiator connected, closing init channel"),g.close(),jn.trace("initiator closing signalling stream"),await m.unwrap().unwrap().close({signal:e});let x=ky(t.currentRemoteDescription?.sdp??"");return jn.trace("initiator connected to remote address %s",x),{remoteAddress:wc(x).encapsulate(`/p2p/${a.toString()}`)}}catch(g){throw t.close(),p.abort(g),g}finally{e?.removeEventListener("abort",d),t.onicecandidate=null,t.onicecandidateerror=null}}finally{if(h)try{await l.close({signal:e})}catch(p){l.abort(p)}}}var Fy=class extends mr{peerId;transportManager;shutdownController;constructor(e,r){super(),this.peerId=e.peerId,this.transportManager=e.transportManager,this.shutdownController=r.shutdownController}async listen(){this.safeDispatchEvent("listening",{})}getAddrs(){return this.transportManager.getListeners().filter(e=>e!==this).map(e=>e.getAddrs().filter(r=>bo.matches(r)).map(r=>r.encapsulate(`/webrtc/p2p/${this.peerId}`))).flat()}async close(){this.shutdownController.abort(),this.safeDispatchEvent("close",{})}};var Pn=jt("libp2p:webrtc:signaling-stream-handler");async function aF({peerConnection:t,stream:e,signal:r,connection:n}){Pn.trace("new inbound signaling stream");let o=Sr(e).pb(Gr);try{let i=ze(),a=ze();r.onabort=()=>{i.reject(new C("Timed out while trying to connect","ERR_TIMEOUT"))},t.onicecandidate=({candidate:h})=>{a.promise.then(async()=>{let p=JSON.stringify(h?.toJSON()??null);Pn.trace("recipient sending ICE candidate %s",p),await o.write({type:Gr.Type.ICE_CANDIDATE,data:p},{signal:r})},p=>{Pn.error("cannot set candidate since sending answer failed",p),i.reject(p)})},Uy(t,i);let c=await o.read({signal:r});if(c.type!==Gr.Type.SDP_OFFER)throw new C(`expected message type SDP_OFFER, received: ${c.type??"undefined"} `,"ERR_SDP_HANDSHAKE_FAILED");Pn.trace("recipient receive SDP offer %s",c.data);let u=new Ny({type:"offer",sdp:c.data});await t.setRemoteDescription(u).catch(h=>{throw Pn.error("could not execute setRemoteDescription",h),new C("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")});let l=await t.createAnswer().catch(h=>{throw Pn.error("could not execute createAnswer",h),a.reject(h),new C("Failed to create answer","ERR_SDP_HANDSHAKE_FAILED")});Pn.trace("recipient send SDP answer %s",l.sdp),await o.write({type:Gr.Type.SDP_ANSWER,data:l.sdp},{signal:r}),await t.setLocalDescription(l).catch(h=>{throw Pn.error("could not execute setLocalDescription",h),a.reject(h),new C("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")}),a.resolve(),Pn.trace("recipient read candidates until connected"),await Oy(i,t,o,{direction:"recipient",signal:r}),Pn.trace("recipient connected, closing signaling stream"),await o.unwrap().unwrap().close({signal:r})}catch(i){if(t.connectionState!=="connected")throw Pn.error("error while handling signaling stream from peer %a",n.remoteAddr,i),t.close(),i;Pn("error while handling signaling stream from peer %a, ignoring as the RTCPeerConnection is already connected",n.remoteAddr,i)}let s=ky(t.currentRemoteDescription?.sdp??"");return Pn.trace("recipient connected to remote address %s",s),{remoteAddress:s}}var v3=jt("libp2p:webrtc:peer"),X0e="/webrtc",J0e="/p2p-circuit",My="/webrtc-signaling/0.0.1",Z0e=30*1e3,Vy=class{components;init;_started=!1;metrics;shutdownController;constructor(e,r={}){this.components=e,this.init=r,this.shutdownController=new AbortController,e.metrics!=null&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_dialer_events_total",{label:"event",help:"Total count of WebRTC dialer events by type"}),listenerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_listener_events_total",{label:"event",help:"Total count of WebRTC listener events by type"})})}isStarted(){return this._started}async start(){await this.components.registrar.handle(My,e=>{this._onProtocol(e).catch(r=>{v3.error("failed to handle incoming connect from %p",e.connection.remotePeer,r)})},{runOnTransientConnection:!0}),this._started=!0}async stop(){await this.components.registrar.unhandle(My),this._started=!1}createListener(e){return new Fy(this.components,{shutdownController:this.shutdownController})}[Symbol.toStringTag]="@libp2p/webrtc";[Yi]=!0;filter(e){return e.filter(ZN.exactMatch)}async dial(e,r){v3.trace("dialing address: %a",e);let n=new Sf(this.init.rtcConfiguration),o=new vc({peerConnection:n,dataChannelOptions:this.init.dataChannel}),{remoteAddress:s}=await sF({peerConnection:n,multiaddr:e,dataChannelOptions:this.init.dataChannel,signal:r.signal,connectionManager:this.components.connectionManager,transportManager:this.components.transportManager}),i=new xc({peerConnection:n,timeline:{open:Date.now()},remoteAddr:s,metrics:this.metrics?.dialerEvents}),a=await r.upgrader.upgradeOutbound(i,{skipProtection:!0,skipEncryption:!0,muxerFactory:o});return this._closeOnShutdown(n,i),a}async _onProtocol({connection:e,stream:r}){let n=AbortSignal.timeout(this.init.inboundConnectionTimeout??Z0e),o=new Sf(this.init.rtcConfiguration),s=new vc({peerConnection:o,dataChannelOptions:this.init.dataChannel});try{let{remoteAddress:i}=await aF({peerConnection:o,connection:e,stream:r,signal:n}),a=new xc({peerConnection:o,timeline:{open:new Date().getTime()},remoteAddr:wc(i).encapsulate(`/p2p/${e.remotePeer.toString()}`),metrics:this.metrics?.listenerEvents});this._closeOnShutdown(o,a),await this.components.upgrader.upgradeInbound(a,{skipEncryption:!0,skipProtection:!0,muxerFactory:s}),await r.close({signal:n})}catch(i){throw r.abort(i),i}}_closeOnShutdown(e,r){let n=()=>{r.close().catch(o=>{v3.error("could not close WebRTCMultiaddrConnection",o)})};this.shutdownController.signal.addEventListener("abort",n),e.addEventListener("close",()=>{this.shutdownController.signal.removeEventListener("abort",n)})}};function iF(t){let e=t.toString().split(X0e+"/");if(e.length!==2)throw new C("webrtc protocol was not present in multiaddr",Bn.ERR_INVALID_MULTIADDR);if(!e[0].includes(J0e))throw new C("p2p-circuit protocol was not present in multiaddr",Bn.ERR_INVALID_MULTIADDR);let r=wc(e[0]),o=wc("/"+e[1]).getPeerId();if(o==null)throw new C("destination peer id was missing",Bn.ERR_INVALID_MULTIADDR);let s=r.protos().pop();if(s===void 0)throw new C("invalid multiaddr",Bn.ERR_INVALID_MULTIADDR);return s.name!=="p2p"&&(r=r.encapsulate(`/p2p/${o}`)),{baseAddr:r,peerId:bc(o)}}function S3(){let t=ze(),e=!1;return{sink:async r=>{if(e)throw new Error("already piped");e=!0,t.resolve(r)},source:async function*(){yield*await t.promise}()}}function cF(){let t=S3(),e=S3();return[{source:t.source,sink:e.sink},{source:e.source,sink:t.sink}]}function eme(t){return t[Symbol.asyncIterator]!=null}function tme(...t){let e=[];for(let r of t)eme(r)||e.push(r);return e.length===t.length?function*(){for(let r of e)yield*r}():async function*(){let r=Je({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async n=>{for await(let o of n)r.push(o)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var uF=tme;function lF(t,...e){if(t==null)throw new Error("Empty pipeline");if(A3(t)){let n=t;t=()=>n.source}else if(hF(t)||fF(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&A3(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)A3(r[n])&&(r[n]=nme(r[n]));return rme(...r)}var rme=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},fF=t=>t?.[Symbol.asyncIterator]!=null,hF=t=>t?.[Symbol.iterator]!=null,A3=t=>t==null?!1:t.sink!=null&&t.source!=null,nme=t=>e=>{let r=t.sink(e);if(r?.then!=null){let n=Je({objectMode:!0});r.then(()=>{n.end()},i=>{n.end(i)});let o,s=t.source;if(fF(s))o=async function*(){yield*s,n.end()};else if(hF(s))o=function*(){yield*s,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return uF(n,o())}return t.source};var dF=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);var ome=t=>t instanceof Uint8Array;var Zs=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),pF=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),sme=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!sme)throw new Error("Non little-endian hardware is not supported");function zy(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function $y(t){if(typeof t=="string"&&(t=zy(t)),!ome(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}var ime=t=>Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object;function mF(t,e){if(e!==void 0&&(typeof e!="object"||!ime(e)))throw new Error("options must be object or undefined");return Object.assign(t,e)}function Ac(t,e){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");if(typeof e=="number"&&t.length!==e)throw new Error(`Uint8Array length ${e} expected`)}function gF(t,e){if(t.length!==e.length)throw new Error("equalBytes: Different size of Uint8Arrays");let r=!0;for(let n=0;n<t.length;n++)r&&(r=t[n]===e[n]);return r}function C3(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let o=BigInt(32),s=BigInt(4294967295),i=Number(r>>o&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,i,n),t.setUint32(e+u,a,n)}function T3(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function ame(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function yF(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function cme(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("hash must be wrapped by utils.wrapConstructor");T3(t.outputLen),T3(t.blockLen)}function ume(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function lme(t,e){yF(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var fme={number:T3,bool:ame,bytes:yF,hash:cme,exists:ume,output:lme},Wr=fme;var Ar=(t,e)=>t[e++]&255|(t[e++]&255)<<8,_3=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=$y(e),Ac(e,32);let r=Ar(e,0),n=Ar(e,2),o=Ar(e,4),s=Ar(e,6),i=Ar(e,8),a=Ar(e,10),c=Ar(e,12),u=Ar(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|o<<6)&7939,this.r[3]=(o>>>7|s<<9)&8191,this.r[4]=(s>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=Ar(e,16+2*l)}process(e,r,n=!1){let o=n?0:2048,{h:s,r:i}=this,a=i[0],c=i[1],u=i[2],l=i[3],h=i[4],p=i[5],m=i[6],f=i[7],d=i[8],g=i[9],y=Ar(e,r+0),b=Ar(e,r+2),w=Ar(e,r+4),x=Ar(e,r+6),E=Ar(e,r+8),S=Ar(e,r+10),v=Ar(e,r+12),A=Ar(e,r+14),_=s[0]+(y&8191),z=s[1]+((y>>>13|b<<3)&8191),V=s[2]+((b>>>10|w<<6)&8191),K=s[3]+((w>>>7|x<<9)&8191),G=s[4]+((x>>>4|E<<12)&8191),se=s[5]+(E>>>1&8191),L=s[6]+((E>>>14|S<<2)&8191),O=s[7]+((S>>>11|v<<5)&8191),P=s[8]+((v>>>8|A<<8)&8191),N=s[9]+(A>>>5|o),D=0,F=D+_*a+z*(5*g)+V*(5*d)+K*(5*f)+G*(5*m);D=F>>>13,F&=8191,F+=se*(5*p)+L*(5*h)+O*(5*l)+P*(5*u)+N*(5*c),D+=F>>>13,F&=8191;let q=D+_*c+z*a+V*(5*g)+K*(5*d)+G*(5*f);D=q>>>13,q&=8191,q+=se*(5*m)+L*(5*p)+O*(5*h)+P*(5*l)+N*(5*u),D+=q>>>13,q&=8191;let W=D+_*u+z*c+V*a+K*(5*g)+G*(5*d);D=W>>>13,W&=8191,W+=se*(5*f)+L*(5*m)+O*(5*p)+P*(5*h)+N*(5*l),D+=W>>>13,W&=8191;let oe=D+_*l+z*u+V*c+K*a+G*(5*g);D=oe>>>13,oe&=8191,oe+=se*(5*d)+L*(5*f)+O*(5*m)+P*(5*p)+N*(5*h),D+=oe>>>13,oe&=8191;let ie=D+_*h+z*l+V*u+K*c+G*a;D=ie>>>13,ie&=8191,ie+=se*(5*g)+L*(5*d)+O*(5*f)+P*(5*m)+N*(5*p),D+=ie>>>13,ie&=8191;let pe=D+_*p+z*h+V*l+K*u+G*c;D=pe>>>13,pe&=8191,pe+=se*a+L*(5*g)+O*(5*d)+P*(5*f)+N*(5*m),D+=pe>>>13,pe&=8191;let ae=D+_*m+z*p+V*h+K*l+G*u;D=ae>>>13,ae&=8191,ae+=se*c+L*a+O*(5*g)+P*(5*d)+N*(5*f),D+=ae>>>13,ae&=8191;let le=D+_*f+z*m+V*p+K*h+G*l;D=le>>>13,le&=8191,le+=se*u+L*c+O*a+P*(5*g)+N*(5*d),D+=le>>>13,le&=8191;let $e=D+_*d+z*f+V*m+K*p+G*h;D=$e>>>13,$e&=8191,$e+=se*l+L*u+O*c+P*a+N*(5*g),D+=$e>>>13,$e&=8191;let Ne=D+_*g+z*d+V*f+K*m+G*p;D=Ne>>>13,Ne&=8191,Ne+=se*h+L*l+O*u+P*c+N*a,D+=Ne>>>13,Ne&=8191,D=(D<<2)+D|0,D=D+F|0,F=D&8191,D=D>>>13,q+=D,s[0]=F,s[1]=q,s[2]=W,s[3]=oe,s[4]=ie,s[5]=pe,s[6]=ae,s[7]=le,s[8]=$e,s[9]=Ne}finalize(){let{h:e,pad:r}=this,n=new Uint16Array(10),o=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=o,o=e[a]>>>13,e[a]&=8191;e[0]+=o*5,o=e[0]>>>13,e[0]&=8191,e[1]+=o,o=e[1]>>>13,e[1]&=8191,e[2]+=o,n[0]=e[0]+5,o=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+o,o=n[a]>>>13,n[a]&=8191;n[9]-=1<<13;let s=(o^1)-1;for(let a=0;a<10;a++)n[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let i=e[0]+r[0];e[0]=i&65535;for(let a=1;a<8;a++)i=(e[a]+r[a]|0)+(i>>>16)|0,e[a]=i&65535}update(e){Wr.exists(this);let{buffer:r,blockLen:n}=this;e=$y(e);let o=e.length;for(let s=0;s<o;){let i=Math.min(n-this.pos,o-s);if(i===n){for(;n<=o-s;s+=n)this.process(e,s);continue}r.set(e.subarray(s,s+i),this.pos),this.pos+=i,s+=i,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){Wr.exists(this),Wr.output(e,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:o}=this;if(o){for(r[o++]=1;o<16;o++)r[o]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let i=0;i<8;i++)e[s++]=n[i]>>>0,e[s++]=n[i]>>>8;return e}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}};function hme(t){let e=(n,o)=>t(o).update($y(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}var bF=hme(t=>new _3(t));var dme=zy("expand 16-byte k"),pme=zy("expand 32-byte k"),mme=Zs(dme),gme=Zs(pme),Ky=t=>!(t.byteOffset%4),wF=t=>{let{core:e,rounds:r,counterRight:n,counterLen:o,allow128bitKeys:s,extendNonceFn:i,blockLen:a}=mF({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},t);Wr.number(o),Wr.number(r),Wr.number(a),Wr.bool(n),Wr.bool(s);let c=a/4;if(a%4!==0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(u,l,h,p,m=0)=>{if(Wr.bytes(u),Wr.bytes(l),Wr.bytes(h),p||(p=new Uint8Array(h.length)),Wr.bytes(p),Wr.number(m),m<0||m>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(p.length<h.length)throw new Error(`Salsa/ChaCha: output (${p.length}) is shorter than data (${h.length})`);let f=[],d,g;if(u.length===32)Ky(u)?d=u:(d=u.slice(),f.push(d)),g=gme;else if(u.length===16&&s)d=new Uint8Array(32),d.set(u),d.set(u,16),g=mme,f.push(d);else throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${u.length}`);if(Ky(l)||(l=l.slice(),f.push(l)),i){if(l.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");d=i(g,d,l.subarray(0,16),new Uint8Array(32)),f.push(d),l=l.subarray(16)}let y=16-o;if(l.length!==y)throw new Error(`Salsa/ChaCha: nonce must be ${y} or 16 bytes`);if(y!==12){let _=new Uint8Array(12);_.set(l,n?0:12-l.length),f.push(l=_)}let b=new Uint8Array(a),w=Zs(b),x=Zs(d),E=Zs(l),S=Ky(h)&&Zs(h),v=Ky(p)&&Zs(p);f.push(w);let A=h.length;for(let _=0,z=m;_<A;z++){if(e(g,x,E,w,z,r),z>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");let V=Math.min(a,A-_);if(V===a&&v&&S){let K=_/4;if(_%4!==0)throw new Error("Salsa/ChaCha: invalid block position");for(let G=0;G<c;G++)v[K+G]=S[K+G]^w[G];_+=a;continue}for(let K=0;K<V;K++)p[_+K]=h[_+K]^b[K];_+=V}for(let _=0;_<f.length;_++)f[_].fill(0);return p}};var _e=(t,e)=>t<<e|t>>>32-e;function yme(t,e,r,n,o,s=20){let i=t[0],a=t[1],c=t[2],u=t[3],l=e[0],h=e[1],p=e[2],m=e[3],f=e[4],d=e[5],g=e[6],y=e[7],b=o,w=r[0],x=r[1],E=r[2],S=i,v=a,A=c,_=u,z=l,V=h,K=p,G=m,se=f,L=d,O=g,P=y,N=b,D=w,F=x,q=E;for(let oe=0;oe<s;oe+=2)S=S+z|0,N=_e(N^S,16),se=se+N|0,z=_e(z^se,12),S=S+z|0,N=_e(N^S,8),se=se+N|0,z=_e(z^se,7),v=v+V|0,D=_e(D^v,16),L=L+D|0,V=_e(V^L,12),v=v+V|0,D=_e(D^v,8),L=L+D|0,V=_e(V^L,7),A=A+K|0,F=_e(F^A,16),O=O+F|0,K=_e(K^O,12),A=A+K|0,F=_e(F^A,8),O=O+F|0,K=_e(K^O,7),_=_+G|0,q=_e(q^_,16),P=P+q|0,G=_e(G^P,12),_=_+G|0,q=_e(q^_,8),P=P+q|0,G=_e(G^P,7),S=S+V|0,q=_e(q^S,16),O=O+q|0,V=_e(V^O,12),S=S+V|0,q=_e(q^S,8),O=O+q|0,V=_e(V^O,7),v=v+K|0,N=_e(N^v,16),P=P+N|0,K=_e(K^P,12),v=v+K|0,N=_e(N^v,8),P=P+N|0,K=_e(K^P,7),A=A+G|0,D=_e(D^A,16),se=se+D|0,G=_e(G^se,12),A=A+G|0,D=_e(D^A,8),se=se+D|0,G=_e(G^se,7),_=_+z|0,F=_e(F^_,16),L=L+F|0,z=_e(z^L,12),_=_+z|0,F=_e(F^_,8),L=L+F|0,z=_e(z^L,7);let W=0;n[W++]=i+S|0,n[W++]=a+v|0,n[W++]=c+A|0,n[W++]=u+_|0,n[W++]=l+z|0,n[W++]=h+V|0,n[W++]=p+K|0,n[W++]=m+G|0,n[W++]=f+se|0,n[W++]=d+L|0,n[W++]=g+O|0,n[W++]=y+P|0,n[W++]=b+N|0,n[W++]=w+D|0,n[W++]=x+F|0,n[W++]=E+q|0}var bme=wF({core:yme,counterRight:!1,counterLen:4,allow128bitKeys:!1});var wme=new Uint8Array(16),xF=(t,e)=>{t.update(e);let r=e.length%16;r&&t.update(wme.subarray(r))},EF=(t,e,r,n,o)=>{let s=t(e,r,new Uint8Array(32)),i=bF.create(s);o&&xF(i,o),xF(i,n);let a=new Uint8Array(16),c=pF(a);C3(c,0,BigInt(o?o.length:0),!0),C3(c,8,BigInt(n.length),!0),i.update(a);let u=i.digest();return s.fill(0),u},xme=t=>(e,r,n)=>(Ac(e,32),Ac(r),{tagLength:16,encrypt:(s,i)=>{let a=s.length,c=a+16;i?Ac(i,c):i=new Uint8Array(c),t(e,r,s,i,1);let u=EF(t,e,r,i.subarray(0,-16),n);return i.set(u,a),i},decrypt:(s,i)=>{let a=s.length,c=a-16;if(a<16)throw new Error(`encrypted data must be at least ${16} bytes`);i?Ac(i,c):i=new Uint8Array(c);let u=s.subarray(0,-16),l=s.subarray(-16),h=EF(t,e,r,u,n);if(!gF(l,h))throw new Error("invalid tag");return t(e,r,u,i,1),i}}),I3=xme(bme);function SF(t,e,r){return vh(t),r===void 0&&(r=new Uint8Array(t.outputLen)),tu(t,yi(r),yi(e))}var D3=new Uint8Array([0]),vF=new Uint8Array;function AF(t,e,r,n=32){if(vh(t),M0(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");let o=Math.ceil(n/t.outputLen);r===void 0&&(r=vF);let s=new Uint8Array(o*t.outputLen),i=tu.create(t,e),a=i._cloneInto(),c=new Uint8Array(i.outputLen);for(let u=0;u<o;u++)D3[0]=u+1,a.update(u===0?vF:c).update(r).update(D3).digestInto(c),s.set(c,t.outputLen*u),i._cloneInto(a);return i.destroy(),a.destroy(),c.fill(0),D3.fill(0),s.slice(0,n)}var R3={hashSHA256(t){return eu(t)},getHKDF(t,e){let r=SF(eu,e,t),o=AF(eu,r,void 0,96),s=o.subarray(0,32),i=o.subarray(32,64),a=o.subarray(64,96);return[s,i,a]},generateX25519KeyPair(){let t=_h.utils.randomPrivateKey();return{publicKey:_h.getPublicKey(t),privateKey:t}},generateX25519KeyPairFromSeed(t){return{publicKey:_h.getPublicKey(t),privateKey:t}},generateX25519SharedKey(t,e){return _h.getSharedSecret(t,e)},chaCha20Poly1305Encrypt(t,e,r,n){return I3(n,e,r).encrypt(t)},chaCha20Poly1305Decrypt(t,e,r,n,o){return I3(n,e,r).decrypt(t,o)}};function Cc(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Rp(t=0){return globalThis.Buffer?.allocUnsafe!=null?Cc(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function ei(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=Rp(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return Cc(r)}var Eme=t=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t),Af=t=>{let e=Eme(2);return new DataView(e.buffer,e.byteOffset,e.byteLength).setUint16(0,t,!1),e};Af.bytes=2;var Lp=t=>{if(t.length<2)throw RangeError("Could not decode int16BE");return t instanceof Uint8Array?new DataView(t.buffer,t.byteOffset,t.byteLength).getUint16(0,!1):t.getUint16(0)};Lp.bytes=2;function CF(t){return ei([t.ne,t.ciphertext],t.ne.length+t.ciphertext.length)}function TF(t){return ei([t.ne,t.ns,t.ciphertext],t.ne.length+t.ns.length+t.ciphertext.length)}function _F(t){return ei([t.ns,t.ciphertext],t.ns.length+t.ciphertext.length)}function IF(t){if(t.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:t.subarray(0,32),ciphertext:t.subarray(32,t.length),ns:new Uint8Array(0)}}function DF(t){if(t.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:t.subarray(0,32),ns:t.subarray(32,80),ciphertext:t.subarray(80,t.length)}}function RF(t){if(t.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:t.subarray(0,48),ciphertext:t.subarray(48,t.length)}}var BF=16;function PF(t,e){return async function*(r){for await(let n of r)for(let o=0;o<n.length;o+=65519){let s=o+65519;s>n.length&&(s=n.length);let i=t.encrypt(n.subarray(o,s),t.session);e?.encryptedPackets.increment(),yield Af(i.byteLength),yield i}}}function NF(t,e){return async function*(r){for await(let n of r)for(let o=0;o<n.length;o+=65535){let s=o+65535;if(s>n.length&&(s=n.length),s-BF<o)throw new Error("Invalid chunk");let i=n.subarray(o,s),a=n.subarray(o,s-BF),{plaintext:c,valid:u}=t.decrypt(i,t.session,a);if(!u)throw e?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");e?.decryptedPackets.increment(),yield c}}}var O3={};T(O3,{base58btc:()=>jr,base58flickr:()=>_me});function vme(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var Sme=vme,Ame=Sme,OF=Ame;var ZXe=new Uint8Array(0);var UF=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ti=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var kF=t=>new TextEncoder().encode(t),MF=t=>new TextDecoder().decode(t);var L3=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},B3=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return VF(this,e)}},P3=class{constructor(e){this.decoders=e}or(e){return VF(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},VF=(t,e)=>new P3({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),N3=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new L3(e,r,n),this.decoder=new B3(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Cf=({name:t,prefix:e,encode:r,decode:n})=>new N3(t,e,r,n),ha=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=OF(r,e);return Cf({prefix:t,name:e,encode:n,decode:s=>ti(o(s))})},Cme=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},Tme=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Lt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Cf({prefix:e,name:t,encode(o){return Tme(o,n,r)},decode(o){return Cme(o,n,r,t)}});var jr=ha({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_me=ha({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var U3={};T(U3,{base10:()=>Ime});var Ime=ha({prefix:"9",name:"base10",alphabet:"0123456789"});var k3={};T(k3,{base16:()=>Dme,base16upper:()=>Rme});var Dme=Lt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Rme=Lt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var M3={};T(M3,{base2:()=>Lme});var Lme=Lt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var F3={};T(F3,{base256emoji:()=>Ume});var zF=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Bme=zF.reduce((t,e,r)=>(t[r]=e,t),[]),Pme=zF.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Nme(t){return t.reduce((e,r)=>(e+=Bme[r],e),"")}function Ome(t){let e=[];for(let r of t){let n=Pme[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Ume=Cf({prefix:"\u{1F680}",name:"base256emoji",encode:Nme,decode:Ome});var V3={};T(V3,{base32:()=>da,base32hex:()=>Vme,base32hexpad:()=>$me,base32hexpadupper:()=>Kme,base32hexupper:()=>zme,base32pad:()=>Mme,base32padupper:()=>Fme,base32upper:()=>kme,base32z:()=>qme});var da=Lt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),kme=Lt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Mme=Lt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fme=Lt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Vme=Lt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zme=Lt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$me=Lt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Kme=Lt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qme=Lt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var z3={};T(z3,{base36:()=>Hme,base36upper:()=>Gme});var Hme=ha({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Gme=ha({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var K3={};T(K3,{base64:()=>$3,base64pad:()=>Wme,base64url:()=>jme,base64urlpad:()=>Yme});var $3=Lt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Wme=Lt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),jme=Lt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Yme=Lt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var q3={};T(q3,{base8:()=>Qme});var Qme=Lt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var H3={};T(H3,{identity:()=>Xme});var Xme=Cf({prefix:"\0",name:"identity",encode:t=>MF(t),decode:t=>kF(t)});var pJe=new TextEncoder,mJe=new TextDecoder;var W3={};T(W3,{identity:()=>Rf});var ege=qF,$F=128,tge=127,rge=~tge,nge=Math.pow(2,31);function qF(t,e,r){e=e||[],r=r||0;for(var n=r;t>=nge;)e[r++]=t&255|$F,t/=128;for(;t&rge;)e[r++]=t&255|$F,t>>>=7;return e[r]=t|0,qF.bytes=r-n+1,e}var oge=G3,sge=128,KF=127;function G3(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw G3.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&KF)<<o:(i&KF)*Math.pow(2,o),o+=7}while(i>=sge);return G3.bytes=s-n,r}var ige=Math.pow(2,7),age=Math.pow(2,14),cge=Math.pow(2,21),uge=Math.pow(2,28),lge=Math.pow(2,35),fge=Math.pow(2,42),hge=Math.pow(2,49),dge=Math.pow(2,56),pge=Math.pow(2,63),mge=function(t){return t<ige?1:t<age?2:t<cge?3:t<uge?4:t<lge?5:t<fge?6:t<hge?7:t<dge?8:t<pge?9:10},gge={encode:ege,decode:oge,encodingLength:mge},yge=gge,Pp=yge;var Np=(t,e=0)=>[Pp.decode(t,e),Pp.decode.bytes],Tf=(t,e,r=0)=>(Pp.encode(t,e,r),e),_f=t=>Pp.encodingLength(t);var Go=(t,e)=>{let r=e.byteLength,n=_f(t),o=n+_f(r),s=new Uint8Array(o+r);return Tf(t,s,0),Tf(r,s,n),s.set(e,o),new If(t,r,e,s)},Op=t=>{let e=ti(t),[r,n]=Np(e),[o,s]=Np(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new If(r,o,i,e)},HF=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&UF(t.bytes,r.bytes)}},If=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var GF=0,bge="identity",WF=ti,wge=t=>Go(GF,WF(t)),Rf={code:GF,name:bge,encode:WF,digest:wge};var Q3={};T(Q3,{sha256:()=>Up,sha512:()=>xge});var Y3=({name:t,code:e,encode:r})=>new j3(t,e,r),j3=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Go(this.code,r):r.then(n=>Go(this.code,n))}else throw Error("Unknown type, must be binary type")}};var YF=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Up=Y3({name:"sha2-256",code:18,encode:YF("SHA-256")}),xge=Y3({name:"sha2-512",code:19,encode:YF("SHA-512")});var QF=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return vge(r,X3(t),e||jr.encoder);default:return Sge(r,X3(t),e||da.encoder)}};var XF=new WeakMap,X3=t=>{let e=XF.get(t);if(e==null){let r=new Map;return XF.set(t,r),r}return e},yt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==kp)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Age)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return yt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Go(e,r);return yt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return yt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&HF(e.multihash,n.multihash)}toString(e){return QF(this,e)}toJSON(){return{"/":QF(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof yt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new yt(n,o,s,i||JF(n,o,s.bytes))}else if(r[Cge]===!0){let{version:n,multihash:o,code:s}=r,i=Op(o);return yt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==kp)throw new Error(`Version 0 CID must use dag-pb (code: ${kp}) block encoding`);return new yt(e,r,n,n.bytes)}case 1:{let o=JF(e,r,n.bytes);return new yt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return yt.create(0,kp,e)}static createV1(e,r){return yt.create(1,e,r)}static decode(e){let[r,n]=yt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=yt.inspectBytes(e),n=r.size-r.multihashSize,o=ti(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new If(r.multihashCode,r.digestSize,s,o);return[r.version===0?yt.createV0(i):yt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Np(e.subarray(r));return r+=p,h},o=n(),s=kp;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=Ege(e,r),s=yt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return X3(s).set(n,e),s}},Ege=(t,e)=>{switch(t[0]){case"Q":{let r=e||jr;return[jr.prefix,r.decode(`${jr.prefix}${t}`)]}case jr.prefix:{let r=e||jr;return[jr.prefix,r.decode(t)]}case da.prefix:{let r=e||da;return[da.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},vge=(t,e,r)=>{let{prefix:n}=r;if(n!==jr.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},Sge=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},kp=112,Age=18,JF=(t,e,r)=>{let n=_f(t),o=n+_f(e),s=new Uint8Array(o+r.byteLength);return Tf(t,s,0),Tf(e,s,n),s.set(r,o),s},Cge=Symbol.for("@ipld/js-cid/CID");var Lf={...H3,...M3,...q3,...U3,...k3,...V3,...z3,...O3,...K3,...F3},LJe={...Q3,...W3};function Bf(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Tge=Symbol.for("nodejs.util.inspect.custom"),ZF=Object.values(Lf).map(t=>t.decoder).reduce((t,e)=>t.or(e),Lf.identity.decoder),eV=114,J3=36,Z3=37,Mp=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[gr]=!0;toString(){return this.string==null&&(this.string=jr.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return yt.createV1(eV,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Bf(this.multihash.bytes,e);if(typeof e=="string")return _ge(e).equals(this);if(e?.multihash?.bytes!=null)return Bf(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Tge](){return`PeerId(${this.toString()})`}},Pf=class extends Mp{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Nf=class extends Mp{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},Of=class extends Mp{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function _ge(t,e){if(e=e??ZF,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Op(jr.decode(`z${t}`));return t.startsWith("12D")?new Nf({multihash:r}):t.startsWith("16U")?new Of({multihash:r}):new Pf({multihash:r})}return Ige(ZF.decode(t))}function Ige(t){try{let e=Op(t);if(e.code===Rf.code){if(e.digest.length===J3)return new Nf({multihash:e});if(e.digest.length===Z3)return new Of({multihash:e})}if(e.code===Up.code)return new Pf({multihash:e})}catch{return Dge(yt.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function Dge(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==eV)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Up.code)return new Pf({multihash:t.multihash});if(e.code===Rf.code){if(e.digest.length===J3)return new Nf({multihash:t.multihash});if(e.digest.length===Z3)return new Of({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function e6(t,e){return t.length===J3?new Nf({multihash:Go(Rf.code,t),privateKey:e}):t.length===Z3?new Of({multihash:Go(Rf.code,t),privateKey:e}):new Pf({multihash:await Up.digest(t),publicKey:t,privateKey:e})}function rV(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var tV=rV("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),t6=rV("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Rp(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Rge={utf8:tV,"utf-8":tV,hex:Lf.base16,latin1:t6,ascii:t6,binary:t6,...Lf},Hy=Rge;function Fp(t,e="utf8"){let r=Hy[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Cc(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var Gy;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{if(o.lengthDelimited!==!1&&n.fork(),r.webtransportCerthashes!=null)for(let s of r.webtransportCerthashes)n.uint32(10),n.bytes(s);o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={webtransportCerthashes:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.webtransportCerthashes.push(r.bytes());break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(Gy||(Gy={}));var Vp;(function(t){let e;t.codec=()=>(e==null&&(e=Te((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),(o.writeDefaults===!0||r.identityKey!=null&&r.identityKey.byteLength>0)&&(n.uint32(10),n.bytes(r.identityKey??new Uint8Array(0))),(o.writeDefaults===!0||r.identitySig!=null&&r.identitySig.byteLength>0)&&(n.uint32(18),n.bytes(r.identitySig??new Uint8Array(0))),r.extensions!=null&&(n.uint32(34),Gy.codec().encode(r.extensions,n,{writeDefaults:!1})),o.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let o={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let i=r.uint32();switch(i>>>3){case 1:o.identityKey=r.bytes();break;case 2:o.identitySig=r.bytes();break;case 4:o.extensions=Gy.codec().decode(r,r.uint32());break;default:r.skipType(i&7);break}}return o})),e),t.encode=r=>Ce(r,t.codec()),t.decode=r=>Ae(r,t.codec())})(Vp||(Vp={}));async function nV(t,e,r){let n=await Bge(t,oV(e));if(t.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return Lge(t.publicKey,n,r)}function Lge(t,e,r){return Vp.encode({identityKey:t,identitySig:e,extensions:r??{webtransportCerthashes:[]}}).subarray()}async function Bge(t,e){if(t.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return(await Ci(t.privateKey)).sign(e)}async function r6(t){return e6(t.identityKey)}function n6(t){return Vp.decode(t)}function oV(t){let e=Fp("noise-libp2p-static-key:");return ei([e,t],e.length+t.length)}async function o6(t,e,r){let n=await e6(e.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);let o=oV(t);if(n.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(e.identitySig==null)throw new Error("Signature was missing from message");if(!await Fa(n.publicKey).verify(o,e.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function zp(t){return!(!(t instanceof Uint8Array)||t.length!==32)}function Wo(t,e="utf8"){let r=Hy[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Nn=J(ao(),1);Nn.default.formatters.b=t=>t==null?"undefined":jr.baseEncode(t);Nn.default.formatters.t=t=>t==null?"undefined":da.baseEncode(t);Nn.default.formatters.m=t=>t==null?"undefined":$3.baseEncode(t);Nn.default.formatters.p=t=>t==null?"undefined":t.toString();Nn.default.formatters.c=t=>t==null?"undefined":t.toString();Nn.default.formatters.k=t=>t==null?"undefined":t.toString();Nn.default.formatters.a=t=>t==null?"undefined":t.toString();function Pge(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function sV(t){let e=Pge(`${t}:trace`);return Nn.default.enabled(`${t}:trace`)&&Nn.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,Nn.default)(`${t}:trace`)),Object.assign((0,Nn.default)(t),{error:(0,Nn.default)(`${t}:error`),trace:e})}var hr=sV("libp2p:noise");var Yn;dF?Yn=hr:Yn=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function iV(t){Yn(`LOCAL_STATIC_PUBLIC_KEY ${Wo(t.publicKey,"hex")}`),Yn(`LOCAL_STATIC_PRIVATE_KEY ${Wo(t.privateKey,"hex")}`)}function s6(t){t?(Yn(`LOCAL_PUBLIC_EPHEMERAL_KEY ${Wo(t.publicKey,"hex")}`),Yn(`LOCAL_PRIVATE_EPHEMERAL_KEY ${Wo(t.privateKey,"hex")}`)):Yn("Missing local ephemeral keys.")}function aV(t){Yn(`REMOTE_STATIC_PUBLIC_KEY ${Wo(t,"hex")}`)}function i6(t){Yn(`REMOTE_EPHEMERAL_PUBLIC_KEY ${Wo(t,"hex")}`)}function cV(t){t.cs1&&t.cs2?(Yn(`CIPHER_STATE_1 ${t.cs1.n.getUint64()} ${Wo(t.cs1.k,"hex")}`),Yn(`CIPHER_STATE_2 ${t.cs2.n.getUint64()} ${Wo(t.cs2.k,"hex")}`)):Yn("Missing cipher state.")}var Nge="Cipherstate has reached maximum n, a new handshake must be performed",Wy=class{n;bytes;view;constructor(e=0){this.n=e,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error(Nge)}};var jy=class{crypto;constructor(e){this.crypto=e}encryptWithAd(e,r,n){let o=this.encrypt(e.k,e.n,r,n);return e.n.increment(),o}decryptWithAd(e,r,n,o){let{plaintext:s,valid:i}=this.decrypt(e.k,e.n,r,n,o);return i&&e.n.increment(),{plaintext:s,valid:i}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){let r=this.createEmptyKey();return Bf(r,e)}encrypt(e,r,n,o){return r.assertValue(),this.crypto.chaCha20Poly1305Encrypt(o,r.getBytes(),n,e)}encryptAndHash(e,r){let n;return this.hasKey(e.cs)?n=this.encryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,n),n}decrypt(e,r,n,o,s){r.assertValue();let i=this.crypto.chaCha20Poly1305Decrypt(o,r.getBytes(),n,e,s);return i?{plaintext:i,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,r){let n,o=!0;return this.hasKey(e.cs)?{plaintext:n,valid:o}=this.decryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,r),{plaintext:n,valid:o}}dh(e,r){try{let n=this.crypto.generateX25519SharedKey(e,r);return n.length===32?n:n.subarray(0,32)}catch(n){let o=n;return hr.error(o),new Uint8Array(32)}}mixHash(e,r){e.h=this.getHash(e.h,r)}getHash(e,r){return this.crypto.hashSHA256(ei([e,r],e.length+r.length))}mixKey(e,r){let[n,o]=this.crypto.getHKDF(e.ck,r);e.cs=this.initializeKey(o),e.ck=n}initializeKey(e){return{k:e,n:new Wy}}initializeSymmetric(e){let r=Fp(e,"utf-8"),n=this.hashProtocolName(r),o=n,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:o,h:n}}hashProtocolName(e){if(e.length<=32){let r=new Uint8Array(32);return r.set(e),r}else return this.getHash(e,new Uint8Array(0))}split(e){let[r,n]=this.crypto.getHKDF(e.ck,new Uint8Array(0)),o=this.initializeKey(r),s=this.initializeKey(n);return{cs1:o,cs2:s}}writeMessageRegular(e,r){let n=this.encryptWithAd(e,new Uint8Array(0),r),o=this.createEmptyKey(),s=new Uint8Array(0);return{ne:o,ns:s,ciphertext:n}}readMessageRegular(e,r){return this.decryptWithAd(e,new Uint8Array(0),r.ciphertext)}};var Yy=class extends jy{initializeInitiator(e,r,n,o){let s="Noise_XX_25519_ChaChaPoly_SHA256",i=this.initializeSymmetric(s);this.mixHash(i,e);let a=new Uint8Array(32);return{ss:i,s:r,rs:n,psk:o,re:a}}initializeResponder(e,r,n,o){let s="Noise_XX_25519_ChaChaPoly_SHA256",i=this.initializeSymmetric(s);this.mixHash(i,e);let a=new Uint8Array(32);return{ss:i,s:r,rs:n,psk:o,re:a}}writeMessageA(e,r,n){let o=new Uint8Array(0);n!==void 0?e.e=n:e.e=this.crypto.generateX25519KeyPair();let s=e.e.publicKey;this.mixHash(e.ss,s);let i=this.encryptAndHash(e.ss,r);return{ne:s,ns:o,ciphertext:i}}writeMessageB(e,r){e.e=this.crypto.generateX25519KeyPair();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let o=e.s.publicKey,s=this.encryptAndHash(e.ss,o);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let i=this.encryptAndHash(e.ss,r);return{ne:n,ns:s,ciphertext:i}}writeMessageC(e,r){let n=e.s.publicKey,o=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,r),a={ne:this.createEmptyKey(),ns:o,ciphertext:s},{cs1:c,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:u}}readMessageA(e,r){return zp(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,r.ciphertext)}readMessageB(e,r){if(zp(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:n,valid:o}=this.decryptAndHash(e.ss,r.ns);o&&zp(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:i}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:s,valid:o&&i}}readMessageC(e,r){let{plaintext:n,valid:o}=this.decryptAndHash(e.ss,r.ns);if(o&&zp(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:i}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:o&&i,cs1:a,cs2:c}}initSession(e,r,n){let o=this.createEmptyKey(),s=new Uint8Array(32),i;return e?i=this.initializeInitiator(r,n,s,o):i=this.initializeResponder(r,n,s,o),{hs:i,i:e,mc:0}}sendMessage(e,r,n){let o;if(e.mc===0)o=this.writeMessageA(e.hs,r,n);else if(e.mc===1)o=this.writeMessageB(e.hs,r);else if(e.mc===2){let{h:s,messageBuffer:i,cs1:a,cs2:c}=this.writeMessageC(e.hs,r);o=i,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");o=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");o=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,o}recvMessage(e,r){let n=new Uint8Array(0),o=!1;if(e.mc===0)({plaintext:n,valid:o}=this.readMessageA(e.hs,r));else if(e.mc===1)({plaintext:n,valid:o}=this.readMessageB(e.hs,r));else if(e.mc===2){let{h:s,plaintext:i,valid:a,cs1:c,cs2:u}=this.readMessageC(e.hs,r);n=i,o=a,e.h=s,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:n,valid:o}}};var Qy=class{isInitiator;session;remotePeer;remoteExtensions={webtransportCerthashes:[]};payload;connection;xx;staticKeypair;prologue;constructor(e,r,n,o,s,i,a,c){this.isInitiator=e,this.payload=r,this.prologue=n,this.staticKeypair=s,this.connection=i,a&&(this.remotePeer=a),this.xx=c??new Yy(o),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(iV(this.session.hs.s),this.isInitiator){hr.trace("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,new Uint8Array(0));await this.connection.write(CF(e)),hr.trace("Stage 0 - Initiator finished sending first message."),s6(this.session.hs.e)}else{hr.trace("Stage 0 - Responder waiting to receive first message...");let e=IF((await this.connection.read()).subarray()),{valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new mi("xx handshake stage 0 validation fail");hr.trace("Stage 0 - Responder received first message."),i6(this.session.hs.re)}}async exchange(){if(this.isInitiator){hr.trace("Stage 1 - Initiator waiting to receive first message from responder...");let e=DF((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new mi("xx handshake stage 1 validation fail");hr.trace("Stage 1 - Initiator received the message."),i6(this.session.hs.re),aV(this.session.hs.rs),hr.trace("Initiator going to check remote's signature...");try{let o=n6(r);this.remotePeer=this.remotePeer||await r6(o),await o6(this.session.hs.rs,o,this.remotePeer),this.setRemoteNoiseExtension(o.extensions)}catch(o){let s=o;throw new kc(`Error occurred while verifying signed payload: ${s.message}`)}hr.trace("All good with the signature!")}else{hr.trace("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(TF(e)),hr.trace("Stage 1 - Responder sent the second handshake message with signed payload."),s6(this.session.hs.e)}}async finish(){if(this.isInitiator){hr.trace("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);await this.connection.write(_F(e)),hr.trace("Stage 2 - Initiator sent message with signed payload.")}else{hr.trace("Stage 2 - Responder waiting for third handshake message...");let e=RF((await this.connection.read()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new mi("xx handshake stage 2 validation fail");hr.trace("Stage 2 - Responder received the message, finished handshake.");try{let o=n6(r);this.remotePeer=this.remotePeer||await r6(o),await o6(this.session.hs.rs,o,this.remotePeer),this.setRemoteNoiseExtension(o.extensions)}catch(o){let s=o;throw new kc(`Error occurred while verifying signed payload: ${s.message}`)}}cV(this.session)}encrypt(e,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,new Uint8Array(0),e)}decrypt(e,r,n){let o=this.getCS(r,!1);return this.xx.decryptWithAd(o,new Uint8Array(0),e,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new mi("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}};function uV(t){return{xxHandshakeSuccesses:t.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:t.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:t.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:t.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:t.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}var Xy=class{protocol="/noise";crypto;prologue;staticKeys;extensions;metrics;constructor(e={}){let{staticNoiseKey:r,extensions:n,crypto:o,prologueBytes:s,metrics:i}=e;this.crypto=o??R3,this.extensions=n,this.metrics=i?uV(i):void 0,r?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(r):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=s??new Uint8Array(0)}async secureOutbound(e,r,n){let o=op(r,{lengthEncoder:Af,lengthDecoder:Lp,maxDataLength:65535}),s=await this.performHandshake({connection:o,isInitiator:!0,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(o,s),remoteExtensions:s.remoteExtensions,remotePeer:s.remotePeer}}async secureInbound(e,r,n){let o=op(r,{lengthEncoder:Af,lengthDecoder:Lp,maxDataLength:65535}),s=await this.performHandshake({connection:o,isInitiator:!1,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(o,s),remotePeer:s.remotePeer,remoteExtensions:s.remoteExtensions}}async performHandshake(e){let r=await nV(e.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(e,r)}async performXXHandshake(e,r){let{isInitiator:n,remotePeer:o,connection:s}=e,i=new Qy(n,r,this.prologue,this.crypto,this.staticKeys,s,o);try{await i.propose(),await i.exchange(),await i.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(a){if(this.metrics?.xxHandshakeErrors.increment(),a instanceof Error)throw a.message=`Error occurred during XX handshake: ${a.message}`,a}return i}async createSecureConnection(e,r){let[n,o]=cF(),s=e.unwrap();return await lF(n,PF(r,this.metrics),s,i=>yo(i,{lengthDecoder:Lp}),NF(r,this.metrics),n),o}};function lV(t={}){return()=>new Xy(t)}var Mz=J(V6(),1);var Lz=J(V6(),1);var z6=jt("libp2p:webrtc:sdp"),$6=Object.values(Ho).map(t=>t.decoder).reduce((t,e)=>t.or(e));function Bz(t){let e=t.getConfiguration().certificates?.at(0);if(e==null||e.getFingerprints==null){z6.trace("fetching fingerprint from local SDP");let n=t.localDescription;return n==null?void 0:Mbe(n.sdp)}if(z6.trace("fetching fingerprint from local certificate"),e.getFingerprints().length===0)return;let r=e.getFingerprints()[0].value;if(r==null)throw m3("","no fingerprint on local certificate");return r}var kbe=/^a=fingerprint:(?:\w+-[0-9]+)\s(?<fingerprint>(:?[0-9a-fA-F]{2})+)$/m;function Mbe(t){return t.match(kbe)?.groups?.fingerprint}function Fbe(t){for(let e of t.protoNames())if(e.startsWith("ip"))return e.toUpperCase();return z6("Warning: multiaddr does not appear to contain IP4 or IP6, defaulting to IP6",t),"IP6"}function ab(t){let r=t.stringTuples().filter(n=>n[0]===Oz).map(n=>n[1])[0];if(r===void 0||r==="")throw Ly(`Couldn't find a certhash component of multiaddr: ${t.toString()}`);return r}function K6(t){let e=$6.decode(t);return Lz.decode(e)}function Vbe(t){let e=K6(ab(t)),r=q6(e.name),n=e.digest.reduce((s,i)=>s+i.toString(16).padStart(2,"0"),""),o=n.match(/.{1,2}/g);if(o==null)throw m3(n,t.toString());return[`${r.toUpperCase()} ${o.join(":").toUpperCase()}`,n]}function q6(t){switch(t){case"sha1":return"sha-1";case"sha2-256":return"sha-256";case"sha2-512":return"sha-512";default:throw j9(t)}}function zbe(t,e){let{host:r,port:n}=t.toOptions(),o=Fbe(t),[s]=Vbe(t);return`v=0
o=- 0 0 IN ${o} ${r}
s=-
c=IN ${o} ${r}
t=0 0
a=ice-lite
m=application ${n} UDP/DTLS/SCTP webrtc-datachannel
a=mid:0
a=setup:passive
a=ice-ufrag:${e}
a=ice-pwd:${e}
a=fingerprint:${s}
a=sctp-port:5000
a=max-message-size:16384
a=candidate:1467250027 1 UDP 1467250027 ${r} ${n} typ host\r
`}function Pz(t,e){return{type:"answer",sdp:zbe(t,e)}}function Nz(t,e){if(t.sdp===void 0)throw Ip("Can't munge a missing SDP");return t.sdp=t.sdp.replace(/\na=ice-ufrag:[^\n]*\n/,`
a=ice-ufrag:`+e+`
`).replace(/\na=ice-pwd:[^\n]*\n/,`
a=ice-pwd:`+e+`
`),t}var Uz=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),kz=t=>[...Array(t)].map(()=>Uz.at(Math.floor(Math.random()*Uz.length))).join("");var cb=jt("libp2p:webrtc:transport"),Kbe=1e4,Ttt=Me("webrtc-direct").code,Oz=Me("certhash").code,ub=class{metrics;components;init;constructor(e,r={}){this.components=e,this.init=r,e.metrics!=null&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc-direct_dialer_events_total",{label:"event",help:"Total count of WebRTC-direct dial events by type"})})}async dial(e,r){let n=await this._connect(e,r);return cb("dialing address: %a",e),n}createListener(e){throw W9("WebRTCTransport.createListener")}filter(e){return e.filter(XN.exactMatch)}[Symbol.toStringTag]="@libp2p/webrtc-direct";[Yi]=!0;async _connect(e,r){let n=new AbortController,o=n.signal,s=e.getPeerId();if(s===null)throw Ly("we need to have the remote's PeerId");let i=bc(s),a=K6(ab(e)),c=await Sf.generateCertificate({name:"ECDSA",namedCurve:"P-256",hash:q6(a.name)}),u=new Sf({certificates:[c]});try{let l=new Promise((A,_)=>{let z=u.createDataChannel("",{negotiated:!0,id:0}),V=setTimeout(()=>{let K=`Data channel was never opened: state: ${z.readyState}`;cb.error(K),this.metrics?.dialerEvents.increment({open_error:!0}),_(p3("data",K))},Kbe);z.onopen=K=>{clearTimeout(V),A(z)},z.onerror=K=>{clearTimeout(V);let se=`Error opening a data channel for handshaking: ${K.target?.toString()??"not specified"}`;cb.error(se),this.metrics?.dialerEvents.increment({unknown_error:!0}),_(p3("data",se))}}),h="libp2p+webrtc+v1/"+kz(32),p=await u.createOffer(),m=Nz(p,h);await u.setLocalDescription(m);let f=Pz(e,h);await u.setRemoteDescription(f);let d=await l,g=this.components.peerId,y=this.generateNoisePrologue(u,a.code,e),b=lV({prologueBytes:y})(),w=vf({channel:d,direction:"inbound",...this.init.dataChannel??{}}),x={...w,sink:w.sink.bind(w),source:async function*(){for await(let A of w.source)for(let _ of A)yield _}()},E=new xc({peerConnection:u,remoteAddr:e,timeline:{open:Date.now()},metrics:this.metrics?.dialerEvents}),S=Dp?"iceconnectionstatechange":"connectionstatechange";u.addEventListener(S,()=>{switch(u.connectionState){case"failed":case"disconnected":case"closed":E.close().catch(A=>{cb.error("error closing connection",A)}).finally(()=>{n.abort()});break;default:break}},{signal:o}),this.metrics?.dialerEvents.increment({peer_connection:!0});let v=new vc({peerConnection:u,metrics:this.metrics?.dialerEvents,dataChannelOptions:this.init.dataChannel});return await b.secureInbound(g,x,i),await r.upgrader.upgradeOutbound(E,{skipProtection:!0,skipEncryption:!0,muxerFactory:v})}catch(l){throw u.close(),l}}generateNoisePrologue(e,r,n){if(e.getConfiguration().certificates?.length===0)throw Ip("no local certificate");let o=Bz(e);if(o==null)throw Ip("no local fingerprint found");let s=o.trim().toLowerCase().replaceAll(":",""),i=bf(s,"hex"),a=Mz.encode(i,r),c=$6.decode(ab(n)),u=bf("libp2p-webrtc-noise:");return Eo([u,a,c])}};function Rtt(t){return e=>new ub(e,t)}function Ltt(t){return e=>new Vy(e,t)}var On=J(ao(),1);var Y6={};T(Y6,{base32:()=>ya,base32hex:()=>Jbe,base32hexpad:()=>ewe,base32hexpadupper:()=>twe,base32hexupper:()=>Zbe,base32pad:()=>Qbe,base32padupper:()=>Xbe,base32upper:()=>Ybe,base32z:()=>rwe});function qbe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var Hbe=qbe,Gbe=Hbe,Fz=Gbe;var Ntt=new Uint8Array(0);var Vz=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},oi=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var zz=t=>new TextEncoder().encode(t),$z=t=>new TextDecoder().decode(t);var H6=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},G6=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return qz(this,e)}},W6=class{constructor(e){this.decoders=e}or(e){return qz(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},qz=(t,e)=>new W6({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),j6=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new H6(e,r,n),this.decoder=new G6(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},qf=({name:t,prefix:e,encode:r,decode:n})=>new j6(t,e,r,n),ga=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=Fz(r,e);return qf({prefix:t,name:e,encode:n,decode:s=>oi(o(s))})},Wbe=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},jbe=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Pt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>qf({prefix:e,name:t,encode(o){return jbe(o,n,r)},decode(o){return Wbe(o,n,r,t)}});var ya=Pt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ybe=Pt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Qbe=Pt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Xbe=Pt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Jbe=Pt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Zbe=Pt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ewe=Pt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),twe=Pt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rwe=Pt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Q6={};T(Q6,{base58btc:()=>Qn,base58flickr:()=>nwe});var Qn=ga({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),nwe=ga({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var J6={};T(J6,{base64:()=>X6,base64pad:()=>owe,base64url:()=>swe,base64urlpad:()=>iwe});var X6=Pt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),owe=Pt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),swe=Pt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),iwe=Pt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});On.default.formatters.b=t=>t==null?"undefined":Qn.baseEncode(t);On.default.formatters.t=t=>t==null?"undefined":ya.baseEncode(t);On.default.formatters.m=t=>t==null?"undefined":X6.baseEncode(t);On.default.formatters.p=t=>t==null?"undefined":t.toString();On.default.formatters.c=t=>t==null?"undefined":t.toString();On.default.formatters.k=t=>t==null?"undefined":t.toString();On.default.formatters.a=t=>t==null?"undefined":t.toString();function awe(t){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function lb(t){let e=awe(`${t}:trace`);return On.default.enabled(`${t}:trace`)&&On.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=(0,On.default)(`${t}:trace`)),Object.assign((0,On.default)(t),{error:(0,On.default)(`${t}:error`),trace:e})}async function*Z6(...t){let e=Je({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async r=>{for await(let n of r)e.push(n)})),e.end()}catch(r){e.end(r)}}),yield*e}var cwe=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},Hz=t=>t!=null&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),eC=t=>t!=null&&typeof t.sink=="function"&&Hz(t.source),uwe=t=>e=>{let r=t.sink(e);if(r.then!=null){let n=Je({objectMode:!0});return r.then(()=>{n.end()},s=>{n.end(s)}),Z6(n,async function*(){yield*t.source,n.end()}())}return t.source};function tC(t,...e){if(eC(t)){let n=t;t=()=>n.source}else if(Hz(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&eC(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)eC(r[n])&&(r[n]=uwe(r[n]));return cwe(...r)}var g$=J(bS(),1);function Hf(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function fb(t=0){return globalThis.Buffer?.allocUnsafe!=null?Hf(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}var rC={};T(rC,{base10:()=>lwe});var lwe=ga({prefix:"9",name:"base10",alphabet:"0123456789"});var nC={};T(nC,{base16:()=>fwe,base16upper:()=>hwe});var fwe=Pt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),hwe=Pt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var oC={};T(oC,{base2:()=>dwe});var dwe=Pt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var sC={};T(sC,{base256emoji:()=>bwe});var Gz=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),pwe=Gz.reduce((t,e,r)=>(t[r]=e,t),[]),mwe=Gz.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function gwe(t){return t.reduce((e,r)=>(e+=pwe[r],e),"")}function ywe(t){let e=[];for(let r of t){let n=mwe[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var bwe=qf({prefix:"\u{1F680}",name:"base256emoji",encode:gwe,decode:ywe});var iC={};T(iC,{base36:()=>wwe,base36upper:()=>xwe});var wwe=ga({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),xwe=ga({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var aC={};T(aC,{base8:()=>Ewe});var Ewe=Pt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var cC={};T(cC,{identity:()=>vwe});var vwe=qf({prefix:"\0",name:"identity",encode:t=>$z(t),decode:t=>zz(t)});var hrt=new TextEncoder,drt=new TextDecoder;var lC={};T(lC,{identity:()=>Hwe});var Cwe=Yz,Wz=128,Twe=127,_we=~Twe,Iwe=Math.pow(2,31);function Yz(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Iwe;)e[r++]=t&255|Wz,t/=128;for(;t&_we;)e[r++]=t&255|Wz,t>>>=7;return e[r]=t|0,Yz.bytes=r-n+1,e}var Dwe=uC,Rwe=128,jz=127;function uC(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw uC.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&jz)<<o:(i&jz)*Math.pow(2,o),o+=7}while(i>=Rwe);return uC.bytes=s-n,r}var Lwe=Math.pow(2,7),Bwe=Math.pow(2,14),Pwe=Math.pow(2,21),Nwe=Math.pow(2,28),Owe=Math.pow(2,35),Uwe=Math.pow(2,42),kwe=Math.pow(2,49),Mwe=Math.pow(2,56),Fwe=Math.pow(2,63),Vwe=function(t){return t<Lwe?1:t<Bwe?2:t<Pwe?3:t<Nwe?4:t<Owe?5:t<Uwe?6:t<kwe?7:t<Mwe?8:t<Fwe?9:10},zwe={encode:Cwe,decode:Dwe,encodingLength:Vwe},$we=zwe,Xp=$we;var Jp=(t,e=0)=>[Xp.decode(t,e),Xp.decode.bytes],Gf=(t,e,r=0)=>(Xp.encode(t,e,r),e),Wf=t=>Xp.encodingLength(t);var Dc=(t,e)=>{let r=e.byteLength,n=Wf(t),o=n+Wf(r),s=new Uint8Array(o+r);return Gf(t,s,0),Gf(r,s,n),s.set(e,o),new jf(t,r,e,s)},Qz=t=>{let e=oi(t),[r,n]=Jp(e),[o,s]=Jp(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new jf(r,o,i,e)},Xz=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Vz(t.bytes,r.bytes)}},jf=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var Jz=0,Kwe="identity",Zz=oi,qwe=t=>Dc(Jz,Zz(t)),Hwe={code:Jz,name:Kwe,encode:Zz,digest:qwe};var dC={};T(dC,{sha256:()=>Gwe,sha512:()=>Wwe});var hC=({name:t,code:e,encode:r})=>new fC(t,e,r),fC=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Dc(this.code,r):r.then(n=>Dc(this.code,n))}else throw Error("Unknown type, must be binary type")}};var t$=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Gwe=hC({name:"sha2-256",code:18,encode:t$("SHA-256")}),Wwe=hC({name:"sha2-512",code:19,encode:t$("SHA-512")});var r$=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Ywe(r,pC(t),e||Qn.encoder);default:return Qwe(r,pC(t),e||ya.encoder)}};var n$=new WeakMap,pC=t=>{let e=n$.get(t);if(e==null){let r=new Map;return n$.set(t,r),r}return e},Yt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==e0)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Xwe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Yt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Dc(e,r);return Yt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Yt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Xz(e.multihash,n.multihash)}toString(e){return r$(this,e)}toJSON(){return{"/":r$(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof Yt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new Yt(n,o,s,i||o$(n,o,s.bytes))}else if(r[Jwe]===!0){let{version:n,multihash:o,code:s}=r,i=Qz(o);return Yt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==e0)throw new Error(`Version 0 CID must use dag-pb (code: ${e0}) block encoding`);return new Yt(e,r,n,n.bytes)}case 1:{let o=o$(e,r,n.bytes);return new Yt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return Yt.create(0,e0,e)}static createV1(e,r){return Yt.create(1,e,r)}static decode(e){let[r,n]=Yt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Yt.inspectBytes(e),n=r.size-r.multihashSize,o=oi(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new jf(r.multihashCode,r.digestSize,s,o);return[r.version===0?Yt.createV0(i):Yt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Jp(e.subarray(r));return r+=p,h},o=n(),s=e0;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=jwe(e,r),s=Yt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return pC(s).set(n,e),s}},jwe=(t,e)=>{switch(t[0]){case"Q":{let r=e||Qn;return[Qn.prefix,r.decode(`${Qn.prefix}${t}`)]}case Qn.prefix:{let r=e||Qn;return[Qn.prefix,r.decode(t)]}case ya.prefix:{let r=e||ya;return[ya.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Ywe=(t,e,r)=>{let{prefix:n}=r;if(n!==Qn.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},Qwe=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},e0=112,Xwe=18,o$=(t,e,r)=>{let n=Wf(t),o=n+Wf(e),s=new Uint8Array(o+r.byteLength);return Gf(t,s,0),Gf(e,s,n),s.set(r,o),s},Jwe=Symbol.for("@ipld/js-cid/CID");var mC={...cC,...oC,...aC,...rC,...nC,...Y6,...iC,...Q6,...J6,...sC},Drt={...dC,...lC};function i$(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var s$=i$("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),gC=i$("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=fb(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Zwe={utf8:s$,"utf-8":s$,hex:mC.base16,latin1:gC,ascii:gC,binary:gC,...mC},db=Zwe;function yC(t,e="utf8"){let r=db[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Hf(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function t0(t,e="utf8"){let r=db[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var ye;(function(t){t[t.NEW_STREAM=0]="NEW_STREAM",t[t.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",t[t.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",t[t.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",t[t.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",t[t.RESET_RECEIVER=5]="RESET_RECEIVER",t[t.RESET_INITIATOR=6]="RESET_INITIATOR"})(ye||(ye={}));var r0=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),bC=Object.freeze({NEW_STREAM:ye.NEW_STREAM,MESSAGE:ye.MESSAGE_INITIATOR,CLOSE:ye.CLOSE_INITIATOR,RESET:ye.RESET_INITIATOR}),a$=Object.freeze({MESSAGE:ye.MESSAGE_RECEIVER,CLOSE:ye.CLOSE_RECEIVER,RESET:ye.RESET_RECEIVER});var wC=1<<20,exe=4<<20,pb=class{_buffer;_headerInfo;_maxMessageSize;_maxUnprocessedMessageQueueSize;constructor(e=wC,r=exe){this._buffer=new ue,this._headerInfo=null,this._maxMessageSize=e,this._maxUnprocessedMessageQueueSize=r}write(e){if(e==null||e.length===0)return[];if(this._buffer.append(e),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});let r=[];for(;this._buffer.length!==0;){if(this._headerInfo==null)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(u){if(u.code==="ERR_MSG_TOO_BIG")throw u;break}let{id:n,type:o,length:s,offset:i}=this._headerInfo;if(this._buffer.length-i<s)break;let c={id:n,type:o};(o===ye.NEW_STREAM||o===ye.MESSAGE_INITIATOR||o===ye.MESSAGE_RECEIVER)&&(c.data=this._buffer.sublist(i,i+s)),r.push(c),this._buffer.consume(i+s),this._headerInfo=null}return r}_decodeHeader(e){let{value:r,offset:n}=u$(e),{value:o,offset:s}=u$(e,n),i=r&7;if(r0[i]==null)throw new Error(`Invalid type received: ${i}`);if(o>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:r>>3,type:i,offset:n+s,length:o}}},txe=128,c$=127;function u$(t,e=0){let r=0,n=0,o=e,s,i=t.length;do{if(o>=i||n>49)throw e=0,new RangeError("Could not decode varint");s=t.get(o++),r+=n<28?(s&c$)<<n:(s&c$)*Math.pow(2,n),n+=7}while(s>=txe);return e=o-e,{value:r,offset:e}}function rxe(t){return t[Symbol.asyncIterator]!=null}var mb=1024*1024,l$=(t,e)=>{e.append(t)};function nxe(t,e){return rxe(t)?async function*(){let r=new ue,n=!1,o=ze(),s=Number(e?.size??mb);if((isNaN(s)||s===0||s<0)&&(s=mb),s!==Math.round(s))throw new Error("Batch size must be an integer");let i=e?.yieldAfter??0,a=e?.serialize??l$;for(Promise.resolve().then(async()=>{try{let c;for await(let u of t){if(a(u,r),r.byteLength>=s){clearTimeout(c),o.resolve();continue}c=setTimeout(()=>{o.resolve()},i)}clearTimeout(c),o.resolve()}catch(c){o.reject(c)}finally{n=!0}});!n;)if(await o.promise,o=ze(),r.byteLength>0){let c=r;r=new ue,yield c.subarray()}}():function*(){let r=new ue,n=Number(e?.size??mb);if((isNaN(n)||n===0||n<0)&&(n=mb),n!==Math.round(n))throw new Error("Batch size must be an integer");let o=e?.serialize??l$;for(let s of t)o(s,r),r.byteLength>=n&&(yield r.subarray(0,n),r.consume(n));r.byteLength>0&&(yield r.subarray())}()}var f$=nxe;function xC(t){return new Uint8Array(t)}var EC=10*1024,vC=class{_pool;_poolOffset;constructor(){this._pool=xC(EC),this._poolOffset=0}write(e,r){let n=this._pool,o=this._poolOffset;re(e.id<<3|e.type,n,o),o+=X(e.id<<3|e.type),(e.type===ye.NEW_STREAM||e.type===ye.MESSAGE_INITIATOR||e.type===ye.MESSAGE_RECEIVER)&&e.data!=null?(re(e.data.length,n,o),o+=X(e.data.length)):(re(0,n,o),o+=X(0));let s=n.subarray(this._poolOffset,o);EC-o<100?(this._pool=xC(EC),this._poolOffset=0):this._poolOffset=o,r.append(s),(e.type===ye.NEW_STREAM||e.type===ye.MESSAGE_INITIATOR||e.type===ye.MESSAGE_RECEIVER)&&e.data!=null&&r.append(e.data)}},h$=new vC;async function*d$(t,e=0){if(e==null||e===0){for await(let r of t){let n=new ue;for(let o of r)h$.write(o,n);yield n.subarray()}return}yield*f$(t,{size:e,serialize:(r,n)=>{for(let o of r)h$.write(o,n)}})}var SC=class extends Ef{name;streamId;send;types;maxDataSize;constructor(e){super(e),this.types=e.direction==="outbound"?bC:a$,this.send=e.send,this.name=e.name,this.streamId=e.streamId,this.maxDataSize=e.maxDataSize}async sendNewStream(){await this.send({id:this.streamId,type:bC.NEW_STREAM,data:new ue(yC(this.name))})}async sendData(e){for(e=e.sublist();e.byteLength>0;){let r=Math.min(e.byteLength,this.maxDataSize);await this.send({id:this.streamId,type:this.types.MESSAGE,data:e.sublist(0,r)}),e.consume(r)}}async sendReset(){await this.send({id:this.streamId,type:this.types.RESET})}async sendCloseWrite(){await this.send({id:this.streamId,type:this.types.CLOSE})}async sendCloseRead(){}};function p$(t){let{id:e,name:r,send:n,onEnd:o,type:s="initiator",maxMsgSize:i=wC}=t;return new SC({id:s==="initiator"?`i${e}`:`r${e}`,streamId:e,name:`${r??e}`,direction:s==="initiator"?"outbound":"inbound",maxDataSize:i,onEnd:o,send:n,log:lb(`libp2p:mplex:stream:${s}:${e}`)})}var Un=lb("libp2p:mplex"),oxe=1024,sxe=1024,ixe=1024*1024*4,axe=5,cxe=500;function m$(t){let e={...t,type:`${r0[t.type]} (${t.type})`};return t.type===ye.NEW_STREAM&&(e.data=t0(t.data instanceof Uint8Array?t.data:t.data.subarray())),(t.type===ye.MESSAGE_INITIATOR||t.type===ye.MESSAGE_RECEIVER)&&(e.data=t0(t.data instanceof Uint8Array?t.data:t.data.subarray(),"base16")),e}var gb=class{protocol="/mplex/6.7.0";sink;source;_streamId;_streams;_init;_source;closeController;rateLimiter;closeTimeout;constructor(e){e=e??{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=e,this.closeTimeout=e.closeTimeout??cxe,this.sink=this._createSink(),this._source=lU({objectMode:!0,onEnd:()=>{for(let r of this._streams.initiators.values())r.destroy();for(let r of this._streams.receivers.values())r.destroy()}}),this.source=tC(this._source,r=>d$(r,this._init.minSendBytes)),this.closeController=new AbortController,this.rateLimiter=new g$.RateLimiterMemory({points:e.disconnectThreshold??axe,duration:1})}get streams(){let e=[];for(let r of this._streams.initiators.values())e.push(r);for(let r of this._streams.receivers.values())e.push(r);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");let r=this._streamId++;e=e==null?r.toString():e.toString();let n=this._streams.initiators;return this._newStream({id:r,name:e,type:"initiator",registry:n})}async close(e){if(this.closeController.signal.aborted)return;let r=e?.signal??AbortSignal.timeout(this.closeTimeout);try{await Promise.all(this.streams.map(async n=>n.close({signal:r}))),this._source.end(),await this._source.onEmpty({signal:r}),this.closeController.abort()}catch(n){this.abort(n)}}abort(e){this.closeController.signal.aborted||(this.streams.forEach(r=>{r.abort(e)}),this.closeController.abort(e))}_newReceiverStream(e){let{id:r,name:n}=e,o=this._streams.receivers;return this._newStream({id:r,name:n,type:"receiver",registry:o})}_newStream(e){let{id:r,name:n,type:o,registry:s}=e;if(Un("new %s stream %s",o,r),o==="initiator"&&this._streams.initiators.size===(this._init.maxOutboundStreams??sxe))throw new C("Too many outbound streams open","ERR_TOO_MANY_OUTBOUND_STREAMS");if(s.has(r))throw new Error(`${o} stream ${r} already exists!`);let c=p$({id:r,name:n,send:async u=>{Un.enabled&&Un.trace("%s stream %s send",o,r,m$(u)),this._source.push(u)},type:o,onEnd:()=>{Un("%s stream with id %s and protocol %s ended",o,r,c.protocol),s.delete(r),this._init.onStreamEnd!=null&&this._init.onStreamEnd(c)},maxMsgSize:this._init.maxMsgSize});return s.set(r,c),c}_createSink(){return async r=>{try{r=go(r,this.closeController.signal,{returnOnAbort:!0});let n=new pb(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);for await(let o of r)for(let s of n.write(o))await this._handleIncoming(s);this._source.end()}catch(n){Un("error in sink",n),this._source.end(n)}}}async _handleIncoming(e){let{id:r,type:n}=e;if(Un.enabled&&Un.trace("incoming message",m$(e)),e.type===ye.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??oxe)){Un("too many inbound streams open"),this._source.push({id:r,type:ye.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{Un("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),this.abort(new Error("Too many open streams"));return}return}let a=this._newReceiverStream({id:r,name:t0(e.data instanceof Uint8Array?e.data:e.data.subarray())});this._init.onIncomingStream!=null&&this._init.onIncomingStream(a);return}let s=((n&1)===1?this._streams.initiators:this._streams.receivers).get(r);if(s==null){Un("missing stream %s for message type %s",r,r0[n]);try{await this.rateLimiter.consume("missing-stream",1)}catch{Un("rate limit hit when receiving messages for streams that do not exist - closing remote connection"),this.abort(new Error("Too many messages for missing streams"));return}return}let i=this._init.maxStreamBufferSize??ixe;try{switch(n){case ye.MESSAGE_INITIATOR:case ye.MESSAGE_RECEIVER:if(s.sourceReadableLength()>i)throw this._source.push({id:e.id,type:n===ye.MESSAGE_INITIATOR?ye.RESET_RECEIVER:ye.RESET_INITIATOR}),new C("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers","ERR_STREAM_INPUT_BUFFER_FULL");s.sourcePush(e.data);break;case ye.CLOSE_INITIATOR:case ye.CLOSE_RECEIVER:s.remoteCloseWrite();break;case ye.RESET_INITIATOR:case ye.RESET_RECEIVER:s.reset();break;default:Un("unknown message type %s",n)}}catch(a){Un.error("error while processing message",a),s.abort(a)}}};var AC=class{protocol="/mplex/6.7.0";_init;constructor(e={}){this._init=e}createStreamMuxer(e={}){return new gb({...e,...this._init})}};function Lnt(t={}){return()=>new AC(t)}var DC={};T(DC,{identity:()=>pxe});function uxe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var lxe=uxe,fxe=lxe,y$=fxe;var Nnt=new Uint8Array(0);var b$=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},si=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var w$=t=>new TextEncoder().encode(t),x$=t=>new TextDecoder().decode(t);var CC=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},TC=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return v$(this,e)}},_C=class{constructor(e){this.decoders=e}or(e){return v$(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},v$=(t,e)=>new _C({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),IC=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new CC(e,r,n),this.decoder=new TC(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Yf=({name:t,prefix:e,encode:r,decode:n})=>new IC(t,e,r,n),ba=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=y$(r,e);return Yf({prefix:t,name:e,encode:n,decode:s=>si(o(s))})},hxe=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},dxe=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Nt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Yf({prefix:e,name:t,encode(o){return dxe(o,n,r)},decode(o){return hxe(o,n,r,t)}});var pxe=Yf({prefix:"\0",name:"identity",encode:t=>x$(t),decode:t=>w$(t)});var RC={};T(RC,{base2:()=>mxe});var mxe=Nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var LC={};T(LC,{base8:()=>gxe});var gxe=Nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var BC={};T(BC,{base10:()=>yxe});var yxe=ba({prefix:"9",name:"base10",alphabet:"0123456789"});var PC={};T(PC,{base16:()=>bxe,base16upper:()=>wxe});var bxe=Nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),wxe=Nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var NC={};T(NC,{base32:()=>Qf,base32hex:()=>Sxe,base32hexpad:()=>Cxe,base32hexpadupper:()=>Txe,base32hexupper:()=>Axe,base32pad:()=>Exe,base32padupper:()=>vxe,base32upper:()=>xxe,base32z:()=>_xe});var Qf=Nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xxe=Nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Exe=Nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),vxe=Nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Sxe=Nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Axe=Nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Cxe=Nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Txe=Nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_xe=Nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var OC={};T(OC,{base36:()=>Ixe,base36upper:()=>Dxe});var Ixe=ba({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Dxe=ba({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var UC={};T(UC,{base58btc:()=>Yo,base58flickr:()=>Rxe});var Yo=ba({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Rxe=ba({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var kC={};T(kC,{base64:()=>Lxe,base64pad:()=>Bxe,base64url:()=>Pxe,base64urlpad:()=>Nxe});var Lxe=Nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Bxe=Nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Pxe=Nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Nxe=Nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var MC={};T(MC,{base256emoji:()=>Fxe});var S$=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Oxe=S$.reduce((t,e,r)=>(t[r]=e,t),[]),Uxe=S$.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function kxe(t){return t.reduce((e,r)=>(e+=Oxe[r],e),"")}function Mxe(t){let e=[];for(let r of t){let n=Uxe[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Fxe=Yf({prefix:"\u{1F680}",name:"base256emoji",encode:kxe,decode:Mxe});var $C={};T($C,{sha256:()=>o2e,sha512:()=>s2e});var Vxe=T$,A$=128,zxe=127,$xe=~zxe,Kxe=Math.pow(2,31);function T$(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Kxe;)e[r++]=t&255|A$,t/=128;for(;t&$xe;)e[r++]=t&255|A$,t>>>=7;return e[r]=t|0,T$.bytes=r-n+1,e}var qxe=FC,Hxe=128,C$=127;function FC(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw FC.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&C$)<<o:(i&C$)*Math.pow(2,o),o+=7}while(i>=Hxe);return FC.bytes=s-n,r}var Gxe=Math.pow(2,7),Wxe=Math.pow(2,14),jxe=Math.pow(2,21),Yxe=Math.pow(2,28),Qxe=Math.pow(2,35),Xxe=Math.pow(2,42),Jxe=Math.pow(2,49),Zxe=Math.pow(2,56),e2e=Math.pow(2,63),t2e=function(t){return t<Gxe?1:t<Wxe?2:t<jxe?3:t<Yxe?4:t<Qxe?5:t<Xxe?6:t<Jxe?7:t<Zxe?8:t<e2e?9:10},r2e={encode:Vxe,decode:qxe,encodingLength:t2e},n2e=r2e,n0=n2e;var o0=(t,e=0)=>[n0.decode(t,e),n0.decode.bytes],Xf=(t,e,r=0)=>(n0.encode(t,e,r),e),Jf=t=>n0.encodingLength(t);var Rc=(t,e)=>{let r=e.byteLength,n=Jf(t),o=n+Jf(r),s=new Uint8Array(o+r);return Xf(t,s,0),Xf(r,s,n),s.set(e,o),new Zf(t,r,e,s)},_$=t=>{let e=si(t),[r,n]=o0(e),[o,s]=o0(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Zf(r,o,i,e)},I$=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&b$(t.bytes,r.bytes)}},Zf=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var zC=({name:t,code:e,encode:r})=>new VC(t,e,r),VC=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Rc(this.code,r):r.then(n=>Rc(this.code,n))}else throw Error("Unknown type, must be binary type")}};var R$=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),o2e=zC({name:"sha2-256",code:18,encode:R$("SHA-256")}),s2e=zC({name:"sha2-512",code:19,encode:R$("SHA-512")});var KC={};T(KC,{identity:()=>c2e});var L$=0,i2e="identity",B$=si,a2e=t=>Rc(L$,B$(t)),c2e={code:L$,name:i2e,encode:B$,digest:a2e};var tot=new TextEncoder,rot=new TextDecoder;var P$=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return h2e(r,qC(t),e||Yo.encoder);default:return d2e(r,qC(t),e||Qf.encoder)}};var N$=new WeakMap,qC=t=>{let e=N$.get(t);if(e==null){let r=new Map;return N$.set(t,r),r}return e},Qt=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==i0)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==p2e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Qt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Rc(e,r);return Qt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Qt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&I$(e.multihash,n.multihash)}toString(e){return P$(this,e)}toJSON(){return{"/":P$(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof Qt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new Qt(n,o,s,i||O$(n,o,s.bytes))}else if(r[m2e]===!0){let{version:n,multihash:o,code:s}=r,i=_$(o);return Qt.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==i0)throw new Error(`Version 0 CID must use dag-pb (code: ${i0}) block encoding`);return new Qt(e,r,n,n.bytes)}case 1:{let o=O$(e,r,n.bytes);return new Qt(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return Qt.create(0,i0,e)}static createV1(e,r){return Qt.create(1,e,r)}static decode(e){let[r,n]=Qt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Qt.inspectBytes(e),n=r.size-r.multihashSize,o=si(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new Zf(r.multihashCode,r.digestSize,s,o);return[r.version===0?Qt.createV0(i):Qt.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=o0(e.subarray(r));return r+=p,h},o=n(),s=i0;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=f2e(e,r),s=Qt.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return qC(s).set(n,e),s}},f2e=(t,e)=>{switch(t[0]){case"Q":{let r=e||Yo;return[Yo.prefix,r.decode(`${Yo.prefix}${t}`)]}case Yo.prefix:{let r=e||Yo;return[Yo.prefix,r.decode(t)]}case Qf.prefix:{let r=e||Qf;return[Qf.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},h2e=(t,e,r)=>{let{prefix:n}=r;if(n!==Yo.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},d2e=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},i0=112,p2e=18,O$=(t,e,r)=>{let n=Jf(t),o=n+Jf(e),s=new Uint8Array(o+r.byteLength);return Xf(t,s,0),Xf(e,s,n),s.set(r,o),s},m2e=Symbol.for("@ipld/js-cid/CID");var HC={...DC,...RC,...LC,...BC,...PC,...NC,...OC,...UC,...kC,...MC},hot={...$C,...KC};function eh(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function bb(t=0){return globalThis.Buffer?.allocUnsafe!=null?eh(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function k$(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var U$=k$("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),GC=k$("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=bb(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),g2e={utf8:U$,"utf-8":U$,hex:HC.base16,latin1:GC,ascii:GC,binary:GC,...HC},wb=g2e;function cn(t,e="utf8"){let r=wb[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var M$=cr,y2e=ur,WC=function(t){let e=0;if(t=t.toString().trim(),M$(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(y2e(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let s=M$(r[n]),i;s&&(i=WC(r[n]),r[n]=cn(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,cn(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let o=new Uint8Array(e+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);o[e++]=s>>8&255,o[e++]=s&255}return o}throw new Error("invalid ip address")},F$=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let o=[];for(let s=0;s<r;s++)o.push(t[e+s]);return o.join(".")}if(r===16){let o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(e+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var a0={},jC={},w2e=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];w2e.forEach(t=>{let e=x2e(...t);jC[e.code]=e,a0[e.name]=e});function x2e(t,e,r,n,o){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(o)}}function ft(t){if(typeof t=="number"){if(jC[t]!=null)return jC[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(a0[t]!=null)return a0[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var E2e=$$,V$=128,v2e=127,S2e=~v2e,A2e=Math.pow(2,31);function $$(t,e,r){e=e||[],r=r||0;for(var n=r;t>=A2e;)e[r++]=t&255|V$,t/=128;for(;t&S2e;)e[r++]=t&255|V$,t>>>=7;return e[r]=t|0,$$.bytes=r-n+1,e}var C2e=YC,T2e=128,z$=127;function YC(t,n){var r=0,n=n||0,o=0,s=n,i,a=t.length;do{if(s>=a)throw YC.bytes=0,new RangeError("Could not decode varint");i=t[s++],r+=o<28?(i&z$)<<o:(i&z$)*Math.pow(2,o),o+=7}while(i>=T2e);return YC.bytes=s-n,r}var _2e=Math.pow(2,7),I2e=Math.pow(2,14),D2e=Math.pow(2,21),R2e=Math.pow(2,28),L2e=Math.pow(2,35),B2e=Math.pow(2,42),P2e=Math.pow(2,49),N2e=Math.pow(2,56),O2e=Math.pow(2,63),U2e=function(t){return t<_2e?1:t<I2e?2:t<D2e?3:t<R2e?4:t<L2e?5:t<B2e?6:t<P2e?7:t<N2e?8:t<O2e?9:10},k2e={encode:E2e,decode:C2e,encodingLength:U2e},M2e=k2e,c0=M2e;var u0=(t,e=0)=>[c0.decode(t,e),c0.decode.bytes],th=(t,e,r=0)=>(c0.encode(t,e,r),e),rh=t=>c0.encodingLength(t);var Iot=new Uint8Array(0);var K$=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ii=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var q$=t=>new TextEncoder().encode(t),H$=t=>new TextDecoder().decode(t);var Lc=(t,e)=>{let r=e.byteLength,n=rh(t),o=n+rh(r),s=new Uint8Array(o+r);return th(t,s,0),th(r,s,n),s.set(e,o),new nh(t,r,e,s)},Eb=t=>{let e=ii(t),[r,n]=u0(e),[o,s]=u0(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new nh(r,o,i,e)},W$=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&K$(t.bytes,r.bytes)}},nh=class{constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};var eT={};T(eT,{base58btc:()=>un,base58flickr:()=>q2e});function F2e(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var s=t.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var d=0,g=0,y=0,b=f.length;y!==b&&f[y]===0;)y++,d++;for(var w=(b-y)*l+1>>>0,x=new Uint8Array(w);y!==b;){for(var E=f[y],S=0,v=w-1;(E!==0||S<g)&&v!==-1;v--,S++)E+=256*x[v]>>>0,x[v]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");g=S,y++}for(var A=w-g;A!==w&&x[A]===0;)A++;for(var _=c.repeat(d);A<w;++A)_+=t.charAt(x[A]);return _}function p(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var d=0;if(f[d]!==" "){for(var g=0,y=0;f[d]===c;)g++,d++;for(var b=(f.length-d)*u+1>>>0,w=new Uint8Array(b);f[d];){var x=r[f.charCodeAt(d)];if(x===255)return;for(var E=0,S=b-1;(x!==0||E<y)&&S!==-1;S--,E++)x+=a*w[S]>>>0,w[S]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");y=E,d++}if(f[d]!==" "){for(var v=b-y;v!==b&&w[v]===0;)v++;for(var A=new Uint8Array(g+(b-v)),_=g;v!==b;)A[_++]=w[v++];return A}}}function m(f){var d=p(f);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:m}}var V2e=F2e,z2e=V2e,j$=z2e;var QC=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},XC=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Y$(this,e)}},JC=class{constructor(e){this.decoders=e}or(e){return Y$(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Y$=(t,e)=>new JC({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),ZC=class{constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new QC(e,r,n),this.decoder=new XC(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},sh=({name:t,prefix:e,encode:r,decode:n})=>new ZC(t,e,r,n),wa=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:o}=j$(r,e);return sh({prefix:t,name:e,encode:n,decode:s=>ii(o(s))})},$2e=(t,e,r,n)=>{let o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let i=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let h=o[t[l]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,i[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return i},K2e=(t,e,r)=>{let n=e[e.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],i+=8;i>r;)i-=r,s+=e[o&a>>i];if(i&&(s+=e[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},Ot=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>sh({prefix:e,name:t,encode(o){return K2e(o,n,r)},decode(o){return $2e(o,n,r,t)}});var un=wa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),q2e=wa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var tT={};T(tT,{base32:()=>ai,base32hex:()=>j2e,base32hexpad:()=>Q2e,base32hexpadupper:()=>X2e,base32hexupper:()=>Y2e,base32pad:()=>G2e,base32padupper:()=>W2e,base32upper:()=>H2e,base32z:()=>J2e});var ai=Ot({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),H2e=Ot({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),G2e=Ot({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),W2e=Ot({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),j2e=Ot({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Y2e=Ot({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Q2e=Ot({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),X2e=Ot({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),J2e=Ot({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Q$=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return e1e(r,rT(t),e||un.encoder);default:return t1e(r,rT(t),e||ai.encoder)}};var X$=new WeakMap,rT=t=>{let e=X$.get(t);if(e==null){let r=new Map;return X$.set(t,r),r}return e},ht=class{constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==l0)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==r1e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ht.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Lc(e,r);return ht.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ht.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&W$(e.multihash,n.multihash)}toString(e){return Q$(this,e)}toJSON(){return{"/":Q$(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof ht)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new ht(n,o,s,i||J$(n,o,s.bytes))}else if(r[n1e]===!0){let{version:n,multihash:o,code:s}=r,i=Eb(o);return ht.create(n,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==l0)throw new Error(`Version 0 CID must use dag-pb (code: ${l0}) block encoding`);return new ht(e,r,n,n.bytes)}case 1:{let o=J$(e,r,n.bytes);return new ht(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return ht.create(0,l0,e)}static createV1(e,r){return ht.create(1,e,r)}static decode(e){let[r,n]=ht.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=ht.inspectBytes(e),n=r.size-r.multihashSize,o=ii(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new nh(r.multihashCode,r.digestSize,s,o);return[r.version===0?ht.createV0(i):ht.createV1(r.codec,i),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=u0(e.subarray(r));return r+=p,h},o=n(),s=l0;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),u=r+c,l=u-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,o]=Z2e(e,r),s=ht.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return rT(s).set(n,e),s}},Z2e=(t,e)=>{switch(t[0]){case"Q":{let r=e||un;return[un.prefix,r.decode(`${un.prefix}${t}`)]}case un.prefix:{let r=e||un;return[un.prefix,r.decode(t)]}case ai.prefix:{let r=e||ai;return[ai.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},e1e=(t,e,r)=>{let{prefix:n}=r;if(n!==un.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return o},t1e=(t,e,r)=>{let{prefix:n}=r,o=e.get(n);if(o==null){let s=r.encode(t);return e.set(n,s),s}else return o},l0=112,r1e=18,J$=(t,e,r)=>{let n=rh(t),o=n+rh(e),s=new Uint8Array(o+r.byteLength);return th(t,s,0),th(e,s,n),s.set(r,o),s},n1e=Symbol.for("@ipld/js-cid/CID");var nT={};T(nT,{identity:()=>o1e});var o1e=sh({prefix:"\0",name:"identity",encode:t=>H$(t),decode:t=>q$(t)});var oT={};T(oT,{base2:()=>s1e});var s1e=Ot({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var sT={};T(sT,{base8:()=>i1e});var i1e=Ot({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var iT={};T(iT,{base10:()=>a1e});var a1e=wa({prefix:"9",name:"base10",alphabet:"0123456789"});var aT={};T(aT,{base16:()=>c1e,base16upper:()=>u1e});var c1e=Ot({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),u1e=Ot({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var cT={};T(cT,{base36:()=>l1e,base36upper:()=>f1e});var l1e=wa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),f1e=wa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var uT={};T(uT,{base64:()=>h1e,base64pad:()=>d1e,base64url:()=>p1e,base64urlpad:()=>m1e});var h1e=Ot({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),d1e=Ot({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),p1e=Ot({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),m1e=Ot({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var lT={};T(lT,{base256emoji:()=>x1e});var Z$=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),g1e=Z$.reduce((t,e,r)=>(t[r]=e,t),[]),y1e=Z$.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function b1e(t){return t.reduce((e,r)=>(e+=g1e[r],e),"")}function w1e(t){let e=[];for(let r of t){let n=y1e[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var x1e=sh({prefix:"\u{1F680}",name:"base256emoji",encode:b1e,decode:w1e});var dT={};T(dT,{sha256:()=>E1e,sha512:()=>v1e});var hT=({name:t,code:e,encode:r})=>new fT(t,e,r),fT=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Lc(this.code,r):r.then(n=>Lc(this.code,n))}else throw Error("Unknown type, must be binary type")}};var tK=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),E1e=hT({name:"sha2-256",code:18,encode:tK("SHA-256")}),v1e=hT({name:"sha2-512",code:19,encode:tK("SHA-512")});var pT={};T(pT,{identity:()=>C1e});var rK=0,S1e="identity",nK=ii,A1e=t=>Lc(rK,nK(t)),C1e={code:rK,name:S1e,encode:nK,digest:A1e};var Zot=new TextEncoder,est=new TextDecoder;var oK={...nT,...oT,...sT,...iT,...aT,...tT,...cT,...eT,...uT,...lT},sst={...dT,...pT};var Qo=J(vb(),1);function yT(t,e="utf8"){let r=wb[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?eh(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function ci(t,e){e==null&&(e=t.reduce((o,s)=>o+s.length,0));let r=bb(e),n=0;for(let o of t)r.set(o,n),n+=o.length;return eh(r)}function bK(t,e){switch(ft(t).code){case 4:case 41:return $1e(e);case 42:return gK(e);case 6:case 273:case 33:case 132:return xK(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return gK(e);case 421:return G1e(e);case 444:return yK(e);case 445:return yK(e);case 466:return H1e(e);default:return cn(e,"base16")}}function wK(t,e){switch(ft(t).code){case 4:return pK(e);case 41:return pK(e);case 42:return mK(e);case 6:case 273:case 33:case 132:return wT(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return mK(e);case 421:return K1e(e);case 444:return W1e(e);case 445:return j1e(e);case 466:return q1e(e);default:return yT(e,"base16")}}var bT=Object.values(oK).map(t=>t.decoder),z1e=function(){let t=bT[0].or(bT[1]);return bT.slice(2).forEach(e=>t=t.or(e)),t}();function pK(t){if(!xe(t))throw new Error("invalid ip address");return WC(t)}function $1e(t){let e=F$(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!xe(e))throw new Error("invalid ip address");return e}function wT(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function xK(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function mK(t){let e=yT(t),r=Uint8Array.from(Qo.default.encode(e.length));return ci([r,e],r.length+e.length)}function gK(t){let e=Qo.default.decode(t);if(t=t.slice(Qo.default.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return cn(t)}function K1e(t){let e;t[0]==="Q"||t[0]==="1"?e=Eb(un.decode(`z${t}`)).bytes:e=ht.parse(t).multihash.bytes;let r=Uint8Array.from(Qo.default.encode(e.length));return ci([r,e],r.length+e.length)}function q1e(t){let e=z1e.decode(t),r=Uint8Array.from(Qo.default.encode(e.length));return ci([r,e],r.length+e.length)}function H1e(t){let e=Qo.default.decode(t),r=t.slice(Qo.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return"u"+cn(r,"base64url")}function G1e(t){let e=Qo.default.decode(t),r=t.slice(Qo.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return cn(r,"base58btc")}function W1e(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=ai.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=wT(n);return ci([r,o],r.length+o.length)}function j1e(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=ai.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=wT(n);return ci([r,o],r.length+o.length)}function yK(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=cn(e,"base32"),o=xK(r);return`${n}:${o}`}var ih=J(vb(),1);function Y1e(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let o=r[n],s=ft(o);if(s.size===0){e.push([o]);continue}if(n++,n>=r.length)throw vK("invalid address: "+t);if(s.path===!0){e.push([o,AT(r.slice(n).join("/"))]);break}e.push([o,r[n]])}return e}function Q1e(t){let e=[];return t.map(r=>{let n=Cb(r);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),AT(e.join("/"))}function X1e(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=Cb(e);return e.length>1?[r.code,wK(r.code,e[1])]:[r.code]})}function xT(t){return t.map(e=>{let r=Cb(e);return e[1]!=null?[r.code,bK(r.code,e[1])]:[r.code]})}function ET(t){return Ab(ci(t.map(e=>{let r=Cb(e),n=Uint8Array.from(ih.default.encode(r.code));return e.length>1&&e[1]!=null&&(n=ci([n,e[1]])),n})))}function vT(t,e){return t.size>0?t.size/8:t.size===0?0:ih.default.decode(e)+(ih.default.decode.bytes??0)}function Sb(t){let e=[],r=0;for(;r<t.length;){let n=ih.default.decode(t,r),o=ih.default.decode.bytes??0,s=ft(n),i=vT(s,t.slice(r+o));if(i===0){e.push([n]),r+=o;continue}let a=t.slice(r+o,r+o+i);if(r+=i+o,r>t.length)throw vK("Invalid address Uint8Array: "+cn(t,"base16"));e.push([n,a])}return e}function ST(t){let e=Sb(t),r=xT(e);return Q1e(r)}function J1e(t){t=AT(t);let e=Y1e(t),r=X1e(e);return ET(r)}function EK(t){return J1e(t)}function Ab(t){let e=Z1e(t);if(e!=null)throw e;return Uint8Array.from(t)}function Z1e(t){try{Sb(t)}catch(e){return e}}function AT(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function vK(t){return new Error("Error parsing address: "+t)}function Cb(t){return ft(t[0])}var TT=J(vb(),1);var CK=J(og(),1);function SK(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var ah=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},CT=function(t,e,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(t,r):o?o.value=r:e.set(t,r),r},f0,h0,d0,AK,tEe=Symbol.for("nodejs.util.inspect.custom"),rEe=[ft("dns").code,ft("dns4").code,ft("dns6").code,ft("dnsaddr").code],nEe=new Map,TK=Symbol.for("@multiformats/js-multiaddr/multiaddr");function oEe(t){return Boolean(t?.[TK])}var ui=class{constructor(e){if(f0.set(this,void 0),h0.set(this,void 0),d0.set(this,void 0),this[AK]=!0,e==null&&(e=""),e instanceof Uint8Array)this.bytes=Ab(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=EK(e)}else if(oEe(e))this.bytes=Ab(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return ah(this,f0,"f")==null&&CT(this,f0,ST(this.bytes),"f"),ah(this,f0,"f")}toJSON(){return this.toString()}toOptions(){let e,r,n,o,s="",i=ft("tcp"),a=ft("udp"),c=ft("ip4"),u=ft("ip6"),l=ft("dns6"),h=ft("ip6zone");for(let[m,f]of this.stringTuples())m===h.code&&(s=`%${f??""}`),rEe.includes(m)&&(r=i.name,o=443,n=`${f??""}${s}`,e=m===l.code?6:4),(m===i.code||m===a.code)&&(r=ft(m).name,o=parseInt(f??"")),(m===c.code||m===u.code)&&(r=ft(m).name,n=`${f??""}${s}`,e=m===u.code?6:4);if(e==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:o}}protos(){return this.protoCodes().map(e=>Object.assign({},ft(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let o=TT.default.decode(r,n),s=TT.default.decode.bytes??0,i=ft(o);n+=vT(i,r.slice(n+s))+s,e.push(o)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return ah(this,h0,"f")==null&&CT(this,h0,Sb(this.bytes),"f"),ah(this,h0,"f")}stringTuples(){return ah(this,d0,"f")==null&&CT(this,d0,xT(this.tuples()),"f"),ah(this,d0,"f")}encapsulate(e){return e=new ui(e),new ui(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new ui(n.slice(0,o))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new ui(ET(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===a0.ipfs.code).pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?cn(un.decode(`z${n}`),"base58btc"):cn(ht.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>ft(r[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return SK(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=nEe.get(r.name);if(n==null)throw(0,CK.default)(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(s=>new ui(s))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[(f0=new WeakMap,h0=new WeakMap,d0=new WeakMap,AK=TK,tEe)](){return`Multiaddr(${ST(this.bytes)})`}};function sEe(t){return new ui(t)}M6();k6();O6();ob();jp();export{tqe as Message,iue as circuitRelayServer,Qle as circuitRelayTransport,RFe as createLibp2p,D4 as filters,U6 as fromString,rqe as identifyService,Lnt as mplex,sEe as multiaddr,eqe as multicodecs,lV as noise,tC as pipe,ft as protocols,R3 as pureJsCrypto,Je as pushable,N6 as toString,Ltt as webRTC,Rtt as webRTCDirect,MWe as webSockets};
/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
/**
 * @license
 * Copyright 2023 Scott J. Miles
 */
